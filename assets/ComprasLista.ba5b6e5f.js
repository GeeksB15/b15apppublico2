import{_ as se,a3 as Ce,r as gt,o as M,d as Y,w as i,f as t,M as jt,G as Ht,h as Nt,i as Rt,k as T,t as J,m as Vt,e as ot,H as vt,Q as dt,N as Et,I as Zt,J as Xt,p as _t,a_ as ke,a$ as le,b4 as Se,b5 as de,W as Mt,b6 as fe,d4 as pe,d5 as Ut,K as Yt,aU as re,D as $t,bh as ve,ar as zt,au as Ee,b3 as xt,s as ie,be as Lt,P as Pt,S as mt,T as Q,j as ct,U as nt,A as De,F as kt,u as Tt,C as ft,l as ue,aO as he,E as oe,bq as be,e0 as Ve,c as ee,bG as ae,e1 as Pe,as as xe,at as Fe,d6 as ze,aN as ge,z as Ne,O as Te}from"./index.7932c35a.js";import{L as Ae}from"./Lista.a12c5a6f.js";import{S as qe}from"./SeletorCfop.e7e15625.js";import{C as Be}from"./Campo.fc5583dc.js";import"./xlsx.0d030d2a.js";const Oe={components:{SeletorNcm:Ce,SeletorCfop:qe,Campo:Be},data(){return{abaSelecionada:"tab1",historicoItem:[],tabelaHistoricoItem:{colunas:[{name:"fornecedor",label:"Fornecedor",align:"left"},{name:"dataCompra",label:"Data Compra",align:"right"},{name:"quantidade",label:"Quantidade",align:"right"},{name:"valorCusto",label:"Valor de Custo",align:"right"},{name:"valorTotal",label:"Valor Total (Custo)",align:"right"}],paginacao:{page:1,rowsPerPage:5}},estoqueItem:[],tabelaEstoqueItem:{colunas:[{name:"empresa",label:"Empresa",align:"left"},{name:"tipoEstoque",label:"Tipo estoque",align:"right"},{name:"lote",label:"Lote",align:"right"},{name:"quantidade",label:"Quantidade",align:"right"}],paginacao:{page:1,rowsPerPage:5}},compra:{},cfop:null,cstIcms:"",cstIpi:"",contaEstoque:[],impostoCstIpi:[],impostoIcmsModalidade:[],impostoCstIcms:[],impostoCstIcmsSt:[],documentoItem:{},imposto:{},item:{},visivel:!1,contasOpcoes:[],exibirIcms:!1,exibirIcmsSt:!1,exibirIpi:!1,somenteLeituraIcms:!1,somenteLeituraIcmsSt:!1,exibirHistorico:!1,exibirEstoque:!1,exibeCfop:!1}},emits:["salvar"],methods:{async mostrar(r,a,h){var e,m,b,_;this.compra=h,this.documentoItem=$utils.clonarV2(r),this.item=$utils.clonarV2(a),await this.consultarHistoricoItem(this.item),await this.consultarEstoqueItem(this.item);const w=await $db.hibrido.lista({table:"impostoParametro",where:{impParamTipoCod:1}}),o=await $db.hibrido.lista({table:"impostoParametro",where:{impParamTipoCod:21}});this.impostoCstIcms=w.concat(o).map(f=>({rotulo:f.numero.trim()+" - "+f.descr,valor:Number(f.numero)})).sort((f,y)=>Number(f.valor)-Number(y.valor)),this.impostoIcmsModalidade=(await $db.hibrido.lista({table:"impostoParametro",where:{impParamTipoCod:3}})).map(f=>({rotulo:f.numero.trim()+" - "+f.descr,valor:Number(f.numero)})).sort((f,y)=>Number(f.valor)-Number(y.valor)),this.impostoCstIcmsSt=(await $db.hibrido.lista({table:"impostoParametro",where:{impParamTipoCod:4}})).map(f=>({rotulo:f.numero.trim()+" - "+f.descr,valor:Number(f.numero)})).sort((f,y)=>Number(f.valor)-Number(y.valor)),this.impostoCstIpi=(await $db.hibrido.lista({table:"impostoParametro",where:{impParamTipoCod:5}})).map(f=>({rotulo:f.numero.trim()+" - "+f.descr,valor:Number(f.numero)})).sort((f,y)=>Number(f.valor)-Number(y.valor)),this.contaEstoque=(await $db.hibrido.lista({table:"financeiroPlanoConta"})).map(f=>{var y,n,C;return{rotulo:(C=(n=(y=f==null?void 0:f.descricao)!=null?y:" - "+(f==null?void 0:f.classificacao))!=null?n:" - "+(f==null?void 0:f.caminho))!=null?C:"",valor:f.id}}).sort((f,y)=>Number(f.valor)-Number(y.valor));let s;(e=this.documentoItem)!=null&&e.idCfop&&(s=await $erp().cfop.where({id:this.documentoItem.idCfop}).first()),s===void 0&&console.log("CFOP inv\xE1lido");const c=this.documentoItem.total/(this.documentoItem.quantidade||1)||0;this.documentoItem.cfop=(m=s==null?void 0:s.cfop.toString())!=null?m:"",this.documentoItem.codigoCfop=(b=s==null?void 0:s.codigoCfop)!=null?b:null,this.documentoItem.idCfop=(_=s==null?void 0:s.id)!=null?_:null,this.documentoItem.valorBaseIcms=this.documentoItem.valorBaseIcms||c,this.documentoItem.valorBaseIpi=this.documentoItem.valorBaseIpi||c,this.documentoItem.valorBaseIcmsSt=this.documentoItem.valorBaseIcmsSt||c,this.calcularImpostos(),this.exibeCfop=!0,this.visivel=!0},async salvar(){try{if(this.exibirIcms||(this.documentoItem.modalidadeBaseCalculo=null,this.documentoItem.codigoCst=null,this.documentoItem.percentualIcms=0,this.documentoItem.valorIcms=0),this.exibirIcmsSt||(this.documentoItem.modalidadeBaseCalculoST=null,this.documentoItem.percentualIcmsSt=0,this.documentoItem.valorIcmsSt=0),this.exibirIpi||(this.documentoItem.codigoCstIpi=null,this.documentoItem.percentualIpi=0,this.documentoItem.valorIpi=0),Object.keys(this.documentoItem.cfop).length>0){const r=await $db.hibrido.lista({table:"cfop",where:{cfop:Number(this.documentoItem.cfop)}});this.documentoItem.codigoCfop=r[0].codigoCfop,this.documentoItem.idCfop=r[0].id}this.documentoItem.cfop&&delete this.documentoItem.cfop,this.$emit("salvar",this.documentoItem),this.exibirIcms=!1,this.exibirIcmsSt=!1,this.exibirIpi=!1,this.visivel=!1}catch(r){$q.notifyError("Ocorreu um erro ao salvar o produto: ",r.message)}finally{$q.notifyPositive("Produto salvo com sucesso.")}},calcularImpostos(r){var f,y,n,C,g,u,l,v,S,D;let a=(f=this.documentoItem.valorBaseIcms)!=null?f:0,h=(y=this.documentoItem.valorBaseIpi)!=null?y:0,w=(n=this.documentoItem.valorBaseIcmsSt)!=null?n:0,o=(C=this.documentoItem.percentualIcms)!=null?C:0,s=(g=this.documentoItem.percentualIpi)!=null?g:0,c=(u=this.documentoItem.percentualIVA)!=null?u:0,e=(l=this.documentoItem.percentualIcmsSt)!=null?l:0,m=(v=this.documentoItem.valorIcms)!=null?v:0,b=(S=this.documentoItem.valorIpi)!=null?S:0,_=(D=this.documentoItem.valorIcmsSt)!=null?D:0;["valorBaseIcms","percentualIcms"].includes(r)&&(m=a*o/100),r==="valorIcms"&&(o=m/a*100),["valorBaseIpi","percentualIpi"].includes(r)&&(b=h*s/100),r==="valorIpi"&&(s=b/h*100),r==="valorBaseIcmsSt"&&(c=0,w>0&&a>0&&w>=a&&(c=(w-a)/a*100),_=w*e/100-m),r==="percentualIVA"&&(w=a*(1+c/100),_=w*e/100-m),r==="percentualIcmsSt"&&(_=w*e/100-m),r==="valorIcmsSt"&&(e=_/w*100),this.documentoItem.valorBaseIcmsSt=parseFloat(w.toFixed(2)),this.documentoItem.percentualIcms=parseFloat(o.toFixed(2)),this.documentoItem.percentualIcmsSt=parseFloat(e.toFixed(2)),this.documentoItem.percentualIpi=parseFloat(s.toFixed(2)),this.documentoItem.percentualIVA=parseFloat(c.toFixed(2)),this.documentoItem.valorIcms=parseFloat(m.toFixed(2)),this.documentoItem.valorIcmsSt=parseFloat(_.toFixed(2)),this.documentoItem.valorIpi=parseFloat(b.toFixed(2)),(this.documentoItem.modalidadeBaseCalculo||this.documentoItem.codigoCst||this.documentoItem.percentualIcms>0||this.documentoItem.valorIcms>0)&&(this.exibirIcms=!0),(this.documentoItem.modalidadeBaseCalculoST||this.documentoItem.percentualIcmsSt>0||this.documentoItem.valorIcmsSt>0)&&(this.exibirIcmsSt=!0),(this.documentoItem.codigoCstIpi||this.documentoItem.percentualIpi>0||this.documentoItem.valorIpi>0)&&(this.exibirIpi=!0)},async consultarCFOP(){var h,w;const r=this.documentoItem.cfop,a=await $erp().cfop.where({cfop:Number(r)}).first();a===void 0&&console.log("CFOP inv\xE1lido"),this.documentoItem.idCfop=(h=a==null?void 0:a.id)!=null?h:null,this.documentoItem.codigoCfop=(w=a==null?void 0:a.CodigoCFOP)!=null?w:null},async consultarHistoricoItem(r){const a={};(r==null?void 0:r.atual)&&Object.keys(r.atual).length>0&&(r=r.atual);const w=(await $db.hibrido.lista({table:"documentoItem",where:{idItem:r.id}})).filter(o=>(o.operacao==="Compra"||o.operacao==="Compra de Mercadoria")&&o.status==="Finalizado"&&o.operacaoFator===1&&o.quantidade>0);for(const o of w){const s=await $db.hibrido.le({table:"documento",id:o.idDocumento}),c=await $db.hibrido.le({table:"contato",id:s.idContato});a[o.idItem]||(a[o.idItem]={fornecedores:[]}),a[o.idItem].fornecedores.push({fornecedor:c.apelido||"",dataCompra:s.dataCompra||"",quantidade:o.quantidade||"",valorCusto:o.valorItem||"",valorTotal:o.valorItem*o.quantidade||""})}Object.keys(a).length>0?(this.historicoItem=a,this.historicoItem[r.id].fornecedores.sort((o,s)=>{const c=new Date(o.dataCompra||"1900-01-01");return new Date(s.dataCompra||"1900-01-01")-c})):this.historicoItem[r.id]={fornecedores:[]},this.exibirHistorico=!0},async consultarEstoqueItem(r){const a={};(r==null?void 0:r.atual)&&Object.keys(r.atual).length>0&&(r=r.atual);const h=await $db.hibrido.lista({table:"estoqueSaldoProdutoEmpresa",where:{idItem:r.id},whereFilter:{tipoEstoque:"Dispon\xEDvel"}});for(const w of h){const o=await $db.hibrido.le({table:"contato",id:w.idEmpresa});a[w.idItem]||(a[w.idItem]={estoques:[]}),a[w.idItem].estoques.push({empresa:o.apelido||"",tipoEstoque:w.tipoEstoque||"",lote:w.lote||"-",quantidade:w.saldo||""})}Object.keys(a).length>0?(this.estoqueItem=a,this.estoqueItem[r.id].estoques.sort((w,o)=>{const s=Number(w.quantidade||0);return Number(o.quantidade||0)-s})):this.estoqueItem[r.id]={estoques:[]},this.exibirEstoque=!0},async fechar(){this.documentoItem.cfop&&delete this.documentoItem.cfop,this.exibirIcms=!1,this.exibirIcmsSt=!1,this.exibirIpi=!1}}},Ue=["src"],Re={key:0},Le={key:0};function Me(r,a,h,w,o,s){const c=gt("badge"),e=gt("g-col"),m=gt("g-row"),b=gt("campo"),_=gt("SeletorNcm"),f=gt("SeletorCfop"),y=gt("g-label");return M(),Y($t,{modelValue:o.visivel,"onUpdate:modelValue":a[36]||(a[36]=n=>o.visivel=n),persistent:""},{default:i(()=>[t(jt,{container:"",view:"hHh Lpr fFf",class:"bg-white",style:{"max-width":"980px"}},{default:i(()=>[t(Ht,{class:"bg-primary"},{default:i(()=>[t(Nt,{class:"bg-primary text-white"},{default:i(()=>[t(Rt,null,{default:i(()=>[T(J(o.documentoItem.descricaoItem),1)]),_:1}),o.item.referencia?(M(),Y(c,{key:0,cor:"tertiary",class:"q-mr-sm"},{default:i(()=>[T(J(o.item.referencia)+" ",1),t(Vt,null,{default:i(()=>a[37]||(a[37]=[T(" Refer\xEAncia ")])),_:1})]),_:1})):ot("",!0),o.item.codigoItem?(M(),Y(c,{key:1,cor:"positive",class:"q-mr-sm"},{default:i(()=>[T(" #"+J(o.item.codigoItem.toString().padStart(4,"0"))+" ",1),t(Vt,null,{default:i(()=>a[38]||(a[38]=[T(" C\xF3digo Item ")])),_:1})]),_:1})):ot("",!0),vt(t(dt,{onClick:s.fechar,dense:"",flat:"",icon:"close",round:""},null,8,["onClick"]),[[Et]])]),_:1})]),_:1}),t(Zt,null,{default:i(()=>[t(Xt,null,{default:i(()=>[t(m,{gutter:"md"},{default:i(()=>[t(e,null,{default:i(()=>[t(m,{class:"col-12 text-center"},{default:i(()=>[t(e,null,{default:i(()=>{var n,C,g,u,l,v;return[((n=o.item)==null?void 0:n.imagem)||((g=(C=o.item)==null?void 0:C.atual)==null?void 0:g.imagem)?(M(),_t("img",{key:0,src:((u=o.item)==null?void 0:u.imagem)||((v=(l=o.item)==null?void 0:l.atual)==null?void 0:v.imagem),alt:"",style:{"max-width":"33%"}},null,8,Ue)):ot("",!0)]}),_:1})]),_:1}),t(ke,{modelValue:o.abaSelecionada,"onUpdate:modelValue":a[0]||(a[0]=n=>o.abaSelecionada=n),align:"justify",dense:"","indicator-color":"light-blue-4",class:"text-primary q-px-sm"},{default:i(()=>[t(le,{default:"",name:"tab1",icon:"info",label:"Detalhes",class:"cinza"}),t(le,{name:"tab2",icon:"history",label:"Compras",class:"cinza"}),t(le,{name:"tab3",icon:"compare_arrows",label:"Estoque",class:"cinza"})]),_:1},8,["modelValue"]),t(Se,{modelValue:o.abaSelecionada,"onUpdate:modelValue":a[35]||(a[35]=n=>o.abaSelecionada=n),animated:"",class:"text-tertiary"},{default:i(()=>[t(de,{name:"tab1",class:"q-px-sm"},{default:i(()=>[t(m,null,{default:i(()=>[t(e,null,{default:i(()=>[t(b,{modelValue:o.documentoItem.observacao,"onUpdate:modelValue":a[1]||(a[1]=n=>o.documentoItem.observacao=n),tipo:"textoArea",rotulo:"Observa\xE7\xE3o",dense:"",rows:"4"},null,8,["modelValue"])]),_:1})]),_:1}),t(m,{mg:"lg-t"},{default:i(()=>[t(e,{col:"12"},{default:i(()=>[t(b,{modelValue:o.documentoItem.referenciaFornecedor,"onUpdate:modelValue":a[2]||(a[2]=n=>o.documentoItem.referenciaFornecedor=n),rotulo:"Refer\xEAncia Fornecedor"},null,8,["modelValue"])]),_:1})]),_:1}),t(m,{mg:"lg-t"},{default:i(()=>[t(e,{col:"12"},{default:i(()=>[t(_,{modelValue:o.documentoItem.ncm,"onUpdate:modelValue":a[3]||(a[3]=n=>o.documentoItem.ncm=n),class:"col-12 col-md-6",outlined:""},null,8,["modelValue"])]),_:1})]),_:1}),t(m,{mg:"lg-t"},{default:i(()=>[t(e,{col:"12"},{default:i(()=>[t(f,{modelValue:o.documentoItem.cfop,"onUpdate:modelValue":a[4]||(a[4]=n=>o.documentoItem.cfop=n),class:"col-12 col-md-6",outlined:""},null,8,["modelValue"])]),_:1})]),_:1}),t(m,{mg:"lg-t"},{default:i(()=>[t(e,null,{default:i(()=>[t(y,{text:"sub1 medium"},{default:i(()=>a[39]||(a[39]=[T("Estoque")])),_:1})]),_:1})]),_:1}),t(m,{items:"center"},{default:i(()=>[t(e,{col:"12"},{default:i(()=>[t(b,{modelValue:o.documentoItem.idPlanoContaEstoque,"onUpdate:modelValue":a[5]||(a[5]=n=>o.documentoItem.idPlanoContaEstoque=n),opcoes:o.contaEstoque,tipo:"seletor",ajuda:"Plano de Conta de Estoque para Entrada de Mercadoria",dense:"",outlined:"",rotulo:"Conta Estoque"},null,8,["modelValue","opcoes"])]),_:1})]),_:1}),t(m,{mg:"lg-t"},{default:i(()=>[t(e,null,{default:i(()=>[t(y,{text:"sub1 medium"},{default:i(()=>a[40]||(a[40]=[T("Impostos")])),_:1})]),_:1})]),_:1}),t(m,null,{default:i(()=>[t(Mt,{label:"ICMS",modelValue:o.exibirIcms,"onUpdate:modelValue":a[6]||(a[6]=n=>o.exibirIcms=n)},null,8,["modelValue"])]),_:1}),o.exibirIcms?(M(),Y(m,{key:0,items:"center"},{default:i(()=>[t(e,{col:"12 sm6"},{default:i(()=>[t(b,{modelValue:o.documentoItem.modalidadeBaseCalculo,"onUpdate:modelValue":a[7]||(a[7]=n=>o.documentoItem.modalidadeBaseCalculo=n),opcoes:o.impostoIcmsModalidade,"somente-leitura":o.somenteLeituraIcms,tipo:"seletor",outlined:"",rotulo:"ICMS (Modalidade)"},null,8,["modelValue","opcoes","somente-leitura"])]),_:1}),t(e,{col:"12 sm6"},{default:i(()=>[t(b,{modelValue:o.documentoItem.codigoCst,"onUpdate:modelValue":a[8]||(a[8]=n=>o.documentoItem.codigoCst=n),opcoes:o.impostoCstIcms,"somente-leitura":o.somenteLeituraIcms,tipo:"seletor",outlined:"",rotulo:"CST ICMS"},null,8,["modelValue","opcoes","somente-leitura"])]),_:1}),t(e,{col:"12 sm4"},{default:i(()=>[t(b,{modelValue:o.documentoItem.valorBaseIcms,"onUpdate:modelValue":a[9]||(a[9]=n=>o.documentoItem.valorBaseIcms=n),onBlur:a[10]||(a[10]=n=>s.calcularImpostos("valorBaseIcms")),"somente-leitura":o.somenteLeituraIcms,tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"Base ICMS"},null,8,["modelValue","somente-leitura"])]),_:1}),t(e,{col:"12 sm4"},{default:i(()=>[t(b,{modelValue:o.documentoItem.percentualIcms,"onUpdate:modelValue":a[11]||(a[11]=n=>o.documentoItem.percentualIcms=n),onBlur:a[12]||(a[12]=n=>s.calcularImpostos("percentualIcms")),"somente-leitura":o.somenteLeituraIcms,tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"ICMS %"},null,8,["modelValue","somente-leitura"])]),_:1}),t(e,{col:"12 sm4"},{default:i(()=>[t(b,{modelValue:o.documentoItem.valorIcms,"onUpdate:modelValue":a[13]||(a[13]=n=>o.documentoItem.valorIcms=n),onBlur:a[14]||(a[14]=n=>s.calcularImpostos("valorIcms")),"somente-leitura":o.somenteLeituraIcms,tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"Valor ICMS"},null,8,["modelValue","somente-leitura"])]),_:1})]),_:1})):ot("",!0),t(m,null,{default:i(()=>[t(Mt,{label:"ICMS ST",modelValue:o.exibirIcmsSt,"onUpdate:modelValue":a[15]||(a[15]=n=>o.exibirIcmsSt=n)},null,8,["modelValue"])]),_:1}),o.exibirIcmsSt?(M(),Y(m,{key:1,items:"center"},{default:i(()=>[t(e,{col:"12 sm6"},{default:i(()=>[t(b,{modelValue:o.documentoItem.modalidadeBaseCalculoST,"onUpdate:modelValue":a[16]||(a[16]=n=>o.documentoItem.modalidadeBaseCalculoST=n),opcoes:o.impostoCstIcmsSt,"somente-leitura":o.somenteLeituraIcmsSt,tipo:"seletor",outlined:"",rotulo:"ICMS ST (Modalidade)"},null,8,["modelValue","opcoes","somente-leitura"])]),_:1}),t(e,{col:"12 sm6"},{default:i(()=>[t(b,{modelValue:o.documentoItem.percentualIVA,"onUpdate:modelValue":a[17]||(a[17]=n=>o.documentoItem.percentualIVA=n),onBlur:a[18]||(a[18]=n=>s.calcularImpostos("percentualIVA")),tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"IVA (%)"},null,8,["modelValue"])]),_:1}),t(e,{col:"12 sm4"},{default:i(()=>[t(b,{modelValue:o.documentoItem.valorBaseIcmsSt,"onUpdate:modelValue":a[19]||(a[19]=n=>o.documentoItem.valorBaseIcmsSt=n),onBlur:a[20]||(a[20]=n=>s.calcularImpostos("valorBaseIcmsSt")),"somente-leitura":o.somenteLeituraIcmsSt,tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"Base ICMS ST"},null,8,["modelValue","somente-leitura"])]),_:1}),t(e,{col:"12 sm4"},{default:i(()=>[t(b,{modelValue:o.documentoItem.percentualIcmsSt,"onUpdate:modelValue":a[21]||(a[21]=n=>o.documentoItem.percentualIcmsSt=n),onBlur:a[22]||(a[22]=n=>s.calcularImpostos("percentualIcmsSt")),"somente-leitura":o.somenteLeituraIcmsSt,tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"ICMS ST (%)"},null,8,["modelValue","somente-leitura"])]),_:1}),t(e,{col:"12 sm4"},{default:i(()=>[t(b,{modelValue:o.documentoItem.valorIcmsSt,"onUpdate:modelValue":a[23]||(a[23]=n=>o.documentoItem.valorIcmsSt=n),onBlur:a[24]||(a[24]=n=>s.calcularImpostos("valorIcmsSt")),"somente-leitura":o.somenteLeituraIcmsSt,tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"Valor ICMS ST"},null,8,["modelValue","somente-leitura"])]),_:1})]),_:1})):ot("",!0),t(m,null,{default:i(()=>[t(Mt,{label:"IPI",modelValue:o.exibirIpi,"onUpdate:modelValue":a[25]||(a[25]=n=>o.exibirIpi=n)},null,8,["modelValue"])]),_:1}),o.exibirIpi?(M(),Y(m,{key:2,items:"center"},{default:i(()=>[t(e,{col:"12"},{default:i(()=>[t(b,{modelValue:o.documentoItem.codigoCstIpi,"onUpdate:modelValue":a[26]||(a[26]=n=>o.documentoItem.codigoCstIpi=n),opcoes:o.impostoCstIpi,tipo:"seletor",dense:"",outlined:"",rotulo:"CST IPI"},null,8,["modelValue","opcoes"])]),_:1}),t(e,{col:"12 sm4"},{default:i(()=>[t(b,{modelValue:o.documentoItem.valorBaseIpi,"onUpdate:modelValue":a[27]||(a[27]=n=>o.documentoItem.valorBaseIpi=n),onBlur:a[28]||(a[28]=n=>s.calcularImpostos("valorBaseIpi")),tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"Base IPI"},null,8,["modelValue"])]),_:1}),t(e,{col:"12 sm4"},{default:i(()=>[t(b,{modelValue:o.documentoItem.percentualIpi,"onUpdate:modelValue":a[29]||(a[29]=n=>o.documentoItem.percentualIpi=n),onBlur:a[30]||(a[30]=n=>s.calcularImpostos("percentualIpi")),tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"IPI %"},null,8,["modelValue"])]),_:1}),t(e,{col:"12 sm4"},{default:i(()=>[t(b,{modelValue:o.documentoItem.valorIpi,"onUpdate:modelValue":a[31]||(a[31]=n=>o.documentoItem.valorIpi=n),onBlur:a[32]||(a[32]=n=>s.calcularImpostos("valorIpi")),tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"Valor IPI"},null,8,["modelValue"])]),_:1})]),_:1})):ot("",!0)]),_:1}),t(de,{name:"tab2",class:"q-px-sm"},{default:i(()=>[o.exibirHistorico?(M(),Y(fe,{key:0,rows:o.historicoItem[o.documentoItem.idItem].fornecedores,columns:o.tabelaHistoricoItem.colunas,pagination:o.tabelaHistoricoItem.paginacao,"onUpdate:pagination":a[33]||(a[33]=n=>o.tabelaHistoricoItem.paginacao=n),"row-key":"index",class:"no-shadow text-left"},{body:i(n=>[t(pe,{props:n},{default:i(()=>[t(Ut,{key:"fornecedor",props:n},{default:i(()=>[T(J(n.row.fornecedor),1)]),_:2},1032,["props"]),t(Ut,{key:"dataCompra",props:n},{default:i(()=>[n.row.dataCompra!==""?(M(),_t("span",Re,J(r.$filters.data(n.row.dataCompra)),1)):ot("",!0)]),_:2},1032,["props"]),t(Ut,{key:"quantidade",props:n},{default:i(()=>[T(J(n.row.quantidade),1)]),_:2},1032,["props"]),t(Ut,{key:"valorCusto",props:n},{default:i(()=>[T(J(r.$filters.numero(n.row.valorCusto,2)),1)]),_:2},1032,["props"]),t(Ut,{key:"valorTotal",props:n},{default:i(()=>[T(J(r.$filters.numero(n.row.valorTotal,2)),1)]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination"])):ot("",!0)]),_:1}),t(de,{name:"tab3",class:"q-px-sm"},{default:i(()=>[o.exibirEstoque?(M(),Y(fe,{key:0,rows:o.estoqueItem[o.documentoItem.idItem].estoques,columns:o.tabelaEstoqueItem.colunas,pagination:o.tabelaEstoqueItem.paginacao,"onUpdate:pagination":a[34]||(a[34]=n=>o.tabelaEstoqueItem.paginacao=n),"row-key":"index",class:"no-shadow text-left"},{body:i(n=>[t(pe,{props:n},{default:i(()=>[t(Ut,{key:"empresa",props:n},{default:i(()=>[T(J(n.row.empresa),1)]),_:2},1032,["props"]),t(Ut,{key:"tipoEstoque",props:n},{default:i(()=>[T(J(n.row.tipoEstoque),1)]),_:2},1032,["props"]),t(Ut,{key:"lote",props:n},{default:i(()=>[n.row.lote!==""?(M(),_t("span",Le,J(n.row.lote),1)):ot("",!0)]),_:2},1032,["props"]),t(Ut,{key:"quantidade",props:n},{default:i(()=>[T(J(n.row.quantidade),1)]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination"])):ot("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),t(Yt,{class:"bg-light q-pa-sm",bordered:""},{default:i(()=>[t(Nt,null,{default:i(()=>[t(re),vt(t(dt,{onClick:s.fechar,label:"Cancelar",size:"md",flat:"","no-ripple":"",color:"tertiary",class:"q-mr-sm"},null,8,["onClick"]),[[Et]]),t(dt,{onClick:s.salvar,label:"Salvar",color:"primary","no-ripple":"",unelevated:""},null,8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}var $e=se(Oe,[["render",Me]]);const je={components:{ModalEditarProdutoCompras:$e,PromptItemV2:ve},data(){const r={ehOrcamento:!0,adicionar:{modal:{value:!1,name:""}},dataPrevistaEntrega:"",horaPrevistaEntrega:"",contatos:{},produtos:[],formasDePagamento:[],visivel:!1,somenteLeitura:!1,condicaoPagamentoRules:[async()=>{const a=this.compra.condicaoPagamento;return/^[\d/]*$/.test(a)}],formaPagamentoRules:[async()=>{const a=this.compra.formaDePagamento;return/^[^\d\s][a-zA-Z\s]*[^\d\s]$/.test(a)}],comprasMigrar:[],erroDesconto:!1,erroFrete:!1,erroSeguro:!1,erroOutrasDespesas:!1,exibeInfNota:!1,documentoNovo:!1,valorTotalPagamento:0,sku:0,operacao:"",alterarPrevisaoEntrega:!1};return this.limpaCampos(r),r},emits:["atualizar","dialogImprimirEtiquetas"],computed:{skus(){return this.compraItens.length>0?`${Number(this.compraItens.length)}`:"0"}},methods:{editarProduto(r){const a=this.produtos[r.idItem],h=this.compra;this.$refs.ModalEditarProdutoCompras.mostrar(r,a,h)},removerItem(r){this.compraItens=this.compraItens.filter(a=>a.id!==r.id),this.calcularTotais()},async migrarParaOutraCompra(r,a){await $tryLoading(async()=>{const h=(a==null?void 0:a.id)||$utils.uuid(),w=a?{...a}:{...this.compra,id:h,codigoDocumento:void 0,numero:void 0,notaNumero:void 0,notaSerie:void 0,naturezaOperacao:void 0,dataCompra:void 0,chaveAcesso:void 0,totalDesconto:void 0,totalPercentualDesconto:void 0,valorFrete:void 0,valorSeguro:void 0,valorOutrasDespesas:void 0,dataHoraEmissao:$utils.dataAtual(),dataHoraFinalizado:void 0,dataHoraPrevisto:void 0,status:"Digita\xE7\xE3o"},o={...r,id:$utils.uuid(),codigoDocumentoItem:void 0,idDocumento:h,codigoDocumento:void 0,dataHoraEmissao:$utils.dataAtual(),dataHoraFinalizado:void 0,status:"Digita\xE7\xE3o"};this.calcularTotais("",w,[o]),await $db.hibrido.grava("documento",{atual:w,original:a}),await $db.hibrido.grava("documentoItem",{atual:o}),this.removerItem(r),this.salvar(),$q.notifyPositive("Item migrado com sucesso!")},{mensagem:"Migrando..."})},fecharEdicaoProduto(r){const a=this.compraItens.findIndex(h=>h.id===r.id);this.compraItens[a]=$utils.clonar(r),this.calcularTotaisItem(a)},async atualizar(){var h,w;this.compraOriginal=await $db.hibrido.le({table:"documento",id:this.compra.id}),this.compra=$utils.clonarV2(this.compraOriginal),$utils.verificarErro(!this.compra.id,"Compra n\xE3o encontrada"),this.compraItensOriginal=(await $db.hibrido.lista({table:"documentoItem",where:{idDocumento:this.compra.id}})).sort((o,s)=>new Date(o.dataHoraEmissao||0)-new Date(s.dataHoraEmissao||0)),this.compraItens=$utils.clonarV2(this.compraItensOriginal),this.compraCondicoesDePagamentoOriginal=(await $db.hibrido.lista({table:"documentoCondicaoPagamento",where:{idDocumento:this.compra.id}})).sort((o,s)=>new Date(o.dataVencimento||0)-new Date(s.dataVencimento||0)),this.compraCondicoesDePagamento=$utils.clonarV2(this.compraCondicoesDePagamentoOriginal),this.compraTitulosOriginal=await $db.hibrido.lista({table:"financeiroTitulo",where:{documentoId:this.compra.id}}),this.compraTitulos=$utils.clonarV2(this.compraTitulosOriginal),this.compraMovimentacoesOriginal=await $db.hibrido.lista({table:"financeiroMovimentacao",where:{documentoId:this.compra.id}}),this.compraMovimentacoes=$utils.clonarV2(this.compraMovimentacoesOriginal),this.compraDocumentoXmlOriginal=await $db.hibrido.lista({table:"documentoXML",where:{idDocumento:this.compra.id}}),this.compraDocumentoXml=$utils.clonarV2(this.compraDocumentoXmlOriginal),this.compra.totalComImposto=!0,this.compra.calcularTributacao=(h=this.compra.calcularTributacao)!=null?h:!0,this.compra.naoGerarFinanceiro=(w=this.compra.naoGerarFinanceiro)!=null?w:!1;const r=[this.compra.idEmpresa,this.compra.idContato,this.compra.idContatoComprador,this.compra.idContatoVendedor,this.compra.idContatoTransportadora].filter(Boolean);this.carregarImagensContatos(r);const a=this.compraItens.map(({idItem:o})=>o).filter(Boolean);if(this.carregarImagensItens(a),this.valorTotalPagamento===0)for(const o of this.compraCondicoesDePagamento)this.valorTotalPagamento=this.valorTotalPagamento+o.valor;this.compra.dataHoraPrevisto&&(this.dataPrevistaEntrega=this.compra.dataHoraPrevisto.slice(0,10),this.horaPrevistaEntrega=this.compra.dataHoraPrevisto.slice(11,16)),this.carregarComprasMigrar(this.compra),this.calcularTotais(),this.exibeInfNota=!0},async carregarContatos(r){const a=await $db.hibrido.lista({table:"contato",columns:["id","apelido","imagem"],whereIn:{id:r}});for(const h of a)this.contatos[h.id]=h},async carregarImagensContatos(r){if(!!r.length){await $utils.dormir(200);try{await this.carregarContatos(r)}catch(a){console.error("Erro ao carregar imagens de contatos - ",a)}}},async carregarComprasMigrar(r){try{this.comprasMigrar=(await $db.hibrido.lista({table:"documento",where:{tipo:"Compra",idContato:r.idContato},whereFilter:{idEmpresa:r.idEmpresa,status:"Digita\xE7\xE3o"}})).filter(({id:a})=>a!==r.id)}catch(a){console.error("Erro ao carregar compras para migra\xE7\xE3o - ",a)}},async carregarItens(r){const a=await $db.hibrido.lista({table:"item",columns:["id","descricao","imagem","valorCustoReposicao","marca","referencia","codigoItem"],whereIn:{id:r}});for(const h of a)this.produtos[h.id]=h},async carregarImagensItens(r){if(!!r.length){await $utils.dormir(200);try{await this.carregarItens(r)}catch(a){console.error("Erro ao ler imagens de itens - ",a)}}},async salvar_click(){await $tryLoading(async()=>{if(this.compra.idContato||(this.compra.idContato=$db.usuario.logado.id),this.dataPrevistaEntrega){const r=`${this.dataPrevistaEntrega} ${this.horaPrevistaEntrega||"00:00:00"}`;this.compra.dataHoraPrevisto=zt.formatDate(r)}this.calcularTotais(),await this.salvar(),this.$emit("atualizar",{aba:"Digita\xE7\xE3o"}),this.ocultarModal(),$q.notifyPositive(this.compra.operacao==="Nota de Entrada"?"A Nota de Entrada foi salva com sucesso.":"O Pedido de Compra foi salvo com sucesso.")},{mensagem:"Salvando..."})},async excluir_click(){!await $q.dialogSimNao({title:"Excluir compra",message:`Deseja excluir ${this.compra.operacao==="Pedido de Compra"?`o ${this.compra.operacao}?`:`a ${this.compra.operacao}?`}`})||await $tryLoading(async()=>{this.visivel=!1,this.operacao=this.compra.operacao,this.compra={},this.compraCondicoesDePagamento=[],this.compraItens=[],this.compraMovimentacoes=[],this.compraTitulos=[],this.compraDocumentoXml=[],await this.salvar(),await this.fechar(),$q.notifyPositive(this.compra.operacao==="Nota de Entrada"?"A Nota de Entrada foi excluida com sucesso.":"O Pedido de Compra foi excluido com sucesso.")},{mensagem:"Excluindo..."})},async criar(){await $tryLoading(async()=>{const r=(await $db.contato.ler({filtros:{ativo:!0,empresas:!0}})).data;if(!(r.length>0)){this.$q.notify({message:"N\xE3o h\xE1 empresa configurada",timeout:0,type:"negative",closeBtn:!0});return}let a=r[0];if(r.length>1){const o={ativo:!0,empresas:!0};if(a=await $g.promptContato.show({filtro:o,placeholder:"Selecione a empresa"}),!a){this.ocultarModal();return}}const h=(await $db.hibrido.lista({table:"empresa",where:{idContato:a.id}}))[0];if(!h){this.ocultarModal(),this.$q.notifyError("Erro ao selecionar empresa");return}if(this.contatos[a.id]||await this.carregarContatos([a.id]),this.limpaCampos(this),this.compra={id:$utils.uuid(),tipo:"Compra",operacao:"Pedido de Compra",status:"Digita\xE7\xE3o",descricaoEmpresa:h.nome,numeroDocumentoEmpresa:h.numeroDocumentoNacional,descricaoContato:"",idContatoComprador:null,dataHoraEmissao:$utils.dataAtual(),tipoFrete:"CIF",tipoTransporte:null,idEmpresa:h.idContato,idContato:null,totalDesconto:0,totalPercentualDesconto:0,calcularTributacao:!0,totalComImposto:!0,naoGerarFinanceiro:!1,freteSeparado:!1,dataHoraPrevisto:null,valorBaseIcms:0,valorIcms:0,valorBaseIcmsSt:0,valorIcmsSt:0,valorOutrasDespesas:0},!await this.abrirModalFornecedor()){this.ocultarModal();return}this.documentoNovo=!0,this.exibeInfNota=!0,this.visivel=!0})},async validaCampos(){try{if($utils.verificarErro(!this.compra.descricaoContato,"N\xE3o \xE9 permitido finalizar a compra sem informar o fornecedor!"),$utils.verificarErro(!this.compraItens.length,"N\xE3o \xE9 permitido finalizar compra sem itens!"),!this.compra.naoGerarFinanceiro){const r=$utils.arredondar(this.compraCondicoesDePagamento.reduce((a,h)=>a+h.valor,0));$utils.verificarErro(!this.compra.formaDePagamento,"N\xE3o \xE9 permitido finalizar a compra sem informar a forma de pagamento!"),$utils.verificarErro(this.compraCondicoesDePagamento.length>0&&this.compra.totalDocumento!==r,"N\xE3o \xE9 permitido finalizar a compra se o valor total difere da soma das parcelas!"),$utils.verificarErro(this.compraCondicoesDePagamento.length===0,'Verifique se a op\xE7\xE3o "N\xE3o gerar financeiro" est\xE1 marcada, ou adicione as parcelas para finalizar a compra!')}return this.compra.operacao==="Nota de Entrada"&&($utils.verificarErro(!this.compra.notaNumero,"N\xE3o \xE9 permitido finalizar a compra sem informar o n\xFAmero da Nota de Entrada!"),$utils.verificarErro(!this.compra.notaSerie,"N\xE3o \xE9 permitido finalizar a compra sem informara s\xE9rie da Nota de Entrada!"),$utils.verificarErro(!this.compra.naturezaOperacao,"N\xE3o \xE9 permitido finalizar a compra sem informar natureza de opera\xE7\xE3o da Nota de Entrada!"),$utils.verificarErro(!this.compra.dataCompra,"N\xE3o \xE9 permitido finalizar a compra sem informar a data de compra da Nota de Entrada!"),$utils.verificarErro(!this.compra.chaveAcesso,"N\xE3o \xE9 permitido finalizar a compra sem informar a chave de acesso da Nota de Entrada!")),!0}catch(r){return $q.notifyError("Ocorreu um erro na valida\xE7\xE3o de campos",r),!1}},async finalizar_click(){if(!await this.validaCampos())return;let r=!1;this.compra.naoGerarFinanceiro||(r=await $q.dialogSimNao({title:"Gerar Financeiro",message:"Deseja gerar as provis\xF5es financeiras?"})),await $tryLoading(async()=>{this.compra.status="Finalizado",this.compra.dataHoraFinalizado=$utils.dataAtual(),this.compra.provisaoCompra=r?1:void 0,await this.finalizarItens(),r&&await this.gerarFinanceiro(),await this.salvar(),this.$emit("atualizar",{aba:"Finalizado"}),this.ocultarModal(),$q.notifyPositive(this.compra.operacao==="Nota de Entrada"?"A Nota de Entrada foi finalizada com sucesso!":"O Pedido de Compra foi finalizada com sucesso!"),r&&$q.notifyPositive("Provisionamento gerado com sucesso!")},{mensagem:"Finalizando Compra..."})},finalizarItens(){var s,c;let r=1,a=0,h=0,w=!1;const o=this.compra;if(o.subTotalProduto>0&&(o.tipoFrete==="FOB"&&o.freteSeparado===0&&(a=(o.valorFrete||0)+(o.valorSeguro||0)),r=((o.subTotalProduto||0)+(o.valorOutrasDespesas||0)-(o.totalDesconto||0)+(a||0))/(o.subTotalProduto||1)),h=this.compraItens.reduce((e,m)=>e+m.valorIcmsSt,h),h!==o.valorIcmsSt&&(w=!0),o.operacao==="Nota de Entrada")for(const e of this.compraItens)e.dataCompra=$utils.dataAtual(),w&&(e.valorIcmsSt=o.valorIcmsSt*((e==null?void 0:e.total)||0)/(o.subTotalProduto>0?o.subTotalProduto:1)),e.valorFreteRateado=o.valorFrete*(((e==null?void 0:e.total)||0)/(o.subTotalProduto||1)),e.valorSeguroRateado=o.valorSeguro*(((e==null?void 0:e.total)||0)/(o.subTotalProduto||1)),e.valorOutrasDespesasRateado=(o.valorOutrasDespesas||0)*(((e==null?void 0:e.total)||0)/(o.subTotalProduto||1)),e.descontoTotalRateado=(o.totalDesconto||0)*(((e==null?void 0:e.total)||0)/(o.subTotalProduto||1)),(e==null?void 0:e.valorIcmsSt)-(e==null?void 0:e.valorIcms)>0&&((e==null?void 0:e.valorIcmsSt)||0)-((e==null?void 0:e.valorIcms)||0),e.valorRealTotal=((e==null?void 0:e.total)||0)*r+((e==null?void 0:e.valorIpi)||0)+((e==null?void 0:e.valorIcms)||0),e.valorRealTotalImpostos=((e==null?void 0:e.total)||0)+e.valorFreteRateado+e.valorSeguroRateado+e.valorOutrasDespesasRateado-e.descontoTotalRateado+((e==null?void 0:e.valorIpi)||0)+((e==null?void 0:e.valorIcmsSt)||0),e.valorReal=e.valorRealTotalImpostos/((e==null?void 0:e.quantidade)||1),e.valorCustoReposicao=((s=this.produtos[e.idItem])==null?void 0:s.valorCustoReposicao)||0;if(o.operacao==="Pedido de Compra")for(const e of this.compraItens){w&&(e.valorIcmsSt=$utils.arredondar(o.valorIcmsSt*(e.total||0)/(o.subTotalProduto>0?o.subTotalProduto:1))),e.valorFreteRateado=$utils.arredondar((o.valorFrete||0)*(e.total||0)/(o.subTotalProduto||1),4),e.valorSeguroRateado=$utils.arredondar((o.valorSeguro||0)*(e.total||0)/(o.subTotalProduto||1),4),e.valorOutrasDespesasRateado=$utils.arredondar((o.valorOutrasDespesas||0)*(e.total||0)/(o.subTotalProduto||1),4),e.descontoTotalRateado=$utils.arredondar((o.totalDesconto||0)*(e.total||0)/(o.subTotalProduto||1),4);let m=0;e.valorIcmsSt-e.valorIcms>0&&(m=$utils.arredondar((e.valorIcmsSt||0)-(e.valorIcms||0),2)),e.valorRealTotal=$utils.arredondar((e.total||0)*r+(e.valorIpi||0)+(m>0?m:0),2),e.valorRealTotalImpostos=$utils.arredondar((e.total||0)+e.valorFreteRateado+e.valorSeguroRateado+e.valorOutrasDespesasRateado-e.descontoTotalRateado+(e.valorIpi||0)+(e.valorIcmsSt||0),4),e.valorReal=$utils.arredondar(e.valorRealTotalImpostos/(e.quantidade||1),4),e.valorCustoReposicao=$utils.arredondar(((c=this.produtos[e.idItem])==null?void 0:c.valorCustoReposicao)||0,2)}},async transformarEmNotaDeEntrada_click(){this.compra.operacao==="Pedido de Compra"&&await $tryLoading(async()=>{var h;const r=this.compraItens.map(({idItem:w})=>w).filter(Boolean),a=await $db.hibrido.lista({table:"itemFornecedor",whereIn:{idItem:r},whereFilter:{idContato:this.compra.idContato}});for(const w of this.compraItens)if(!a.some(({idItem:o})=>o===w.idItem)){const o={id:$utils.uuid(),idItem:w.idItem,idContato:this.compra.idContato,referencia:"",descricao:w.descricaoItem};await $db.hibrido.grava("itemFornecedor",{atual:o,original:{}})}for(const w of this.compraTitulos)w.formaDePagamento=(h=this.compra.formaDePagamento)!=null?h:"";this.compra.operacao="Nota de Entrada",this.compra.dataHoraFinalizado="",this.compra.status="Digita\xE7\xE3o",await this.salvar(),$q.notifyPositive("Nota de Entrada gerada com sucesso!")},{mensagem:"Processando..."})},async mostrar({id:r}){this.visivel=!0;const a=$utils.logarIni("ComprasFicha");await $tryLoading(async()=>{this.compra.id=r,await this.atualizar()}),$utils.logarFim(a,1)},fechar(){this.compra.status==="Finalizado"?this.$emit("atualizar",{aba:"Finalizado"}):this.$emit("atualizar",{aba:"Digita\xE7\xE3o"}),this.ocultarModal(),this.produtos=[],this.limpaCampos(this),this.formasDePagamento=[],this.documentoNovo=!1,this.exibeInfNota=!1,this.valorTotalPagamento=0},ocultarModal(){this.visivel=!1},async abrirModalEmpresa(){const r={ativo:!0,empresas:!0},a=await $g.promptContato.show({filtro:r,placeholder:"Selecione"});if(!a)return;let h=(await $db.hibrido.lista({table:"empresa",where:{idContato:a.id}}))[0];if(!h){this.ocultarModal(),this.$q.notifyError("Erro ao selecionar empresa");return}this.contatos[a.id]||await this.carregarContatos([a.id]),this.compra.descricaoEmpresa=h.nome,this.compra.idEmpresa=h.idContato,this.compra.numeroDocumentoEmpresa=h.numeroDocumentoNacional,this.compra.InscricaoMunicipalEmpresa=h.InscricaoMunicipalEmpresa},async abrirModalComprador(){const r=await this.selecionarContato({placeholder:"Selecione o comprador",filtro:{ativo:!0,compradores:!0}});r.id&&(this.compra.idContatoComprador=r.id),this.contatos[r.id]||await this.carregarContatos([r.id])},async abrirModalFornecedor(){const r={ativo:!0},a=await $g.promptContato.show({filtro:r,placeholder:"Selecione o fornecedor"});if(!a)return a;const h=await $db.contatoTelefone.le({idContato:a.id}),w=await $db.contatoEndereco.le({idContato:a.id}),o=h.find(e=>e.tipoTelefone==="Principal"||e.tipoTelefone==="WhatsApp")||h[0]||null,s=w.find(e=>e.grupo==="Principal")||w[0]||null;let c;return s&&Object.keys(s).length>0&&(c=`${s.logradouro}, ${s.numero} ${s.complemento} - ${s.bairro} - ${s.municipio}/${s.uf}`),a.id&&(this.compra.idContato=a.id,this.compra.descricaoContato=a.nome,this.compra.numeroDocumentoContato=a.numeroDocumentoNacional,this.compra.emailContato=(a==null?void 0:a.email)||null,this.compra.regimeContato=(a==null?void 0:a.regime)||null,this.compra.telefoneContato=(o==null?void 0:o.telefone)||null,this.compra.descricaoContatoEndereco=c||null),this.contatos[a.id]||await this.carregarContatos([a.id]),a},async abrirModalVendedor(){const r=(await $db.contato.leFilhos(this.compra.idContato)).map(h=>h.id),a=await this.selecionarContato({placeholder:"Selecione o vendedor",filtro:{ativo:!0,usuarios:r}});a.id&&(this.compra.idContatoVendedor=a.id),this.contatos[a.id]||await this.carregarContatos([a.id])},async abrirModalTransportador(){const r=await this.selecionarContato({placeholder:"Selecione o transportadora",filtro:{ativo:!0,transportadoras:!0}});r.id&&(this.compra.idContatoTransportadora=r.id),this.contatos[r.id]||await this.carregarContatos([r.id])},async selecionarContato(r){const{placeholder:a,filtro:h}={placeholder:"Selecione o contato",filtro:{ativo:!0},...r},w=await $g.promptContato.show({filtro:h,placeholder:a});if(!w)throw new Error("Contato n\xE3o selecionado");return w},async adicionarItem(){let r={},a=[];for(const h of a)r[h.idItem]={item:await $db.hibrido.le({table:"item",id:h.idItem}),quantidade:h.quantidade};this.adicionar.modal.value=!0,this.adicionar.modal.name="Item"},async selecionarItens(r){var a,h;for(const w in r){let o=await $db.hibrido.lista({table:"estoqueSaldoProdutoEmpresa",whereFilter:{idEmpresa:this.compra.idEmpresa,tipoEstoque:"Dispon\xEDvel",idItem:w}});o=o[0];const s=await $db.configuracoes.porNome("vendas.checaestoque",this.compra.idEmpresa);Number((a=s.find(n=>n.id))==null?void 0:a.valor);const c=r[w].item||{},e=((h=(await $db.hibrido.lista({table:"itemFornecedor",whereFilter:{idItem:c.id}}))[0])==null?void 0:h.referencia)||null,m=r[w].quantidade||0,b=(c==null?void 0:c.valorCustoReposicao)||(o==null?void 0:o.valorCustoMedio)||0;let _=this.compraItens.find(n=>n.idItem===w);const f=(await $erp().cfop.where({cfop:5102}).toArray())[0],y=await $db.financeiroPlanoConta.lePorConfig("financeiro.planocontas.comprageral");if(_)_.quantidade=$utils.arredondar(m,4),_.quantidadeRealizado=$utils.arredondar(m,4),_.subTotal=$utils.arredondar(b,2),_.total=$utils.arredondar(m*b,2);else{const n={dataHoraEmissao:$utils.dataAtual(),dataHoraFinalizado:"",descricaoItem:c.descricao,id:$utils.uuid(),idDocumento:this.compra.id,idItem:c.id,referencia:c.referencia,referenciaFornecedor:e,ncm:c.ncm||null,operacao:"Compra de Mercadoria",operacaoFator:1,idCfop:f==null?void 0:f.id,idPlanoContaEstoque:y==null?void 0:y.id,quantidade:$utils.arredondar(m,4),quantidadeRealizado:$utils.arredondar(m,4),status:"Digita\xE7\xE3o",tipoItem:c.tipo,subTotal:$utils.arredondar(b,2),total:$utils.arredondar(m*b,2),unidade:c.unidade,valorCustoMedio:(o==null?void 0:o.valorCustoMedio)||0,valorItem:b,valorOriginal:b,observacao:""};this.compraItens.push(n),await this.carregarItens([c.id])}this.compra.subTotal=0,this.compra.subTotalProduto=0;for(let n in this.compraItens)this.compra.subTotal+=this.compraItens[n].total,this.compra.subTotalProduto+=this.compraItens[n].total;this.compra.subTotal=$utils.arredondar(this.compra.subTotal,2),this.compra.totalDocumento=this.compra.subTotal}},formatXml(r,a="  "){let h="",w="";return r.split(/>\s*</).forEach(o=>{o.match(/^\/\w/)&&(w=w.substring(a.length)),h+=w+"<"+o+`>
`,o.match(/^<?\w[^>]*[^\/]$/)&&(w+=a)}),h.substring(1,h.length-3)},calcularTotaisItem(r,a){const h=$utils.clonar(this.compraItens[r]),w=h.valorOriginal||0,o=h.quantidade||0;let s=h.valorItem||0,c=h.descontoPercentualItem||0,e=h.descontoItem||0,m=h.subTotal||0,b=h.total||0;a==="descontoPercentualItem"&&((c<0||c>100)&&(c=0),e=s*c/100,m=s-e),a==="descontoItem"&&((e<0||e>s)&&(e=0),c=e/s*100,m=s-e),a==="valorItem"&&(s<w&&(s=w),e>s&&(e=0,c=0),c=e/s*100,m=s-e),a==="subTotal"&&((m<0||m>s)&&(m=s),e=s-m,c=e/s*100),b=o*m,h.valorItem=s,h.descontoItem=e,h.descontoPercentualItem=c,h.subTotal=m,h.total=b,this.compraItens[r]=h,this.calcularTotais("totalDesconto")},calcularTotais(r,a,h){const w=a||$utils.clonar(this.compra),o=h||this.compraItens;let s=0,c=0,e=0,m=w.totalDesconto||0,b=w.totalPercentualDesconto||0,_=w.valorFrete||0,f=w.valorSeguro||0,y=w.valorOutrasDespesas||0,n=0,C=0,g=0,u=0,l=0;this.erroFrete=!1,this.erroSeguro=!1,this.erroOutrasDespesas=!1;for(const v of o)s+=v.total,n+=v.valorBaseIcms||0,C+=v.valorIcms||0,g+=v.valorBaseIcmsSt||0,u+=v.valorIcmsSt||0,l+=v.valorIpi||0;r==="totalPercentualDesconto"&&(this.erroDesconto=!1,(b<0||b>100)&&(this.erroDesconto=!0),m=s*b/100),r==="totalDesconto"&&(this.erroDesconto=!1,(m<0||m>s)&&(this.erroDesconto=!0),b=m/s*100),_<0&&(this.erroFrete=!0),_=w.tipoFrete==="FOB"?_:0,f<0&&(this.erroSeguro=!0),f=w.tipoFrete==="FOB"?f:0,y<0&&(this.erroOutrasDespesas=!0),w.calcularTributacao||(n=0,C=0,g=0,u=0),w.totalComImposto||(l=0),c=s-m+_+f+y,e=c+l+u,w.valorBaseIcms=$utils.arredondar(n,2),w.valorIcms=$utils.arredondar(C),w.valorBaseIcmsSt=$utils.arredondar(g),w.valorIcmsSt=$utils.arredondar(u),w.valorIpi=$utils.arredondar(l),w.totalDesconto=$utils.arredondar(m),w.totalPercentualDesconto=$utils.arredondar(b),w.subTotalProduto=$utils.arredondar(s),w.totalProduto=$utils.arredondar(s)-$utils.arredondar(m),w.subTotal=$utils.arredondar(c),w.totalDocumento=$utils.arredondar(e),a||(this.compra=w)},limpaCampos(r){r.compra={},r.compraOriginal={},r.compraItens=[],r.compraItensOriginal=[],r.compraCondicoesDePagamento=[],r.compraCondicoesDePagamentoOriginal=[],r.compraTitulos=[],r.compraTitulosOriginal=[],r.compraMovimentacoes=[],r.compraMovimentacoesOriginal=[],r.compraDocumentoXml=[],r.compraDocumentoXmlOriginal=[],r.dataPrevistaEntrega="",r.horaPrevistaEntrega=""},async salvar(){this.compra.totalComImposto&&delete this.compra.totalComImposto;for(const r of this.compraItens)r.dataHoraFinalizado=this.compra.dataHoraFinalizado,r.status=this.compra.status;this.compra.id?await $db.hibrido.grava("documento",{atual:this.compra,original:this.compraOriginal}):this.compraOriginal.id&&await $db.hibrido.remove("documento",this.compraOriginal),await $db.hibrido.gravaLista("documentoItem",{atual:this.compraItens,original:this.compraItensOriginal}),await $db.hibrido.gravaLista("documentoCondicaoPagamento",{atual:this.compraCondicoesDePagamento,original:this.compraCondicoesDePagamentoOriginal}),await $db.hibrido.gravaLista("financeiroTitulo",{atual:this.compraTitulos,original:this.compraTitulosOriginal}),await $db.hibrido.gravaLista("financeiroMovimentacao",{atual:this.compraMovimentacoes,original:this.compraMovimentacoesOriginal}),await $db.hibrido.gravaLista("documentoXML",{atual:this.compraDocumentoXml,original:this.compraDocumentoXmlOriginal}),this.compra.totalComImposto=!0,this.calculaKardex()},async calculaKardex(){const r=$utils.logarIni("calculaKardex"),a=this.compraItens.map(({idItem:h})=>h).filter(Boolean);try{a.length&&await $utils.geeksApi({calculaKardex:{funcao:"9913E9FD-24A5-4C0A-9F1E-AACCDC7EAB9D",idsItem:a}})}catch(h){console.error(`Erro ao calcular Kardex
`,h)}$utils.logarFim(r,a.length)},async reabrir_click(){!await $q.dialogSimNao({title:"Reabertura",message:`Deseja reabrir o documento?<br/>${this.compra.naoGerarFinanceiro?"":"<strong>O Financeiro ser\xE1 apagado!</strong>"}`,html:!0})||await $tryLoading(async()=>{await this.retornarParaDigitacao(),await this.salvar(),await this.atualizar(),$q.notifyPositive("Documento reaberto para digita\xE7\xE3o!")},{mensagem:"Reabrindo..."})},async retornarParaDigitacao(){$utils.verificarErro(this.compra.status!=="Finalizado","N\xE3o \xE9 poss\xEDvel realizar esta opera\xE7\xE3o em documento n\xE3o finalizado.");const r=this.compraTitulos.filter(({dataPagamento:a})=>a);$utils.verificarErro(r.length,"N\xE3o \xE9 poss\xEDvel excluir o Financeiro. Parcelas provisionadas j\xE1 pagas!"),this.compra.dataHoraFinalizado="",this.compra.status="Digita\xE7\xE3o",this.compra.operacao==="Pedido de Compra"&&(this.compraTitulos=[],this.compraMovimentacoes=[])},async removerPagamento_click(r){try{this.compraCondicoesDePagamento=this.compraCondicoesDePagamento.filter(a=>a.id!==r.id),this.compraCondicoesDePagamento.sort((a,h)=>{let w=new Date(a.dataVencimento),o=new Date(h.dataVencimento);return w-o}),await this.atualizaValorTotalPagamento({condicao:r,acao:"remover"})}catch(a){console.log(a.message)}},async gerarCondicoesDePagamento_click(){var r;try{let a=this.compra.id,h=this.compra.condicaoPagamento,w=(r=this.compra.notaNumero)!=null?r:null;this.compra.naoGerarFinanceiro||await this.gerarParcelamento(a,h,w),this.compra.naoGerarFinanceiro&&(this.compraCondicoesDePagamento=[])}catch(a){console.log(a.message)}},async gerarParcelamento(r,a,h){this.compraCondicoesDePagamento=[];const w=$utils.clonar(this.compra),o=`${this.dataPrevistaEntrega} ${this.horaPrevistaEntrega||"00:00:00"}`,s=zt.formatDate(o)||w.dataHoraPrevisto,c=w.dataCompra||s||$utils.dataAtual(),e=a.split("/"),m=e.length,b=(w==null?void 0:w.freteSeparado)||0;let _=$utils.arredondar(w==null?void 0:w.totalDocumento,2);const f=((w==null?void 0:w.valorFrete)||0)+((w==null?void 0:w.valorSeguro)||0);if(b&&(w==null?void 0:w.tipoFrete)==="FOB"&&f>0){let C;s?C=new Date(s):(C=new Date(c),C.setDate(C.getDate()+Number(e[0]||0)));let g={id:$utils.uuid(),idDocumento:w==null?void 0:w.id,dataVencimento:zt.formatDate(C),valor:f,observacao:"Valor Frete + Seguro",freteSeparado:!0};this.compraCondicoesDePagamento.push(g),_-=f}let y=0,n=_/m;for(let C in e){let g=new Date(c);g.setDate(g.getDate()+Number(e[C]||0));let u={id:$utils.uuid(),idDocumento:w==null?void 0:w.id,dataVencimento:zt.formatDate(g),valor:n,observacao:""};this.compraCondicoesDePagamento.push(u),y+=n||0}_!==y&&(this.compraCondicoesDePagamento[0].valor+=(_||0)-(y||0)),this.valorTotalPagamento=b&&(w==null?void 0:w.tipoFrete)==="FOB"?_+f:_},async gerarFinanceiro(){var c,e;const r=await $db.financeiroPlanoConta.lePorConfig("financeiro.planocontas.comprageral"),a=[];for(const m of this.compraItens){if(m.idPlanoContaEstoque===r.id)continue;const b=(m.total||0)-(m.descontoTotalRateado||0),_=a.findIndex(({idPlanoContaEstoque:f})=>f===m.idPlanoContaEstoque);_!==-1?a[_].valor+=b:a.push({idPlanoContaEstoque:m.idPlanoContaEstoque,idPlanoContaDestino:"",valor:b,porcentagem:0})}for(const m of a)m.valor=$utils.arredondar(m.valor),m.porcentagem=$utils.arredondar(m.valor/this.compra.totalDocumento,4);const h=await $db.financeiroPlanoConta.lePorConfig("financeiro.planocontas.freteaquisicao"),w=this.compraTitulos.filter(({dataPagamento:m})=>m);$utils.verificarErro(w.length,"N\xE3o \xE9 poss\xEDvel regerar o Financeiro. Parcelas provisionadas j\xE1 pagas!");const o=zt.formatDate(new Date().setHours(0,0,0,0));this.compraTitulos=[];for(const m in this.compraCondicoesDePagamento){const b=this.compraCondicoesDePagamento[m],_=[b.observacao,this.compra.codigoDocumento?`Pedido de Compra: ${this.compra.codigoDocumento}`:"",this.compra.notaNumero?`Nota nro: ${this.compra.notaNumero}`:""].filter(Boolean).join(" | "),f={id:$utils.uuid(),dataEmissao:o,dataCompetencia:o,dataVencimento:zt.formatDate(new Date(b.dataVencimento).setHours(0,0,0,0)),dataVencimentoOriginal:zt.formatDate(new Date(b.dataVencimento).setHours(0,0,0,0)),valor:$utils.arredondar(b.valor,2),tipoJuros:"dia",valorMulta:0,percentualJuros:0,documentoTipo:this.compra.operacao,parcela:`${Number(m)+1}/${this.compraCondicoesDePagamento.length}`,descricao:this.compra.operacao,observacao:_,formaDePagamento:this.compra.operacao==="Pedido de Compra"?`Provis\xE3o Pedido - ${(c=this.compra.formaDePagamento)!=null?c:""}`:(e=this.compra.formaDePagamento)!=null?e:"",receberPagar:0,valorOriginal:$utils.arredondar(b.valor,2),documentoVinculado:1,valorTotal:$utils.arredondar(b.valor,2),valorARealizar:$utils.arredondar(b.valor,2),valorDesconto:0,percentualDesconto:0,idEmpresa:this.compra.idEmpresa,idContato:(b==null?void 0:b.freteSeparado)&&!!this.compra.idContatoTransportadora?this.compra.idContatoTransportadora:this.compra.idContato,idFinanceiroPlanoConta:b.observacao==="Valor Frete + Seguro"?h.id:r==null?void 0:r.id,documentoId:this.compra.id,idFinanceiroMovimentacaoAgrupamentoAutomatico:$utils.uuid(),cobrancaAtivo:1};this.compraTitulos.push(f)}const s=$utils.uuid();this.compraMovimentacoes=[];for(const m of a){const b={id:$utils.uuid(),idFinanceiroMovimentacaoN:s,idEmpresa:this.compra.idEmpresa,idFinanceiroPlanoConta:r.id,dataEmissao:o,valorCredito:this.compra.totalDocumento*m.porcentagem,valorDebito:0,descricao:r.descricao.trim(),observacao:"",automatico:0,liquidando:0,dataCompetencia:o,dataVencimento:o,dataMovimento:o,documentoTipo:this.compra.operacao,documentoId:this.compra.id};this.compraMovimentacoes.push(b);const _=await $db.financeiroPlanoConta.leCache({id:m.idPlanoContaEstoque}),f={id:$utils.uuid(),idFinanceiroMovimentacaoN:s,idEmpresa:this.compra.idEmpresa,idFinanceiroPlanoConta:m.idPlanoContaEstoque,dataEmissao:o,valorCredito:0,valorDebito:this.compra.totalDocumento*m.porcentagem,descricao:_.descricao.trim(),observacao:"",automatico:0,liquidando:0,dataCompetencia:o,dataVencimento:o,dataMovimento:o,documentoTipo:this.compra.operacao,documentoId:this.compra.id};this.compraMovimentacoes.push(f)}},async atualizaValorTotalPagamento({condicao:r,acao:a}){!r||a==="remover"&&(this.valorTotalPagamento=this.valorTotalPagamento-r.valor)},async ajustarPrevisaoEntrega(r){r==="alterar"&&(this.alterarPrevisaoEntrega=!0),r==="salvar"&&(await $tryLoading(async()=>{const a=`${this.dataPrevistaEntrega} ${this.horaPrevistaEntrega||"00:00:00"}`;$utils.verificarErro(!this.dataPrevistaEntrega&&this.horaPrevistaEntrega,"\xC9 necess\xE1rio preencher uma data em conjunto com a hora."),zt.formatDate(a)!==zt.formatDate(this.compra.dataHoraPrevisto)?(this.compra.dataHoraPrevisto=zt.formatDate(a)||"",await this.salvar(),await this.atualizar(),$q.notifyPositive("A previs\xE3o foi salva com sucesso")):$q.notifyPositive("N\xE3o h\xE1 dados alterados.")}),this.alterarPrevisaoEntrega=!1)},dialogImprimirEtiquetas(r,a){this.$emit("dialogImprimirEtiquetas",{acao:r,item:a})}}},He={class:"row items-center"},Ze={class:"col-auto"},Xe={class:"col-auto"},We={class:"col-auto"};function Ge(r,a,h,w,o,s){const c=gt("g-label"),e=gt("g-col"),m=gt("Badge"),b=gt("BadgeCopiarUid"),_=gt("g-row"),f=gt("avatar"),y=gt("campo"),n=gt("ModalEditarProdutoCompras"),C=gt("PromptItemV2"),g=Ee("mask");return M(),_t(kt,null,[t($t,{modelValue:r.visivel,"onUpdate:modelValue":a[33]||(a[33]=u=>r.visivel=u),persistent:"",maximized:"",onKeyup:be(s.fechar,["esc"])},{default:i(()=>[t(jt,{view:"hHh lpR lFr",container:"",class:"bg-light"},{default:i(()=>[t(Ht,null,{default:i(()=>[t(Nt,null,{default:i(()=>[t(dt,{onClick:s.fechar,icon:"arrow_back",flat:"",round:"",dense:""},null,8,["onClick"]),t(Rt,null,{default:i(()=>[T(J(r.compra.operacao),1)]),_:1}),vt(t(dt,{onClick:s.salvar_click,label:"Salvar",color:"white","text-color":"primary",unelevated:"",class:"q-ml-sm"},null,8,["onClick"]),[[xt,r.compra.status==="Digita\xE7\xE3o"]])]),_:1})]),_:1}),t(Zt,{class:"u-container"},{default:i(()=>[t(Xt,null,{default:i(()=>[t(_,{gutter:"md",mg:"md",bg:"bg-white"},{default:i(()=>[t(e,{col:"12 sm12 md6"},{default:i(()=>[t(_,{items:"center",justify:"end",class:"hideondesktop"},{default:i(()=>[t(e,{col:"xs-shrink",order:"1 sm0"},{default:i(()=>[vt(t(c,{text:"caption",icon:"mdi-calendar-today sm tertiary left",tip:`Emitido \xE1s ${r.$filters.hora(r.compra.dataHoraEmissao)}`},{default:i(()=>[T(J(r.$filters.data(r.compra.dataHoraEmissao)),1)]),_:1},8,["tip"]),[[xt,r.compra.dataHoraEmissao]])]),_:1}),t(e,{col:"xs-shrink",order:"1 sm0"},{default:i(()=>[vt(t(c,{text:"caption",icon:"mdi-calendar-today sm tertiary left",tip:`Finalizado \xE1s ${r.$filters.hora(r.compra.dataHoraFinalizado)}`},{default:i(()=>[T(J(r.$filters.data(r.compra.dataHoraFinalizado)),1)]),_:1},8,["tip"]),[[xt,r.compra.dataHoraFinalizado]])]),_:1}),t(e,{col:"xs12 sm-shrink",order:"0 sm1",text:"right"},{default:i(()=>[t(m,{cor:r.compra.status!=="Digita\xE7\xE3o"?"tertiary":"light",escuro:r.compra.status!=="Digita\xE7\xE3o",class:"q-ml-sm"},{default:i(()=>[T(J(r.compra.status),1)]),_:1},8,["cor","escuro"]),t(b,{id:r.compra.id,numero:r.compra.numero,cor:"positive",class:"q-ml-sm"},null,8,["id","numero"])]),_:1})]),_:1}),t(_,null,{default:i(()=>[t(e,{col:"12 sm6"},{default:i(()=>[t(_,null,{default:i(()=>[t(e,{col:"xs-shrink"},{default:i(()=>{var u,l;return[t(f,{imagem:(u=r.contatos[r.compra.idContato])==null?void 0:u.imagem,rotulo:(l=r.contatos[r.compra.idContato])==null?void 0:l.apelido,tamanho:"50"},null,8,["imagem","rotulo"])]}),_:1}),t(e,{col:"xs"},{default:i(()=>{var u;return[t(y,{modelValue:(u=r.contatos[r.compra.idContato])==null?void 0:u.apelido,"somente-leitura":"",after:[{icon:"edit",handler(){s.abrirModalFornecedor()}}],disable:r.compra.status!=="Digita\xE7\xE3o",rotulo:"Fornecedor",dense:"",borderless:"",class:"q-mb-sm"},null,8,["modelValue","after","disable"])]}),_:1})]),_:1})]),_:1}),t(e,{col:"12 sm6"},{default:i(()=>{var u;return[t(y,{modelValue:(u=r.contatos[r.compra.idContatoVendedor])==null?void 0:u.apelido,"somente-leitura":"",disable:r.compra.status!=="Digita\xE7\xE3o",after:[{icon:"edit",handler(){s.abrirModalVendedor()}}],rotulo:"Vendedor",dense:"",borderless:"",class:"q-mb-sm"},null,8,["modelValue","disable","after"])]}),_:1}),t(e,{col:"12 sm6"},{default:i(()=>{var u;return[t(y,{modelValue:(u=r.contatos[r.compra.idEmpresa])==null?void 0:u.apelido,"somente-leitura":"",after:[{icon:"edit",handler(){s.abrirModalEmpresa()}}],disable:r.compra.status!=="Digita\xE7\xE3o",rotulo:"Empresa",dense:"",borderless:"",class:"q-mb-sm"},null,8,["modelValue","after","disable"])]}),_:1}),t(e,{col:"12 sm6"},{default:i(()=>{var u;return[t(y,{modelValue:(u=r.contatos[r.compra.idContatoComprador])==null?void 0:u.apelido,"somente-leitura":"",disable:r.compra.status!=="Digita\xE7\xE3o",after:[{icon:"edit",handler(){s.abrirModalComprador()}}],rotulo:"Comprador",dense:"",borderless:"",class:"q-mb-sm"},null,8,["modelValue","disable","after"])]}),_:1}),t(e,{col:"12 sm6"},{default:i(()=>{var u;return[t(y,{modelValue:(u=r.contatos[r.compra.idContatoTransportadora])==null?void 0:u.apelido,"somente-leitura":"",disable:r.compra.status!=="Digita\xE7\xE3o",after:[{icon:"edit",handler(){s.abrirModalTransportador()}}],rotulo:"Transportadora",dense:"",borderless:"",class:"q-mb-sm"},null,8,["modelValue","disable","after"])]}),_:1}),t(e,{col:"12 sm6"},{default:i(()=>[t(_,null,{default:i(()=>[t(e,{col:"7"},{default:i(()=>[t(ie,{modelValue:r.dataPrevistaEntrega,"onUpdate:modelValue":a[0]||(a[0]=u=>r.dataPrevistaEntrega=u),disable:!this.alterarPrevisaoEntrega&&this.compra.status!=="Digita\xE7\xE3o",type:"date",label:"Data Prevista de Entrega",clearable:"",dense:"","stack-label":"",borderless:"",class:"q-mb-sm"},null,8,["modelValue","disable"])]),_:1}),t(e,{col:"5"},{default:i(()=>[t(ie,{modelValue:r.horaPrevistaEntrega,"onUpdate:modelValue":a[1]||(a[1]=u=>r.horaPrevistaEntrega=u),disable:!this.alterarPrevisaoEntrega&&this.compra.status!=="Digita\xE7\xE3o",type:"time",label:"Hora Prevista de Entrega",clearable:"",dense:"","stack-label":"",borderless:"",class:"q-mb-sm"},null,8,["modelValue","disable"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(e,{col:"12 sm12 md6"},{default:i(()=>[t(_,{justify:"end",items:"center",text:"right",class:"hideonmobile"},{default:i(()=>[t(e,{col:"12"},{default:i(()=>[t(_,{justify:"end",items:"center"},{default:i(()=>[t(m,{cor:r.compra.status!=="Digita\xE7\xE3o"?"tertiary":"light",escuro:r.compra.status!=="Digita\xE7\xE3o"},{default:i(()=>[T(J(r.compra.status),1)]),_:1},8,["cor","escuro"]),t(b,{id:r.compra.id,numero:r.compra.numero,cor:"positive",class:"q-ml-sm"},null,8,["id","numero"]),t(dt,{color:"tertiary",flat:"",icon:"more_vert",round:""},{default:i(()=>[t(Lt,null,{default:i(()=>[vt((M(),Y(Pt,{link:"",separator:""},{default:i(()=>[r.alterarPrevisaoEntrega?(M(),Y(mt,{key:1,clickable:"",onClick:a[3]||(a[3]=u=>s.ajustarPrevisaoEntrega("salvar"))},{default:i(()=>[t(Q,{avatar:""},{default:i(()=>[t(ct,{name:"local_shipping"})]),_:1}),t(Q,null,{default:i(()=>[t(nt,null,{default:i(()=>a[36]||(a[36]=[T("Salvar Previs\xE3o de Entrega")])),_:1})]),_:1})]),_:1})):(M(),Y(mt,{key:0,disable:r.compra.status==="Digita\xE7\xE3o",clickable:"",onClick:a[2]||(a[2]=u=>s.ajustarPrevisaoEntrega("alterar"))},{default:i(()=>[t(Q,{avatar:""},{default:i(()=>[t(ct,{name:"local_shipping"})]),_:1}),t(Q,null,{default:i(()=>[t(nt,null,{default:i(()=>a[35]||(a[35]=[T("Alterar Previs\xE3o de Entrega")])),_:1})]),_:1})]),_:1},8,["disable"])),t(mt,{onClick:a[4]||(a[4]=u=>s.dialogImprimirEtiquetas("adicionar",r.compra)),clickable:""},{default:i(()=>[t(Q,{avatar:""},{default:i(()=>[t(ct,{name:"print"})]),_:1}),t(Q,null,{default:i(()=>[t(nt,null,{default:i(()=>a[37]||(a[37]=[T(" Adicionar Etiquetas ")])),_:1})]),_:1})]),_:1}),t(mt,{onClick:a[5]||(a[5]=u=>s.dialogImprimirEtiquetas("impressao",r.compra)),clickable:""},{default:i(()=>[t(Q,{avatar:""},{default:i(()=>[t(ct,{name:"print"})]),_:1}),t(Q,null,{default:i(()=>[t(nt,null,{default:i(()=>a[38]||(a[38]=[T(" Imprimir Etiquetas ")])),_:1})]),_:1})]),_:1})]),_:1})),[[Et]])]),_:1})]),_:1})]),_:1})]),_:1}),t(e,{col:"shrink"},{default:i(()=>[vt(t(c,{text:"caption",icon:"mdi-calendar-today sm tertiary left",tip:`Emitido \xE1s ${r.$filters.hora(r.compra.dataHoraEmissao)}`},{default:i(()=>[T(J(r.$filters.data(r.compra.dataHoraEmissao)),1)]),_:1},8,["tip"]),[[xt,r.compra.dataHoraEmissao]])]),_:1}),t(e,{col:"shrink"},{default:i(()=>[vt(t(c,{text:"caption",icon:"mdi-calendar sm tertiary left",tip:`Finalizado \xE1s ${r.$filters.hora(r.compra.dataHoraFinalizado)}`},{default:i(()=>[T(J(r.$filters.data(r.compra.dataHoraFinalizado)),1)]),_:1},8,["tip"]),[[xt,r.compra.dataHoraFinalizado]])]),_:1})]),_:1}),t(_,null,{default:i(()=>[t(e,null,{default:i(()=>[t(y,{modelValue:r.compra.observacao,"onUpdate:modelValue":a[6]||(a[6]=u=>r.compra.observacao=u),"somente-leitura":r.compra.status!=="Digita\xE7\xE3o",tipo:"textoArea",rotulo:"Observa\xE7\xE3o",rows:"4"},null,8,["modelValue","somente-leitura"])]),_:1})]),_:1})]),_:1})]),_:1}),t(_,{gutter:"md",mg:"md",bg:"bg-white"},{default:i(()=>[r.exibeInfNota?(M(),Y(De,{key:0,"default-opened":r.compra.notaNumero>0||r.documentoNovo,"header-class":"q-px-sm",class:"notaEntrada g-col col-12"},{header:i(()=>[t(Q,null,{default:i(()=>[t(c,{text:"sub1 medium",icon:"mdi-file-replace sm tertiary left"},{default:i(()=>a[39]||(a[39]=[T("Nota de Entrada")])),_:1})]),_:1})]),default:i(()=>[t(e,{col:"12"},{default:i(()=>[t(_,null,{default:i(()=>[t(e,{col:"12 sm6 md3"},{default:i(()=>[vt(t(y,{modelValue:r.compra.notaNumero,"onUpdate:modelValue":a[7]||(a[7]=u=>r.compra.notaNumero=u),"somente-leitura":r.compra.status!=="Digita\xE7\xE3o",rotulo:"Numero",dense:""},null,8,["modelValue","somente-leitura"]),[[g,"##########"]])]),_:1}),t(e,{col:"12 sm6 md3"},{default:i(()=>[t(y,{modelValue:r.compra.notaSerie,"onUpdate:modelValue":a[8]||(a[8]=u=>r.compra.notaSerie=u),"somente-leitura":r.compra.status!=="Digita\xE7\xE3o",rotulo:"Serie",dense:""},null,8,["modelValue","somente-leitura"])]),_:1}),t(e,{col:"12 sm6 md3"},{default:i(()=>[t(y,{modelValue:r.compra.naturezaOperacao,"onUpdate:modelValue":a[9]||(a[9]=u=>r.compra.naturezaOperacao=u),"somente-leitura":r.compra.status!=="Digita\xE7\xE3o",rotulo:"Natureza da Opera\xE7\xE3o",dense:""},null,8,["modelValue","somente-leitura"])]),_:1}),t(e,{col:"12 sm6 md3"},{default:i(()=>[t(y,{modelValue:r.compra.dataCompra,"onUpdate:modelValue":a[10]||(a[10]=u=>r.compra.dataCompra=u),"somente-leitura":r.compra.status!=="Digita\xE7\xE3o",rotulo:"Data compra",tipo:"data",dense:""},null,8,["modelValue","somente-leitura"])]),_:1}),t(e,{col:"12"},{default:i(()=>[t(y,{modelValue:r.compra.chaveAcesso,"onUpdate:modelValue":a[11]||(a[11]=u=>r.compra.chaveAcesso=u),"somente-leitura":r.compra.status!=="Digita\xE7\xE3o",rotulo:"Chave",dense:""},null,8,["modelValue","somente-leitura"])]),_:1})]),_:1})]),_:1})]),_:1},8,["default-opened"])):ot("",!0)]),_:1}),t(_,{gutter:"md",mg:"md",bg:"bg-white"},{default:i(()=>[t(e,{col:"12"},{default:i(()=>[t(c,{text:"sub1 medium",icon:"shopping_cart sm tertiary left"},{default:i(()=>[a[40]||(a[40]=T("Carrinho ")),t(dt,{onClick:a[12]||(a[12]=u=>s.adicionarItem()),disable:r.compra.status!=="Digita\xE7\xE3o",icon:"add",label:"Produto",size:"md",color:"primary",flat:"",dense:"",class:"float-right q-px-sm"},null,8,["disable"])]),_:1})]),_:1}),(M(!0),_t(kt,null,Tt(r.compraItens,(u,l)=>(M(),Y(e,{col:"12",key:l},{default:i(()=>[t(Pt,{class:"full-width"},{default:i(()=>[t(mt,{class:"q-px-none"},{default:i(()=>{var v;return[t(Q,{avatar:"",class:"col-auto"},{default:i(()=>{var S;return[t(f,{imagem:(S=r.produtos[u.idItem])==null?void 0:S.imagem,rotulo:u.descricaoItem,tamanho:"50"},null,8,["imagem","rotulo"])]}),_:2},1024),t(Q,{class:"q-px-none"},{default:i(()=>[t(nt,null,{default:i(()=>[T(J(u.descricaoItem),1)]),_:2},1024),t(nt,{caption:""},{default:i(()=>{var S,D;return[T(J((D=(S=r.produtos[u.idItem])==null?void 0:S.marca)!=null?D:""),1)]}),_:2},1024)]),_:2},1024),vt(t(Q,{avatar:""},{default:i(()=>[t(m,{denso:""},{default:i(()=>{var S,D;return[T(J((D=(S=r.produtos[u.idItem])==null?void 0:S.referencia)!=null?D:""),1)]}),_:2},1024)]),_:2},1536),[[xt,(v=r.produtos[u.idItem])==null?void 0:v.referencia]]),t(Q,{avatar:""},{default:i(()=>[ft("div",He,[ft("div",Ze,[t(dt,{color:"primary",dense:"",flat:"",icon:"edit",round:"",onClick:S=>s.editarProduto(u),disable:r.compra.status!=="Digita\xE7\xE3o"},null,8,["onClick","disable"])]),ft("div",Xe,[t(dt,{color:"tertiary",dense:"",flat:"",icon:"delete",round:"",onClick:S=>s.removerItem(u),disable:r.compra.status!=="Digita\xE7\xE3o"},{default:i(()=>[t(Vt,{anchor:"bottom middle",self:"center middle"},{default:i(()=>a[41]||(a[41]=[T("Remover Item")])),_:1})]),_:2},1032,["onClick","disable"])]),ft("div",We,[t(dt,{color:"tertiary",dense:"",flat:"",icon:"more_vert",round:"",disable:r.compra.status!=="Digita\xE7\xE3o"},{default:i(()=>[t(Lt,null,{default:i(()=>[vt((M(),Y(Pt,{link:"",separator:""},{default:i(()=>[r.compra.status==="Digita\xE7\xE3o"?(M(),_t(kt,{key:0},[(M(!0),_t(kt,null,Tt(r.comprasMigrar,S=>(M(),Y(mt,{key:S.id,clickable:"",onClick:D=>s.migrarParaOutraCompra(u,S)},{default:i(()=>[t(Q,{avatar:""},{default:i(()=>[t(ct,{name:"mdi-folder-move"})]),_:1}),t(Q,null,{default:i(()=>[T(J("Migrar para Compra #"+(S.numero||S.id.slice(-6))),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),t(mt,{clickable:"",onClick:S=>s.migrarParaOutraCompra(u)},{default:i(()=>[t(Q,{avatar:""},{default:i(()=>[t(ct,{name:"mdi-folder-move"})]),_:1}),t(Q,null,{default:i(()=>a[42]||(a[42]=[T("Migrar para nova Compra")])),_:1})]),_:2},1032,["onClick"])],64)):ot("",!0)]),_:2},1024)),[[Et]])]),_:2},1024)]),_:2},1032,["disable"])])])]),_:2},1024)]}),_:2},1024)]),_:2},1024),t(_,null,{default:i(()=>[t(e,{col:"4 md"},{default:i(()=>[t(y,{dense:"",align:"left",tipo:"decimal",decimals:"4",zerosDireita:"2",outlined:"",rotulo:"Valor do produto",modelValue:u.valorItem,"onUpdate:modelValue":v=>u.valorItem=v,"somente-leitura":r.compra.status!=="Digita\xE7\xE3o",onBlur:v=>s.calcularTotaisItem(l,"valorItem")},null,8,["modelValue","onUpdate:modelValue","somente-leitura","onBlur"])]),_:2},1024),t(e,{col:"4 md"},{default:i(()=>[t(_,{items:"center"},{default:i(()=>[t(e,{col:"shrink"},{default:i(()=>[t(ct,{name:"mdi-minus",color:"primary"})]),_:1}),t(e,{col:"xs"},{default:i(()=>[t(y,{dense:"",opcoes:{maximumValue:100},tipo:"decimal",decimals:"2",rotulo:"Desconto percentual",modelValue:u.descontoPercentualItem,"onUpdate:modelValue":v=>u.descontoPercentualItem=v,outlined:"",suffix:"%","somente-leitura":r.compra.status!=="Digita\xE7\xE3o",onBlur:v=>s.calcularTotaisItem(l,"descontoPercentualItem")},null,8,["modelValue","onUpdate:modelValue","somente-leitura","onBlur"])]),_:2},1024)]),_:2},1024)]),_:2},1024),t(e,{col:"4 md"},{default:i(()=>[t(y,{dense:"",tipo:"decimal",modelValue:u.descontoItem,"onUpdate:modelValue":v=>u.descontoItem=v,decimals:"4",zerosDireita:"2",outlined:"",rotulo:"Desconto em reais",prefix:"R$",onBlur:v=>s.calcularTotaisItem(l,"descontoItem"),"somente-leitura":r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onUpdate:modelValue","onBlur","somente-leitura"])]),_:2},1024),t(e,{col:"6 md"},{default:i(()=>[t(_,{items:"center"},{default:i(()=>[t(e,{col:"shrink",class:"hideonmobile"},{default:i(()=>[t(ct,{name:"mdi-equal",color:"primary"})]),_:1}),t(e,{col:"xs"},{default:i(()=>[t(y,{dense:"",outlined:"",opcoes:{maximumValue:10,minimumValue:0},rotulo:"Subtotal",tipo:"decimal",decimals:"4",zerosDireita:"2",modelValue:u.subTotal,"onUpdate:modelValue":v=>u.subTotal=v,onBlur:v=>s.calcularTotaisItem(l,"subTotal"),"somente-leitura":r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onUpdate:modelValue","onBlur","somente-leitura"])]),_:2},1024)]),_:2},1024)]),_:2},1024),t(e,{col:"6 md"},{default:i(()=>[t(_,{items:"center"},{default:i(()=>[t(e,{col:"shrink"},{default:i(()=>[t(ct,{name:"mdi-close",color:"primary"})]),_:1}),t(e,{col:"xs"},{default:i(()=>[t(y,{dense:"",max:"100",min:"0",outlined:"",modelValue:u.quantidade,"onUpdate:modelValue":v=>u.quantidade=v,decimals:"4",zerosDireita:"0",tipo:"quantidade",onBlur:v=>s.calcularTotaisItem(l),disable:r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onUpdate:modelValue","onBlur","disable"]),t(Vt,{anchor:"bottom middle",self:"center middle"},{default:i(()=>a[43]||(a[43]=[T("Quantidade")])),_:1})]),_:2},1024)]),_:2},1024)]),_:2},1024),t(e,{col:"12 md"},{default:i(()=>[t(_,{items:"center"},{default:i(()=>[t(e,{col:"shrink",class:"hideonmobile"},{default:i(()=>[t(ct,{name:"mdi-equal",color:"primary"})]),_:1}),t(e,{col:"xs"},{default:i(()=>[t(y,{dense:"",tipo:"decimal",decimals:"2",rotulo:"Total","somente-leitura":"",modelValue:u.total,"onUpdate:modelValue":v=>u.total=v,outlined:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),t(e,{col:"12"},{default:i(()=>[t(_,{gutter:"md",mg:"md-y",justify:"end",items:"center",bg:"bg-light","rounded-borders":"","min-height":"49px"},{default:i(()=>[t(e,{col:"3 sm2 md-shrink",text:"bold"},{default:i(()=>a[44]||(a[44]=[T(" Calcular ")])),_:1}),t(e,{col:"9 sm10 md"},{default:i(()=>[t(Mt,{modelValue:r.compra.calcularTributacao,"onUpdate:modelValue":[a[13]||(a[13]=u=>r.compra.calcularTributacao=u),s.calcularTotais],"checked-icon":"check",color:"green","unchecked-icon":"clear",disable:r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onUpdate:modelValue","disable"])]),_:1}),t(e,{col:"6 md-shrink"},{default:i(()=>a[45]||(a[45]=[T(" Base ICMS ")])),_:1}),t(e,{col:"6 md",text:"right"},{default:i(()=>[t(y,{dense:"",outlined:"",decimals:"2",zerosDireita:"2",tipo:"decimal",modelValue:r.compra.valorBaseIcms,"onUpdate:modelValue":a[14]||(a[14]=u=>r.compra.valorBaseIcms=u),"somente-leitura":!!r.compra.calcularTributacao||r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","somente-leitura"])]),_:1}),t(e,{col:"6 md-shrink"},{default:i(()=>a[46]||(a[46]=[T(" Valor ICMS ")])),_:1}),t(e,{col:"6 md",text:"right"},{default:i(()=>[t(y,{dense:"",outlined:"",modelValue:r.compra.valorIcms,"onUpdate:modelValue":a[15]||(a[15]=u=>r.compra.valorIcms=u),decimals:"2",zerosDireita:"2",tipo:"decimal","somente-leitura":!!r.compra.calcularTributacao||r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","somente-leitura"])]),_:1}),t(e,{col:"6 md-shrink"},{default:i(()=>a[47]||(a[47]=[T(" Base ICMS ST ")])),_:1}),t(e,{col:"6 md",text:"right"},{default:i(()=>[t(y,{dense:"",outlined:"",modelValue:r.compra.valorBaseIcmsSt,"onUpdate:modelValue":a[16]||(a[16]=u=>r.compra.valorBaseIcmsSt=u),decimals:"2",zerosDireita:"2",tipo:"decimal","somente-leitura":!!r.compra.calcularTributacao||r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","somente-leitura"])]),_:1}),t(e,{col:"6 md-shrink"},{default:i(()=>a[48]||(a[48]=[T(" ICMS ST ")])),_:1}),t(e,{col:"6 md",text:"right"},{default:i(()=>[t(y,{dense:"",outlined:"",modelValue:r.compra.valorIcmsSt,"onUpdate:modelValue":a[17]||(a[17]=u=>r.compra.valorIcmsSt=u),decimals:"2",zerosDireita:"2",tipo:"decimal","somente-leitura":!!r.compra.calcularTributacao||r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","somente-leitura"])]),_:1})]),_:1}),t(_,{mg:"lg-t",justify:"end"},{default:i(()=>[t(e,{col:"xs12 sm8 md4"},{default:i(()=>[t(_,{items:"center"},{default:i(()=>[t(e,{col:"3",text:"bold"},{default:i(()=>a[49]||(a[49]=[T(" Subtotal ")])),_:1}),t(e,{col:"xs",text:"right bold"},{default:i(()=>[T(J(r.$filters.numero(r.compra.subTotalProduto,2)),1)]),_:1})]),_:1}),t(ue,{class:"q-mb-md q-mt-xs"}),t(_,{items:"center"},{default:i(()=>[t(e,{col:"xs3"},{default:i(()=>a[50]||(a[50]=[T(" Desconto ")])),_:1}),t(e,{col:"xs"},{default:i(()=>[t(y,{tipo:"decimal",decimals:"2",modelValue:r.compra.totalPercentualDesconto,"onUpdate:modelValue":a[18]||(a[18]=u=>r.compra.totalPercentualDesconto=u),onBlur:a[19]||(a[19]=u=>s.calcularTotais("totalPercentualDesconto")),suffix:"%",error:r.erroDesconto,"somente-leitura":r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","error","somente-leitura"])]),_:1}),t(e,{col:"xs"},{default:i(()=>[t(y,{tipo:"decimal",decimals:"2",modelValue:r.compra.totalDesconto,"onUpdate:modelValue":a[20]||(a[20]=u=>r.compra.totalDesconto=u),onBlur:a[21]||(a[21]=u=>s.calcularTotais("totalDesconto")),error:r.erroDesconto,"somente-leitura":r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","error","somente-leitura"])]),_:1})]),_:1}),t(_,{items:"center"},{default:i(()=>[t(e,{col:"xs3"},{default:i(()=>a[51]||(a[51]=[T(" Frete ")])),_:1}),t(e,{col:"xs"},{default:i(()=>[t(he,{class:"q-mr-md",label:"CIF",val:"CIF",modelValue:r.compra.tipoFrete,"onUpdate:modelValue":[a[22]||(a[22]=u=>r.compra.tipoFrete=u),s.calcularTotais],dense:"",disable:r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onUpdate:modelValue","disable"]),t(he,{label:"FOB",val:"FOB",modelValue:r.compra.tipoFrete,"onUpdate:modelValue":[a[23]||(a[23]=u=>r.compra.tipoFrete=u),s.calcularTotais],dense:"",disable:r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onUpdate:modelValue","disable"])]),_:1}),t(e,{col:"xs"},{default:i(()=>[t(y,{tipo:"decimal",decimals:"2",modelValue:r.compra.valorFrete,"onUpdate:modelValue":a[24]||(a[24]=u=>r.compra.valorFrete=u),onBlur:s.calcularTotais,error:r.erroFrete,"somente-leitura":r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onBlur","error","somente-leitura"])]),_:1})]),_:1}),t(_,{items:"center"},{default:i(()=>[t(e,{col:"xs3"},{default:i(()=>a[52]||(a[52]=[T(" Seguro ")])),_:1}),t(e,{col:"xs"},{default:i(()=>[t(y,{tipo:"decimal",decimals:"2",modelValue:r.compra.valorSeguro,"onUpdate:modelValue":a[25]||(a[25]=u=>r.compra.valorSeguro=u),onBlur:s.calcularTotais,error:r.erroSeguro,"somente-leitura":r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onBlur","error","somente-leitura"])]),_:1})]),_:1}),t(_,{items:"center"},{default:i(()=>[t(e,{col:"xs5"},{default:i(()=>a[53]||(a[53]=[T(" Outras despesas ")])),_:1}),t(e,{col:"xs"},{default:i(()=>[t(y,{tipo:"decimal",decimals:"2",modelValue:r.compra.valorOutrasDespesas,"onUpdate:modelValue":a[26]||(a[26]=u=>r.compra.valorOutrasDespesas=u),onBlur:s.calcularTotais,error:r.erroOutrasDespesas,"somente-leitura":r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onBlur","error","somente-leitura"])]),_:1})]),_:1}),t(ue,{class:"q-mt-md q-mb-xs"}),t(_,{items:"center"},{default:i(()=>[t(e,{col:"xs4",text:"bold"},{default:i(()=>a[54]||(a[54]=[T(" Total ")])),_:1}),t(e,{col:"xs",text:"right bold"},{default:i(()=>[T(J(r.$filters.numero(r.compra.totalProduto,2)),1)]),_:1})]),_:1}),r.compra.totalComImposto?(M(),Y(_,{key:0,items:"center"},{default:i(()=>[t(e,{col:"xs4",text:"bold"},{default:i(()=>a[55]||(a[55]=[T(" Total IPI ")])),_:1}),t(e,{col:"xs",text:"right bold"},{default:i(()=>[T(J(r.$filters.numero(r.compra.valorIpi,2)),1)]),_:1})]),_:1})):ot("",!0),t(_,{items:"center"},{default:i(()=>[t(e,{col:"xs5",text:"bold"},{default:i(()=>a[56]||(a[56]=[T(" Total c/ Impostos ")])),_:1}),t(e,{col:"xs-shrink"},{default:i(()=>[t(Mt,{disable:r.compra.status!=="Digita\xE7\xE3o",modelValue:r.compra.totalComImposto,"onUpdate:modelValue":[a[27]||(a[27]=u=>r.compra.totalComImposto=u),s.calcularTotais],"checked-icon":"check",color:"green","unchecked-icon":"clear"},null,8,["disable","modelValue","onUpdate:modelValue"])]),_:1}),t(e,{col:"xs",text:"right bold"},{default:i(()=>[T(J(r.$filters.numero(r.compra.totalDocumento,2)),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(_,{gutter:"md",mg:"md",bg:"bg-white"},{default:i(()=>[t(e,{col:"12"},{default:i(()=>[t(c,{text:"sub1 medium",icon:"credit_card sm tertiary left"},{default:i(()=>a[57]||(a[57]=[T("Faturar")])),_:1})]),_:1}),t(e,{col:"12"},{default:i(()=>[t(y,{modelValue:r.compra.observacaoFaturamento,"onUpdate:modelValue":a[28]||(a[28]=u=>r.compra.observacaoFaturamento=u),tipo:"textoArea",rotulo:"Observa\xE7\xE3o faturamento",rows:"5"},null,8,["modelValue"])]),_:1}),t(e,{col:"12"},{default:i(()=>[t(oe,{ref:"formAdicionarPagamento"},{default:i(()=>[t(_,{mg:"md-y",items:"center"},{default:i(()=>[t(e,{col:"12 sm6 md"},{default:i(()=>[t(y,{modelValue:r.compra.formaDePagamento,"onUpdate:modelValue":a[29]||(a[29]=u=>r.compra.formaDePagamento=u),rules:r.formaPagamentoRules,ajuda:"Exemplo: Boleto","somente-leitura":r.compra.status!=="Digita\xE7\xE3o",rotulo:"Forma de pagamento"},null,8,["modelValue","rules","somente-leitura"])]),_:1}),t(e,{col:"12 sm6 md"},{default:i(()=>[t(y,{modelValue:r.compra.condicaoPagamento,"onUpdate:modelValue":a[30]||(a[30]=u=>r.compra.condicaoPagamento=u),rules:r.condicaoPagamentoRules,ajuda:"Exemplo: 28/56/64","somente-leitura":r.compra.status!=="Digita\xE7\xE3o",rotulo:"Cond. Pag",tipo:"numero"},null,8,["modelValue","rules","somente-leitura"])]),_:1}),t(e,{col:"12 sm4 md",text:"bold",class:"q-my-sm"},{default:i(()=>[a[58]||(a[58]=T(" Frete Separado ")),t(Mt,{modelValue:r.compra.freteSeparado,"onUpdate:modelValue":[a[31]||(a[31]=u=>r.compra.freteSeparado=u),s.calcularTotais],disable:r.compra.status!=="Digita\xE7\xE3o",dense:"",class:"q-ml-sm"},null,8,["modelValue","onUpdate:modelValue","disable"])]),_:1}),t(e,{col:"12 sm4 md",text:"bold",class:"q-my-sm"},{default:i(()=>[a[59]||(a[59]=T(" N\xE3o gerar financeiro ")),t(Mt,{modelValue:r.compra.naoGerarFinanceiro,"onUpdate:modelValue":[a[32]||(a[32]=u=>r.compra.naoGerarFinanceiro=u),s.calcularTotais],disable:r.compra.status!=="Digita\xE7\xE3o",dense:"",class:"q-ml-sm"},null,8,["modelValue","onUpdate:modelValue","disable"])]),_:1}),t(e,{col:"12 sm4 md",text:"center"},{default:i(()=>[t(dt,{onClick:s.gerarCondicoesDePagamento_click,disable:r.compra.status!=="Digita\xE7\xE3o",color:"positive",icon:"add",label:"Forma de pagamento",outline:"",size:"sm"},null,8,["onClick","disable"])]),_:1})]),_:1})]),_:1},512)]),_:1}),t(e,{col:"12"},{default:i(()=>[vt(t(c,{text:"sub1 medium"},{default:i(()=>a[60]||(a[60]=[T("Condi\xE7\xF5es de pagamento")])),_:1},512),[[xt,r.compraCondicoesDePagamento.length>0]]),(M(!0),_t(kt,null,Tt(r.compraCondicoesDePagamento,u=>(M(),Y(Pt,{highlight:"",class:"q-pa-none",key:u.id},{default:i(()=>[t(_,{gutter:"md",mg:"sm-y",items:"center",bordered:"","rounded-borders":""},{default:i(()=>[t(e,{col:"xs6 md-shrink"},{default:i(()=>[t(y,{modelValue:u.dataVencimento,"onUpdate:modelValue":l=>u.dataVencimento=l,"somente-leitura":r.compra.status!=="Digita\xE7\xE3o",rotulo:"Data vencimento",tipo:"data",dense:""},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024),t(e,{col:"xs6 md2"},{default:i(()=>[t(y,{modelValue:u.valor,"onUpdate:modelValue":l=>u.valor=l,"somente-leitura":r.compra.status!=="Digita\xE7\xE3o",align:"left",rotulo:"Valor",decimals:"2",zerosDireita:"2",tipo:"decimal"},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024),t(e,{col:"xs-grow"},{default:i(()=>[t(y,{modelValue:u.observacao,"onUpdate:modelValue":l=>u.observacao=l,"somente-leitura":r.compra.status!=="Digita\xE7\xE3o"||u.observacao==="Valor Frete + Seguro",rotulo:"Observa\xE7\xE3o"},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024),t(e,{col:"xs-shrink",text:"right"},{default:i(()=>[t(dt,{onClick:l=>s.removerPagamento_click(u),icon:"delete",round:"",dense:"",flat:"",color:"tertiary",disable:r.compra.status!=="Digita\xE7\xE3o"},null,8,["onClick","disable"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),r.valorTotalPagamento>0?(M(),Y(_,{key:0,mg:"sm-t"},{default:i(()=>[t(e,{col:"xs-shrink",text:"bold"},{default:i(()=>[T(" Valor total: "+J(r.$filters.numero(r.valorTotalPagamento,2)),1)]),_:1})]),_:1})):ot("",!0)]),_:1})]),_:1}),r.$db.usuario.desenvolvedor()?(M(),Y(_,{key:0,gutter:"md",mg:"md",bg:"bg-yellow"},{default:i(()=>[t(e,{col:"12"},{default:i(()=>[t(c,{text:"sub1 medium",icon:"credit_card sm tertiary left"},{default:i(()=>a[61]||(a[61]=[T("Contabilidade (apenas desenvolvedor)")])),_:1})]),_:1}),t(e,{col:"12"},{default:i(()=>[r.compraTitulos.length?(M(),Y(c,{key:0,text:"sub1 medium"},{default:i(()=>a[62]||(a[62]=[T("Titulos")])),_:1})):ot("",!0),t(Pt,{highlight:"",class:"q-pa-none"},{default:i(()=>[(M(!0),_t(kt,null,Tt(r.compraTitulos,u=>(M(),Y(_,{key:u.id,items:"center"},{default:i(()=>[t(e,{col:"sm2"},{default:i(()=>[t(y,{modelValue:u.dataVencimento,"somente-leitura":"",rotulo:"Data vencimento",tipo:"data",dense:""},null,8,["modelValue"])]),_:2},1024),t(e,{col:"sm2"},{default:i(()=>[t(y,{modelValue:u.dataPagamento||"A pagar","somente-leitura":"",rotulo:"Data pagamento",tipo:u.dataPagamento?"data":"texto",dense:""},null,8,["modelValue","tipo"])]),_:2},1024),t(e,{col:"sm2"},{default:i(()=>[t(y,{modelValue:u.valor,"somente-leitura":"",align:"left",rotulo:"Valor",decimals:"2",tipo:"decimal"},null,8,["modelValue"])]),_:2},1024),t(e,{col:"sm2"},{default:i(()=>[t(y,{modelValue:u.parcela,"somente-leitura":"",align:"left",rotulo:"Parcela"},null,8,["modelValue"])]),_:2},1024),t(e,{col:"sm2"},{default:i(()=>[t(y,{modelValue:u.formaDePagamento,"somente-leitura":"",rotulo:"Forma de pagamento"},null,8,["modelValue"])]),_:2},1024),t(e,{col:"sm2"},{default:i(()=>[t(y,{modelValue:u.observacao,"somente-leitura":"",rotulo:"Observa\xE7\xE3o"},null,8,["modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),t(e,{col:"12"},{default:i(()=>[r.compraMovimentacoes.length?(M(),Y(c,{key:0,text:"sub1 medium"},{default:i(()=>a[63]||(a[63]=[T("Movimenta\xE7\xF4es")])),_:1})):ot("",!0),t(Pt,{highlight:"",class:"q-pa-none"},{default:i(()=>[(M(!0),_t(kt,null,Tt(r.compraMovimentacoes,u=>(M(),Y(_,{key:u.id,gutter:"sm",mg:"sm-y",items:"center"},{default:i(()=>[t(e,{col:"xs-grow"},{default:i(()=>[t(y,{modelValue:u.descricao,"somente-leitura":"",rotulo:"Descri\xE7\xE3o"},null,8,["modelValue"])]),_:2},1024),u.valorCredito?(M(),Y(e,{key:0,col:"xs6 md2"},{default:i(()=>[t(y,{modelValue:u.valorCredito,"somente-leitura":"",align:"left",rotulo:"Valor Credito",decimals:"2",tipo:"decimal"},null,8,["modelValue"])]),_:2},1024)):ot("",!0),u.valorDebito?(M(),Y(e,{key:1,col:"xs6 md2"},{default:i(()=>[t(y,{modelValue:u.valorDebito,"somente-leitura":"",align:"left",rotulo:"Valor Debito",decimals:"2",tipo:"decimal"},null,8,["modelValue"])]),_:2},1024)):ot("",!0),t(e,{col:"xs6 md-shrink"},{default:i(()=>[t(y,{modelValue:u.dataCompetencia,"somente-leitura":"",rotulo:"Data competencia",tipo:"data",dense:""},null,8,["modelValue"])]),_:2},1024),t(e,{col:"xs-grow"},{default:i(()=>[t(y,{modelValue:u.observacao,"somente-leitura":"",rotulo:"Observa\xE7\xE3o"},null,8,["modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})):ot("",!0),r.$db.usuario.desenvolvedor()&&r.compraDocumentoXml.length?(M(),Y(_,{key:1,gutter:"md",mg:"md",bg:"bg-yellow"},{default:i(()=>[t(e,{col:"12"},{default:i(()=>[t(c,{text:"sub1 medium",icon:"credit_card sm tertiary left"},{default:i(()=>a[64]||(a[64]=[T("XML importado (apenas desenvolvedor)")])),_:1})]),_:1}),t(e,{col:"12"},{default:i(()=>[t(Pt,{highlight:"",class:"q-pa-none"},{default:i(()=>[(M(!0),_t(kt,null,Tt(r.compraDocumentoXml,u=>(M(),Y(_,{key:u.id},{default:i(()=>[ft("pre",null,J(s.formatXml(u.xmlData)),1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})):ot("",!0)]),_:1})]),_:1}),t(Yt,{class:"bg-light border-top"},{default:i(()=>[t(Nt,{class:"bg-light text-tertiary q-px-md u-container"},{default:i(()=>[t(Rt,{class:"text-subtitle2"},{default:i(()=>[T(" Valor Total: "+J(r.$filters.numero(r.compra.totalDocumento,2))+" ",1),a[65]||(a[65]=ft("span",{class:"q-px-xs"},"|",-1)),T(" SKU: "+J(s.skus),1)]),_:1}),t(re),vt(t(dt,{onClick:s.excluir_click,type:"submit",class:"q-ml-sm",color:"white","text-color":"negative",flat:"",label:"Excluir"},null,8,["onClick"]),[[xt,r.compra.status==="Digita\xE7\xE3o"]]),vt(t(dt,{onClick:s.finalizar_click,type:"submit",class:"q-ml-sm",color:"primary",unelevated:"",label:"Finalizar"},null,8,["onClick"]),[[xt,r.compra.status==="Digita\xE7\xE3o"]]),vt(t(dt,{onClick:s.reabrir_click,color:"tertiary",flat:"",label:"Reabrir",type:"submit",class:"q-ml-sm"},null,8,["onClick"]),[[xt,r.compra.status==="Finalizado"]]),vt(t(dt,{unelevated:"",onClick:s.transformarEmNotaDeEntrada_click,class:"q-ml-sm",color:"primary",label:"Transformar em Nota de Entrada",type:"submit"},null,8,["onClick"]),[[xt,r.compra.status==="Finalizado"&&r.compra.operacao==="Pedido de Compra"]])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onKeyup"]),t(n,{ref:"ModalEditarProdutoCompras",onSalvar:s.fecharEdicaoProduto},null,8,["onSalvar"]),t(C,{modelValue:r.adicionar.modal.value,"onUpdate:modelValue":a[34]||(a[34]=u=>r.adicionar.modal.value=u),filtro:{ativo:!0,idEmpresa:r.compra.idEmpresa},ref:"promptItem",habilitarQuantidade:!0,exibirValorVenda:!1,calculaItemCusto:!0,onSelecionarItens:s.selecionarItens},null,8,["modelValue","filtro","onSelecionarItens"])],64)}var Qe=se(je,[["render",Ge]]);const Ke={components:{PromptItemV2:ve},data(){return{mostrarItemModal:!1,idxItem:0,compra:{},compraItens:[],compraItensNaoVinculados:[],visivel:!1,edicaoGeral:{marca:"",grupo:"",subGrupo:"",percentualMarkup:0}}},emits:["atualizar","concluirImportacao"],computed:{produtosNaoVinculados(){return this.compraItens.reduce((r,a)=>r+(a.vinculado?0:1),0)},quantProdutos(){return this.compraItens.reduce((r,a)=>r+1,0)}},methods:{async mostrar(r){for(const a of r.documentosItem)this.recalcularItem_blur(a);this.compra=r,this.compraItens=r.documentosItem,this.compraItensNaoVinculados=this.compraItens.filter(({vinculado:a})=>!a),this.visivel=!0},async fechar(){this.visivel=!1},async selecionarItens(r){await $tryLoading(async()=>{var c;const a=(c=Object.values(r)[0])==null?void 0:c.item;$utils.verificarErro(!(a!=null&&a.id),"Produto inv\xE1lido"),this.compraItensNaoVinculados[this.idxItem].item=a;const{documentoItem:h,item:w,nfeProd:o}=this.compraItensNaoVinculados[this.idxItem];h.idItem=w.id,h.descricaoItem=w.descricao;const s={id:$utils.uuid(),idItem:h.idItem,idContato:this.compra.documento.idContato,referencia:o.cProd,descricao:o.xProd};this.compra.itensFornecedor.push(s),this.compraItensNaoVinculados[this.idxItem].vinculado=!0,this.compraItensNaoVinculados=this.compraItens.filter(({vinculado:e})=>!e),$q.notifyPositive(`Produto vinculado com sucesso: ${w.descricao}`)},{mensagem:"Vinculando produto..."}),this.mostrarItemModal=!1},aplicar_click(){for(const r of this.compraItens)r.vinculado||(this.edicaoGeral.marca&&(r.item.marca=this.edicaoGeral.marca),this.edicaoGeral.grupo&&(r.item.grupo=this.edicaoGeral.grupo),this.edicaoGeral.subGrupo&&(r.item.subGrupo=this.edicaoGeral.subGrupo),this.edicaoGeral.percentualMarkup&&(r.item.percentualMarkup=this.edicaoGeral.percentualMarkup,this.recalcularItem_blur(r)))},async recalcularItem_blur(r){const{item:a,documentoItem:h,itemAnterior:w=$utils.clonarV2(r.item)}=r,{valorFreteRateado:o=0,valorSeguroRateado:s=0,valorOutrasDespesasRateado:c=0}=h;r.valoresEdicao||(r.valoresEdicao={valorOutrasDespesas:o+s+c,percentualIpi:h.percentualIpi||0,percentualIcmsSt:h.percentualIcmsSt||0,percentualDifal:0});const{valorOutrasDespesas:e,percentualIpi:m,percentualIcmsSt:b,percentualDifal:_}=r.valoresEdicao,{valorCusto:f=0,percentualMarkup:y=0,valorVenda:n=0}=a,C=f+e,g=C*m/100,u=C*b/100,l=C*_/100;a.valorCustoReposicao=$utils.arredondar(C+g+u+l,2),n!==w.valorVenda?a.percentualMarkup=$utils.arredondar(100*(n-a.valorCustoReposicao)/n,2):a.valorVenda=$utils.arredondar(a.valorCustoReposicao/(1-y/100),2),r.itemAnterior=$utils.clonarV2(a)},async adicionarItem_click(r){r.buttonLoading=!0,await this.$nextTick(),await $tryLoading(async()=>{const a=await $db.hibrido.lista({table:"item",where:{referencia:r.item.referencia}});$utils.verificarErro(a.length,"Referencia j\xE1 utilizada por outro produto"),r.documentoItem.descricaoItem=r.item.descricao,r.item.descricaoConcatenada=r.item.descricao;const h=r.nfeProd,w={id:$utils.uuid(),idItem:r.item.id,idContato:this.compra.documento.idContato,referencia:h.cProd,descricao:h.xProd};this.compra.itens.push(r.item),this.compra.itensFornecedor.push(w),r.vinculado=!0,$q.notifyPositive(`Item criado com sucesso: ${r.item.descricao}`)},{mensagem:"Cadastrando produto..."}),r.buttonLoading=!1},async salvar_click(){this.compraItens.some(({vinculado:r})=>!r)?$q.notifyError("Verifique todos os itens n\xE3o vinculados!"):(this.mostrarItemModal=!1,this.visivel=!1,this.$emit("concluirImportacao",this.compra))},async incluirTodos_click(){for(const r of this.compraItens)r.vinculado||await this.adicionarItem_click(r)}}},Ye={class:"layout-padding q-pa-none q-pb-md"},Je={class:"items-carrinho items-center row q-pa-none rounded-borders u-container",style:{"margin-top":"12px","margin-bottom":"12px"}},ta={class:"col-2"},ea=["id"],aa={class:"col-12"},oa={class:"col-4 col-md"},ra={class:"col-4 col-md"},ia={class:"col-4 col-md"},sa={class:"col-4 col-md"},na={class:"col-6 col-md"},la={class:"col-12 col-md"},da={class:"col-6 col-md"},ua={class:"col-12 col-md"},ca={key:0,class:"col-12"},ma={class:"col-12 col-md-4"},fa={class:"col-12 col-md-auto q-pl-none"},pa={key:1,class:"col-12 q-pt-md text-right text-bold"},ha={class:"text-positive"};function ga(r,a,h,w,o,s){const c=gt("ajuda"),e=gt("campo"),m=gt("row"),b=gt("card"),_=gt("PromptItemV2");return M(),_t(kt,null,[t($t,{modelValue:o.visivel,"onUpdate:modelValue":a[4]||(a[4]=f=>o.visivel=f),persistent:"",maximized:"",onKeyup:be(s.fechar,["esc"])},{default:i(()=>[t(jt,{container:"",view:"hHh LpR fFf",class:"bg-light"},{default:i(()=>[t(Ht,null,{default:i(()=>[t(Nt,null,{default:i(()=>[t(dt,{icon:"arrow_back",flat:"",round:"",dense:"",onClick:s.fechar},null,8,["onClick"]),t(Rt,null,{default:i(()=>a[6]||(a[6]=[T("Importar XML x Cadastro")])),_:1}),t(c)]),_:1})]),_:1}),t(Zt,null,{default:i(()=>[t(Xt,null,{default:i(()=>[ft("div",Ye,[ft("div",Je,[t(b,{icon:"mdi-set-none",label:"Propriedades para todos os produtos",class:"full-width"},{default:i(()=>[t(m,null,{default:i(()=>[t(e,{modelValue:o.edicaoGeral.marca,"onUpdate:modelValue":a[0]||(a[0]=f=>o.edicaoGeral.marca=f),rotulo:"Marca",dense:"",tipo:"texto",outlined:"",col:"4"},null,8,["modelValue"]),t(e,{modelValue:o.edicaoGeral.grupo,"onUpdate:modelValue":a[1]||(a[1]=f=>o.edicaoGeral.grupo=f),rotulo:"Grupo",dense:"",tipo:"texto",outlined:"",col:"4"},null,8,["modelValue"]),t(e,{modelValue:o.edicaoGeral.subGrupo,"onUpdate:modelValue":a[2]||(a[2]=f=>o.edicaoGeral.subGrupo=f),rotulo:"SubGrupo",dense:"",tipo:"texto",outlined:"",col:"4"},null,8,["modelValue"])]),_:1}),t(m,{class:"q-pt-sm"},{default:i(()=>[a[7]||(a[7]=ft("div",{class:"col-8"},null,-1)),t(e,{modelValue:o.edicaoGeral.percentualMarkup,"onUpdate:modelValue":a[3]||(a[3]=f=>o.edicaoGeral.percentualMarkup=f),rotulo:"Margem de Lucro",suffix:"%",opcoes:{maximumValue:100},dense:"",tipo:"decimal",decimals:"2",outlined:"",col:"2"},null,8,["modelValue"]),ft("div",ta,[t(dt,{class:"q-ml-sm no-shadow",color:"primary",icon:"play_arrow",unelevated:"",label:"Aplicar",onClick:s.aplicar_click},null,8,["onClick"])])]),_:1})]),_:1})]),t(Ve,{items:o.compraItensNaoVinculados,separator:""},{default:i(({item:f,index:y})=>[ft("div",{class:"items-carrinho items-center row q-pa-md bg-white rounded-borders u-container",style:{"margin-top":"12px","margin-bottom":"12px"},id:y},[t(Pt,{class:"full-width"},{default:i(()=>[t(mt,{class:"q-px-none"},{default:i(()=>[t(Q,{class:"q-px-none"},{default:i(()=>[t(nt,null,{default:i(()=>[t(e,{dense:"",align:"left",tipo:"texto",outlined:"",rotulo:"Descri\xE7\xE3o Item",modelValue:f.item.descricao,"onUpdate:modelValue":n=>f.item.descricao=n,"somente-leitura":!!f.vinculado},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024)]),_:2},1024),t(Q,null,{default:i(()=>[t(nt,null,{default:i(()=>[t(e,{dense:"",align:"left",tipo:"texto",outlined:"",rotulo:"Referencia",modelValue:f.item.referencia,"onUpdate:modelValue":n=>f.item.referencia=n,"somente-leitura":!!f.vinculado},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),t(Pt,{class:"full-width"},{default:i(()=>[t(mt,{class:"q-px-none"},{default:i(()=>[t(Q,null,{default:i(()=>[t(nt,null,{default:i(()=>[t(e,{dense:"",tipo:"texto",outlined:"",rotulo:"Marca",modelValue:f.item.marca,"onUpdate:modelValue":n=>f.item.marca=n,"somente-leitura":!!f.vinculado},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024)]),_:2},1024),t(Q,null,{default:i(()=>[t(nt,null,{default:i(()=>[t(e,{dense:"",tipo:"texto",outlined:"",rotulo:"Grupo",modelValue:f.item.grupo,"onUpdate:modelValue":n=>f.item.grupo=n,"somente-leitura":!!f.vinculado},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024)]),_:2},1024),t(Q,null,{default:i(()=>[t(nt,null,{default:i(()=>[t(e,{dense:"",tipo:"texto",outlined:"",rotulo:"SubGrupo",modelValue:f.item.subGrupo,"onUpdate:modelValue":n=>f.item.subGrupo=n,"somente-leitura":!!f.vinculado},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),ft("div",aa,[t(m,{class:"q-col-gutter-sm"},{default:i(()=>[ft("div",oa,[t(e,{modelValue:f.item.valorCusto,"onUpdate:modelValue":n=>f.item.valorCusto=n,rotulo:"Valor pr\xE9 custo",dense:"",tipo:"decimal",decimals:"4",zerosDireita:"2",outlined:"","somente-leitura":""},null,8,["modelValue","onUpdate:modelValue"])]),ft("div",ra,[t(e,{modelValue:f.valoresEdicao.valorOutrasDespesas,"onUpdate:modelValue":n=>f.valoresEdicao.valorOutrasDespesas=n,rotulo:"Outras Despesas",dense:"",tipo:"decimal",decimals:"4","somente-leitura":!!f.vinculado,outlined:"",onBlur:n=>s.recalcularItem_blur(f)},null,8,["modelValue","onUpdate:modelValue","somente-leitura","onBlur"])]),ft("div",ia,[t(e,{modelValue:f.valoresEdicao.percentualIpi,"onUpdate:modelValue":n=>f.valoresEdicao.percentualIpi=n,rotulo:"IPI",suffix:"%",opcoes:{maximumValue:100},dense:"",tipo:"decimal",decimals:"2","somente-leitura":!!f.vinculado,outlined:"",onBlur:n=>s.recalcularItem_blur(f)},null,8,["modelValue","onUpdate:modelValue","somente-leitura","onBlur"])]),ft("div",sa,[t(e,{modelValue:f.valoresEdicao.percentualIcmsSt,"onUpdate:modelValue":n=>f.valoresEdicao.percentualIcmsSt=n,rotulo:"ST",suffix:"%",opcoes:{maximumValue:100},dense:"",tipo:"decimal",decimals:"2","somente-leitura":!!f.vinculado,outlined:"",onBlur:n=>s.recalcularItem_blur(f)},null,8,["modelValue","onUpdate:modelValue","somente-leitura","onBlur"])]),ft("div",na,[t(e,{modelValue:f.valoresEdicao.percentualDifal,"onUpdate:modelValue":n=>f.valoresEdicao.percentualDifal=n,rotulo:"DIFAL",suffix:"%",opcoes:{maximumValue:100},dense:"",tipo:"decimal",decimals:"2","somente-leitura":!!f.vinculado,outlined:"",onBlur:n=>s.recalcularItem_blur(f)},null,8,["modelValue","onUpdate:modelValue","somente-leitura","onBlur"])]),ft("div",la,[t(e,{modelValue:f.item.valorCustoReposicao,"onUpdate:modelValue":n=>f.item.valorCustoReposicao=n,rotulo:"Custo de reposi\xE7\xE3o",dense:"",tipo:"decimal",decimals:"4",zerosDireita:"2",outlined:"","somente-leitura":""},null,8,["modelValue","onUpdate:modelValue"])]),ft("div",da,[t(e,{modelValue:f.item.percentualMarkup,"onUpdate:modelValue":n=>f.item.percentualMarkup=n,rotulo:"Margem de Lucro",suffix:"%",opcoes:{maximumValue:100},dense:"",tipo:"decimal",decimals:"2","somente-leitura":!!f.vinculado,outlined:"",onBlur:n=>s.recalcularItem_blur(f)},null,8,["modelValue","onUpdate:modelValue","somente-leitura","onBlur"])]),ft("div",ua,[t(e,{modelValue:f.item.valorVenda,"onUpdate:modelValue":n=>f.item.valorVenda=n,rotulo:"Valor de Venda",dense:"",tipo:"decimal",decimals:"4",zerosDireita:"2",outlined:"","somente-leitura":!!f.vinculado,onBlur:n=>s.recalcularItem_blur(f)},null,8,["modelValue","onUpdate:modelValue","somente-leitura","onBlur"])])]),_:2},1024)]),f.vinculado?(M(),_t("div",pa," Produto vinculado ")):(M(),_t("div",ca,[t(m,{class:"q-mt-lg text-right full-width justify-end items-center"},{default:i(()=>[ft("div",ma,[t(dt,{class:"q-ml-sm no-shadow",color:"primary",icon:"search",unelevated:"",label:"Vincular",onClick:()=>{o.mostrarItemModal=!o.mostrarItemModal,o.idxItem=y}},null,8,["onClick"])]),a[8]||(a[8]=ft("div",{class:"col-12 col-md-auto"},"ou",-1)),ft("div",fa,[t(dt,{loading:f.buttonLoading,class:"q-ml-sm no-shadow",color:"primary",icon:"add",unelevated:"",label:"Novo",onClick:n=>s.adicionarItem_click(f)},null,8,["loading","onClick"])])]),_:2},1024)]))],8,ea)]),_:1},8,["items"])])]),_:1})]),_:1}),t(Yt,{class:"bg-light"},{default:i(()=>[t(Nt,null,{default:i(()=>[t(Rt,null,{default:i(()=>[ft("span",ha,"Produtos: "+J(s.quantProdutos)+" - N\xE3o vinculados: "+J(s.produtosNaoVinculados),1)]),_:1}),s.produtosNaoVinculados?(M(),Y(dt,{key:0,class:"q-ml-sm no-shadow float-right",color:"primary",label:"Incluir Todos",onClick:s.incluirTodos_click,unelevated:""},null,8,["onClick"])):(M(),Y(dt,{key:1,class:"q-ml-sm no-shadow float-right",color:"primary",label:"Salvar",onClick:s.salvar_click,unelevated:""},null,8,["onClick"]))]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onKeyup"]),t(_,{modelValue:o.mostrarItemModal,"onUpdate:modelValue":a[5]||(a[5]=f=>o.mostrarItemModal=f),habilitarQuantidade:!1,filtro:{ativo:!0,idEmpresa:o.compra.idEmpresa},exibirValorVenda:!1,onSelecionarItens:s.selecionarItens,ref:"promptItem"},null,8,["modelValue","filtro","onSelecionarItens"])],64)}var va=se(Ke,[["render",ga]]),_e={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(r,a){(function(h){r.exports=h()})(function(){return function h(w,o,s){function c(b,_){if(!o[b]){if(!w[b]){var f=typeof ae=="function"&&ae;if(!_&&f)return f(b,!0);if(e)return e(b,!0);var y=new Error("Cannot find module '"+b+"'");throw y.code="MODULE_NOT_FOUND",y}var n=o[b]={exports:{}};w[b][0].call(n.exports,function(C){var g=w[b][1][C];return c(g||C)},n,n.exports,h,w,o,s)}return o[b].exports}for(var e=typeof ae=="function"&&ae,m=0;m<s.length;m++)c(s[m]);return c}({1:[function(h,w,o){var s=h("./utils"),c=h("./support"),e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";o.encode=function(m){for(var b,_,f,y,n,C,g,u=[],l=0,v=m.length,S=v,D=s.getTypeOf(m)!=="string";l<m.length;)S=v-l,f=D?(b=m[l++],_=l<v?m[l++]:0,l<v?m[l++]:0):(b=m.charCodeAt(l++),_=l<v?m.charCodeAt(l++):0,l<v?m.charCodeAt(l++):0),y=b>>2,n=(3&b)<<4|_>>4,C=1<S?(15&_)<<2|f>>6:64,g=2<S?63&f:64,u.push(e.charAt(y)+e.charAt(n)+e.charAt(C)+e.charAt(g));return u.join("")},o.decode=function(m){var b,_,f,y,n,C,g=0,u=0,l="data:";if(m.substr(0,l.length)===l)throw new Error("Invalid base64 input, it looks like a data url.");var v,S=3*(m=m.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(m.charAt(m.length-1)===e.charAt(64)&&S--,m.charAt(m.length-2)===e.charAt(64)&&S--,S%1!=0)throw new Error("Invalid base64 input, bad content length.");for(v=c.uint8array?new Uint8Array(0|S):new Array(0|S);g<m.length;)b=e.indexOf(m.charAt(g++))<<2|(y=e.indexOf(m.charAt(g++)))>>4,_=(15&y)<<4|(n=e.indexOf(m.charAt(g++)))>>2,f=(3&n)<<6|(C=e.indexOf(m.charAt(g++))),v[u++]=b,n!==64&&(v[u++]=_),C!==64&&(v[u++]=f);return v}},{"./support":30,"./utils":32}],2:[function(h,w,o){var s=h("./external"),c=h("./stream/DataWorker"),e=h("./stream/Crc32Probe"),m=h("./stream/DataLengthProbe");function b(_,f,y,n,C){this.compressedSize=_,this.uncompressedSize=f,this.crc32=y,this.compression=n,this.compressedContent=C}b.prototype={getContentWorker:function(){var _=new c(s.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new m("data_length")),f=this;return _.on("end",function(){if(this.streamInfo.data_length!==f.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),_},getCompressedWorker:function(){return new c(s.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},b.createWorkerFrom=function(_,f,y){return _.pipe(new e).pipe(new m("uncompressedSize")).pipe(f.compressWorker(y)).pipe(new m("compressedSize")).withStreamInfo("compression",f)},w.exports=b},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(h,w,o){var s=h("./stream/GenericWorker");o.STORE={magic:"\0\0",compressWorker:function(){return new s("STORE compression")},uncompressWorker:function(){return new s("STORE decompression")}},o.DEFLATE=h("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(h,w,o){var s=h("./utils"),c=function(){for(var e,m=[],b=0;b<256;b++){e=b;for(var _=0;_<8;_++)e=1&e?3988292384^e>>>1:e>>>1;m[b]=e}return m}();w.exports=function(e,m){return e!==void 0&&e.length?s.getTypeOf(e)!=="string"?function(b,_,f,y){var n=c,C=y+f;b^=-1;for(var g=y;g<C;g++)b=b>>>8^n[255&(b^_[g])];return-1^b}(0|m,e,e.length,0):function(b,_,f,y){var n=c,C=y+f;b^=-1;for(var g=y;g<C;g++)b=b>>>8^n[255&(b^_.charCodeAt(g))];return-1^b}(0|m,e,e.length,0):0}},{"./utils":32}],5:[function(h,w,o){o.base64=!1,o.binary=!1,o.dir=!1,o.createFolders=!0,o.date=null,o.compression=null,o.compressionOptions=null,o.comment=null,o.unixPermissions=null,o.dosPermissions=null},{}],6:[function(h,w,o){var s=null;s=typeof Promise!="undefined"?Promise:h("lie"),w.exports={Promise:s}},{lie:37}],7:[function(h,w,o){var s=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Uint32Array!="undefined",c=h("pako"),e=h("./utils"),m=h("./stream/GenericWorker"),b=s?"uint8array":"array";function _(f,y){m.call(this,"FlateWorker/"+f),this._pako=null,this._pakoAction=f,this._pakoOptions=y,this.meta={}}o.magic="\b\0",e.inherits(_,m),_.prototype.processChunk=function(f){this.meta=f.meta,this._pako===null&&this._createPako(),this._pako.push(e.transformTo(b,f.data),!1)},_.prototype.flush=function(){m.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},_.prototype.cleanUp=function(){m.prototype.cleanUp.call(this),this._pako=null},_.prototype._createPako=function(){this._pako=new c[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var f=this;this._pako.onData=function(y){f.push({data:y,meta:f.meta})}},o.compressWorker=function(f){return new _("Deflate",f)},o.uncompressWorker=function(){return new _("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(h,w,o){function s(n,C){var g,u="";for(g=0;g<C;g++)u+=String.fromCharCode(255&n),n>>>=8;return u}function c(n,C,g,u,l,v){var S,D,P=n.file,O=n.compression,q=v!==b.utf8encode,j=e.transformTo("string",v(P.name)),A=e.transformTo("string",b.utf8encode(P.name)),Z=P.comment,at=e.transformTo("string",v(Z)),E=e.transformTo("string",b.utf8encode(Z)),B=A.length!==P.name.length,p=E.length!==Z.length,R="",lt="",H="",ut=P.dir,X=P.date,st={crc32:0,compressedSize:0,uncompressedSize:0};C&&!g||(st.crc32=n.crc32,st.compressedSize=n.compressedSize,st.uncompressedSize=n.uncompressedSize);var z=0;C&&(z|=8),q||!B&&!p||(z|=2048);var F=0,it=0;ut&&(F|=16),l==="UNIX"?(it=798,F|=function(K,wt){var Dt=K;return K||(Dt=wt?16893:33204),(65535&Dt)<<16}(P.unixPermissions,ut)):(it=20,F|=function(K){return 63&(K||0)}(P.dosPermissions)),S=X.getUTCHours(),S<<=6,S|=X.getUTCMinutes(),S<<=5,S|=X.getUTCSeconds()/2,D=X.getUTCFullYear()-1980,D<<=4,D|=X.getUTCMonth()+1,D<<=5,D|=X.getUTCDate(),B&&(lt=s(1,1)+s(_(j),4)+A,R+="up"+s(lt.length,2)+lt),p&&(H=s(1,1)+s(_(at),4)+E,R+="uc"+s(H.length,2)+H);var tt="";return tt+=`
\0`,tt+=s(z,2),tt+=O.magic,tt+=s(S,2),tt+=s(D,2),tt+=s(st.crc32,4),tt+=s(st.compressedSize,4),tt+=s(st.uncompressedSize,4),tt+=s(j.length,2),tt+=s(R.length,2),{fileRecord:f.LOCAL_FILE_HEADER+tt+j+R,dirRecord:f.CENTRAL_FILE_HEADER+s(it,2)+tt+s(at.length,2)+"\0\0\0\0"+s(F,4)+s(u,4)+j+R+at}}var e=h("../utils"),m=h("../stream/GenericWorker"),b=h("../utf8"),_=h("../crc32"),f=h("../signature");function y(n,C,g,u){m.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=C,this.zipPlatform=g,this.encodeFileName=u,this.streamFiles=n,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}e.inherits(y,m),y.prototype.push=function(n){var C=n.meta.percent||0,g=this.entriesCount,u=this._sources.length;this.accumulate?this.contentBuffer.push(n):(this.bytesWritten+=n.data.length,m.prototype.push.call(this,{data:n.data,meta:{currentFile:this.currentFile,percent:g?(C+100*(g-u-1))/g:100}}))},y.prototype.openedSource=function(n){this.currentSourceOffset=this.bytesWritten,this.currentFile=n.file.name;var C=this.streamFiles&&!n.file.dir;if(C){var g=c(n,C,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:g.fileRecord,meta:{percent:0}})}else this.accumulate=!0},y.prototype.closedSource=function(n){this.accumulate=!1;var C=this.streamFiles&&!n.file.dir,g=c(n,C,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(g.dirRecord),C)this.push({data:function(u){return f.DATA_DESCRIPTOR+s(u.crc32,4)+s(u.compressedSize,4)+s(u.uncompressedSize,4)}(n),meta:{percent:100}});else for(this.push({data:g.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},y.prototype.flush=function(){for(var n=this.bytesWritten,C=0;C<this.dirRecords.length;C++)this.push({data:this.dirRecords[C],meta:{percent:100}});var g=this.bytesWritten-n,u=function(l,v,S,D,P){var O=e.transformTo("string",P(D));return f.CENTRAL_DIRECTORY_END+"\0\0\0\0"+s(l,2)+s(l,2)+s(v,4)+s(S,4)+s(O.length,2)+O}(this.dirRecords.length,g,n,this.zipComment,this.encodeFileName);this.push({data:u,meta:{percent:100}})},y.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},y.prototype.registerPrevious=function(n){this._sources.push(n);var C=this;return n.on("data",function(g){C.processChunk(g)}),n.on("end",function(){C.closedSource(C.previous.streamInfo),C._sources.length?C.prepareNextSource():C.end()}),n.on("error",function(g){C.error(g)}),this},y.prototype.resume=function(){return!!m.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},y.prototype.error=function(n){var C=this._sources;if(!m.prototype.error.call(this,n))return!1;for(var g=0;g<C.length;g++)try{C[g].error(n)}catch{}return!0},y.prototype.lock=function(){m.prototype.lock.call(this);for(var n=this._sources,C=0;C<n.length;C++)n[C].lock()},w.exports=y},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(h,w,o){var s=h("../compressions"),c=h("./ZipFileWorker");o.generateWorker=function(e,m,b){var _=new c(m.streamFiles,b,m.platform,m.encodeFileName),f=0;try{e.forEach(function(y,n){f++;var C=function(v,S){var D=v||S,P=s[D];if(!P)throw new Error(D+" is not a valid compression method !");return P}(n.options.compression,m.compression),g=n.options.compressionOptions||m.compressionOptions||{},u=n.dir,l=n.date;n._compressWorker(C,g).withStreamInfo("file",{name:y,dir:u,date:l,comment:n.comment||"",unixPermissions:n.unixPermissions,dosPermissions:n.dosPermissions}).pipe(_)}),_.entriesCount=f}catch(y){_.error(y)}return _}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(h,w,o){function s(){if(!(this instanceof s))return new s;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var c=new s;for(var e in this)typeof this[e]!="function"&&(c[e]=this[e]);return c}}(s.prototype=h("./object")).loadAsync=h("./load"),s.support=h("./support"),s.defaults=h("./defaults"),s.version="3.10.1",s.loadAsync=function(c,e){return new s().loadAsync(c,e)},s.external=h("./external"),w.exports=s},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(h,w,o){var s=h("./utils"),c=h("./external"),e=h("./utf8"),m=h("./zipEntries"),b=h("./stream/Crc32Probe"),_=h("./nodejsUtils");function f(y){return new c.Promise(function(n,C){var g=y.decompressed.getContentWorker().pipe(new b);g.on("error",function(u){C(u)}).on("end",function(){g.streamInfo.crc32!==y.decompressed.crc32?C(new Error("Corrupted zip : CRC32 mismatch")):n()}).resume()})}w.exports=function(y,n){var C=this;return n=s.extend(n||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:e.utf8decode}),_.isNode&&_.isStream(y)?c.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):s.prepareContent("the loaded zip file",y,!0,n.optimizedBinaryString,n.base64).then(function(g){var u=new m(n);return u.load(g),u}).then(function(g){var u=[c.Promise.resolve(g)],l=g.files;if(n.checkCRC32)for(var v=0;v<l.length;v++)u.push(f(l[v]));return c.Promise.all(u)}).then(function(g){for(var u=g.shift(),l=u.files,v=0;v<l.length;v++){var S=l[v],D=S.fileNameStr,P=s.resolve(S.fileNameStr);C.file(P,S.decompressed,{binary:!0,optimizedBinaryString:!0,date:S.date,dir:S.dir,comment:S.fileCommentStr.length?S.fileCommentStr:null,unixPermissions:S.unixPermissions,dosPermissions:S.dosPermissions,createFolders:n.createFolders}),S.dir||(C.file(P).unsafeOriginalName=D)}return u.zipComment.length&&(C.comment=u.zipComment),C})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(h,w,o){var s=h("../utils"),c=h("../stream/GenericWorker");function e(m,b){c.call(this,"Nodejs stream input adapter for "+m),this._upstreamEnded=!1,this._bindStream(b)}s.inherits(e,c),e.prototype._bindStream=function(m){var b=this;(this._stream=m).pause(),m.on("data",function(_){b.push({data:_,meta:{percent:0}})}).on("error",function(_){b.isPaused?this.generatedError=_:b.error(_)}).on("end",function(){b.isPaused?b._upstreamEnded=!0:b.end()})},e.prototype.pause=function(){return!!c.prototype.pause.call(this)&&(this._stream.pause(),!0)},e.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},w.exports=e},{"../stream/GenericWorker":28,"../utils":32}],13:[function(h,w,o){var s=h("readable-stream").Readable;function c(e,m,b){s.call(this,m),this._helper=e;var _=this;e.on("data",function(f,y){_.push(f)||_._helper.pause(),b&&b(y)}).on("error",function(f){_.emit("error",f)}).on("end",function(){_.push(null)})}h("../utils").inherits(c,s),c.prototype._read=function(){this._helper.resume()},w.exports=c},{"../utils":32,"readable-stream":16}],14:[function(h,w,o){w.exports={isNode:typeof Buffer!="undefined",newBufferFrom:function(s,c){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(s,c);if(typeof s=="number")throw new Error('The "data" argument must not be a number');return new Buffer(s,c)},allocBuffer:function(s){if(Buffer.alloc)return Buffer.alloc(s);var c=new Buffer(s);return c.fill(0),c},isBuffer:function(s){return Buffer.isBuffer(s)},isStream:function(s){return s&&typeof s.on=="function"&&typeof s.pause=="function"&&typeof s.resume=="function"}}},{}],15:[function(h,w,o){function s(P,O,q){var j,A=e.getTypeOf(O),Z=e.extend(q||{},_);Z.date=Z.date||new Date,Z.compression!==null&&(Z.compression=Z.compression.toUpperCase()),typeof Z.unixPermissions=="string"&&(Z.unixPermissions=parseInt(Z.unixPermissions,8)),Z.unixPermissions&&16384&Z.unixPermissions&&(Z.dir=!0),Z.dosPermissions&&16&Z.dosPermissions&&(Z.dir=!0),Z.dir&&(P=l(P)),Z.createFolders&&(j=u(P))&&v.call(this,j,!0);var at=A==="string"&&Z.binary===!1&&Z.base64===!1;q&&q.binary!==void 0||(Z.binary=!at),(O instanceof f&&O.uncompressedSize===0||Z.dir||!O||O.length===0)&&(Z.base64=!1,Z.binary=!0,O="",Z.compression="STORE",A="string");var E=null;E=O instanceof f||O instanceof m?O:C.isNode&&C.isStream(O)?new g(P,O):e.prepareContent(P,O,Z.binary,Z.optimizedBinaryString,Z.base64);var B=new y(P,E,Z);this.files[P]=B}var c=h("./utf8"),e=h("./utils"),m=h("./stream/GenericWorker"),b=h("./stream/StreamHelper"),_=h("./defaults"),f=h("./compressedObject"),y=h("./zipObject"),n=h("./generate"),C=h("./nodejsUtils"),g=h("./nodejs/NodejsStreamInputAdapter"),u=function(P){P.slice(-1)==="/"&&(P=P.substring(0,P.length-1));var O=P.lastIndexOf("/");return 0<O?P.substring(0,O):""},l=function(P){return P.slice(-1)!=="/"&&(P+="/"),P},v=function(P,O){return O=O!==void 0?O:_.createFolders,P=l(P),this.files[P]||s.call(this,P,null,{dir:!0,createFolders:O}),this.files[P]};function S(P){return Object.prototype.toString.call(P)==="[object RegExp]"}var D={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(P){var O,q,j;for(O in this.files)j=this.files[O],(q=O.slice(this.root.length,O.length))&&O.slice(0,this.root.length)===this.root&&P(q,j)},filter:function(P){var O=[];return this.forEach(function(q,j){P(q,j)&&O.push(j)}),O},file:function(P,O,q){if(arguments.length!==1)return P=this.root+P,s.call(this,P,O,q),this;if(S(P)){var j=P;return this.filter(function(Z,at){return!at.dir&&j.test(Z)})}var A=this.files[this.root+P];return A&&!A.dir?A:null},folder:function(P){if(!P)return this;if(S(P))return this.filter(function(A,Z){return Z.dir&&P.test(A)});var O=this.root+P,q=v.call(this,O),j=this.clone();return j.root=q.name,j},remove:function(P){P=this.root+P;var O=this.files[P];if(O||(P.slice(-1)!=="/"&&(P+="/"),O=this.files[P]),O&&!O.dir)delete this.files[P];else for(var q=this.filter(function(A,Z){return Z.name.slice(0,P.length)===P}),j=0;j<q.length;j++)delete this.files[q[j].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(P){var O,q={};try{if((q=e.extend(P||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:c.utf8encode})).type=q.type.toLowerCase(),q.compression=q.compression.toUpperCase(),q.type==="binarystring"&&(q.type="string"),!q.type)throw new Error("No output type specified.");e.checkSupport(q.type),q.platform!=="darwin"&&q.platform!=="freebsd"&&q.platform!=="linux"&&q.platform!=="sunos"||(q.platform="UNIX"),q.platform==="win32"&&(q.platform="DOS");var j=q.comment||this.comment||"";O=n.generateWorker(this,q,j)}catch(A){(O=new m("error")).error(A)}return new b(O,q.type||"string",q.mimeType)},generateAsync:function(P,O){return this.generateInternalStream(P).accumulate(O)},generateNodeStream:function(P,O){return(P=P||{}).type||(P.type="nodebuffer"),this.generateInternalStream(P).toNodejsStream(O)}};w.exports=D},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(h,w,o){w.exports=h("stream")},{stream:void 0}],17:[function(h,w,o){var s=h("./DataReader");function c(e){s.call(this,e);for(var m=0;m<this.data.length;m++)e[m]=255&e[m]}h("../utils").inherits(c,s),c.prototype.byteAt=function(e){return this.data[this.zero+e]},c.prototype.lastIndexOfSignature=function(e){for(var m=e.charCodeAt(0),b=e.charCodeAt(1),_=e.charCodeAt(2),f=e.charCodeAt(3),y=this.length-4;0<=y;--y)if(this.data[y]===m&&this.data[y+1]===b&&this.data[y+2]===_&&this.data[y+3]===f)return y-this.zero;return-1},c.prototype.readAndCheckSignature=function(e){var m=e.charCodeAt(0),b=e.charCodeAt(1),_=e.charCodeAt(2),f=e.charCodeAt(3),y=this.readData(4);return m===y[0]&&b===y[1]&&_===y[2]&&f===y[3]},c.prototype.readData=function(e){if(this.checkOffset(e),e===0)return[];var m=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,m},w.exports=c},{"../utils":32,"./DataReader":18}],18:[function(h,w,o){var s=h("../utils");function c(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}c.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var m,b=0;for(this.checkOffset(e),m=this.index+e-1;m>=this.index;m--)b=(b<<8)+this.byteAt(m);return this.index+=e,b},readString:function(e){return s.transformTo("string",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},w.exports=c},{"../utils":32}],19:[function(h,w,o){var s=h("./Uint8ArrayReader");function c(e){s.call(this,e)}h("../utils").inherits(c,s),c.prototype.readData=function(e){this.checkOffset(e);var m=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,m},w.exports=c},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(h,w,o){var s=h("./DataReader");function c(e){s.call(this,e)}h("../utils").inherits(c,s),c.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},c.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},c.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},c.prototype.readData=function(e){this.checkOffset(e);var m=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,m},w.exports=c},{"../utils":32,"./DataReader":18}],21:[function(h,w,o){var s=h("./ArrayReader");function c(e){s.call(this,e)}h("../utils").inherits(c,s),c.prototype.readData=function(e){if(this.checkOffset(e),e===0)return new Uint8Array(0);var m=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,m},w.exports=c},{"../utils":32,"./ArrayReader":17}],22:[function(h,w,o){var s=h("../utils"),c=h("../support"),e=h("./ArrayReader"),m=h("./StringReader"),b=h("./NodeBufferReader"),_=h("./Uint8ArrayReader");w.exports=function(f){var y=s.getTypeOf(f);return s.checkSupport(y),y!=="string"||c.uint8array?y==="nodebuffer"?new b(f):c.uint8array?new _(s.transformTo("uint8array",f)):new e(s.transformTo("array",f)):new m(f)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(h,w,o){o.LOCAL_FILE_HEADER="PK",o.CENTRAL_FILE_HEADER="PK",o.CENTRAL_DIRECTORY_END="PK",o.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",o.ZIP64_CENTRAL_DIRECTORY_END="PK",o.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(h,w,o){var s=h("./GenericWorker"),c=h("../utils");function e(m){s.call(this,"ConvertWorker to "+m),this.destType=m}c.inherits(e,s),e.prototype.processChunk=function(m){this.push({data:c.transformTo(this.destType,m.data),meta:m.meta})},w.exports=e},{"../utils":32,"./GenericWorker":28}],25:[function(h,w,o){var s=h("./GenericWorker"),c=h("../crc32");function e(){s.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}h("../utils").inherits(e,s),e.prototype.processChunk=function(m){this.streamInfo.crc32=c(m.data,this.streamInfo.crc32||0),this.push(m)},w.exports=e},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(h,w,o){var s=h("../utils"),c=h("./GenericWorker");function e(m){c.call(this,"DataLengthProbe for "+m),this.propName=m,this.withStreamInfo(m,0)}s.inherits(e,c),e.prototype.processChunk=function(m){if(m){var b=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=b+m.data.length}c.prototype.processChunk.call(this,m)},w.exports=e},{"../utils":32,"./GenericWorker":28}],27:[function(h,w,o){var s=h("../utils"),c=h("./GenericWorker");function e(m){c.call(this,"DataWorker");var b=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,m.then(function(_){b.dataIsReady=!0,b.data=_,b.max=_&&_.length||0,b.type=s.getTypeOf(_),b.isPaused||b._tickAndRepeat()},function(_){b.error(_)})}s.inherits(e,c),e.prototype.cleanUp=function(){c.prototype.cleanUp.call(this),this.data=null},e.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,s.delay(this._tickAndRepeat,[],this)),!0)},e.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(s.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},e.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var m=null,b=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":m=this.data.substring(this.index,b);break;case"uint8array":m=this.data.subarray(this.index,b);break;case"array":case"nodebuffer":m=this.data.slice(this.index,b)}return this.index=b,this.push({data:m,meta:{percent:this.max?this.index/this.max*100:0}})},w.exports=e},{"../utils":32,"./GenericWorker":28}],28:[function(h,w,o){function s(c){this.name=c||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}s.prototype={push:function(c){this.emit("data",c)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(c){this.emit("error",c)}return!0},error:function(c){return!this.isFinished&&(this.isPaused?this.generatedError=c:(this.isFinished=!0,this.emit("error",c),this.previous&&this.previous.error(c),this.cleanUp()),!0)},on:function(c,e){return this._listeners[c].push(e),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(c,e){if(this._listeners[c])for(var m=0;m<this._listeners[c].length;m++)this._listeners[c][m].call(this,e)},pipe:function(c){return c.registerPrevious(this)},registerPrevious:function(c){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=c.streamInfo,this.mergeStreamInfo(),this.previous=c;var e=this;return c.on("data",function(m){e.processChunk(m)}),c.on("end",function(){e.end()}),c.on("error",function(m){e.error(m)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var c=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),c=!0),this.previous&&this.previous.resume(),!c},flush:function(){},processChunk:function(c){this.push(c)},withStreamInfo:function(c,e){return this.extraStreamInfo[c]=e,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var c in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,c)&&(this.streamInfo[c]=this.extraStreamInfo[c])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var c="Worker "+this.name;return this.previous?this.previous+" -> "+c:c}},w.exports=s},{}],29:[function(h,w,o){var s=h("../utils"),c=h("./ConvertWorker"),e=h("./GenericWorker"),m=h("../base64"),b=h("../support"),_=h("../external"),f=null;if(b.nodestream)try{f=h("../nodejs/NodejsStreamOutputAdapter")}catch{}function y(C,g){return new _.Promise(function(u,l){var v=[],S=C._internalType,D=C._outputType,P=C._mimeType;C.on("data",function(O,q){v.push(O),g&&g(q)}).on("error",function(O){v=[],l(O)}).on("end",function(){try{var O=function(q,j,A){switch(q){case"blob":return s.newBlob(s.transformTo("arraybuffer",j),A);case"base64":return m.encode(j);default:return s.transformTo(q,j)}}(D,function(q,j){var A,Z=0,at=null,E=0;for(A=0;A<j.length;A++)E+=j[A].length;switch(q){case"string":return j.join("");case"array":return Array.prototype.concat.apply([],j);case"uint8array":for(at=new Uint8Array(E),A=0;A<j.length;A++)at.set(j[A],Z),Z+=j[A].length;return at;case"nodebuffer":return Buffer.concat(j);default:throw new Error("concat : unsupported type '"+q+"'")}}(S,v),P);u(O)}catch(q){l(q)}v=[]}).resume()})}function n(C,g,u){var l=g;switch(g){case"blob":case"arraybuffer":l="uint8array";break;case"base64":l="string"}try{this._internalType=l,this._outputType=g,this._mimeType=u,s.checkSupport(l),this._worker=C.pipe(new c(l)),C.lock()}catch(v){this._worker=new e("error"),this._worker.error(v)}}n.prototype={accumulate:function(C){return y(this,C)},on:function(C,g){var u=this;return C==="data"?this._worker.on(C,function(l){g.call(u,l.data,l.meta)}):this._worker.on(C,function(){s.delay(g,arguments,u)}),this},resume:function(){return s.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(C){if(s.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new f(this,{objectMode:this._outputType!=="nodebuffer"},C)}},w.exports=n},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(h,w,o){if(o.base64=!0,o.array=!0,o.string=!0,o.arraybuffer=typeof ArrayBuffer!="undefined"&&typeof Uint8Array!="undefined",o.nodebuffer=typeof Buffer!="undefined",o.uint8array=typeof Uint8Array!="undefined",typeof ArrayBuffer=="undefined")o.blob=!1;else{var s=new ArrayBuffer(0);try{o.blob=new Blob([s],{type:"application/zip"}).size===0}catch{try{var c=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);c.append(s),o.blob=c.getBlob("application/zip").size===0}catch{o.blob=!1}}}try{o.nodestream=!!h("readable-stream").Readable}catch{o.nodestream=!1}},{"readable-stream":16}],31:[function(h,w,o){for(var s=h("./utils"),c=h("./support"),e=h("./nodejsUtils"),m=h("./stream/GenericWorker"),b=new Array(256),_=0;_<256;_++)b[_]=252<=_?6:248<=_?5:240<=_?4:224<=_?3:192<=_?2:1;b[254]=b[254]=1;function f(){m.call(this,"utf-8 decode"),this.leftOver=null}function y(){m.call(this,"utf-8 encode")}o.utf8encode=function(n){return c.nodebuffer?e.newBufferFrom(n,"utf-8"):function(C){var g,u,l,v,S,D=C.length,P=0;for(v=0;v<D;v++)(64512&(u=C.charCodeAt(v)))==55296&&v+1<D&&(64512&(l=C.charCodeAt(v+1)))==56320&&(u=65536+(u-55296<<10)+(l-56320),v++),P+=u<128?1:u<2048?2:u<65536?3:4;for(g=c.uint8array?new Uint8Array(P):new Array(P),v=S=0;S<P;v++)(64512&(u=C.charCodeAt(v)))==55296&&v+1<D&&(64512&(l=C.charCodeAt(v+1)))==56320&&(u=65536+(u-55296<<10)+(l-56320),v++),u<128?g[S++]=u:(u<2048?g[S++]=192|u>>>6:(u<65536?g[S++]=224|u>>>12:(g[S++]=240|u>>>18,g[S++]=128|u>>>12&63),g[S++]=128|u>>>6&63),g[S++]=128|63&u);return g}(n)},o.utf8decode=function(n){return c.nodebuffer?s.transformTo("nodebuffer",n).toString("utf-8"):function(C){var g,u,l,v,S=C.length,D=new Array(2*S);for(g=u=0;g<S;)if((l=C[g++])<128)D[u++]=l;else if(4<(v=b[l]))D[u++]=65533,g+=v-1;else{for(l&=v===2?31:v===3?15:7;1<v&&g<S;)l=l<<6|63&C[g++],v--;1<v?D[u++]=65533:l<65536?D[u++]=l:(l-=65536,D[u++]=55296|l>>10&1023,D[u++]=56320|1023&l)}return D.length!==u&&(D.subarray?D=D.subarray(0,u):D.length=u),s.applyFromCharCode(D)}(n=s.transformTo(c.uint8array?"uint8array":"array",n))},s.inherits(f,m),f.prototype.processChunk=function(n){var C=s.transformTo(c.uint8array?"uint8array":"array",n.data);if(this.leftOver&&this.leftOver.length){if(c.uint8array){var g=C;(C=new Uint8Array(g.length+this.leftOver.length)).set(this.leftOver,0),C.set(g,this.leftOver.length)}else C=this.leftOver.concat(C);this.leftOver=null}var u=function(v,S){var D;for((S=S||v.length)>v.length&&(S=v.length),D=S-1;0<=D&&(192&v[D])==128;)D--;return D<0||D===0?S:D+b[v[D]]>S?D:S}(C),l=C;u!==C.length&&(c.uint8array?(l=C.subarray(0,u),this.leftOver=C.subarray(u,C.length)):(l=C.slice(0,u),this.leftOver=C.slice(u,C.length))),this.push({data:o.utf8decode(l),meta:n.meta})},f.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:o.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},o.Utf8DecodeWorker=f,s.inherits(y,m),y.prototype.processChunk=function(n){this.push({data:o.utf8encode(n.data),meta:n.meta})},o.Utf8EncodeWorker=y},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(h,w,o){var s=h("./support"),c=h("./base64"),e=h("./nodejsUtils"),m=h("./external");function b(g){return g}function _(g,u){for(var l=0;l<g.length;++l)u[l]=255&g.charCodeAt(l);return u}h("setimmediate"),o.newBlob=function(g,u){o.checkSupport("blob");try{return new Blob([g],{type:u})}catch{try{var l=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return l.append(g),l.getBlob(u)}catch{throw new Error("Bug : can't construct the Blob.")}}};var f={stringifyByChunk:function(g,u,l){var v=[],S=0,D=g.length;if(D<=l)return String.fromCharCode.apply(null,g);for(;S<D;)u==="array"||u==="nodebuffer"?v.push(String.fromCharCode.apply(null,g.slice(S,Math.min(S+l,D)))):v.push(String.fromCharCode.apply(null,g.subarray(S,Math.min(S+l,D)))),S+=l;return v.join("")},stringifyByChar:function(g){for(var u="",l=0;l<g.length;l++)u+=String.fromCharCode(g[l]);return u},applyCanBeUsed:{uint8array:function(){try{return s.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return s.nodebuffer&&String.fromCharCode.apply(null,e.allocBuffer(1)).length===1}catch{return!1}}()}};function y(g){var u=65536,l=o.getTypeOf(g),v=!0;if(l==="uint8array"?v=f.applyCanBeUsed.uint8array:l==="nodebuffer"&&(v=f.applyCanBeUsed.nodebuffer),v)for(;1<u;)try{return f.stringifyByChunk(g,l,u)}catch{u=Math.floor(u/2)}return f.stringifyByChar(g)}function n(g,u){for(var l=0;l<g.length;l++)u[l]=g[l];return u}o.applyFromCharCode=y;var C={};C.string={string:b,array:function(g){return _(g,new Array(g.length))},arraybuffer:function(g){return C.string.uint8array(g).buffer},uint8array:function(g){return _(g,new Uint8Array(g.length))},nodebuffer:function(g){return _(g,e.allocBuffer(g.length))}},C.array={string:y,array:b,arraybuffer:function(g){return new Uint8Array(g).buffer},uint8array:function(g){return new Uint8Array(g)},nodebuffer:function(g){return e.newBufferFrom(g)}},C.arraybuffer={string:function(g){return y(new Uint8Array(g))},array:function(g){return n(new Uint8Array(g),new Array(g.byteLength))},arraybuffer:b,uint8array:function(g){return new Uint8Array(g)},nodebuffer:function(g){return e.newBufferFrom(new Uint8Array(g))}},C.uint8array={string:y,array:function(g){return n(g,new Array(g.length))},arraybuffer:function(g){return g.buffer},uint8array:b,nodebuffer:function(g){return e.newBufferFrom(g)}},C.nodebuffer={string:y,array:function(g){return n(g,new Array(g.length))},arraybuffer:function(g){return C.nodebuffer.uint8array(g).buffer},uint8array:function(g){return n(g,new Uint8Array(g.length))},nodebuffer:b},o.transformTo=function(g,u){if(u=u||"",!g)return u;o.checkSupport(g);var l=o.getTypeOf(u);return C[l][g](u)},o.resolve=function(g){for(var u=g.split("/"),l=[],v=0;v<u.length;v++){var S=u[v];S==="."||S===""&&v!==0&&v!==u.length-1||(S===".."?l.pop():l.push(S))}return l.join("/")},o.getTypeOf=function(g){return typeof g=="string"?"string":Object.prototype.toString.call(g)==="[object Array]"?"array":s.nodebuffer&&e.isBuffer(g)?"nodebuffer":s.uint8array&&g instanceof Uint8Array?"uint8array":s.arraybuffer&&g instanceof ArrayBuffer?"arraybuffer":void 0},o.checkSupport=function(g){if(!s[g.toLowerCase()])throw new Error(g+" is not supported by this platform")},o.MAX_VALUE_16BITS=65535,o.MAX_VALUE_32BITS=-1,o.pretty=function(g){var u,l,v="";for(l=0;l<(g||"").length;l++)v+="\\x"+((u=g.charCodeAt(l))<16?"0":"")+u.toString(16).toUpperCase();return v},o.delay=function(g,u,l){setImmediate(function(){g.apply(l||null,u||[])})},o.inherits=function(g,u){function l(){}l.prototype=u.prototype,g.prototype=new l},o.extend=function(){var g,u,l={};for(g=0;g<arguments.length;g++)for(u in arguments[g])Object.prototype.hasOwnProperty.call(arguments[g],u)&&l[u]===void 0&&(l[u]=arguments[g][u]);return l},o.prepareContent=function(g,u,l,v,S){return m.Promise.resolve(u).then(function(D){return s.blob&&(D instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(D))!==-1)&&typeof FileReader!="undefined"?new m.Promise(function(P,O){var q=new FileReader;q.onload=function(j){P(j.target.result)},q.onerror=function(j){O(j.target.error)},q.readAsArrayBuffer(D)}):D}).then(function(D){var P=o.getTypeOf(D);return P?(P==="arraybuffer"?D=o.transformTo("uint8array",D):P==="string"&&(S?D=c.decode(D):l&&v!==!0&&(D=function(O){return _(O,s.uint8array?new Uint8Array(O.length):new Array(O.length))}(D))),D):m.Promise.reject(new Error("Can't read the data of '"+g+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(h,w,o){var s=h("./reader/readerFor"),c=h("./utils"),e=h("./signature"),m=h("./zipEntry"),b=h("./support");function _(f){this.files=[],this.loadOptions=f}_.prototype={checkSignature:function(f){if(!this.reader.readAndCheckSignature(f)){this.reader.index-=4;var y=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+c.pretty(y)+", expected "+c.pretty(f)+")")}},isSignature:function(f,y){var n=this.reader.index;this.reader.setIndex(f);var C=this.reader.readString(4)===y;return this.reader.setIndex(n),C},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var f=this.reader.readData(this.zipCommentLength),y=b.uint8array?"uint8array":"array",n=c.transformTo(y,f);this.zipComment=this.loadOptions.decodeFileName(n)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var f,y,n,C=this.zip64EndOfCentralSize-44;0<C;)f=this.reader.readInt(2),y=this.reader.readInt(4),n=this.reader.readData(y),this.zip64ExtensibleData[f]={id:f,length:y,value:n}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var f,y;for(f=0;f<this.files.length;f++)y=this.files[f],this.reader.setIndex(y.localHeaderOffset),this.checkSignature(e.LOCAL_FILE_HEADER),y.readLocalPart(this.reader),y.handleUTF8(),y.processAttributes()},readCentralDir:function(){var f;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(e.CENTRAL_FILE_HEADER);)(f=new m({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(f);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var f=this.reader.lastIndexOfSignature(e.CENTRAL_DIRECTORY_END);if(f<0)throw this.isSignature(0,e.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(f);var y=f;if(this.checkSignature(e.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===c.MAX_VALUE_16BITS||this.diskWithCentralDirStart===c.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===c.MAX_VALUE_16BITS||this.centralDirRecords===c.MAX_VALUE_16BITS||this.centralDirSize===c.MAX_VALUE_32BITS||this.centralDirOffset===c.MAX_VALUE_32BITS){if(this.zip64=!0,(f=this.reader.lastIndexOfSignature(e.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(f),this.checkSignature(e.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,e.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(e.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(e.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var n=this.centralDirOffset+this.centralDirSize;this.zip64&&(n+=20,n+=12+this.zip64EndOfCentralSize);var C=y-n;if(0<C)this.isSignature(y,e.CENTRAL_FILE_HEADER)||(this.reader.zero=C);else if(C<0)throw new Error("Corrupted zip: missing "+Math.abs(C)+" bytes.")},prepareReader:function(f){this.reader=s(f)},load:function(f){this.prepareReader(f),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},w.exports=_},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(h,w,o){var s=h("./reader/readerFor"),c=h("./utils"),e=h("./compressedObject"),m=h("./crc32"),b=h("./utf8"),_=h("./compressions"),f=h("./support");function y(n,C){this.options=n,this.loadOptions=C}y.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(n){var C,g;if(n.skip(22),this.fileNameLength=n.readInt(2),g=n.readInt(2),this.fileName=n.readData(this.fileNameLength),n.skip(g),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((C=function(u){for(var l in _)if(Object.prototype.hasOwnProperty.call(_,l)&&_[l].magic===u)return _[l];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+c.pretty(this.compressionMethod)+" unknown (inner file : "+c.transformTo("string",this.fileName)+")");this.decompressed=new e(this.compressedSize,this.uncompressedSize,this.crc32,C,n.readData(this.compressedSize))},readCentralPart:function(n){this.versionMadeBy=n.readInt(2),n.skip(2),this.bitFlag=n.readInt(2),this.compressionMethod=n.readString(2),this.date=n.readDate(),this.crc32=n.readInt(4),this.compressedSize=n.readInt(4),this.uncompressedSize=n.readInt(4);var C=n.readInt(2);if(this.extraFieldsLength=n.readInt(2),this.fileCommentLength=n.readInt(2),this.diskNumberStart=n.readInt(2),this.internalFileAttributes=n.readInt(2),this.externalFileAttributes=n.readInt(4),this.localHeaderOffset=n.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");n.skip(C),this.readExtraFields(n),this.parseZIP64ExtraField(n),this.fileComment=n.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var n=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),n==0&&(this.dosPermissions=63&this.externalFileAttributes),n==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var n=s(this.extraFields[1].value);this.uncompressedSize===c.MAX_VALUE_32BITS&&(this.uncompressedSize=n.readInt(8)),this.compressedSize===c.MAX_VALUE_32BITS&&(this.compressedSize=n.readInt(8)),this.localHeaderOffset===c.MAX_VALUE_32BITS&&(this.localHeaderOffset=n.readInt(8)),this.diskNumberStart===c.MAX_VALUE_32BITS&&(this.diskNumberStart=n.readInt(4))}},readExtraFields:function(n){var C,g,u,l=n.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});n.index+4<l;)C=n.readInt(2),g=n.readInt(2),u=n.readData(g),this.extraFields[C]={id:C,length:g,value:u};n.setIndex(l)},handleUTF8:function(){var n=f.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=b.utf8decode(this.fileName),this.fileCommentStr=b.utf8decode(this.fileComment);else{var C=this.findExtraFieldUnicodePath();if(C!==null)this.fileNameStr=C;else{var g=c.transformTo(n,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(g)}var u=this.findExtraFieldUnicodeComment();if(u!==null)this.fileCommentStr=u;else{var l=c.transformTo(n,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(l)}}},findExtraFieldUnicodePath:function(){var n=this.extraFields[28789];if(n){var C=s(n.value);return C.readInt(1)!==1||m(this.fileName)!==C.readInt(4)?null:b.utf8decode(C.readData(n.length-5))}return null},findExtraFieldUnicodeComment:function(){var n=this.extraFields[25461];if(n){var C=s(n.value);return C.readInt(1)!==1||m(this.fileComment)!==C.readInt(4)?null:b.utf8decode(C.readData(n.length-5))}return null}},w.exports=y},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(h,w,o){function s(C,g,u){this.name=C,this.dir=u.dir,this.date=u.date,this.comment=u.comment,this.unixPermissions=u.unixPermissions,this.dosPermissions=u.dosPermissions,this._data=g,this._dataBinary=u.binary,this.options={compression:u.compression,compressionOptions:u.compressionOptions}}var c=h("./stream/StreamHelper"),e=h("./stream/DataWorker"),m=h("./utf8"),b=h("./compressedObject"),_=h("./stream/GenericWorker");s.prototype={internalStream:function(C){var g=null,u="string";try{if(!C)throw new Error("No output type specified.");var l=(u=C.toLowerCase())==="string"||u==="text";u!=="binarystring"&&u!=="text"||(u="string"),g=this._decompressWorker();var v=!this._dataBinary;v&&!l&&(g=g.pipe(new m.Utf8EncodeWorker)),!v&&l&&(g=g.pipe(new m.Utf8DecodeWorker))}catch(S){(g=new _("error")).error(S)}return new c(g,u,"")},async:function(C,g){return this.internalStream(C).accumulate(g)},nodeStream:function(C,g){return this.internalStream(C||"nodebuffer").toNodejsStream(g)},_compressWorker:function(C,g){if(this._data instanceof b&&this._data.compression.magic===C.magic)return this._data.getCompressedWorker();var u=this._decompressWorker();return this._dataBinary||(u=u.pipe(new m.Utf8EncodeWorker)),b.createWorkerFrom(u,C,g)},_decompressWorker:function(){return this._data instanceof b?this._data.getContentWorker():this._data instanceof _?this._data:new e(this._data)}};for(var f=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],y=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},n=0;n<f.length;n++)s.prototype[f[n]]=y;w.exports=s},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(h,w,o){(function(s){var c,e,m=s.MutationObserver||s.WebKitMutationObserver;if(m){var b=0,_=new m(C),f=s.document.createTextNode("");_.observe(f,{characterData:!0}),c=function(){f.data=b=++b%2}}else if(s.setImmediate||s.MessageChannel===void 0)c="document"in s&&"onreadystatechange"in s.document.createElement("script")?function(){var g=s.document.createElement("script");g.onreadystatechange=function(){C(),g.onreadystatechange=null,g.parentNode.removeChild(g),g=null},s.document.documentElement.appendChild(g)}:function(){setTimeout(C,0)};else{var y=new s.MessageChannel;y.port1.onmessage=C,c=function(){y.port2.postMessage(0)}}var n=[];function C(){var g,u;e=!0;for(var l=n.length;l;){for(u=n,n=[],g=-1;++g<l;)u[g]();l=n.length}e=!1}w.exports=function(g){n.push(g)!==1||e||c()}}).call(this,typeof ee!="undefined"?ee:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],37:[function(h,w,o){var s=h("immediate");function c(){}var e={},m=["REJECTED"],b=["FULFILLED"],_=["PENDING"];function f(l){if(typeof l!="function")throw new TypeError("resolver must be a function");this.state=_,this.queue=[],this.outcome=void 0,l!==c&&g(this,l)}function y(l,v,S){this.promise=l,typeof v=="function"&&(this.onFulfilled=v,this.callFulfilled=this.otherCallFulfilled),typeof S=="function"&&(this.onRejected=S,this.callRejected=this.otherCallRejected)}function n(l,v,S){s(function(){var D;try{D=v(S)}catch(P){return e.reject(l,P)}D===l?e.reject(l,new TypeError("Cannot resolve promise with itself")):e.resolve(l,D)})}function C(l){var v=l&&l.then;if(l&&(typeof l=="object"||typeof l=="function")&&typeof v=="function")return function(){v.apply(l,arguments)}}function g(l,v){var S=!1;function D(q){S||(S=!0,e.reject(l,q))}function P(q){S||(S=!0,e.resolve(l,q))}var O=u(function(){v(P,D)});O.status==="error"&&D(O.value)}function u(l,v){var S={};try{S.value=l(v),S.status="success"}catch(D){S.status="error",S.value=D}return S}(w.exports=f).prototype.finally=function(l){if(typeof l!="function")return this;var v=this.constructor;return this.then(function(S){return v.resolve(l()).then(function(){return S})},function(S){return v.resolve(l()).then(function(){throw S})})},f.prototype.catch=function(l){return this.then(null,l)},f.prototype.then=function(l,v){if(typeof l!="function"&&this.state===b||typeof v!="function"&&this.state===m)return this;var S=new this.constructor(c);return this.state!==_?n(S,this.state===b?l:v,this.outcome):this.queue.push(new y(S,l,v)),S},y.prototype.callFulfilled=function(l){e.resolve(this.promise,l)},y.prototype.otherCallFulfilled=function(l){n(this.promise,this.onFulfilled,l)},y.prototype.callRejected=function(l){e.reject(this.promise,l)},y.prototype.otherCallRejected=function(l){n(this.promise,this.onRejected,l)},e.resolve=function(l,v){var S=u(C,v);if(S.status==="error")return e.reject(l,S.value);var D=S.value;if(D)g(l,D);else{l.state=b,l.outcome=v;for(var P=-1,O=l.queue.length;++P<O;)l.queue[P].callFulfilled(v)}return l},e.reject=function(l,v){l.state=m,l.outcome=v;for(var S=-1,D=l.queue.length;++S<D;)l.queue[S].callRejected(v);return l},f.resolve=function(l){return l instanceof this?l:e.resolve(new this(c),l)},f.reject=function(l){var v=new this(c);return e.reject(v,l)},f.all=function(l){var v=this;if(Object.prototype.toString.call(l)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=l.length,D=!1;if(!S)return this.resolve([]);for(var P=new Array(S),O=0,q=-1,j=new this(c);++q<S;)A(l[q],q);return j;function A(Z,at){v.resolve(Z).then(function(E){P[at]=E,++O!==S||D||(D=!0,e.resolve(j,P))},function(E){D||(D=!0,e.reject(j,E))})}},f.race=function(l){var v=this;if(Object.prototype.toString.call(l)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=l.length,D=!1;if(!S)return this.resolve([]);for(var P=-1,O=new this(c);++P<S;)q=l[P],v.resolve(q).then(function(j){D||(D=!0,e.resolve(O,j))},function(j){D||(D=!0,e.reject(O,j))});var q;return O}},{immediate:36}],38:[function(h,w,o){var s={};(0,h("./lib/utils/common").assign)(s,h("./lib/deflate"),h("./lib/inflate"),h("./lib/zlib/constants")),w.exports=s},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(h,w,o){var s=h("./zlib/deflate"),c=h("./utils/common"),e=h("./utils/strings"),m=h("./zlib/messages"),b=h("./zlib/zstream"),_=Object.prototype.toString,f=0,y=-1,n=0,C=8;function g(l){if(!(this instanceof g))return new g(l);this.options=c.assign({level:y,method:C,chunkSize:16384,windowBits:15,memLevel:8,strategy:n,to:""},l||{});var v=this.options;v.raw&&0<v.windowBits?v.windowBits=-v.windowBits:v.gzip&&0<v.windowBits&&v.windowBits<16&&(v.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new b,this.strm.avail_out=0;var S=s.deflateInit2(this.strm,v.level,v.method,v.windowBits,v.memLevel,v.strategy);if(S!==f)throw new Error(m[S]);if(v.header&&s.deflateSetHeader(this.strm,v.header),v.dictionary){var D;if(D=typeof v.dictionary=="string"?e.string2buf(v.dictionary):_.call(v.dictionary)==="[object ArrayBuffer]"?new Uint8Array(v.dictionary):v.dictionary,(S=s.deflateSetDictionary(this.strm,D))!==f)throw new Error(m[S]);this._dict_set=!0}}function u(l,v){var S=new g(v);if(S.push(l,!0),S.err)throw S.msg||m[S.err];return S.result}g.prototype.push=function(l,v){var S,D,P=this.strm,O=this.options.chunkSize;if(this.ended)return!1;D=v===~~v?v:v===!0?4:0,typeof l=="string"?P.input=e.string2buf(l):_.call(l)==="[object ArrayBuffer]"?P.input=new Uint8Array(l):P.input=l,P.next_in=0,P.avail_in=P.input.length;do{if(P.avail_out===0&&(P.output=new c.Buf8(O),P.next_out=0,P.avail_out=O),(S=s.deflate(P,D))!==1&&S!==f)return this.onEnd(S),!(this.ended=!0);P.avail_out!==0&&(P.avail_in!==0||D!==4&&D!==2)||(this.options.to==="string"?this.onData(e.buf2binstring(c.shrinkBuf(P.output,P.next_out))):this.onData(c.shrinkBuf(P.output,P.next_out)))}while((0<P.avail_in||P.avail_out===0)&&S!==1);return D===4?(S=s.deflateEnd(this.strm),this.onEnd(S),this.ended=!0,S===f):D!==2||(this.onEnd(f),!(P.avail_out=0))},g.prototype.onData=function(l){this.chunks.push(l)},g.prototype.onEnd=function(l){l===f&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=c.flattenChunks(this.chunks)),this.chunks=[],this.err=l,this.msg=this.strm.msg},o.Deflate=g,o.deflate=u,o.deflateRaw=function(l,v){return(v=v||{}).raw=!0,u(l,v)},o.gzip=function(l,v){return(v=v||{}).gzip=!0,u(l,v)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(h,w,o){var s=h("./zlib/inflate"),c=h("./utils/common"),e=h("./utils/strings"),m=h("./zlib/constants"),b=h("./zlib/messages"),_=h("./zlib/zstream"),f=h("./zlib/gzheader"),y=Object.prototype.toString;function n(g){if(!(this instanceof n))return new n(g);this.options=c.assign({chunkSize:16384,windowBits:0,to:""},g||{});var u=this.options;u.raw&&0<=u.windowBits&&u.windowBits<16&&(u.windowBits=-u.windowBits,u.windowBits===0&&(u.windowBits=-15)),!(0<=u.windowBits&&u.windowBits<16)||g&&g.windowBits||(u.windowBits+=32),15<u.windowBits&&u.windowBits<48&&(15&u.windowBits)==0&&(u.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new _,this.strm.avail_out=0;var l=s.inflateInit2(this.strm,u.windowBits);if(l!==m.Z_OK)throw new Error(b[l]);this.header=new f,s.inflateGetHeader(this.strm,this.header)}function C(g,u){var l=new n(u);if(l.push(g,!0),l.err)throw l.msg||b[l.err];return l.result}n.prototype.push=function(g,u){var l,v,S,D,P,O,q=this.strm,j=this.options.chunkSize,A=this.options.dictionary,Z=!1;if(this.ended)return!1;v=u===~~u?u:u===!0?m.Z_FINISH:m.Z_NO_FLUSH,typeof g=="string"?q.input=e.binstring2buf(g):y.call(g)==="[object ArrayBuffer]"?q.input=new Uint8Array(g):q.input=g,q.next_in=0,q.avail_in=q.input.length;do{if(q.avail_out===0&&(q.output=new c.Buf8(j),q.next_out=0,q.avail_out=j),(l=s.inflate(q,m.Z_NO_FLUSH))===m.Z_NEED_DICT&&A&&(O=typeof A=="string"?e.string2buf(A):y.call(A)==="[object ArrayBuffer]"?new Uint8Array(A):A,l=s.inflateSetDictionary(this.strm,O)),l===m.Z_BUF_ERROR&&Z===!0&&(l=m.Z_OK,Z=!1),l!==m.Z_STREAM_END&&l!==m.Z_OK)return this.onEnd(l),!(this.ended=!0);q.next_out&&(q.avail_out!==0&&l!==m.Z_STREAM_END&&(q.avail_in!==0||v!==m.Z_FINISH&&v!==m.Z_SYNC_FLUSH)||(this.options.to==="string"?(S=e.utf8border(q.output,q.next_out),D=q.next_out-S,P=e.buf2string(q.output,S),q.next_out=D,q.avail_out=j-D,D&&c.arraySet(q.output,q.output,S,D,0),this.onData(P)):this.onData(c.shrinkBuf(q.output,q.next_out)))),q.avail_in===0&&q.avail_out===0&&(Z=!0)}while((0<q.avail_in||q.avail_out===0)&&l!==m.Z_STREAM_END);return l===m.Z_STREAM_END&&(v=m.Z_FINISH),v===m.Z_FINISH?(l=s.inflateEnd(this.strm),this.onEnd(l),this.ended=!0,l===m.Z_OK):v!==m.Z_SYNC_FLUSH||(this.onEnd(m.Z_OK),!(q.avail_out=0))},n.prototype.onData=function(g){this.chunks.push(g)},n.prototype.onEnd=function(g){g===m.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=c.flattenChunks(this.chunks)),this.chunks=[],this.err=g,this.msg=this.strm.msg},o.Inflate=n,o.inflate=C,o.inflateRaw=function(g,u){return(u=u||{}).raw=!0,C(g,u)},o.ungzip=C},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(h,w,o){var s=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Int32Array!="undefined";o.assign=function(m){for(var b=Array.prototype.slice.call(arguments,1);b.length;){var _=b.shift();if(_){if(typeof _!="object")throw new TypeError(_+"must be non-object");for(var f in _)_.hasOwnProperty(f)&&(m[f]=_[f])}}return m},o.shrinkBuf=function(m,b){return m.length===b?m:m.subarray?m.subarray(0,b):(m.length=b,m)};var c={arraySet:function(m,b,_,f,y){if(b.subarray&&m.subarray)m.set(b.subarray(_,_+f),y);else for(var n=0;n<f;n++)m[y+n]=b[_+n]},flattenChunks:function(m){var b,_,f,y,n,C;for(b=f=0,_=m.length;b<_;b++)f+=m[b].length;for(C=new Uint8Array(f),b=y=0,_=m.length;b<_;b++)n=m[b],C.set(n,y),y+=n.length;return C}},e={arraySet:function(m,b,_,f,y){for(var n=0;n<f;n++)m[y+n]=b[_+n]},flattenChunks:function(m){return[].concat.apply([],m)}};o.setTyped=function(m){m?(o.Buf8=Uint8Array,o.Buf16=Uint16Array,o.Buf32=Int32Array,o.assign(o,c)):(o.Buf8=Array,o.Buf16=Array,o.Buf32=Array,o.assign(o,e))},o.setTyped(s)},{}],42:[function(h,w,o){var s=h("./common"),c=!0,e=!0;try{String.fromCharCode.apply(null,[0])}catch{c=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{e=!1}for(var m=new s.Buf8(256),b=0;b<256;b++)m[b]=252<=b?6:248<=b?5:240<=b?4:224<=b?3:192<=b?2:1;function _(f,y){if(y<65537&&(f.subarray&&e||!f.subarray&&c))return String.fromCharCode.apply(null,s.shrinkBuf(f,y));for(var n="",C=0;C<y;C++)n+=String.fromCharCode(f[C]);return n}m[254]=m[254]=1,o.string2buf=function(f){var y,n,C,g,u,l=f.length,v=0;for(g=0;g<l;g++)(64512&(n=f.charCodeAt(g)))==55296&&g+1<l&&(64512&(C=f.charCodeAt(g+1)))==56320&&(n=65536+(n-55296<<10)+(C-56320),g++),v+=n<128?1:n<2048?2:n<65536?3:4;for(y=new s.Buf8(v),g=u=0;u<v;g++)(64512&(n=f.charCodeAt(g)))==55296&&g+1<l&&(64512&(C=f.charCodeAt(g+1)))==56320&&(n=65536+(n-55296<<10)+(C-56320),g++),n<128?y[u++]=n:(n<2048?y[u++]=192|n>>>6:(n<65536?y[u++]=224|n>>>12:(y[u++]=240|n>>>18,y[u++]=128|n>>>12&63),y[u++]=128|n>>>6&63),y[u++]=128|63&n);return y},o.buf2binstring=function(f){return _(f,f.length)},o.binstring2buf=function(f){for(var y=new s.Buf8(f.length),n=0,C=y.length;n<C;n++)y[n]=f.charCodeAt(n);return y},o.buf2string=function(f,y){var n,C,g,u,l=y||f.length,v=new Array(2*l);for(n=C=0;n<l;)if((g=f[n++])<128)v[C++]=g;else if(4<(u=m[g]))v[C++]=65533,n+=u-1;else{for(g&=u===2?31:u===3?15:7;1<u&&n<l;)g=g<<6|63&f[n++],u--;1<u?v[C++]=65533:g<65536?v[C++]=g:(g-=65536,v[C++]=55296|g>>10&1023,v[C++]=56320|1023&g)}return _(v,C)},o.utf8border=function(f,y){var n;for((y=y||f.length)>f.length&&(y=f.length),n=y-1;0<=n&&(192&f[n])==128;)n--;return n<0||n===0?y:n+m[f[n]]>y?n:y}},{"./common":41}],43:[function(h,w,o){w.exports=function(s,c,e,m){for(var b=65535&s|0,_=s>>>16&65535|0,f=0;e!==0;){for(e-=f=2e3<e?2e3:e;_=_+(b=b+c[m++]|0)|0,--f;);b%=65521,_%=65521}return b|_<<16|0}},{}],44:[function(h,w,o){w.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(h,w,o){var s=function(){for(var c,e=[],m=0;m<256;m++){c=m;for(var b=0;b<8;b++)c=1&c?3988292384^c>>>1:c>>>1;e[m]=c}return e}();w.exports=function(c,e,m,b){var _=s,f=b+m;c^=-1;for(var y=b;y<f;y++)c=c>>>8^_[255&(c^e[y])];return-1^c}},{}],46:[function(h,w,o){var s,c=h("../utils/common"),e=h("./trees"),m=h("./adler32"),b=h("./crc32"),_=h("./messages"),f=0,y=4,n=0,C=-2,g=-1,u=4,l=2,v=8,S=9,D=286,P=30,O=19,q=2*D+1,j=15,A=3,Z=258,at=Z+A+1,E=42,B=113,p=1,R=2,lt=3,H=4;function ut(d,U){return d.msg=_[U],U}function X(d){return(d<<1)-(4<d?9:0)}function st(d){for(var U=d.length;0<=--U;)d[U]=0}function z(d){var U=d.state,N=U.pending;N>d.avail_out&&(N=d.avail_out),N!==0&&(c.arraySet(d.output,U.pending_buf,U.pending_out,N,d.next_out),d.next_out+=N,U.pending_out+=N,d.total_out+=N,d.avail_out-=N,U.pending-=N,U.pending===0&&(U.pending_out=0))}function F(d,U){e._tr_flush_block(d,0<=d.block_start?d.block_start:-1,d.strstart-d.block_start,U),d.block_start=d.strstart,z(d.strm)}function it(d,U){d.pending_buf[d.pending++]=U}function tt(d,U){d.pending_buf[d.pending++]=U>>>8&255,d.pending_buf[d.pending++]=255&U}function K(d,U){var N,k,I=d.max_chain_length,V=d.strstart,L=d.prev_length,$=d.nice_match,x=d.strstart>d.w_size-at?d.strstart-(d.w_size-at):0,W=d.window,et=d.w_mask,G=d.prev,rt=d.strstart+Z,yt=W[V+L-1],ht=W[V+L];d.prev_length>=d.good_match&&(I>>=2),$>d.lookahead&&($=d.lookahead);do if(W[(N=U)+L]===ht&&W[N+L-1]===yt&&W[N]===W[V]&&W[++N]===W[V+1]){V+=2,N++;do;while(W[++V]===W[++N]&&W[++V]===W[++N]&&W[++V]===W[++N]&&W[++V]===W[++N]&&W[++V]===W[++N]&&W[++V]===W[++N]&&W[++V]===W[++N]&&W[++V]===W[++N]&&V<rt);if(k=Z-(rt-V),V=rt-Z,L<k){if(d.match_start=U,$<=(L=k))break;yt=W[V+L-1],ht=W[V+L]}}while((U=G[U&et])>x&&--I!=0);return L<=d.lookahead?L:d.lookahead}function wt(d){var U,N,k,I,V,L,$,x,W,et,G=d.w_size;do{if(I=d.window_size-d.lookahead-d.strstart,d.strstart>=G+(G-at)){for(c.arraySet(d.window,d.window,G,G,0),d.match_start-=G,d.strstart-=G,d.block_start-=G,U=N=d.hash_size;k=d.head[--U],d.head[U]=G<=k?k-G:0,--N;);for(U=N=G;k=d.prev[--U],d.prev[U]=G<=k?k-G:0,--N;);I+=G}if(d.strm.avail_in===0)break;if(L=d.strm,$=d.window,x=d.strstart+d.lookahead,W=I,et=void 0,et=L.avail_in,W<et&&(et=W),N=et===0?0:(L.avail_in-=et,c.arraySet($,L.input,L.next_in,et,x),L.state.wrap===1?L.adler=m(L.adler,$,et,x):L.state.wrap===2&&(L.adler=b(L.adler,$,et,x)),L.next_in+=et,L.total_in+=et,et),d.lookahead+=N,d.lookahead+d.insert>=A)for(V=d.strstart-d.insert,d.ins_h=d.window[V],d.ins_h=(d.ins_h<<d.hash_shift^d.window[V+1])&d.hash_mask;d.insert&&(d.ins_h=(d.ins_h<<d.hash_shift^d.window[V+A-1])&d.hash_mask,d.prev[V&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=V,V++,d.insert--,!(d.lookahead+d.insert<A)););}while(d.lookahead<at&&d.strm.avail_in!==0)}function Dt(d,U){for(var N,k;;){if(d.lookahead<at){if(wt(d),d.lookahead<at&&U===f)return p;if(d.lookahead===0)break}if(N=0,d.lookahead>=A&&(d.ins_h=(d.ins_h<<d.hash_shift^d.window[d.strstart+A-1])&d.hash_mask,N=d.prev[d.strstart&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=d.strstart),N!==0&&d.strstart-N<=d.w_size-at&&(d.match_length=K(d,N)),d.match_length>=A)if(k=e._tr_tally(d,d.strstart-d.match_start,d.match_length-A),d.lookahead-=d.match_length,d.match_length<=d.max_lazy_match&&d.lookahead>=A){for(d.match_length--;d.strstart++,d.ins_h=(d.ins_h<<d.hash_shift^d.window[d.strstart+A-1])&d.hash_mask,N=d.prev[d.strstart&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=d.strstart,--d.match_length!=0;);d.strstart++}else d.strstart+=d.match_length,d.match_length=0,d.ins_h=d.window[d.strstart],d.ins_h=(d.ins_h<<d.hash_shift^d.window[d.strstart+1])&d.hash_mask;else k=e._tr_tally(d,0,d.window[d.strstart]),d.lookahead--,d.strstart++;if(k&&(F(d,!1),d.strm.avail_out===0))return p}return d.insert=d.strstart<A-1?d.strstart:A-1,U===y?(F(d,!0),d.strm.avail_out===0?lt:H):d.last_lit&&(F(d,!1),d.strm.avail_out===0)?p:R}function pt(d,U){for(var N,k,I;;){if(d.lookahead<at){if(wt(d),d.lookahead<at&&U===f)return p;if(d.lookahead===0)break}if(N=0,d.lookahead>=A&&(d.ins_h=(d.ins_h<<d.hash_shift^d.window[d.strstart+A-1])&d.hash_mask,N=d.prev[d.strstart&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=d.strstart),d.prev_length=d.match_length,d.prev_match=d.match_start,d.match_length=A-1,N!==0&&d.prev_length<d.max_lazy_match&&d.strstart-N<=d.w_size-at&&(d.match_length=K(d,N),d.match_length<=5&&(d.strategy===1||d.match_length===A&&4096<d.strstart-d.match_start)&&(d.match_length=A-1)),d.prev_length>=A&&d.match_length<=d.prev_length){for(I=d.strstart+d.lookahead-A,k=e._tr_tally(d,d.strstart-1-d.prev_match,d.prev_length-A),d.lookahead-=d.prev_length-1,d.prev_length-=2;++d.strstart<=I&&(d.ins_h=(d.ins_h<<d.hash_shift^d.window[d.strstart+A-1])&d.hash_mask,N=d.prev[d.strstart&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=d.strstart),--d.prev_length!=0;);if(d.match_available=0,d.match_length=A-1,d.strstart++,k&&(F(d,!1),d.strm.avail_out===0))return p}else if(d.match_available){if((k=e._tr_tally(d,0,d.window[d.strstart-1]))&&F(d,!1),d.strstart++,d.lookahead--,d.strm.avail_out===0)return p}else d.match_available=1,d.strstart++,d.lookahead--}return d.match_available&&(k=e._tr_tally(d,0,d.window[d.strstart-1]),d.match_available=0),d.insert=d.strstart<A-1?d.strstart:A-1,U===y?(F(d,!0),d.strm.avail_out===0?lt:H):d.last_lit&&(F(d,!1),d.strm.avail_out===0)?p:R}function bt(d,U,N,k,I){this.good_length=d,this.max_lazy=U,this.nice_length=N,this.max_chain=k,this.func=I}function St(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=v,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new c.Buf16(2*q),this.dyn_dtree=new c.Buf16(2*(2*P+1)),this.bl_tree=new c.Buf16(2*(2*O+1)),st(this.dyn_ltree),st(this.dyn_dtree),st(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new c.Buf16(j+1),this.heap=new c.Buf16(2*D+1),st(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new c.Buf16(2*D+1),st(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function It(d){var U;return d&&d.state?(d.total_in=d.total_out=0,d.data_type=l,(U=d.state).pending=0,U.pending_out=0,U.wrap<0&&(U.wrap=-U.wrap),U.status=U.wrap?E:B,d.adler=U.wrap===2?0:1,U.last_flush=f,e._tr_init(U),n):ut(d,C)}function qt(d){var U=It(d);return U===n&&function(N){N.window_size=2*N.w_size,st(N.head),N.max_lazy_match=s[N.level].max_lazy,N.good_match=s[N.level].good_length,N.nice_match=s[N.level].nice_length,N.max_chain_length=s[N.level].max_chain,N.strstart=0,N.block_start=0,N.lookahead=0,N.insert=0,N.match_length=N.prev_length=A-1,N.match_available=0,N.ins_h=0}(d.state),U}function At(d,U,N,k,I,V){if(!d)return C;var L=1;if(U===g&&(U=6),k<0?(L=0,k=-k):15<k&&(L=2,k-=16),I<1||S<I||N!==v||k<8||15<k||U<0||9<U||V<0||u<V)return ut(d,C);k===8&&(k=9);var $=new St;return(d.state=$).strm=d,$.wrap=L,$.gzhead=null,$.w_bits=k,$.w_size=1<<$.w_bits,$.w_mask=$.w_size-1,$.hash_bits=I+7,$.hash_size=1<<$.hash_bits,$.hash_mask=$.hash_size-1,$.hash_shift=~~(($.hash_bits+A-1)/A),$.window=new c.Buf8(2*$.w_size),$.head=new c.Buf16($.hash_size),$.prev=new c.Buf16($.w_size),$.lit_bufsize=1<<I+6,$.pending_buf_size=4*$.lit_bufsize,$.pending_buf=new c.Buf8($.pending_buf_size),$.d_buf=1*$.lit_bufsize,$.l_buf=3*$.lit_bufsize,$.level=U,$.strategy=V,$.method=N,qt(d)}s=[new bt(0,0,0,0,function(d,U){var N=65535;for(N>d.pending_buf_size-5&&(N=d.pending_buf_size-5);;){if(d.lookahead<=1){if(wt(d),d.lookahead===0&&U===f)return p;if(d.lookahead===0)break}d.strstart+=d.lookahead,d.lookahead=0;var k=d.block_start+N;if((d.strstart===0||d.strstart>=k)&&(d.lookahead=d.strstart-k,d.strstart=k,F(d,!1),d.strm.avail_out===0)||d.strstart-d.block_start>=d.w_size-at&&(F(d,!1),d.strm.avail_out===0))return p}return d.insert=0,U===y?(F(d,!0),d.strm.avail_out===0?lt:H):(d.strstart>d.block_start&&(F(d,!1),d.strm.avail_out),p)}),new bt(4,4,8,4,Dt),new bt(4,5,16,8,Dt),new bt(4,6,32,32,Dt),new bt(4,4,16,16,pt),new bt(8,16,32,32,pt),new bt(8,16,128,128,pt),new bt(8,32,128,256,pt),new bt(32,128,258,1024,pt),new bt(32,258,258,4096,pt)],o.deflateInit=function(d,U){return At(d,U,v,15,8,0)},o.deflateInit2=At,o.deflateReset=qt,o.deflateResetKeep=It,o.deflateSetHeader=function(d,U){return d&&d.state?d.state.wrap!==2?C:(d.state.gzhead=U,n):C},o.deflate=function(d,U){var N,k,I,V;if(!d||!d.state||5<U||U<0)return d?ut(d,C):C;if(k=d.state,!d.output||!d.input&&d.avail_in!==0||k.status===666&&U!==y)return ut(d,d.avail_out===0?-5:C);if(k.strm=d,N=k.last_flush,k.last_flush=U,k.status===E)if(k.wrap===2)d.adler=0,it(k,31),it(k,139),it(k,8),k.gzhead?(it(k,(k.gzhead.text?1:0)+(k.gzhead.hcrc?2:0)+(k.gzhead.extra?4:0)+(k.gzhead.name?8:0)+(k.gzhead.comment?16:0)),it(k,255&k.gzhead.time),it(k,k.gzhead.time>>8&255),it(k,k.gzhead.time>>16&255),it(k,k.gzhead.time>>24&255),it(k,k.level===9?2:2<=k.strategy||k.level<2?4:0),it(k,255&k.gzhead.os),k.gzhead.extra&&k.gzhead.extra.length&&(it(k,255&k.gzhead.extra.length),it(k,k.gzhead.extra.length>>8&255)),k.gzhead.hcrc&&(d.adler=b(d.adler,k.pending_buf,k.pending,0)),k.gzindex=0,k.status=69):(it(k,0),it(k,0),it(k,0),it(k,0),it(k,0),it(k,k.level===9?2:2<=k.strategy||k.level<2?4:0),it(k,3),k.status=B);else{var L=v+(k.w_bits-8<<4)<<8;L|=(2<=k.strategy||k.level<2?0:k.level<6?1:k.level===6?2:3)<<6,k.strstart!==0&&(L|=32),L+=31-L%31,k.status=B,tt(k,L),k.strstart!==0&&(tt(k,d.adler>>>16),tt(k,65535&d.adler)),d.adler=1}if(k.status===69)if(k.gzhead.extra){for(I=k.pending;k.gzindex<(65535&k.gzhead.extra.length)&&(k.pending!==k.pending_buf_size||(k.gzhead.hcrc&&k.pending>I&&(d.adler=b(d.adler,k.pending_buf,k.pending-I,I)),z(d),I=k.pending,k.pending!==k.pending_buf_size));)it(k,255&k.gzhead.extra[k.gzindex]),k.gzindex++;k.gzhead.hcrc&&k.pending>I&&(d.adler=b(d.adler,k.pending_buf,k.pending-I,I)),k.gzindex===k.gzhead.extra.length&&(k.gzindex=0,k.status=73)}else k.status=73;if(k.status===73)if(k.gzhead.name){I=k.pending;do{if(k.pending===k.pending_buf_size&&(k.gzhead.hcrc&&k.pending>I&&(d.adler=b(d.adler,k.pending_buf,k.pending-I,I)),z(d),I=k.pending,k.pending===k.pending_buf_size)){V=1;break}V=k.gzindex<k.gzhead.name.length?255&k.gzhead.name.charCodeAt(k.gzindex++):0,it(k,V)}while(V!==0);k.gzhead.hcrc&&k.pending>I&&(d.adler=b(d.adler,k.pending_buf,k.pending-I,I)),V===0&&(k.gzindex=0,k.status=91)}else k.status=91;if(k.status===91)if(k.gzhead.comment){I=k.pending;do{if(k.pending===k.pending_buf_size&&(k.gzhead.hcrc&&k.pending>I&&(d.adler=b(d.adler,k.pending_buf,k.pending-I,I)),z(d),I=k.pending,k.pending===k.pending_buf_size)){V=1;break}V=k.gzindex<k.gzhead.comment.length?255&k.gzhead.comment.charCodeAt(k.gzindex++):0,it(k,V)}while(V!==0);k.gzhead.hcrc&&k.pending>I&&(d.adler=b(d.adler,k.pending_buf,k.pending-I,I)),V===0&&(k.status=103)}else k.status=103;if(k.status===103&&(k.gzhead.hcrc?(k.pending+2>k.pending_buf_size&&z(d),k.pending+2<=k.pending_buf_size&&(it(k,255&d.adler),it(k,d.adler>>8&255),d.adler=0,k.status=B)):k.status=B),k.pending!==0){if(z(d),d.avail_out===0)return k.last_flush=-1,n}else if(d.avail_in===0&&X(U)<=X(N)&&U!==y)return ut(d,-5);if(k.status===666&&d.avail_in!==0)return ut(d,-5);if(d.avail_in!==0||k.lookahead!==0||U!==f&&k.status!==666){var $=k.strategy===2?function(x,W){for(var et;;){if(x.lookahead===0&&(wt(x),x.lookahead===0)){if(W===f)return p;break}if(x.match_length=0,et=e._tr_tally(x,0,x.window[x.strstart]),x.lookahead--,x.strstart++,et&&(F(x,!1),x.strm.avail_out===0))return p}return x.insert=0,W===y?(F(x,!0),x.strm.avail_out===0?lt:H):x.last_lit&&(F(x,!1),x.strm.avail_out===0)?p:R}(k,U):k.strategy===3?function(x,W){for(var et,G,rt,yt,ht=x.window;;){if(x.lookahead<=Z){if(wt(x),x.lookahead<=Z&&W===f)return p;if(x.lookahead===0)break}if(x.match_length=0,x.lookahead>=A&&0<x.strstart&&(G=ht[rt=x.strstart-1])===ht[++rt]&&G===ht[++rt]&&G===ht[++rt]){yt=x.strstart+Z;do;while(G===ht[++rt]&&G===ht[++rt]&&G===ht[++rt]&&G===ht[++rt]&&G===ht[++rt]&&G===ht[++rt]&&G===ht[++rt]&&G===ht[++rt]&&rt<yt);x.match_length=Z-(yt-rt),x.match_length>x.lookahead&&(x.match_length=x.lookahead)}if(x.match_length>=A?(et=e._tr_tally(x,1,x.match_length-A),x.lookahead-=x.match_length,x.strstart+=x.match_length,x.match_length=0):(et=e._tr_tally(x,0,x.window[x.strstart]),x.lookahead--,x.strstart++),et&&(F(x,!1),x.strm.avail_out===0))return p}return x.insert=0,W===y?(F(x,!0),x.strm.avail_out===0?lt:H):x.last_lit&&(F(x,!1),x.strm.avail_out===0)?p:R}(k,U):s[k.level].func(k,U);if($!==lt&&$!==H||(k.status=666),$===p||$===lt)return d.avail_out===0&&(k.last_flush=-1),n;if($===R&&(U===1?e._tr_align(k):U!==5&&(e._tr_stored_block(k,0,0,!1),U===3&&(st(k.head),k.lookahead===0&&(k.strstart=0,k.block_start=0,k.insert=0))),z(d),d.avail_out===0))return k.last_flush=-1,n}return U!==y?n:k.wrap<=0?1:(k.wrap===2?(it(k,255&d.adler),it(k,d.adler>>8&255),it(k,d.adler>>16&255),it(k,d.adler>>24&255),it(k,255&d.total_in),it(k,d.total_in>>8&255),it(k,d.total_in>>16&255),it(k,d.total_in>>24&255)):(tt(k,d.adler>>>16),tt(k,65535&d.adler)),z(d),0<k.wrap&&(k.wrap=-k.wrap),k.pending!==0?n:1)},o.deflateEnd=function(d){var U;return d&&d.state?(U=d.state.status)!==E&&U!==69&&U!==73&&U!==91&&U!==103&&U!==B&&U!==666?ut(d,C):(d.state=null,U===B?ut(d,-3):n):C},o.deflateSetDictionary=function(d,U){var N,k,I,V,L,$,x,W,et=U.length;if(!d||!d.state||(V=(N=d.state).wrap)===2||V===1&&N.status!==E||N.lookahead)return C;for(V===1&&(d.adler=m(d.adler,U,et,0)),N.wrap=0,et>=N.w_size&&(V===0&&(st(N.head),N.strstart=0,N.block_start=0,N.insert=0),W=new c.Buf8(N.w_size),c.arraySet(W,U,et-N.w_size,N.w_size,0),U=W,et=N.w_size),L=d.avail_in,$=d.next_in,x=d.input,d.avail_in=et,d.next_in=0,d.input=U,wt(N);N.lookahead>=A;){for(k=N.strstart,I=N.lookahead-(A-1);N.ins_h=(N.ins_h<<N.hash_shift^N.window[k+A-1])&N.hash_mask,N.prev[k&N.w_mask]=N.head[N.ins_h],N.head[N.ins_h]=k,k++,--I;);N.strstart=k,N.lookahead=A-1,wt(N)}return N.strstart+=N.lookahead,N.block_start=N.strstart,N.insert=N.lookahead,N.lookahead=0,N.match_length=N.prev_length=A-1,N.match_available=0,d.next_in=$,d.input=x,d.avail_in=L,N.wrap=V,n},o.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(h,w,o){w.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(h,w,o){w.exports=function(s,c){var e,m,b,_,f,y,n,C,g,u,l,v,S,D,P,O,q,j,A,Z,at,E,B,p,R;e=s.state,m=s.next_in,p=s.input,b=m+(s.avail_in-5),_=s.next_out,R=s.output,f=_-(c-s.avail_out),y=_+(s.avail_out-257),n=e.dmax,C=e.wsize,g=e.whave,u=e.wnext,l=e.window,v=e.hold,S=e.bits,D=e.lencode,P=e.distcode,O=(1<<e.lenbits)-1,q=(1<<e.distbits)-1;t:do{S<15&&(v+=p[m++]<<S,S+=8,v+=p[m++]<<S,S+=8),j=D[v&O];e:for(;;){if(v>>>=A=j>>>24,S-=A,(A=j>>>16&255)===0)R[_++]=65535&j;else{if(!(16&A)){if((64&A)==0){j=D[(65535&j)+(v&(1<<A)-1)];continue e}if(32&A){e.mode=12;break t}s.msg="invalid literal/length code",e.mode=30;break t}Z=65535&j,(A&=15)&&(S<A&&(v+=p[m++]<<S,S+=8),Z+=v&(1<<A)-1,v>>>=A,S-=A),S<15&&(v+=p[m++]<<S,S+=8,v+=p[m++]<<S,S+=8),j=P[v&q];a:for(;;){if(v>>>=A=j>>>24,S-=A,!(16&(A=j>>>16&255))){if((64&A)==0){j=P[(65535&j)+(v&(1<<A)-1)];continue a}s.msg="invalid distance code",e.mode=30;break t}if(at=65535&j,S<(A&=15)&&(v+=p[m++]<<S,(S+=8)<A&&(v+=p[m++]<<S,S+=8)),n<(at+=v&(1<<A)-1)){s.msg="invalid distance too far back",e.mode=30;break t}if(v>>>=A,S-=A,(A=_-f)<at){if(g<(A=at-A)&&e.sane){s.msg="invalid distance too far back",e.mode=30;break t}if(B=l,(E=0)===u){if(E+=C-A,A<Z){for(Z-=A;R[_++]=l[E++],--A;);E=_-at,B=R}}else if(u<A){if(E+=C+u-A,(A-=u)<Z){for(Z-=A;R[_++]=l[E++],--A;);if(E=0,u<Z){for(Z-=A=u;R[_++]=l[E++],--A;);E=_-at,B=R}}}else if(E+=u-A,A<Z){for(Z-=A;R[_++]=l[E++],--A;);E=_-at,B=R}for(;2<Z;)R[_++]=B[E++],R[_++]=B[E++],R[_++]=B[E++],Z-=3;Z&&(R[_++]=B[E++],1<Z&&(R[_++]=B[E++]))}else{for(E=_-at;R[_++]=R[E++],R[_++]=R[E++],R[_++]=R[E++],2<(Z-=3););Z&&(R[_++]=R[E++],1<Z&&(R[_++]=R[E++]))}break}}break}}while(m<b&&_<y);m-=Z=S>>3,v&=(1<<(S-=Z<<3))-1,s.next_in=m,s.next_out=_,s.avail_in=m<b?b-m+5:5-(m-b),s.avail_out=_<y?y-_+257:257-(_-y),e.hold=v,e.bits=S}},{}],49:[function(h,w,o){var s=h("../utils/common"),c=h("./adler32"),e=h("./crc32"),m=h("./inffast"),b=h("./inftrees"),_=1,f=2,y=0,n=-2,C=1,g=852,u=592;function l(E){return(E>>>24&255)+(E>>>8&65280)+((65280&E)<<8)+((255&E)<<24)}function v(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function S(E){var B;return E&&E.state?(B=E.state,E.total_in=E.total_out=B.total=0,E.msg="",B.wrap&&(E.adler=1&B.wrap),B.mode=C,B.last=0,B.havedict=0,B.dmax=32768,B.head=null,B.hold=0,B.bits=0,B.lencode=B.lendyn=new s.Buf32(g),B.distcode=B.distdyn=new s.Buf32(u),B.sane=1,B.back=-1,y):n}function D(E){var B;return E&&E.state?((B=E.state).wsize=0,B.whave=0,B.wnext=0,S(E)):n}function P(E,B){var p,R;return E&&E.state?(R=E.state,B<0?(p=0,B=-B):(p=1+(B>>4),B<48&&(B&=15)),B&&(B<8||15<B)?n:(R.window!==null&&R.wbits!==B&&(R.window=null),R.wrap=p,R.wbits=B,D(E))):n}function O(E,B){var p,R;return E?(R=new v,(E.state=R).window=null,(p=P(E,B))!==y&&(E.state=null),p):n}var q,j,A=!0;function Z(E){if(A){var B;for(q=new s.Buf32(512),j=new s.Buf32(32),B=0;B<144;)E.lens[B++]=8;for(;B<256;)E.lens[B++]=9;for(;B<280;)E.lens[B++]=7;for(;B<288;)E.lens[B++]=8;for(b(_,E.lens,0,288,q,0,E.work,{bits:9}),B=0;B<32;)E.lens[B++]=5;b(f,E.lens,0,32,j,0,E.work,{bits:5}),A=!1}E.lencode=q,E.lenbits=9,E.distcode=j,E.distbits=5}function at(E,B,p,R){var lt,H=E.state;return H.window===null&&(H.wsize=1<<H.wbits,H.wnext=0,H.whave=0,H.window=new s.Buf8(H.wsize)),R>=H.wsize?(s.arraySet(H.window,B,p-H.wsize,H.wsize,0),H.wnext=0,H.whave=H.wsize):(R<(lt=H.wsize-H.wnext)&&(lt=R),s.arraySet(H.window,B,p-R,lt,H.wnext),(R-=lt)?(s.arraySet(H.window,B,p-R,R,0),H.wnext=R,H.whave=H.wsize):(H.wnext+=lt,H.wnext===H.wsize&&(H.wnext=0),H.whave<H.wsize&&(H.whave+=lt))),0}o.inflateReset=D,o.inflateReset2=P,o.inflateResetKeep=S,o.inflateInit=function(E){return O(E,15)},o.inflateInit2=O,o.inflate=function(E,B){var p,R,lt,H,ut,X,st,z,F,it,tt,K,wt,Dt,pt,bt,St,It,qt,At,d,U,N,k,I=0,V=new s.Buf8(4),L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!E||!E.state||!E.output||!E.input&&E.avail_in!==0)return n;(p=E.state).mode===12&&(p.mode=13),ut=E.next_out,lt=E.output,st=E.avail_out,H=E.next_in,R=E.input,X=E.avail_in,z=p.hold,F=p.bits,it=X,tt=st,U=y;t:for(;;)switch(p.mode){case C:if(p.wrap===0){p.mode=13;break}for(;F<16;){if(X===0)break t;X--,z+=R[H++]<<F,F+=8}if(2&p.wrap&&z===35615){V[p.check=0]=255&z,V[1]=z>>>8&255,p.check=e(p.check,V,2,0),F=z=0,p.mode=2;break}if(p.flags=0,p.head&&(p.head.done=!1),!(1&p.wrap)||(((255&z)<<8)+(z>>8))%31){E.msg="incorrect header check",p.mode=30;break}if((15&z)!=8){E.msg="unknown compression method",p.mode=30;break}if(F-=4,d=8+(15&(z>>>=4)),p.wbits===0)p.wbits=d;else if(d>p.wbits){E.msg="invalid window size",p.mode=30;break}p.dmax=1<<d,E.adler=p.check=1,p.mode=512&z?10:12,F=z=0;break;case 2:for(;F<16;){if(X===0)break t;X--,z+=R[H++]<<F,F+=8}if(p.flags=z,(255&p.flags)!=8){E.msg="unknown compression method",p.mode=30;break}if(57344&p.flags){E.msg="unknown header flags set",p.mode=30;break}p.head&&(p.head.text=z>>8&1),512&p.flags&&(V[0]=255&z,V[1]=z>>>8&255,p.check=e(p.check,V,2,0)),F=z=0,p.mode=3;case 3:for(;F<32;){if(X===0)break t;X--,z+=R[H++]<<F,F+=8}p.head&&(p.head.time=z),512&p.flags&&(V[0]=255&z,V[1]=z>>>8&255,V[2]=z>>>16&255,V[3]=z>>>24&255,p.check=e(p.check,V,4,0)),F=z=0,p.mode=4;case 4:for(;F<16;){if(X===0)break t;X--,z+=R[H++]<<F,F+=8}p.head&&(p.head.xflags=255&z,p.head.os=z>>8),512&p.flags&&(V[0]=255&z,V[1]=z>>>8&255,p.check=e(p.check,V,2,0)),F=z=0,p.mode=5;case 5:if(1024&p.flags){for(;F<16;){if(X===0)break t;X--,z+=R[H++]<<F,F+=8}p.length=z,p.head&&(p.head.extra_len=z),512&p.flags&&(V[0]=255&z,V[1]=z>>>8&255,p.check=e(p.check,V,2,0)),F=z=0}else p.head&&(p.head.extra=null);p.mode=6;case 6:if(1024&p.flags&&(X<(K=p.length)&&(K=X),K&&(p.head&&(d=p.head.extra_len-p.length,p.head.extra||(p.head.extra=new Array(p.head.extra_len)),s.arraySet(p.head.extra,R,H,K,d)),512&p.flags&&(p.check=e(p.check,R,K,H)),X-=K,H+=K,p.length-=K),p.length))break t;p.length=0,p.mode=7;case 7:if(2048&p.flags){if(X===0)break t;for(K=0;d=R[H+K++],p.head&&d&&p.length<65536&&(p.head.name+=String.fromCharCode(d)),d&&K<X;);if(512&p.flags&&(p.check=e(p.check,R,K,H)),X-=K,H+=K,d)break t}else p.head&&(p.head.name=null);p.length=0,p.mode=8;case 8:if(4096&p.flags){if(X===0)break t;for(K=0;d=R[H+K++],p.head&&d&&p.length<65536&&(p.head.comment+=String.fromCharCode(d)),d&&K<X;);if(512&p.flags&&(p.check=e(p.check,R,K,H)),X-=K,H+=K,d)break t}else p.head&&(p.head.comment=null);p.mode=9;case 9:if(512&p.flags){for(;F<16;){if(X===0)break t;X--,z+=R[H++]<<F,F+=8}if(z!==(65535&p.check)){E.msg="header crc mismatch",p.mode=30;break}F=z=0}p.head&&(p.head.hcrc=p.flags>>9&1,p.head.done=!0),E.adler=p.check=0,p.mode=12;break;case 10:for(;F<32;){if(X===0)break t;X--,z+=R[H++]<<F,F+=8}E.adler=p.check=l(z),F=z=0,p.mode=11;case 11:if(p.havedict===0)return E.next_out=ut,E.avail_out=st,E.next_in=H,E.avail_in=X,p.hold=z,p.bits=F,2;E.adler=p.check=1,p.mode=12;case 12:if(B===5||B===6)break t;case 13:if(p.last){z>>>=7&F,F-=7&F,p.mode=27;break}for(;F<3;){if(X===0)break t;X--,z+=R[H++]<<F,F+=8}switch(p.last=1&z,F-=1,3&(z>>>=1)){case 0:p.mode=14;break;case 1:if(Z(p),p.mode=20,B!==6)break;z>>>=2,F-=2;break t;case 2:p.mode=17;break;case 3:E.msg="invalid block type",p.mode=30}z>>>=2,F-=2;break;case 14:for(z>>>=7&F,F-=7&F;F<32;){if(X===0)break t;X--,z+=R[H++]<<F,F+=8}if((65535&z)!=(z>>>16^65535)){E.msg="invalid stored block lengths",p.mode=30;break}if(p.length=65535&z,F=z=0,p.mode=15,B===6)break t;case 15:p.mode=16;case 16:if(K=p.length){if(X<K&&(K=X),st<K&&(K=st),K===0)break t;s.arraySet(lt,R,H,K,ut),X-=K,H+=K,st-=K,ut+=K,p.length-=K;break}p.mode=12;break;case 17:for(;F<14;){if(X===0)break t;X--,z+=R[H++]<<F,F+=8}if(p.nlen=257+(31&z),z>>>=5,F-=5,p.ndist=1+(31&z),z>>>=5,F-=5,p.ncode=4+(15&z),z>>>=4,F-=4,286<p.nlen||30<p.ndist){E.msg="too many length or distance symbols",p.mode=30;break}p.have=0,p.mode=18;case 18:for(;p.have<p.ncode;){for(;F<3;){if(X===0)break t;X--,z+=R[H++]<<F,F+=8}p.lens[L[p.have++]]=7&z,z>>>=3,F-=3}for(;p.have<19;)p.lens[L[p.have++]]=0;if(p.lencode=p.lendyn,p.lenbits=7,N={bits:p.lenbits},U=b(0,p.lens,0,19,p.lencode,0,p.work,N),p.lenbits=N.bits,U){E.msg="invalid code lengths set",p.mode=30;break}p.have=0,p.mode=19;case 19:for(;p.have<p.nlen+p.ndist;){for(;bt=(I=p.lencode[z&(1<<p.lenbits)-1])>>>16&255,St=65535&I,!((pt=I>>>24)<=F);){if(X===0)break t;X--,z+=R[H++]<<F,F+=8}if(St<16)z>>>=pt,F-=pt,p.lens[p.have++]=St;else{if(St===16){for(k=pt+2;F<k;){if(X===0)break t;X--,z+=R[H++]<<F,F+=8}if(z>>>=pt,F-=pt,p.have===0){E.msg="invalid bit length repeat",p.mode=30;break}d=p.lens[p.have-1],K=3+(3&z),z>>>=2,F-=2}else if(St===17){for(k=pt+3;F<k;){if(X===0)break t;X--,z+=R[H++]<<F,F+=8}F-=pt,d=0,K=3+(7&(z>>>=pt)),z>>>=3,F-=3}else{for(k=pt+7;F<k;){if(X===0)break t;X--,z+=R[H++]<<F,F+=8}F-=pt,d=0,K=11+(127&(z>>>=pt)),z>>>=7,F-=7}if(p.have+K>p.nlen+p.ndist){E.msg="invalid bit length repeat",p.mode=30;break}for(;K--;)p.lens[p.have++]=d}}if(p.mode===30)break;if(p.lens[256]===0){E.msg="invalid code -- missing end-of-block",p.mode=30;break}if(p.lenbits=9,N={bits:p.lenbits},U=b(_,p.lens,0,p.nlen,p.lencode,0,p.work,N),p.lenbits=N.bits,U){E.msg="invalid literal/lengths set",p.mode=30;break}if(p.distbits=6,p.distcode=p.distdyn,N={bits:p.distbits},U=b(f,p.lens,p.nlen,p.ndist,p.distcode,0,p.work,N),p.distbits=N.bits,U){E.msg="invalid distances set",p.mode=30;break}if(p.mode=20,B===6)break t;case 20:p.mode=21;case 21:if(6<=X&&258<=st){E.next_out=ut,E.avail_out=st,E.next_in=H,E.avail_in=X,p.hold=z,p.bits=F,m(E,tt),ut=E.next_out,lt=E.output,st=E.avail_out,H=E.next_in,R=E.input,X=E.avail_in,z=p.hold,F=p.bits,p.mode===12&&(p.back=-1);break}for(p.back=0;bt=(I=p.lencode[z&(1<<p.lenbits)-1])>>>16&255,St=65535&I,!((pt=I>>>24)<=F);){if(X===0)break t;X--,z+=R[H++]<<F,F+=8}if(bt&&(240&bt)==0){for(It=pt,qt=bt,At=St;bt=(I=p.lencode[At+((z&(1<<It+qt)-1)>>It)])>>>16&255,St=65535&I,!(It+(pt=I>>>24)<=F);){if(X===0)break t;X--,z+=R[H++]<<F,F+=8}z>>>=It,F-=It,p.back+=It}if(z>>>=pt,F-=pt,p.back+=pt,p.length=St,bt===0){p.mode=26;break}if(32&bt){p.back=-1,p.mode=12;break}if(64&bt){E.msg="invalid literal/length code",p.mode=30;break}p.extra=15&bt,p.mode=22;case 22:if(p.extra){for(k=p.extra;F<k;){if(X===0)break t;X--,z+=R[H++]<<F,F+=8}p.length+=z&(1<<p.extra)-1,z>>>=p.extra,F-=p.extra,p.back+=p.extra}p.was=p.length,p.mode=23;case 23:for(;bt=(I=p.distcode[z&(1<<p.distbits)-1])>>>16&255,St=65535&I,!((pt=I>>>24)<=F);){if(X===0)break t;X--,z+=R[H++]<<F,F+=8}if((240&bt)==0){for(It=pt,qt=bt,At=St;bt=(I=p.distcode[At+((z&(1<<It+qt)-1)>>It)])>>>16&255,St=65535&I,!(It+(pt=I>>>24)<=F);){if(X===0)break t;X--,z+=R[H++]<<F,F+=8}z>>>=It,F-=It,p.back+=It}if(z>>>=pt,F-=pt,p.back+=pt,64&bt){E.msg="invalid distance code",p.mode=30;break}p.offset=St,p.extra=15&bt,p.mode=24;case 24:if(p.extra){for(k=p.extra;F<k;){if(X===0)break t;X--,z+=R[H++]<<F,F+=8}p.offset+=z&(1<<p.extra)-1,z>>>=p.extra,F-=p.extra,p.back+=p.extra}if(p.offset>p.dmax){E.msg="invalid distance too far back",p.mode=30;break}p.mode=25;case 25:if(st===0)break t;if(K=tt-st,p.offset>K){if((K=p.offset-K)>p.whave&&p.sane){E.msg="invalid distance too far back",p.mode=30;break}wt=K>p.wnext?(K-=p.wnext,p.wsize-K):p.wnext-K,K>p.length&&(K=p.length),Dt=p.window}else Dt=lt,wt=ut-p.offset,K=p.length;for(st<K&&(K=st),st-=K,p.length-=K;lt[ut++]=Dt[wt++],--K;);p.length===0&&(p.mode=21);break;case 26:if(st===0)break t;lt[ut++]=p.length,st--,p.mode=21;break;case 27:if(p.wrap){for(;F<32;){if(X===0)break t;X--,z|=R[H++]<<F,F+=8}if(tt-=st,E.total_out+=tt,p.total+=tt,tt&&(E.adler=p.check=p.flags?e(p.check,lt,tt,ut-tt):c(p.check,lt,tt,ut-tt)),tt=st,(p.flags?z:l(z))!==p.check){E.msg="incorrect data check",p.mode=30;break}F=z=0}p.mode=28;case 28:if(p.wrap&&p.flags){for(;F<32;){if(X===0)break t;X--,z+=R[H++]<<F,F+=8}if(z!==(4294967295&p.total)){E.msg="incorrect length check",p.mode=30;break}F=z=0}p.mode=29;case 29:U=1;break t;case 30:U=-3;break t;case 31:return-4;case 32:default:return n}return E.next_out=ut,E.avail_out=st,E.next_in=H,E.avail_in=X,p.hold=z,p.bits=F,(p.wsize||tt!==E.avail_out&&p.mode<30&&(p.mode<27||B!==4))&&at(E,E.output,E.next_out,tt-E.avail_out)?(p.mode=31,-4):(it-=E.avail_in,tt-=E.avail_out,E.total_in+=it,E.total_out+=tt,p.total+=tt,p.wrap&&tt&&(E.adler=p.check=p.flags?e(p.check,lt,tt,E.next_out-tt):c(p.check,lt,tt,E.next_out-tt)),E.data_type=p.bits+(p.last?64:0)+(p.mode===12?128:0)+(p.mode===20||p.mode===15?256:0),(it==0&&tt===0||B===4)&&U===y&&(U=-5),U)},o.inflateEnd=function(E){if(!E||!E.state)return n;var B=E.state;return B.window&&(B.window=null),E.state=null,y},o.inflateGetHeader=function(E,B){var p;return E&&E.state?(2&(p=E.state).wrap)==0?n:((p.head=B).done=!1,y):n},o.inflateSetDictionary=function(E,B){var p,R=B.length;return E&&E.state?(p=E.state).wrap!==0&&p.mode!==11?n:p.mode===11&&c(1,B,R,0)!==p.check?-3:at(E,B,R,R)?(p.mode=31,-4):(p.havedict=1,y):n},o.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(h,w,o){var s=h("../utils/common"),c=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],e=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],m=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],b=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];w.exports=function(_,f,y,n,C,g,u,l){var v,S,D,P,O,q,j,A,Z,at=l.bits,E=0,B=0,p=0,R=0,lt=0,H=0,ut=0,X=0,st=0,z=0,F=null,it=0,tt=new s.Buf16(16),K=new s.Buf16(16),wt=null,Dt=0;for(E=0;E<=15;E++)tt[E]=0;for(B=0;B<n;B++)tt[f[y+B]]++;for(lt=at,R=15;1<=R&&tt[R]===0;R--);if(R<lt&&(lt=R),R===0)return C[g++]=20971520,C[g++]=20971520,l.bits=1,0;for(p=1;p<R&&tt[p]===0;p++);for(lt<p&&(lt=p),E=X=1;E<=15;E++)if(X<<=1,(X-=tt[E])<0)return-1;if(0<X&&(_===0||R!==1))return-1;for(K[1]=0,E=1;E<15;E++)K[E+1]=K[E]+tt[E];for(B=0;B<n;B++)f[y+B]!==0&&(u[K[f[y+B]]++]=B);if(q=_===0?(F=wt=u,19):_===1?(F=c,it-=257,wt=e,Dt-=257,256):(F=m,wt=b,-1),E=p,O=g,ut=B=z=0,D=-1,P=(st=1<<(H=lt))-1,_===1&&852<st||_===2&&592<st)return 1;for(;;){for(j=E-ut,Z=u[B]<q?(A=0,u[B]):u[B]>q?(A=wt[Dt+u[B]],F[it+u[B]]):(A=96,0),v=1<<E-ut,p=S=1<<H;C[O+(z>>ut)+(S-=v)]=j<<24|A<<16|Z|0,S!==0;);for(v=1<<E-1;z&v;)v>>=1;if(v!==0?(z&=v-1,z+=v):z=0,B++,--tt[E]==0){if(E===R)break;E=f[y+u[B]]}if(lt<E&&(z&P)!==D){for(ut===0&&(ut=lt),O+=p,X=1<<(H=E-ut);H+ut<R&&!((X-=tt[H+ut])<=0);)H++,X<<=1;if(st+=1<<H,_===1&&852<st||_===2&&592<st)return 1;C[D=z&P]=lt<<24|H<<16|O-g|0}}return z!==0&&(C[O+z]=E-ut<<24|64<<16|0),l.bits=lt,0}},{"../utils/common":41}],51:[function(h,w,o){w.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(h,w,o){var s=h("../utils/common"),c=0,e=1;function m(I){for(var V=I.length;0<=--V;)I[V]=0}var b=0,_=29,f=256,y=f+1+_,n=30,C=19,g=2*y+1,u=15,l=16,v=7,S=256,D=16,P=17,O=18,q=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],j=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],A=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],at=new Array(2*(y+2));m(at);var E=new Array(2*n);m(E);var B=new Array(512);m(B);var p=new Array(256);m(p);var R=new Array(_);m(R);var lt,H,ut,X=new Array(n);function st(I,V,L,$,x){this.static_tree=I,this.extra_bits=V,this.extra_base=L,this.elems=$,this.max_length=x,this.has_stree=I&&I.length}function z(I,V){this.dyn_tree=I,this.max_code=0,this.stat_desc=V}function F(I){return I<256?B[I]:B[256+(I>>>7)]}function it(I,V){I.pending_buf[I.pending++]=255&V,I.pending_buf[I.pending++]=V>>>8&255}function tt(I,V,L){I.bi_valid>l-L?(I.bi_buf|=V<<I.bi_valid&65535,it(I,I.bi_buf),I.bi_buf=V>>l-I.bi_valid,I.bi_valid+=L-l):(I.bi_buf|=V<<I.bi_valid&65535,I.bi_valid+=L)}function K(I,V,L){tt(I,L[2*V],L[2*V+1])}function wt(I,V){for(var L=0;L|=1&I,I>>>=1,L<<=1,0<--V;);return L>>>1}function Dt(I,V,L){var $,x,W=new Array(u+1),et=0;for($=1;$<=u;$++)W[$]=et=et+L[$-1]<<1;for(x=0;x<=V;x++){var G=I[2*x+1];G!==0&&(I[2*x]=wt(W[G]++,G))}}function pt(I){var V;for(V=0;V<y;V++)I.dyn_ltree[2*V]=0;for(V=0;V<n;V++)I.dyn_dtree[2*V]=0;for(V=0;V<C;V++)I.bl_tree[2*V]=0;I.dyn_ltree[2*S]=1,I.opt_len=I.static_len=0,I.last_lit=I.matches=0}function bt(I){8<I.bi_valid?it(I,I.bi_buf):0<I.bi_valid&&(I.pending_buf[I.pending++]=I.bi_buf),I.bi_buf=0,I.bi_valid=0}function St(I,V,L,$){var x=2*V,W=2*L;return I[x]<I[W]||I[x]===I[W]&&$[V]<=$[L]}function It(I,V,L){for(var $=I.heap[L],x=L<<1;x<=I.heap_len&&(x<I.heap_len&&St(V,I.heap[x+1],I.heap[x],I.depth)&&x++,!St(V,$,I.heap[x],I.depth));)I.heap[L]=I.heap[x],L=x,x<<=1;I.heap[L]=$}function qt(I,V,L){var $,x,W,et,G=0;if(I.last_lit!==0)for(;$=I.pending_buf[I.d_buf+2*G]<<8|I.pending_buf[I.d_buf+2*G+1],x=I.pending_buf[I.l_buf+G],G++,$===0?K(I,x,V):(K(I,(W=p[x])+f+1,V),(et=q[W])!==0&&tt(I,x-=R[W],et),K(I,W=F(--$),L),(et=j[W])!==0&&tt(I,$-=X[W],et)),G<I.last_lit;);K(I,S,V)}function At(I,V){var L,$,x,W=V.dyn_tree,et=V.stat_desc.static_tree,G=V.stat_desc.has_stree,rt=V.stat_desc.elems,yt=-1;for(I.heap_len=0,I.heap_max=g,L=0;L<rt;L++)W[2*L]!==0?(I.heap[++I.heap_len]=yt=L,I.depth[L]=0):W[2*L+1]=0;for(;I.heap_len<2;)W[2*(x=I.heap[++I.heap_len]=yt<2?++yt:0)]=1,I.depth[x]=0,I.opt_len--,G&&(I.static_len-=et[2*x+1]);for(V.max_code=yt,L=I.heap_len>>1;1<=L;L--)It(I,W,L);for(x=rt;L=I.heap[1],I.heap[1]=I.heap[I.heap_len--],It(I,W,1),$=I.heap[1],I.heap[--I.heap_max]=L,I.heap[--I.heap_max]=$,W[2*x]=W[2*L]+W[2*$],I.depth[x]=(I.depth[L]>=I.depth[$]?I.depth[L]:I.depth[$])+1,W[2*L+1]=W[2*$+1]=x,I.heap[1]=x++,It(I,W,1),2<=I.heap_len;);I.heap[--I.heap_max]=I.heap[1],function(ht,Ft){var Wt,Bt,Gt,Ct,Jt,ne,Ot=Ft.dyn_tree,ce=Ft.max_code,ye=Ft.stat_desc.static_tree,we=Ft.stat_desc.has_stree,Ie=Ft.stat_desc.extra_bits,me=Ft.stat_desc.extra_base,Qt=Ft.stat_desc.max_length,te=0;for(Ct=0;Ct<=u;Ct++)ht.bl_count[Ct]=0;for(Ot[2*ht.heap[ht.heap_max]+1]=0,Wt=ht.heap_max+1;Wt<g;Wt++)Qt<(Ct=Ot[2*Ot[2*(Bt=ht.heap[Wt])+1]+1]+1)&&(Ct=Qt,te++),Ot[2*Bt+1]=Ct,ce<Bt||(ht.bl_count[Ct]++,Jt=0,me<=Bt&&(Jt=Ie[Bt-me]),ne=Ot[2*Bt],ht.opt_len+=ne*(Ct+Jt),we&&(ht.static_len+=ne*(ye[2*Bt+1]+Jt)));if(te!==0){do{for(Ct=Qt-1;ht.bl_count[Ct]===0;)Ct--;ht.bl_count[Ct]--,ht.bl_count[Ct+1]+=2,ht.bl_count[Qt]--,te-=2}while(0<te);for(Ct=Qt;Ct!==0;Ct--)for(Bt=ht.bl_count[Ct];Bt!==0;)ce<(Gt=ht.heap[--Wt])||(Ot[2*Gt+1]!==Ct&&(ht.opt_len+=(Ct-Ot[2*Gt+1])*Ot[2*Gt],Ot[2*Gt+1]=Ct),Bt--)}}(I,V),Dt(W,yt,I.bl_count)}function d(I,V,L){var $,x,W=-1,et=V[1],G=0,rt=7,yt=4;for(et===0&&(rt=138,yt=3),V[2*(L+1)+1]=65535,$=0;$<=L;$++)x=et,et=V[2*($+1)+1],++G<rt&&x===et||(G<yt?I.bl_tree[2*x]+=G:x!==0?(x!==W&&I.bl_tree[2*x]++,I.bl_tree[2*D]++):G<=10?I.bl_tree[2*P]++:I.bl_tree[2*O]++,W=x,yt=(G=0)===et?(rt=138,3):x===et?(rt=6,3):(rt=7,4))}function U(I,V,L){var $,x,W=-1,et=V[1],G=0,rt=7,yt=4;for(et===0&&(rt=138,yt=3),$=0;$<=L;$++)if(x=et,et=V[2*($+1)+1],!(++G<rt&&x===et)){if(G<yt)for(;K(I,x,I.bl_tree),--G!=0;);else x!==0?(x!==W&&(K(I,x,I.bl_tree),G--),K(I,D,I.bl_tree),tt(I,G-3,2)):G<=10?(K(I,P,I.bl_tree),tt(I,G-3,3)):(K(I,O,I.bl_tree),tt(I,G-11,7));W=x,yt=(G=0)===et?(rt=138,3):x===et?(rt=6,3):(rt=7,4)}}m(X);var N=!1;function k(I,V,L,$){tt(I,(b<<1)+($?1:0),3),function(x,W,et,G){bt(x),G&&(it(x,et),it(x,~et)),s.arraySet(x.pending_buf,x.window,W,et,x.pending),x.pending+=et}(I,V,L,!0)}o._tr_init=function(I){N||(function(){var V,L,$,x,W,et=new Array(u+1);for(x=$=0;x<_-1;x++)for(R[x]=$,V=0;V<1<<q[x];V++)p[$++]=x;for(p[$-1]=x,x=W=0;x<16;x++)for(X[x]=W,V=0;V<1<<j[x];V++)B[W++]=x;for(W>>=7;x<n;x++)for(X[x]=W<<7,V=0;V<1<<j[x]-7;V++)B[256+W++]=x;for(L=0;L<=u;L++)et[L]=0;for(V=0;V<=143;)at[2*V+1]=8,V++,et[8]++;for(;V<=255;)at[2*V+1]=9,V++,et[9]++;for(;V<=279;)at[2*V+1]=7,V++,et[7]++;for(;V<=287;)at[2*V+1]=8,V++,et[8]++;for(Dt(at,y+1,et),V=0;V<n;V++)E[2*V+1]=5,E[2*V]=wt(V,5);lt=new st(at,q,f+1,y,u),H=new st(E,j,0,n,u),ut=new st(new Array(0),A,0,C,v)}(),N=!0),I.l_desc=new z(I.dyn_ltree,lt),I.d_desc=new z(I.dyn_dtree,H),I.bl_desc=new z(I.bl_tree,ut),I.bi_buf=0,I.bi_valid=0,pt(I)},o._tr_stored_block=k,o._tr_flush_block=function(I,V,L,$){var x,W,et=0;0<I.level?(I.strm.data_type===2&&(I.strm.data_type=function(G){var rt,yt=4093624447;for(rt=0;rt<=31;rt++,yt>>>=1)if(1&yt&&G.dyn_ltree[2*rt]!==0)return c;if(G.dyn_ltree[18]!==0||G.dyn_ltree[20]!==0||G.dyn_ltree[26]!==0)return e;for(rt=32;rt<f;rt++)if(G.dyn_ltree[2*rt]!==0)return e;return c}(I)),At(I,I.l_desc),At(I,I.d_desc),et=function(G){var rt;for(d(G,G.dyn_ltree,G.l_desc.max_code),d(G,G.dyn_dtree,G.d_desc.max_code),At(G,G.bl_desc),rt=C-1;3<=rt&&G.bl_tree[2*Z[rt]+1]===0;rt--);return G.opt_len+=3*(rt+1)+5+5+4,rt}(I),x=I.opt_len+3+7>>>3,(W=I.static_len+3+7>>>3)<=x&&(x=W)):x=W=L+5,L+4<=x&&V!==-1?k(I,V,L,$):I.strategy===4||W===x?(tt(I,2+($?1:0),3),qt(I,at,E)):(tt(I,4+($?1:0),3),function(G,rt,yt,ht){var Ft;for(tt(G,rt-257,5),tt(G,yt-1,5),tt(G,ht-4,4),Ft=0;Ft<ht;Ft++)tt(G,G.bl_tree[2*Z[Ft]+1],3);U(G,G.dyn_ltree,rt-1),U(G,G.dyn_dtree,yt-1)}(I,I.l_desc.max_code+1,I.d_desc.max_code+1,et+1),qt(I,I.dyn_ltree,I.dyn_dtree)),pt(I),$&&bt(I)},o._tr_tally=function(I,V,L){return I.pending_buf[I.d_buf+2*I.last_lit]=V>>>8&255,I.pending_buf[I.d_buf+2*I.last_lit+1]=255&V,I.pending_buf[I.l_buf+I.last_lit]=255&L,I.last_lit++,V===0?I.dyn_ltree[2*L]++:(I.matches++,V--,I.dyn_ltree[2*(p[L]+f+1)]++,I.dyn_dtree[2*F(V)]++),I.last_lit===I.lit_bufsize-1},o._tr_align=function(I){tt(I,2,3),K(I,S,at),function(V){V.bi_valid===16?(it(V,V.bi_buf),V.bi_buf=0,V.bi_valid=0):8<=V.bi_valid&&(V.pending_buf[V.pending++]=255&V.bi_buf,V.bi_buf>>=8,V.bi_valid-=8)}(I)}},{"../utils/common":41}],53:[function(h,w,o){w.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(h,w,o){(function(s){(function(c,e){if(!c.setImmediate){var m,b,_,f,y=1,n={},C=!1,g=c.document,u=Object.getPrototypeOf&&Object.getPrototypeOf(c);u=u&&u.setTimeout?u:c,m={}.toString.call(c.process)==="[object process]"?function(D){process.nextTick(function(){v(D)})}:function(){if(c.postMessage&&!c.importScripts){var D=!0,P=c.onmessage;return c.onmessage=function(){D=!1},c.postMessage("","*"),c.onmessage=P,D}}()?(f="setImmediate$"+Math.random()+"$",c.addEventListener?c.addEventListener("message",S,!1):c.attachEvent("onmessage",S),function(D){c.postMessage(f+D,"*")}):c.MessageChannel?((_=new MessageChannel).port1.onmessage=function(D){v(D.data)},function(D){_.port2.postMessage(D)}):g&&"onreadystatechange"in g.createElement("script")?(b=g.documentElement,function(D){var P=g.createElement("script");P.onreadystatechange=function(){v(D),P.onreadystatechange=null,b.removeChild(P),P=null},b.appendChild(P)}):function(D){setTimeout(v,0,D)},u.setImmediate=function(D){typeof D!="function"&&(D=new Function(""+D));for(var P=new Array(arguments.length-1),O=0;O<P.length;O++)P[O]=arguments[O+1];var q={callback:D,args:P};return n[y]=q,m(y),y++},u.clearImmediate=l}function l(D){delete n[D]}function v(D){if(C)setTimeout(v,0,D);else{var P=n[D];if(P){C=!0;try{(function(O){var q=O.callback,j=O.args;switch(j.length){case 0:q();break;case 1:q(j[0]);break;case 2:q(j[0],j[1]);break;case 3:q(j[0],j[1],j[2]);break;default:q.apply(e,j)}})(P)}finally{l(D),C=!1}}}}function S(D){D.source===c&&typeof D.data=="string"&&D.data.indexOf(f)===0&&v(+D.data.slice(f.length))}})(typeof self=="undefined"?s===void 0?this:s:self)}).call(this,typeof ee!="undefined"?ee:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}]},{},[10])(10)})})(_e);var ba=_e.exports;const Kt={paginacao:{atual:1,maximo:1,total:1,limite:25},filtros:{numero:"",numeroCompra:null,termoBusca:"",periodoEmissao:{ini:"",fim:""},periodoFinalizado:{ini:"",fim:""},fornecedor:{nome:""},destinatario:null}},_a={components:{Lista:Ae,ComprasFicha:Qe,ComprasImportacaoXML:va},data(){return{usuario:"",clienteSistema:"",lista:[],contatos:{},destinatarioOpcoes:[],destinatarioSelecionado:null,mostrar:{header:!0,barraTopo:!0,toolbarTitulo:!0,icone:"factory",titulo:"Compras",filtroAvancado:!0,buscar:!0,btnAjuda:!0,btnAtualizar:!0,btnNovo:!0,toolbarAcoes:!0,checkBox:!1,btnRemover:!1,btnRestaurar:!1,centralizaTabs:!1,btnDetalhes:!1,btnExportaXLS:!1,btnMenuMais:!1,toolbarAdicao:!1,bannerMsg:""},resultado:{},busca:"",filtros:$utils.clonarV2(Kt.filtros),tabSelecionada2:{valor:"Digita\xE7\xE3o"},tabs2:[{valor:"Digita\xE7\xE3o",rotulo:"Digita\xE7\xE3o"},{valor:"Finalizado",rotulo:"Finalizado"},{valor:"Todos",rotulo:"Todos"}],tabSelecionada:{},tabs:[],paginacao:$utils.clonarV2(Kt.paginacao),xmlDevolucao:!1,xmlEstrangeiro:!1,modalXMLNotaEntrada:!1,xmlNotaEntrada:{},abrirNotadeEntrada:null,modalPrevisaoEntrega:{},configImpressao:[],configImpressaoPedidoCompra:[{valor:"ped_compra",texto:"Pedido de Compra",observacao:"Modelo 1"},{valor:"pedidoCompra",texto:"Pedido de Compra",observacao:"Modelo 2"}],dialogEtiquetas:{impressao:!1,adicionar:!1,limpar:!1,item:{}},opcoesModelo:[],modeloSelecionado:"",emBranco:0,opcoesEmpresas:[],empresaSelecionada:"",tabelasPreco:[],opcoesTabelasPreco:[],tabelaPrecoSelecionada:""}},methods:{aoSelecionarDestinatario(){this.filtros.destinatario=$utils.clonar(this.destinatarioSelecionado)},async atualizar(r){var h;const a=$utils.logarIni("ComprasLista");await $tryLoading(async()=>{var _;let{buscarDadosRecentes:w}=r!=null?r:{},o,s,c,e,m=["dataHoraFinalizado","dataHoraEmissao"],b=["desc","desc"];if(r!=null&&r.aba2&&(this.tabSelecionada.valor=r.aba2),this.tabSelecionadaAnterior&&this.tabSelecionadaAnterior!==this.tabSelecionada.valor&&(this.setOpcoesTabs(this.tabSelecionada.valor),this.filtros=$utils.clonarV2(Kt.filtros),this.paginacao=$utils.clonarV2(Kt.paginacao),this.busca="",w=!0),this.tabSelecionadaAnterior=this.tabSelecionada.valor,w&&(o=await $utils.localIDB.getItem({objectStore:"dadosRecentes",id:this.tabSelecionada.valor}),o!=null&&o._id&&(this.destinatarioSelecionado=o.filtros.destinatario,this.filtros=o.filtros,this.busca=o.termoBusca,m=o.sort,b=o.dir)),r!=null&&r.aba&&(this.tabSelecionada2.valor=r.aba),s=$utils.eliminarVazios(this.filtros),c=this.paginacao.limite,e=this.paginacao.atual,s.status=this.tabSelecionada2.valor,s.operacao=this.tabSelecionada.valor,s.termoBusca=this.busca,this.tabSelecionada2.valor==="Todos"&&delete s.status,s.operacao==="Nota na SEFAZ"){let f=await $db.hibrido.lista({table:"documentoFiscalEletronico",columns:["id","xNomeEmitente","cpfCnpjEmitente","xNomeDestinatario","cpfCnpjDestinatario","vNF","situacao","nNF"],where:{tipo:"DFe",...this.tabSelecionada2.valor!=="Todos"?{situacao:this.tabSelecionada2.valor}:{}}});f=f.filter(g=>{var u,l,v;return!(((u=this.filtros.fornecedor)==null?void 0:u.nome)&&!g.xNomeEmitente.toLowerCase().includes(this.filtros.fornecedor.nome.toLowerCase())||((l=this.filtros.destinatario)==null?void 0:l.numeroDocumentoNacional)&&((v=g.cpfCnpjDestinatario)==null?void 0:v.replace(/\D/g,""))!==this.filtros.destinatario.numeroDocumentoNacional.replace(/\D/g,""))});const y=await $db.hibrido.lista({table:"documentoFiscalEletronicoXml",columns:["idDocumentoFiscalEletronico","dhRecbto"],whereIn:{idDocumentoFiscalEletronico:f.map(g=>g.id)}}),n=[];y.forEach(g=>{var D,P;const u=f.find(O=>O.id===g.idDocumentoFiscalEletronico),l=new Date(g.dhRecbto).setHours(0,0,0,0),v=new Date((D=this.filtros.periodoEmissao)==null?void 0:D.ini).setHours(0,0,0,0),S=new Date((P=this.filtros.periodoEmissao)==null?void 0:P.fim).setHours(0,0,0,0);(v||S)&&l&&(v&&l<v||S&&l>S)||u&&n.push({id:u.id,descricaoContato:u.xNomeEmitente,numeroDocumentoContato:this.$filters.cpfCnpj(u.cpfCnpjEmitente)||"",descricaoEmpresa:u.xNomeDestinatario,numeroDocumentoEmpresa:this.$filters.cpfCnpj(u.cpfCnpjDestinatario)||"",dhRecbto:g.dhRecbto,totalDocumento:u.vNF,status:u.situacao,notaNumero:u.nNF})});const C=(e-1)*c;this.paginacao.total=n.length,this.paginacao.maximo=Math.ceil(this.paginacao.total/c)||1,n.sort((g,u)=>g.dhRecbto<u.dhRecbto?1:-1),this.lista=n.splice(C,c)}else{(_=this.filtros.destinatario)!=null&&_.value&&(s.idContatoEmpresa=this.filtros.destinatario.value);const f=await $db.compra.leListaCompleta({filtros:s,limit:c,page:e,sort:m,dir:b});this.paginacao.total=f.total,this.paginacao.maximo=f.totalPages,this.lista=f.data.compras}for(const{idContato:f}of this.lista)f&&!this.contatos[f]&&(this.contatos[f]={});this.carregarImagensContatos(this.contatos),o={_id:this.tabSelecionada.valor,tabSelecionada2:this.tabSelecionada2.valor,filtros:$utils.clonarV2(s),termoBusca:this.busca,sort:m,dir:b},await $utils.localIDB.setItem({objectStore:"dadosRecentes",data:o}),this.configuraImpressao(this.filtros.idEmpresa)}),$utils.logarFim(a,((h=this.paginacao)==null?void 0:h.total)||1)},async carregarImagensContatos(r){const a=Object.keys(r);if(!!a.length){await $utils.dormir(200);try{const h=await $db.hibrido.lista({table:"contato",columns:["id","apelido","imagem"],whereIn:{id:a}});for(const w of h)r[w.id].imagem=w.imagem||""}catch(h){console.error("Erro ao carregar imagens de contatos - ",h)}}},adicionarXml(r){this.xmlNotaEntrada.arquivo=r[0]},async concluirImportacao(r){await $tryLoading(async()=>{await $db.compra.grava({atual:r}),$q.notifyPositive("Importa\xE7\xE3o realizada com sucesso!"),this.tabSelecionada2.valor="Digita\xE7\xE3o",this.tabSelecionada.valor="Nota de Entrada",await this.$refs.comprasFicha.mostrar({id:r.documento.id})},{mensagem:"Gravando importa\xE7\xE3o..."})},async importarXmlNotaDeEntrada(){var w,o,s,c,e,m;let r;try{$utils.verificarErro(!this.xmlNotaEntrada.arquivo,"Adicione um arquivo XML antes de enviar!"),r=await new Promise((b,_)=>{const f=new FileReader;f.readAsText(this.xmlNotaEntrada.arquivo,"UTF-8"),f.onload=()=>b(f.result),f.onerror=y=>_(y)})}catch(b){return console.error(b),$q.notifyError("Ocorreu um erro na importa\xE7\xE3o"),!1}let a;try{a=await Pe.parseStringPromise(r)}catch(b){return console.error(b),$q.notifyError("Arquivo inv\xE1lido ou corrompido"),!1}if(!((m=(e=(c=(s=(o=(w=a==null?void 0:a.nfeProc)==null?void 0:w.protNFe)==null?void 0:o[0])==null?void 0:s.infProt)==null?void 0:c[0])==null?void 0:e.nProt)==null?void 0:m[0])&&!await $q.dialogSimNao({title:"Aviso importante",message:"O XML que est\xE1 sendo importado n\xE3o foi protocolado pela Sefaz, gostaria de importar o XML sem o protocolo?",html:!0})){$q.notifyError("Opera\xE7\xE3o para importa\xE7\xE3o de XML n\xE3o realizada!",erro);return}await $tryLoading(async()=>{const b=(await $db.hibrido.lista({table:"documentoXML",whereFilter:{xmlAux:r}}))[0];$utils.verificarErro(b==null?void 0:b.id,"Esse xml j\xE1 foi importado!");const _=await $db.compra.importaXml({xmlString:r,xmlEstrangeiro:Boolean(this.xmlEstrangeiro)});_.documentosItem.find(({vinculado:f})=>!f)?this.$refs.comprasImportacaoXML.mostrar(_):await this.concluirImportacao(_)},{mensagem:"Importando..."}),delete this.xmlNotaEntrada.arquivo,this.modalXMLNotaEntrada=!1,this.xmlEstrangeiro=!1},async fecharXmlNotaDeEntrada(){delete this.xmlNotaEntrada.arquivo},async abrir(r){this.tabSelecionada.valor!=="Nota na SEFAZ"&&this.$refs.comprasFicha.mostrar({id:r})},criarClick(){this.$refs.comprasFicha.criar()},importarXmlClick(){this.modalXMLNotaEntrada=!0},limparFiltrosClick(){this.filtros=$utils.clonarV2(Kt.filtros),this.destinatarioSelecionado=null,this.atualizar()},setOpcoesTabs(r){r!=="Nota na SEFAZ"?(this.tabSelecionada2.valor="Digita\xE7\xE3o",this.tabs2=[{valor:"Digita\xE7\xE3o",rotulo:"Digita\xE7\xE3o"},{valor:"Finalizado",rotulo:"Finalizado"},{valor:"Todos",rotulo:"Todos"}]):(this.tabSelecionada2.valor="N\xE3o Importada",this.tabs2=[{valor:"N\xE3o Importada",rotulo:"N\xE3o Importada"},{valor:"Importada",rotulo:"Importada"},{valor:"Todos",rotulo:"Todas"}])},async duplicarDocumento_click(r){!await $q.dialogSimNao({title:"Duplicar",message:"Deseja prosseguir com a opera\xE7\xE3o?"})||await $tryLoading(async()=>{const a=await $db.hibrido.le({table:"documento",id:r.id});$utils.verificarErro(!a.id,"Compra n\xE3o encontrada");const h=(await $db.hibrido.lista({table:"documentoItem",where:{idDocumento:r.id}})).sort((o,s)=>new Date(o.dataHoraEmissao||0)-new Date(s.dataHoraEmissao||0)),w=$utils.uuid();await $db.hibrido.grava("documento",{atual:{...a,id:w,codigoDocumento:void 0,numero:void 0,notaNumero:void 0,notaSerie:void 0,naturezaOperacao:void 0,dataCompra:void 0,chaveAcesso:void 0,dataHoraEmissao:$utils.dataAtual(),dataHoraFinalizado:void 0,dataHoraPrevisto:void 0,status:"Digita\xE7\xE3o",operacao:"Pedido de Compra"}}),await $db.hibrido.gravaLista("documentoItem",{atual:h.map(o=>({...o,id:$utils.uuid(),codigoDocumentoItem:void 0,idDocumento:w,codigoDocumento:void 0,dataHoraEmissao:$utils.dataAtual(),dataHoraFinalizado:void 0,status:"Digita\xE7\xE3o"}))}),$q.notifyPositive("Duplica\xE7\xE3o realizada com sucesso!"),this.tabSelecionada2.valor="Digita\xE7\xE3o",this.tabSelecionada.valor="Pedido de Compra",await this.$refs.comprasFicha.mostrar({id:w})},{mensagem:"Duplicando..."})},async trocarCfop_click(r){!await $q.dialogSimNao({title:"Confirma\xE7\xE3o",message:"Deseja trocar os CFOP iniciados em 5 e 6 para 1 e 2 correspondentes?"})||await $tryLoading(async()=>{var s;const a=await $db.hibrido.lista({table:"documentoItem",where:{idDocumento:r.id}}),h=$utils.clonarV2(a),w=await $db.hibrido.lista({table:"cfop",whereIn:{id:$utils.unicos(h,"idCfop")}});let o=0;for(const c of w){const e=String(c.cfop),m=e[0]==="5"?"1"+e.substr(1):e[0]==="6"?"2"+e.substr(1):e;if(m!==e){const b=(s=(await $db.hibrido.lista({table:"cfop",where:{cfop:m}}))[0])==null?void 0:s.id;$utils.verificarErro(!b,`CFOP ${m} n\xE3o encontrado`);for(const _ of h)_.idCfop===c.id&&(_.idCfop=b,o++)}}$utils.verificarErro(!o,"N\xE3o h\xE1 CFOPs com inicial 5 ou 6 para realizar trocas"),await $db.hibrido.gravaLista("documentoItem",{atual:h,original:a}),$q.notifyPositive(`Troca de CFOP realizada com sucesso em ${o} itens!`)},{mensagem:"Processando..."})},async alterarPrevisaoEntrega_click(r){var a,h;this.modalPrevisaoEntrega={visivel:!0,dataPrevistaEntrega:(a=r.dataHoraPrevisto)==null?void 0:a.slice(0,10),horaPrevistaEntrega:(h=r.dataHoraPrevisto)==null?void 0:h.slice(11,16),compra:r}},async alterarPrevisaoEntrega(){await $tryLoading(async()=>{const{compra:r,dataPrevistaEntrega:a,horaPrevistaEntrega:h}=this.modalPrevisaoEntrega;$utils.verificarErro(!a,"\xC9 necess\xE1rio preencher a data");const w=zt.formatDate(`${a} ${h||"00:00:00"}`);$utils.verificarErro(!w,"Data Inv\xE1lida"),w!==zt.formatDate(r.dataHoraPrevisto)?(await $db.hibrido.grava("documento",{atual:{id:r.id,dataHoraPrevisto:w}}),r.dataHoraPrevisto=w,$q.notifyPositive("A previs\xE3o foi salva com sucesso"),this.modalPrevisaoEntrega={}):$q.notifyPositive("N\xE3o h\xE1 dados alterados.")})},async downloadXmlDFeFiltrados(){var r,a,h,w,o;if(!!await $q.dialogSimNao({title:"Download XML's filtrados",message:"Deseja prosseguir com a opera\xE7\xE3o?"}))try{$q.loading.show();let s=[];if($db.hibrido.isOnline())s=(o=(w=(h=await $utils.geeksApi({downloadDFe:{funcao:"2D9F9B43-47D3-491E-AD49-528EC9547BDC",...this.tabSelecionada2.valor!=="Todos"?{situacao:this.tabSelecionada2.valor}:{},fornecedor:(r=this.filtros.fornecedor)==null?void 0:r.nome,numeroDocumentoNacionalDestinatario:(a=this.filtros.destinatario)==null?void 0:a.numeroDocumentoNacional,periodoRecbto:this.filtros.periodoEmissao}}))==null?void 0:h.data)==null?void 0:w.downloadDFe)!=null?o:[];else{let c=await $db.hibrido.lista({table:"documentoFiscalEletronico",columns:["id","dhEmi","cpfCnpjEmitente","cpfCnpjDestinatario","xNomeEmitente","xNomeDestinatario"],where:{tipo:"DFe",...this.tabSelecionada2.valor!=="Todos"?{situacao:this.tabSelecionada2.valor}:{}}});c=c.filter(m=>{var b,_,f;return!(((b=this.filtros.fornecedor)==null?void 0:b.nome)&&!m.xNomeEmitente.toLowerCase().includes(this.filtros.fornecedor.nome.toLowerCase())||((_=this.filtros.destinatario)==null?void 0:_.numeroDocumentoNacional)&&((f=m.cpfCnpjDestinatario)==null?void 0:f.replace(/\D/g,""))!==this.filtros.destinatario.numeroDocumentoNacional.replace(/\D/g,""))}),(await $db.hibrido.lista({table:"documentoFiscalEletronicoXml",columns:["idDocumentoFiscalEletronico","chNFe","dhRecbto","xmlProt"],whereIn:{idDocumentoFiscalEletronico:c.map(m=>m.id)}})).forEach(m=>{var n,C;const b=c.find(g=>g.id===m.idDocumentoFiscalEletronico),_=new Date(m.dhRecbto).setHours(0,0,0,0),f=new Date((n=this.filtros.periodoEmissao)==null?void 0:n.ini).setHours(0,0,0,0),y=new Date((C=this.filtros.periodoEmissao)==null?void 0:C.fim).setHours(0,0,0,0);(f||y)&&_&&(f&&_<f||y&&_>y)||b&&s.push({chNFe:m.chNFe,xml:m.xmlProt,cnpj:b.cpfCnpjDestinatario})})}if((s==null?void 0:s.length)>0){const c=Array.from(new Set(s.filter(m=>m.cnpj).map(m=>m.cnpj))),e=new ba;for(const m of c)for(const b of s.filter(_=>_.cnpj===m))e.file(`${m}/${b.chNFe}.procNFe.xml`,b.xml);e.generateAsync({type:"blob"}).then(function(m){const b=new Date,_=document.createElement("a");_.href=window.URL.createObjectURL(m),_.download=`${b.getFullYear()}-${String(b.getMonth()+1).padStart(2,"0")}-${String(b.getDate()).padStart(2,"0")}_NotasEntradaSEFAZ.zip`,_.click()})}}catch{$q.notify({message:"N\xE3o foi poss\xEDvel realizar o download",type:"negative"})}finally{$q.loading.hide()}},async downloadXmlDFe(r,a){!await $q.dialogSimNao({title:"Download XML",message:"Deseja prosseguir com a opera\xE7\xE3o?"})||await $tryLoading(async()=>{var m;const w=(a==="Nota de Entrada"?await $db.hibrido.lista({table:"documentoXML",where:{idDocumento:r}}):await $db.hibrido.lista({table:"documentoFiscalEletronicoXml",where:{idDocumentoFiscalEletronico:r}}))[0],o=(w==null?void 0:w.xmlProt)||(w==null?void 0:w.xmlData),s=(w==null?void 0:w.chNFe)||((m=/<chNFe>(\d+)<\/chNFe>/i.exec(o))==null?void 0:m[1]);$utils.verificarErro(!o,"N\xE3o foi poss\xEDvel recuperar o XML");const c=document.createElement("a"),e=new Blob([o],{type:"text/plain"});c.setAttribute("href",window.URL.createObjectURL(e)),c.setAttribute("download",`${s||r}-procNFe.xml`),c.click()})},async importarXmlDFe(r){!await $q.dialogSimNao({title:"Importar XML",message:"Deseja prosseguir com a opera\xE7\xE3o?"})||await $tryLoading(async()=>{const a=await $db.hibrido.le({table:"documentoFiscalEletronico",id:r}),h=(await $db.hibrido.lista({table:"documentoFiscalEletronicoXml",where:{idDocumentoFiscalEletronico:r}}))[0];if((a==null?void 0:a.id)&&(h==null?void 0:h.xmlProt)){const w=(await $db.hibrido.lista({table:"documento",whereFilter:{chaveAcesso:h==null?void 0:h.chNFe}}))[0];$utils.verificarErro(w==null?void 0:w.id,"Esse xml j\xE1 foi importado!");const o=await $db.compra.importaXml({xmlString:h.xmlProt});o.documentoFiscalEletronico={id:r,situacao:"Importada"},o.documentosItem.find(({vinculado:s})=>!s)?this.$refs.comprasImportacaoXML.mostrar(o):await this.concluirImportacao(o)}},{mensagem:"Importando..."})},async destinatarioOpcoesCarregar(){const r=(await $db.contato.ler({filtros:{ativo:!0,empresas:!0}})).data;this.destinatarioOpcoes=r.map(a=>({label:a.nome,value:a.id,numeroDocumentoNacional:a.numeroDocumentoNacional}))},async configuraImpressao(r){const a=await $db.configuracoes.porNome("impressao.compra",r);this.configImpressao=[...a.length?a.map(h=>({valor:h.valor,texto:h.texto,observacao:h.observacao})):[{valor:"invoice",texto:"Pedido de Compra",observacao:"Invoice"}]]},imprimirPedidoCompra(r,a){r==="pedidoCompra"&&this.abrirImpressao(`
            https://rel.storage.b15.com.br/Relatorios/OptiSoul/pedidoCompra.html
            ?CodigoDocumento=${a}
            &hfCodigoSistema=${encodeURIComponent(JSON.stringify({data:{CodigoUsuario:this.usuario.codigoUsuario,CodigoSistema:this.clienteSistema.codigoSistema,CodigoClienteSistema:this.clienteSistema.codigoClienteSistema,Sistema:this.clienteSistema.sistema,URLServidor:this.clienteSistema.urlServidor,BancoDeDados:this.clienteSistema.bancoDeDados,CodigoCliente:this.clienteSistema.codigoCliente,Cliente:this.clienteSistema.cliente,Administrador:this.clienteSistema.administrador,GrupoInterno:this.clienteSistema.grupoInterno}}))}
          `),r==="ped_compra"&&this.abrirImpressao(`
            https://rel.storage.b15.com.br/Relatorios/distribuidor/email.html
            ?CodigoDocumento=${a}
            &URLServidor=${encodeURIComponent(this.clienteSistema.urlServidor)}
            &Banco=${encodeURIComponent(this.clienteSistema.bancoDeDados)}
            &NomeReport=ped_compra
            &CodigoUsuario=${this.usuario.codigoUsuario}
            &hfCodigoSistema=${encodeURIComponent(JSON.stringify({data:{CodigoUsuario:this.usuario.codigoUsuario,CodigoSistema:this.clienteSistema.codigoSistema,CodigoClienteSistema:this.clienteSistema.codigoClienteSistema,Sistema:this.clienteSistema.sistema,Versao:this.clienteSistema.versao,URLServidor:this.clienteSistema.urlServidor,BancoDeDados:this.clienteSistema.bancoDeDados,CodigoCliente:this.clienteSistema.codigoCliente,Cliente:this.clienteSistema.cliente,Padrao:this.clienteSistema.padrao?this.clienteSistema.padrao:null,Administrador:this.clienteSistema.administrador,GrupoInterno:this.clienteSistema.grupoInterno}}))}
          `)},async configuraEtiqueta(){const r=await $db.configuracoes.le({nome:"impressao.etiqueta"});this.opcoesModelo=[],r.length?r.forEach(a=>{this.opcoesModelo.push({rotulo:a.texto,valor:a.observacao&&a.observacao.trim()!==""?a.observacao:a.valor,modelo:a.valor})}):this.opcoesModelo.push({rotulo:"Etiqueta Carta (EBF-23)",valor:"etiqueta-carta-ebf23",modelo:"imprimir-etiquetas"},{rotulo:"Etiqueta Fila Joias",valor:"etiqueta-fila-joias",modelo:"imprimir-etiquetas"},{rotulo:"Etiqueta Fila 3 Colunas",valor:"etiqueta-fila-3colunas",modelo:"imprimir-etiquetas"},{rotulo:"Etiqueta Pimaco (A4 96)",valor:"etiqueta-pimaco-a496",modelo:"imprimir-etiquetas"}),this.opcoesModelo=[...this.opcoesModelo,{rotulo:"Modelos antigos:",value:"modelos-antigos",disable:!0},{rotulo:"Folha Argox",valor:"etiqueta-fila"},{rotulo:"Folha Carta",valor:"etiqueta-carta"},{rotulo:"Folha Pimaco",valor:"EtiquetaPimaco6Col"},{rotulo:"Personaliz\xE1vel",valor:"etiqueta_generica_ajustavel"},{rotulo:"Etiqueta Fila",valor:"etiquetaFila",modelo:"etiquetaFila"}],this.modeloSelecionado=this.opcoesModelo[0].valor},async configuraEmpresas(){const r=(await $db.contato.ler({filtros:{ativo:!0,empresas:!0}})).data;this.opcoesEmpresas=r.map(a=>({rotulo:a.apelido||a.nome,valor:a.id,codigoEmpresa:a.codigoContato})),this.empresaSelecionada=""},async configuraTabelasPreco(){this.tabelasPreco=await $db.itemTabelaPreco.le({ativo:!0,tabelaMaster:!0})||[],this.opcoesTabelasPreco=this.tabelasPreco.map(r=>({rotulo:r.descricao,valor:r.id,codigoItemTabelaPreco:r.codigoItemTabelaPreco})),this.tabelaPrecoSelecionada=""},async dialogImprimirEtiquetas({acao:r,item:a}){try{await this.configuraEtiqueta(),await this.configuraEmpresas(),await this.configuraTabelasPreco(),this.dialogEtiquetas={[r]:!0,item:a||{},limpar:!1}}catch(h){console.error("Erro ao configurar impress\xE3o de etiquetas",h)}},imprimirEtiquetas(r){var a,h,w,o,s;if(r==="etiqueta_generica_ajustavel"||r==="etiqueta-fila"||r==="etiqueta-carta"||r==="EtiquetaPimaco6Col"){const c=r==="etiqueta_generica_ajustavel"?"":"OptiSoul/";this.abrirImpressao(`
            https://rel.storage.b15.com.br/Relatorios/${c}${r}.html
            ?Banco=${encodeURIComponent(this.clienteSistema.bancoDeDados)}
            &URLServidor=${encodeURIComponent(this.clienteSistema.urlServidor)}
            &CodigoUsuario=${this.usuario.codigoUsuario}
            &EmBranco=${this.emBranco}
            &CodigoPedido=${(h=(a=this.dialogEtiquetas)==null?void 0:a.item)==null?void 0:h.codigoDocumento}
            &TabelaPreco=${this.tabelaPrecoSelecionada?encodeURIComponent(this.opcoesTabelasPreco.find(e=>e.valor===this.tabelaPrecoSelecionada).codigoItemTabelaPreco):""}
            &CodigoContatoEmpresa=${this.empresaSelecionada?encodeURIComponent(this.opcoesEmpresas.find(e=>e.valor===this.empresaSelecionada).codigoEmpresa):""}
            &cpfUsuarioLogado=${encodeURIComponent(this.usuario.cpf)}
            &hfCodigoSistema=${encodeURIComponent(JSON.stringify({data:{CodigoUsuario:this.usuario.codigoUsuario,CodigoSistema:this.clienteSistema.codigoSistema,CodigoClienteSistema:this.clienteSistema.codigoClienteSistema,Sistema:this.clienteSistema.sistema,URLServidor:this.clienteSistema.urlServidor,BancoDeDados:this.clienteSistema.bancoDeDados,CodigoCliente:this.clienteSistema.codigoCliente,Cliente:this.clienteSistema.cliente,Administrador:this.clienteSistema.administrador,GrupoInterno:this.clienteSistema.grupoInterno}}))}
          `)}else{const c=(w=this.opcoesModelo)==null?void 0:w.find(b=>b.valor===r),e=(c==null?void 0:c.modelo)||"",m=(c==null?void 0:c.valor)||"";$imprimir(e,{id:(s=(o=this.dialogEtiquetas)==null?void 0:o.item)==null?void 0:s.id,impressao:"etiquetas"},{modelo:m,idEmpresa:this.empresaSelecionada,idTabelaPreco:this.tabelaPrecoSelecionada,emBranco:this.emBranco})}},abrirImpressao(r){window.open(r.replace(/[\s\n]/g,""),"_blank").focus()},async adicionarEtiquetas(){var r;try{$q.loading.show();const a=this.dialogEtiquetas;let h=await $db.etiqueta.ler({cpfUsuarioLogado:this.usuario.numeroDocumentoNacional})||[];if(a!=null&&a.limpar){for(const c of h)await $db.etiqueta.remover(c.id);h=[]}const w=await $db.hibrido.lista({table:"documentoItem",where:{idDocumento:(r=a==null?void 0:a.item)==null?void 0:r.id}});if(!w.length){$q.notifyError("N\xE3o foi poss\xEDvel encontrar itens para carregar a impress\xE3o etiquetas");return}const o=w.map(c=>c.idItem),s=await $db.hibrido.lista({table:"item",columns:["id","codigoItem","descricaoConcatenada","valorVenda"],whereIn:{id:o}});if(!s.length){$q.notifyError("N\xE3o foi poss\xEDvel encontrar itens para carregar a impress\xE3o etiquetas");return}for(const c of s){if(h.length){const m=h.find(b=>b.idItem===c.id)||null;m&&await $db.etiqueta.remover(m==null?void 0:m.id)}const e={id:$utils.uuid(),idItem:c.id,nomeProduto:c.descricaoConcatenada,valor:c.valorVenda||0,quantidadeEtiquetas:w.find(m=>m.idItem===c.id).quantidade||0,cpfUsuarioLogado:this.usuario.numeroDocumentoNacional,dataHoraEmissao:$utils.dataAtual()};await $db.etiqueta.gravar({atual:e})}$q.loading.hide(),this.$q.dialog({title:"",message:"Ir para tela de impress\xE3o de etiquetas?",noRefocus:!0,preventClose:!0,ok:{label:"SIM",push:!0,class:"bg-primary",textColor:"white",flat:!0},cancel:{label:"N\xC3O",push:!0,color:"tertiary",flat:!0}}).onOk(()=>{this.$router.push({name:"EtiquetasLista"})}).onCancel(()=>{this.dialogEtiquetas.adicionar=!1})}catch(a){$q.loading.hide(),$q.notifyError("Erro ao adicionar etiquetas",a)}}},watch:{"tabSelecionada.valor"(){this.tabSelecionada.valor==="Nota na SEFAZ"?this.mostrar.btnMenuMais=!0:this.mostrar.btnMenuMais=!1}},async created(){await this.destinatarioOpcoesCarregar();const r=[{valor:"Pedido de Compra",rotulo:"Pedido de Compra"},{valor:"Nota de Entrada",rotulo:"Nota de Entrada"}];[52,53,62].includes(Number(this.clienteSistema.codigoSistema))&&r.push({valor:"Nota na SEFAZ",rotulo:"Nota na SEFAZ"}),this.tabSelecionada={valor:"Pedido de Compra"},this.tabs=r},async mounted(){this.usuario=JSON.parse(localStorage.getItem("usuario")),this.clienteSistema=JSON.parse(localStorage.getItem("clienteSistema")),this.tabSelecionada.valor=this.$route.name,this.atualizar({buscarDadosRecentes:!0})}},ya={id:"Compras"},wa={class:"mw80 text-center"},Ia={key:0,class:"text-weight-medium"},Ca={class:"row q-ma-md"},ka={key:0,class:"row q-ma-md"},Sa={class:"certificado-error-messages"},Ea={class:"col-12"},Da={class:"col-12"},Va={class:"q-mt-lg text-right"};function Pa(r,a,h,w,o,s){const c=gt("campo"),e=gt("BadgeCopiarUid"),m=gt("avatar"),b=gt("g-label"),_=gt("badge"),f=gt("g-col"),y=gt("g-row"),n=gt("Lista"),C=gt("ComprasFicha"),g=gt("ComprasImportacaoXML"),u=gt("row");return M(),_t("div",ya,[t(n,{busca:o.busca,"onUpdate:busca":a[11]||(a[11]=l=>o.busca=l),onAtualizar:s.atualizar,onLimparFiltrosClick:s.limparFiltrosClick,onCriarClick:s.criarClick,lista:o.lista,tabSelecionada:o.tabSelecionada,tabs:o.tabs,tabSelecionada2:o.tabSelecionada2,tabs2:o.tabs2,paginacao:o.paginacao,mostrar:o.mostrar},{botaoNovo:i(()=>[t(dt,{label:"Novo",icon:"add",unelevated:"",color:"primary","text-color":"white",class:"hideonmobile"},{default:i(()=>[t(Lt,null,{default:i(()=>[t(Pt,{link:"","no-border":"",separator:""},{default:i(()=>[vt((M(),Y(mt,{onClick:s.criarClick,clickable:""},{default:i(()=>[t(Q,{avatar:""},{default:i(()=>[t(ct,{name:"add"})]),_:1}),t(Q,null,{default:i(()=>a[27]||(a[27]=[T("Incluir Manual")])),_:1})]),_:1},8,["onClick"])),[[Et]]),vt((M(),Y(mt,{onClick:s.importarXmlClick,clickable:""},{default:i(()=>[t(Q,{avatar:""},{default:i(()=>[t(ct,{name:"add"})]),_:1}),t(Q,null,{default:i(()=>a[28]||(a[28]=[T("Importar XML")])),_:1})]),_:1},8,["onClick"])),[[Et]])]),_:1})]),_:1})]),_:1}),t(dt,{icon:"add",flat:"",round:"",color:"primary","text-color":"white",class:"hideondesktop"},{default:i(()=>[t(Lt,null,{default:i(()=>[t(Pt,{link:"","no-border":"",separator:""},{default:i(()=>[vt((M(),Y(mt,{onClick:s.criarClick,clickable:""},{default:i(()=>[t(Q,{avatar:""},{default:i(()=>[t(ct,{name:"add"})]),_:1}),t(Q,null,{default:i(()=>a[29]||(a[29]=[T("Incluir Manual")])),_:1})]),_:1},8,["onClick"])),[[Et]]),vt((M(),Y(mt,{onClick:s.importarXmlClick,clickable:""},{default:i(()=>[t(Q,{avatar:""},{default:i(()=>[t(ct,{name:"add"})]),_:1}),t(Q,null,{default:i(()=>a[30]||(a[30]=[T("Importar XML")])),_:1})]),_:1},8,["onClick"])),[[Et]])]),_:1})]),_:1})]),_:1})]),filtroCampos:i(()=>[t(c,{modelValue:o.filtros.numero,"onUpdate:modelValue":a[0]||(a[0]=l=>o.filtros.numero=l),dense:"",rotulo:"N\xBA Nota",class:"q-mt-md"},null,8,["modelValue"]),t(c,{modelValue:o.filtros.numeroCompra,"onUpdate:modelValue":a[1]||(a[1]=l=>o.filtros.numeroCompra=l),dense:"",rotulo:"Ordem de compra",class:"q-mt-lg"},null,8,["modelValue"]),t(xe,{modelValue:o.destinatarioSelecionado,"onUpdate:modelValue":[a[2]||(a[2]=l=>o.destinatarioSelecionado=l),s.aoSelecionarDestinatario],options:o.destinatarioOpcoes,clearable:"",dense:"",label:"Destinat\xE1rio",class:"q-mt-lg"},null,8,["modelValue","onUpdate:modelValue","options"]),t(c,{modelValue:o.filtros.fornecedor.nome,"onUpdate:modelValue":a[3]||(a[3]=l=>o.filtros.fornecedor.nome=l),dense:"",rotulo:"Fornecedor",class:"q-mt-lg"},null,8,["modelValue"]),this.tabSelecionada.valor==="Nota na SEFAZ"?(M(),_t(kt,{key:0},[t(c,{modelValue:o.filtros.periodoEmissao.ini,"onUpdate:modelValue":a[4]||(a[4]=l=>o.filtros.periodoEmissao.ini=l),dense:"",rotulo:"Data Emiss\xE3o",tipo:"data",class:"q-mt-xl"},null,8,["modelValue"]),t(c,{modelValue:o.filtros.periodoEmissao.fim,"onUpdate:modelValue":a[5]||(a[5]=l=>o.filtros.periodoEmissao.fim=l),rotulo:"at\xE9",dense:"",tipo:"data",class:"q-mt-sm"},null,8,["modelValue"])],64)):(M(),_t(kt,{key:1},[t(c,{modelValue:o.filtros.periodoEmissao.ini,"onUpdate:modelValue":a[6]||(a[6]=l=>o.filtros.periodoEmissao.ini=l),dense:"",rotulo:"Data Emiss\xE3o",tipo:"data",class:"q-mt-xl"},null,8,["modelValue"]),t(c,{modelValue:o.filtros.periodoEmissao.fim,"onUpdate:modelValue":a[7]||(a[7]=l=>o.filtros.periodoEmissao.fim=l),dense:"",rotulo:"at\xE9",tipo:"data",class:"q-mt-sm"},null,8,["modelValue"]),t(c,{modelValue:o.filtros.periodoFinalizado.ini,"onUpdate:modelValue":a[8]||(a[8]=l=>o.filtros.periodoFinalizado.ini=l),dense:"",rotulo:"Data Finalizado",tipo:"data",class:"q-mt-xl"},null,8,["modelValue"]),t(c,{modelValue:o.filtros.periodoFinalizado.fim,"onUpdate:modelValue":a[9]||(a[9]=l=>o.filtros.periodoFinalizado.fim=l),dense:"",rotulo:"at\xE9",tipo:"data",class:"q-mt-sm"},null,8,["modelValue"])],64)),t(c,{modelValue:o.paginacao.limite,"onUpdate:modelValue":a[10]||(a[10]=l=>o.paginacao.limite=l),dense:"",min:"1",tipo:"quantidade",rotulo:"Quantidade por p\xE1gina",class:"q-mt-xl q-mb-lg"},null,8,["modelValue"])]),menuExtras:i(()=>[vt((M(),Y(mt,{onClick:s.downloadXmlDFeFiltrados,clickable:""},{default:i(()=>[t(Q,{avatar:""},{default:i(()=>[t(ct,{name:"download"})]),_:1}),t(Q,null,{default:i(()=>[t(nt,null,{default:i(()=>a[31]||(a[31]=[T("Download")])),_:1})]),_:1}),t(Vt,null,{default:i(()=>a[32]||(a[32]=[T("Download dos XML's filtrados")])),_:1})]),_:1},8,["onClick"])),[[Et]])]),itemLista:i(()=>[t(Pt,{bordered:"",class:"bg-white q-mb-xs rounded-borders",style:{"min-height":"calc(100vh - 200px)"}},{default:i(()=>[(M(!0),_t(kt,null,Tt(o.lista,l=>(M(),_t("div",{key:l.id,class:"itemHover"},[t(mt,{"manual-focus":"",class:"q-py-sm q-px-xs items-center"},{default:i(()=>[t(Q,{class:"hideonmobile col-auto q-px-sm no-margin"},{default:i(()=>[ft("div",wa,[t(e,{id:l.id,numero:l.numero,cor:"positive",escuro:""},null,8,["id","numero"])])]),_:2},1024),t(Q,{class:"col-md col-lg col-xl no-margin"},{default:i(()=>[t(mt,{class:"q-pa-none"},{default:i(()=>[t(Q,{onClick:v=>s.abrir(l.id),class:"col-auto items-center"},{default:i(()=>[t(m,{imagem:(o.contatos[l.idContato]||{}).imagem,rotulo:l.descricaoContato,tamanho:"40"},null,8,["imagem","rotulo"])]),_:2},1032,["onClick"]),t(Q,{class:"col"},{default:i(()=>[t(nt,{onClick:v=>s.abrir(l.id),lines:"2",class:"text-tertiary text-weight-bold ellipsis-2-lines"},{default:i(()=>[T(J(l.descricaoContato)+" ",1),t(Vt,{anchor:"bottom middle",self:"center middle"},{default:i(()=>a[33]||(a[33]=[T("Fornecedor")])),_:1})]),_:2},1032,["onClick"]),l.descricaoEmpresa?(M(),Y(nt,{key:0,onClick:v=>s.abrir(l.id),caption:""},{default:i(()=>[l.descricaoEmpresa?(M(),Y(b,{key:0,icon:"business 14px tertiary left"},{default:i(()=>[T(J(l.descricaoEmpresa)+" ",1),l.numeroDocumentoEmpresa?(M(),_t("span",Ia,"("+J(l.numeroDocumentoEmpresa)+")",1)):ot("",!0)]),_:2},1024)):ot("",!0)]),_:2},1032,["onClick"])):ot("",!0),t(mt,{class:"q-pa-none hideonmobile q-mt-xs",style:{"min-height":"unset"}},{default:i(()=>[l.notaNumero?(M(),Y(_,{key:0,cor:"tertiary",class:"mw50 text-center",escuro:""},{default:i(()=>[T(J(l.notaNumero)+" ",1),t(Vt,{anchor:"bottom middle",self:"center middle"},{default:i(()=>a[34]||(a[34]=[T("N\xFAmero da Nota")])),_:1})]),_:2},1024)):(M(),Y(_,{key:1,cor:"warning",class:"mw50 text-center",escuro:""},{default:i(()=>[a[36]||(a[36]=T(" S/N ")),t(Vt,{anchor:"bottom middle",self:"center middle"},{default:i(()=>a[35]||(a[35]=[T("N\xFAmero da Nota")])),_:1})]),_:1}))]),_:2},1024),t(Q,{class:"hideondesktop q-mt-sm"},{default:i(()=>[t(y,{mg:"xs-b"},{default:i(()=>[l.dataHoraEmissao?(M(),Y(f,{key:0,col:"shrink"},{default:i(()=>[t(b,{icon:"mdi-calendar-today xs tertiary left",tip:`Emitido \xE0s ${r.$filters.hora(l.dataHoraEmissao)}`},{default:i(()=>[T(J(r.$filters.data(l.dataHoraEmissao)),1)]),_:2},1032,["tip"])]),_:2},1024)):ot("",!0),l.dataHoraFinalizado?(M(),Y(f,{key:1,col:"shrink",class:"q-ml-sm"},{default:i(()=>[t(b,{icon:"mdi-calendar xs tertiary left",tip:`Finalizado \xE1s ${r.$filters.hora(l.dataHoraFinalizado)}`},{default:i(()=>[T(J(r.$filters.data(l.dataHoraFinalizado)),1)]),_:2},1032,["tip"])]),_:2},1024)):ot("",!0)]),_:2},1024),t(y,{mg:"xs-b"},{default:i(()=>[t(f,{col:"shrink"},{default:i(()=>[t(e,{id:l.id,numero:l.numero,cor:"positive",escuro:""},null,8,["id","numero"])]),_:2},1024),t(f,{col:"shrink",class:"q-ml-sm"},{default:i(()=>[l.notaNumero?(M(),Y(_,{key:0,cor:"tertiary",class:"mw50",escuro:""},{default:i(()=>[T(J(l.notaNumero)+" ",1),t(Vt,{anchor:"bottom middle",self:"center middle"},{default:i(()=>a[37]||(a[37]=[T("N\xFAmero da Nota")])),_:1})]),_:2},1024)):(M(),Y(_,{key:1,cor:"warning",class:"mw50",escuro:""},{default:i(()=>[a[39]||(a[39]=T(" S/N ")),t(Vt,{anchor:"bottom middle",self:"center middle"},{default:i(()=>a[38]||(a[38]=[T("N\xFAmero da Nota")])),_:1})]),_:1}))]),_:2},1024),t(f,{col:"shrink",class:"q-ml-sm"},{default:i(()=>[t(_,{rotulo:l.status,cor:l.status!=="Digita\xE7\xE3o"?"tertiary":"light",escuro:l.status!=="Digita\xE7\xE3o"},null,8,["rotulo","cor","escuro"])]),_:2},1024)]),_:2},1024),t(y,null,{default:i(()=>[t(f,{col:"shrink",text:"bold"},{default:i(()=>[T(J(r.$filters.numero(l.totalDocumento,2)),1)]),_:2},1024),vt(t(f,{col:"grow",text:"center",class:"q-ml-sm"},{default:i(()=>[T(J(l.qtdeContatos)+" Itens ",1)]),_:2},1536),[[xt,l.qtdeContatos>0]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),t(Q,{onClick:v=>s.abrir(l.id),class:"hideonmobile maxw110 q-pl-sm no-margin"},{default:i(()=>[this.tabSelecionada.valor==="Nota na SEFAZ"?(M(),_t(kt,{key:0},[l.dhRecbto?(M(),Y(nt,{key:0,lines:"1",color:"tertiary",class:"ellipsis"},{default:i(()=>[t(ct,{name:"mdi-calendar-today"}),T(" "+J(r.$filters.data(l.dhRecbto))+" ",1),t(Vt,{anchor:"bottom middle",self:"center middle"},{default:i(()=>[T(" Autorizado \xE0s "+J(r.$filters.hora(l.dhRecbto)),1)]),_:2},1024)]),_:2},1024)):ot("",!0)],64)):(M(),_t(kt,{key:1},[l.dataHoraEmissao?(M(),Y(nt,{key:0,lines:"1",color:"tertiary",class:"ellipsis"},{default:i(()=>[t(ct,{name:"mdi-calendar-today"}),T(" "+J(r.$filters.data(l.dataHoraEmissao))+" ",1),t(Vt,{anchor:"bottom middle",self:"center middle"},{default:i(()=>[T(" Emitido \xE0s "+J(r.$filters.hora(l.dataHoraEmissao)),1)]),_:2},1024)]),_:2},1024)):ot("",!0),l.dataHoraFinalizado?(M(),Y(nt,{key:1,lines:"1",color:"tertiary",class:"ellipsis"},{default:i(()=>[t(ct,{name:"mdi-calendar"}),T(" "+J(r.$filters.data(l.dataHoraFinalizado))+" ",1),t(Vt,{anchor:"bottom middle",self:"center middle"},{default:i(()=>[T(" Finalizado \xE1s "+J(r.$filters.hora(l.dataHoraFinalizado)),1)]),_:2},1024)]),_:2},1024)):ot("",!0)],64))]),_:2},1032,["onClick"]),t(Q,{onClick:v=>s.abrir(l.id),class:"hideonmobile maxw100 q-pl-sm no-margin"},{default:i(()=>[t(_,{cor:l.status!=="Digita\xE7\xE3o"?"tertiary":"light",escuro:l.status!=="Digita\xE7\xE3o",class:"col-auto q-mx-auto"},{default:i(()=>[T(J(l.status)+" ",1),t(Vt,{anchor:"bottom middle",self:"center middle"},{default:i(()=>a[40]||(a[40]=[T(" Status ")])),_:1})]),_:2},1032,["cor","escuro"])]),_:2},1032,["onClick"]),t(Q,{onClick:v=>s.abrir(l.id),class:"hideonmobile maxw120 q-pl-sm no-margin"},{default:i(()=>[t(nt,{class:"text-tertiary text-weight-bold text-right"},{default:i(()=>[T(J(r.$filters.numero(l.totalDocumento,2)),1)]),_:2},1024),vt(t(nt,{class:"text-tertiary text-right"},{default:i(()=>[T(J(l.qtdeContatos)+" Itens ",1)]),_:2},1536),[[xt,l.qtdeContatos>0]])]),_:2},1032,["onClick"]),t(Q,{class:"hideonmobile col-auto q-pl-sm no-margin"},{default:i(()=>[t(mt,{class:"q-pa-none"},{default:i(()=>[o.tabSelecionada.valor!=="Nota na SEFAZ"?(M(),Y(Q,{key:0,class:"no-margin"},{default:i(()=>[t(dt,{onClick:v=>s.abrir(l.id),icon:"edit",size:"md",color:"primary",round:"",flat:"",dense:""},null,8,["onClick"])]),_:2},1024)):ot("",!0),o.tabSelecionada.valor==="Nota na SEFAZ"?(M(),Y(Q,{key:1,class:"no-margin",style:{width:"33.6px"}},{default:i(()=>[l.status==="N\xE3o Importada"?(M(),Y(dt,{key:0,onClick:v=>s.importarXmlDFe(l.id),flat:"",round:"",dense:"",icon:"mdi-upload",size:"md",color:"tertiary",class:"buttons"},{default:i(()=>[t(Vt,{anchor:"bottom middle",self:"center middle"},{default:i(()=>a[41]||(a[41]=[T("Importar XML")])),_:1})]),_:2},1032,["onClick"])):ot("",!0)]),_:2},1024)):ot("",!0),["Nota na SEFAZ","Nota de Entrada"].includes(o.tabSelecionada.valor)?(M(),Y(Q,{key:2,class:"no-margin",style:{width:"33.6px"}},{default:i(()=>[t(dt,{onClick:v=>s.downloadXmlDFe(l.id,o.tabSelecionada.valor),flat:"",round:"",dense:"",icon:"mdi-download",color:"tertiary",size:"md",class:"buttons"},{default:i(()=>[t(Vt,{anchor:"bottom middle",self:"center middle"},{default:i(()=>a[42]||(a[42]=[T("Download XML")])),_:1})]),_:2},1032,["onClick"])]),_:2},1024)):ot("",!0),o.tabSelecionada.valor!=="Nota na SEFAZ"?(M(),Y(Q,{key:3,class:"no-margin"},{default:i(()=>[t(dt,{icon:"print",size:"md",color:"tertiary",round:"",flat:"",dense:""},{default:i(()=>[t(Lt,null,{default:i(()=>[vt((M(),Y(Pt,{link:"","no-border":"",separator:""},{default:i(()=>[(M(!0),_t(kt,null,Tt(o.configImpressao,v=>(M(),Y(mt,{key:v.valor,onClick:S=>r.$imprimir(v.valor,l.id),clickable:""},{default:i(()=>[t(Q,{avatar:""},{default:i(()=>[t(ct,{name:"print"})]),_:1}),t(Q,null,{default:i(()=>[t(nt,null,{default:i(()=>[T(J(v.texto),1)]),_:2},1024),v.observacao?(M(),Y(nt,{key:0,caption:""},{default:i(()=>[T(J(v.observacao),1)]),_:2},1024)):ot("",!0)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),(M(!0),_t(kt,null,Tt(o.configImpressaoPedidoCompra,v=>(M(),Y(mt,{key:v.valor,onClick:S=>s.imprimirPedidoCompra(v.valor,l==null?void 0:l.codigoDocumento),clickable:""},{default:i(()=>[t(Q,{avatar:""},{default:i(()=>[t(ct,{name:"print"})]),_:1}),t(Q,null,{default:i(()=>[t(nt,null,{default:i(()=>[T(J(v.texto),1)]),_:2},1024),v.observacao?(M(),Y(nt,{key:0,caption:""},{default:i(()=>[T(J(v.observacao),1)]),_:2},1024)):ot("",!0)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),t(mt,{onClick:v=>s.dialogImprimirEtiquetas({acao:"adicionar",item:l}),clickable:""},{default:i(()=>[t(Q,{avatar:""},{default:i(()=>[t(ct,{name:"print"})]),_:1}),t(Q,null,{default:i(()=>[t(nt,null,{default:i(()=>a[43]||(a[43]=[T(" Etiquetas ")])),_:1}),t(nt,{caption:""},{default:i(()=>a[44]||(a[44]=[T(" Adicionar \xE1 Fila ")])),_:1})]),_:1})]),_:2},1032,["onClick"]),t(mt,{onClick:v=>s.dialogImprimirEtiquetas({acao:"impressao",item:l}),clickable:""},{default:i(()=>[t(Q,{avatar:""},{default:i(()=>[t(ct,{name:"print"})]),_:1}),t(Q,null,{default:i(()=>[t(nt,null,{default:i(()=>a[45]||(a[45]=[T(" Etiquetas ")])),_:1}),t(nt,{caption:""},{default:i(()=>a[46]||(a[46]=[T(" Impress\xE3o Direta ")])),_:1})]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)),[[Et]])]),_:2},1024)]),_:2},1024)]),_:2},1024)):ot("",!0),o.tabSelecionada.valor!=="Nota na SEFAZ"?(M(),Y(Q,{key:4,class:"no-margin"},{default:i(()=>[t(dt,{icon:"more_vert",size:"md",color:"tertiary",round:"",flat:"",dense:""},{default:i(()=>[t(Lt,null,{default:i(()=>[vt((M(),Y(Pt,{link:"","no-border":"",separator:""},{default:i(()=>[o.tabSelecionada.valor!=="Nota na SEFAZ"?(M(),Y(mt,{key:0,onClick:v=>s.duplicarDocumento_click(l),clickable:""},{default:i(()=>[t(Q,{avatar:""},{default:i(()=>[t(ct,{name:"content_copy"})]),_:1}),t(Q,null,{default:i(()=>[t(nt,null,{default:i(()=>a[47]||(a[47]=[T(" Duplicar ")])),_:1})]),_:1})]),_:2},1032,["onClick"])):ot("",!0),o.tabSelecionada.valor!=="Nota na SEFAZ"?(M(),Y(mt,{key:1,onClick:v=>s.alterarPrevisaoEntrega_click(l),clickable:""},{default:i(()=>[t(Q,{avatar:""},{default:i(()=>[t(ct,{name:"local_shipping"})]),_:1}),t(Q,null,{default:i(()=>[t(nt,null,{default:i(()=>a[48]||(a[48]=[T("Alterar Previs\xE3o de Entrega")])),_:1})]),_:1})]),_:2},1032,["onClick"])):ot("",!0),o.tabSelecionada.valor!=="Nota na SEFAZ"?(M(),Y(mt,{key:2,onClick:v=>s.trocarCfop_click(l),clickable:""},{default:i(()=>[t(Q,{avatar:""},{default:i(()=>[t(ct,{name:"sync_alt"})]),_:1}),t(Q,null,{default:i(()=>[t(nt,null,{default:i(()=>a[49]||(a[49]=[T("Trocar CFOP para consumo")])),_:1})]),_:1})]),_:2},1032,["onClick"])):ot("",!0),ot("",!0)]),_:2},1024)),[[Et]])]),_:2},1024)]),_:2},1024)]),_:2},1024)):ot("",!0)]),_:2},1024)]),_:2},1024),t(Q,{class:"hideondesktop col-auto q-pl-sm no-margin"},{default:i(()=>[t(dt,{icon:"more_vert",size:"md",color:"tertiary",round:"",flat:"",dense:""},{default:i(()=>[t(Lt,null,{default:i(()=>[vt((M(),Y(Pt,{link:"","no-border":"",separator:""},{default:i(()=>[ot("",!0),o.tabSelecionada.valor!=="Nota na SEFAZ"?(M(),Y(mt,{key:1,onClick:v=>s.abrir(l.id),clickable:"",class:"itemHover"},{default:i(()=>[t(Q,{avatar:""},{default:i(()=>[t(ct,{name:"edit"})]),_:1}),t(Q,null,{default:i(()=>[t(nt,null,{default:i(()=>a[54]||(a[54]=[T(" Editar ")])),_:1})]),_:1})]),_:2},1032,["onClick"])):ot("",!0),o.tabSelecionada.valor==="Nota na SEFAZ"&&l.status==="N\xE3o Importada"?(M(),Y(mt,{key:2,onClick:v=>s.importarXmlDFe(l.id),clickable:"",class:"itemHover"},{default:i(()=>[t(Q,{avatar:""},{default:i(()=>[t(ct,{name:"mdi-upload"})]),_:1}),t(Q,null,{default:i(()=>[t(nt,null,{default:i(()=>a[55]||(a[55]=[T(" Importar XML ")])),_:1})]),_:1})]),_:2},1032,["onClick"])):ot("",!0),["Nota na SEFAZ","Nota de Entrada"].includes(o.tabSelecionada.valor)?(M(),Y(mt,{key:3,onClick:v=>s.downloadXmlDFe(l.id,o.tabSelecionada.valor),clickable:"",class:"itemHover"},{default:i(()=>[t(Q,{avatar:""},{default:i(()=>[t(ct,{name:"mdi-download"})]),_:1}),t(Q,null,{default:i(()=>[t(nt,null,{default:i(()=>a[56]||(a[56]=[T(" Download XML ")])),_:1})]),_:1})]),_:2},1032,["onClick"])):ot("",!0),o.tabSelecionada.valor!=="Nota na SEFAZ"?(M(!0),_t(kt,{key:4},Tt(o.configImpressao,v=>(M(),Y(mt,{key:v.valor,onClick:S=>r.$imprimir(v.valor,l.id),clickable:""},{default:i(()=>[t(Q,{avatar:""},{default:i(()=>[t(ct,{name:"print"})]),_:1}),t(Q,null,{default:i(()=>[t(nt,null,{default:i(()=>[T(J(v.texto),1)]),_:2},1024),v.observacao?(M(),Y(nt,{key:0,caption:""},{default:i(()=>[T(J(v.observacao),1)]),_:2},1024)):ot("",!0)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):ot("",!0),o.tabSelecionada.valor!=="Nota na SEFAZ"?(M(!0),_t(kt,{key:5},Tt(o.configImpressaoPedidoCompra,v=>(M(),Y(mt,{clickable:"",key:v.valor,onClick:S=>s.imprimirPedidoCompra(v.valor,l==null?void 0:l.codigoDocumento)},{default:i(()=>[t(Q,{avatar:""},{default:i(()=>[t(ct,{name:"print"})]),_:1}),t(Q,null,{default:i(()=>[t(nt,null,{default:i(()=>[T(J(v.texto),1)]),_:2},1024),v.observacao?(M(),Y(nt,{key:0,caption:""},{default:i(()=>[T(J(v.observacao),1)]),_:2},1024)):ot("",!0)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):ot("",!0),o.tabSelecionada.valor!=="Nota na SEFAZ"?(M(),Y(mt,{key:6,clickable:"",onClick:v=>s.dialogImprimirEtiquetas({acao:"adicionar",item:l})},{default:i(()=>[t(Q,{avatar:""},{default:i(()=>[t(ct,{name:"print"})]),_:1}),t(Q,null,{default:i(()=>[t(nt,null,{default:i(()=>a[57]||(a[57]=[T(" Etiquetas ")])),_:1}),t(nt,{caption:""},{default:i(()=>a[58]||(a[58]=[T(" Adicionar \xE1 Fila ")])),_:1})]),_:1})]),_:2},1032,["onClick"])):ot("",!0),o.tabSelecionada.valor!=="Nota na SEFAZ"?(M(),Y(mt,{key:7,clickable:"",onClick:v=>s.dialogImprimirEtiquetas({acao:"impressao",item:l})},{default:i(()=>[t(Q,{avatar:""},{default:i(()=>[t(ct,{name:"print"})]),_:1}),t(Q,null,{default:i(()=>[t(nt,null,{default:i(()=>a[59]||(a[59]=[T(" Etiquetas ")])),_:1}),t(nt,{caption:""},{default:i(()=>a[60]||(a[60]=[T(" Impress\xE3o Direta ")])),_:1})]),_:1})]),_:2},1032,["onClick"])):ot("",!0),o.tabSelecionada.valor!=="Nota na SEFAZ"?(M(),Y(mt,{key:8,onClick:v=>s.duplicarDocumento_click(l),clickable:"",class:"itemHover"},{default:i(()=>[t(Q,{avatar:""},{default:i(()=>[t(ct,{name:"content_copy"})]),_:1}),t(Q,null,{default:i(()=>[t(nt,null,{default:i(()=>a[61]||(a[61]=[T(" Duplicar ")])),_:1})]),_:1})]),_:2},1032,["onClick"])):ot("",!0),o.tabSelecionada.valor!=="Nota na SEFAZ"?(M(),Y(mt,{key:9,onClick:v=>s.alterarPrevisaoEntrega_click(l),clickable:""},{default:i(()=>[t(Q,{avatar:""},{default:i(()=>[t(ct,{name:"local_shipping"})]),_:1}),t(Q,null,{default:i(()=>[t(nt,null,{default:i(()=>a[62]||(a[62]=[T("Alterar Previs\xE3o de Entrega")])),_:1})]),_:1})]),_:2},1032,["onClick"])):ot("",!0),o.tabSelecionada.valor!=="Nota na SEFAZ"?(M(),Y(mt,{key:10,onClick:v=>s.trocarCfop_click(l),clickable:""},{default:i(()=>[t(Q,{avatar:""},{default:i(()=>[t(ct,{name:"sync_alt"})]),_:1}),t(Q,null,{default:i(()=>[t(nt,null,{default:i(()=>a[63]||(a[63]=[T("Trocar CFOP para consumo")])),_:1})]),_:1})]),_:2},1032,["onClick"])):ot("",!0)]),_:2},1024)),[[Et]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),t(ue)]))),128))]),_:1})]),_:1},8,["busca","onAtualizar","onLimparFiltrosClick","onCriarClick","lista","tabSelecionada","tabs","tabSelecionada2","tabs2","paginacao","mostrar"]),t(C,{ref:"comprasFicha",onAtualizar:s.atualizar,onDialogImprimirEtiquetas:s.dialogImprimirEtiquetas},null,8,["onAtualizar","onDialogImprimirEtiquetas"]),t(g,{ref:"comprasImportacaoXML",onAtualizar:s.atualizar,onConcluirImportacao:s.concluirImportacao},null,8,["onAtualizar","onConcluirImportacao"]),t($t,{modelValue:o.modalXMLNotaEntrada,"onUpdate:modelValue":a[15]||(a[15]=l=>o.modalXMLNotaEntrada=l),persistent:""},{default:i(()=>[t(jt,{container:"",class:"bg-light",style:{height:"40vh",width:"50vw","max-width":"100vw"}},{default:i(()=>[ft("form",{onSubmit:a[14]||(a[14]=Fe((...l)=>s.importarXmlNotaDeEntrada&&s.importarXmlNotaDeEntrada(...l),["prevent"]))},[t(Ht,null,{default:i(()=>[t(Nt,null,{default:i(()=>[vt(t(dt,{onClick:s.fecharXmlNotaDeEntrada,flat:"",round:"",dense:"",icon:"close"},null,8,["onClick"]),[[Et]]),t(Rt,null,{default:i(()=>a[64]||(a[64]=[T("Importar XML Nota de Entrada")])),_:1}),t(dt,{color:"white","text-color":"primary",label:"Enviar",type:"submit",unelevated:""})]),_:1})]),_:1}),t(Zt,{class:"u-container"},{default:i(()=>[t(Xt,{style:{"min-height":"300px"}},{default:i(()=>{var l,v,S;return[ft("div",Ca,[t(ze,{class:"col-12","hide-upload-btn":"","auto-upload":"",factory:s.adicionarXml,filter:D=>D.filter(P=>P.type==="text/xml")},null,8,["factory","filter"]),t(ge,{modelValue:o.xmlDevolucao,"onUpdate:modelValue":a[12]||(a[12]=D=>o.xmlDevolucao=D),label:"Devolu\xE7\xE3o"},null,8,["modelValue"]),t(ge,{modelValue:o.xmlEstrangeiro,"onUpdate:modelValue":a[13]||(a[13]=D=>o.xmlEstrangeiro=D),label:"Importa\xE7\xE3o do exterior"},null,8,["modelValue"])]),Object.keys((S=(v=(l=o.xmlNotaEntrada.error)==null?void 0:l.data)==null?void 0:v.fields)!=null?S:{}).length?(M(),_t("div",ka,[ft("ul",Sa,[(M(!0),_t(kt,null,Tt(Object.keys(o.xmlNotaEntrada.error.data.fields),D=>(M(),_t("li",{key:D},[ft("span",null,J(D),1),ft("span",null,J(o.xmlNotaEntrada.error.data.fields[D]),1)]))),128))])])):ot("",!0)]}),_:1})]),_:1})],32)]),_:1})]),_:1},8,["modelValue"]),t($t,{modelValue:o.modalPrevisaoEntrega.visivel,"onUpdate:modelValue":a[18]||(a[18]=l=>o.modalPrevisaoEntrega.visivel=l),"content-css":{minWidth:"50vw"}},{default:i(()=>[t(Ne,null,{default:i(()=>[t(Nt,{class:"bg-primary text-white"},{default:i(()=>[t(Rt,null,{default:i(()=>a[65]||(a[65]=[T("Alterar Previs\xE3o de Entrega")])),_:1}),vt(t(dt,{dense:"",flat:"",icon:"close",round:""},null,512),[[Et]])]),_:1}),t(Te,null,{default:i(()=>[t(oe,{onSubmit:s.alterarPrevisaoEntrega},{default:i(()=>[t(u,{class:"q-col-gutter-md"},{default:i(()=>[ft("div",Ea,[t(ie,{modelValue:o.modalPrevisaoEntrega.dataPrevistaEntrega,"onUpdate:modelValue":a[16]||(a[16]=l=>o.modalPrevisaoEntrega.dataPrevistaEntrega=l),type:"date",label:"Data Prevista de Entrega",clearable:"",dense:"","stack-label":"",borderless:""},null,8,["modelValue"])]),ft("div",Da,[t(ie,{modelValue:o.modalPrevisaoEntrega.horaPrevistaEntrega,"onUpdate:modelValue":a[17]||(a[17]=l=>o.modalPrevisaoEntrega.horaPrevistaEntrega=l),type:"time",label:"Hora Prevista de Entrega",clearable:"",dense:"","stack-label":"",borderless:""},null,8,["modelValue"])])]),_:1}),ft("div",Va,[vt(t(dt,{color:"tertiary",flat:"",label:"Cancelar"},null,512),[[Et]]),t(dt,{color:"primary",class:"q-ml-sm no-shadow",unelevated:"",label:"Alterar",type:"submit"})])]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t($t,{modelValue:o.dialogEtiquetas.impressao,"onUpdate:modelValue":a[24]||(a[24]=l=>o.dialogEtiquetas.impressao=l)},{default:i(()=>[t(jt,{container:"",view:"hHh LpR fFf",class:"bg-white rounded-borders",style:{height:"100%","max-height":"425px"}},{default:i(()=>[t(oe,{onSubmit:a[23]||(a[23]=l=>s.imprimirEtiquetas(o.modeloSelecionado)),autocorrect:"off",autocapitalize:"off",autocomplete:"off",spellcheck:"false",novalidate:""},{default:i(()=>[t(Ht,null,{default:i(()=>[t(Nt,{class:"bg-primary text-white"},{default:i(()=>[t(Rt,null,{default:i(()=>[t(ct,{name:"mdi-tag-plus",size:"sm",class:"q-mr-sm"}),a[66]||(a[66]=T(" Imprimir Etiquetas "))]),_:1})]),_:1})]),_:1}),t(Zt,null,{default:i(()=>[t(Xt,{class:"q-pa-md"},{default:i(()=>[t(b,{class:"q-pb-lg"},{default:i(()=>{var l,v,S,D,P,O,q,j,A,Z,at,E,B;return[a[67]||(a[67]=T(" Imprimir os itens: ")),ft("strong",null,J((l=o.tabSelecionada)==null?void 0:l.valor)+" "+J((S=(v=o.dialogEtiquetas)==null?void 0:v.item)!=null&&S.numero?", #"+((P=(D=o.dialogEtiquetas)==null?void 0:D.item)==null?void 0:P.numero):"")+" "+J((q=(O=o.dialogEtiquetas)==null?void 0:O.item)!=null&&q.descricaoContato?" - "+((A=(j=o.dialogEtiquetas)==null?void 0:j.item)==null?void 0:A.descricaoContato):"")+" "+J((at=(Z=o.dialogEtiquetas)==null?void 0:Z.item)!=null&&at.notaNumero?", Nota #"+((B=(E=o.dialogEtiquetas)==null?void 0:E.item)==null?void 0:B.notaNumero):""),1),a[68]||(a[68]=T(". "))]}),_:1}),t(c,{modelValue:o.modeloSelecionado,"onUpdate:modelValue":a[19]||(a[19]=l=>o.modeloSelecionado=l),opcoes:o.opcoesModelo,dense:"",filled:"",tipo:"seletor",rotulo:"Modelo",cor:"white","popup-content-class":"etiquetas-modelo-selecionado",class:"q-field--with-bottom"},null,8,["modelValue","opcoes"]),t(c,{modelValue:o.empresaSelecionada,"onUpdate:modelValue":a[20]||(a[20]=l=>o.empresaSelecionada=l),opcoes:o.opcoesEmpresas,dense:"",filled:"",clearable:"",tipo:"seletor",rotulo:"Empresa",color:"tertiary",class:"q-field--with-bottom"},null,8,["modelValue","opcoes"]),t(c,{modelValue:o.tabelaPrecoSelecionada,"onUpdate:modelValue":a[21]||(a[21]=l=>o.tabelaPrecoSelecionada=l),opcoes:o.opcoesTabelasPreco,dense:"",filled:"",clearable:"",tipo:"seletor",rotulo:"Tabela de Pre\xE7o",color:"tertiary",class:"q-field--with-bottom"},null,8,["modelValue","opcoes"]),t(c,{modelValue:o.emBranco,"onUpdate:modelValue":a[22]||(a[22]=l=>o.emBranco=l),min:0,tipo:"quantidade",dense:"",filled:"",rotulo:"Etiquetas em branco",color:"tertiary","text-color":"red"},null,8,["modelValue"])]),_:1})]),_:1}),t(Yt,{class:"bg-light"},{default:i(()=>[t(Nt,null,{default:i(()=>[t(re),vt(t(dt,{label:"Cancelar",color:"tertiary",flat:"",class:"q-mr-sm"},null,512),[[Et]]),t(dt,{label:"Confirmar",color:"primary",type:"submit",unelevated:""})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t($t,{modelValue:o.dialogEtiquetas.adicionar,"onUpdate:modelValue":a[26]||(a[26]=l=>o.dialogEtiquetas.adicionar=l)},{default:i(()=>[t(jt,{container:"",view:"hHh LpR fFf",class:"bg-white rounded-borders",style:{height:"100%","max-height":"250px"}},{default:i(()=>[t(oe,{onSubmit:s.adicionarEtiquetas,autocorrect:"off",autocapitalize:"off",autocomplete:"off",spellcheck:"false",novalidate:""},{default:i(()=>[t(Ht,null,{default:i(()=>[t(Nt,{class:"bg-primary text-white"},{default:i(()=>[t(Rt,null,{default:i(()=>[t(ct,{name:"mdi-tag-plus",size:"sm",class:"q-mr-sm"}),a[69]||(a[69]=T(" Adicionar os itens a lista de etiquetas "))]),_:1})]),_:1})]),_:1}),t(Zt,null,{default:i(()=>[t(Xt,{class:"q-pa-md"},{default:i(()=>[t(b,{class:"q-pb-lg"},{default:i(()=>{var l,v,S,D,P,O,q,j,A,Z,at,E,B;return[a[70]||(a[70]=T(" Adicionar os itens: ")),ft("strong",null,J((l=o.tabSelecionada)==null?void 0:l.valor)+" "+J((S=(v=o.dialogEtiquetas)==null?void 0:v.item)!=null&&S.numero?", #"+((P=(D=o.dialogEtiquetas)==null?void 0:D.item)==null?void 0:P.numero):"")+" "+J((q=(O=o.dialogEtiquetas)==null?void 0:O.item)!=null&&q.descricaoContato?" - "+((A=(j=o.dialogEtiquetas)==null?void 0:j.item)==null?void 0:A.descricaoContato):"")+" "+J((at=(Z=o.dialogEtiquetas)==null?void 0:Z.item)!=null&&at.notaNumero?", Nota #"+((B=(E=o.dialogEtiquetas)==null?void 0:E.item)==null?void 0:B.notaNumero):""),1),a[71]||(a[71]=T(" \xE0 lista de etiquetas para impress\xE3o. "))]}),_:1}),t(c,{modelValue:o.dialogEtiquetas.limpar,"onUpdate:modelValue":a[25]||(a[25]=l=>o.dialogEtiquetas.limpar=l),tipo:"logico",rotulo:"Limpar lista de etiquetas anterior."},null,8,["modelValue"])]),_:1})]),_:1}),t(Yt,{class:"bg-light"},{default:i(()=>[t(Nt,null,{default:i(()=>[t(re),vt(t(dt,{label:"Cancelar",color:"tertiary",flat:"",class:"q-mr-sm"},null,512),[[Et]]),t(dt,{label:"Confirmar",color:"primary",type:"submit",unelevated:""})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])])}var Aa=se(_a,[["render",Pa]]);export{Aa as default};
