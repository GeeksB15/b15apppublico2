import{_ as H,r as C,o as g,d as v,w as t,f as o,A as ie,h as B,i as ee,k as p,O as ce,d6 as Te,p as E,q as xe,t as P,Q as _,aU as te,H as O,N as Y,D as oe,E as ae,z as w,dL as Ce,as as Le,dY as Je,bh as Re,v as be,b3 as de,di as Ne,cJ as Xe,e as k,F as z,x as L,Y as Ye,$ as We,dj as Be,a1 as Ze,a3 as $e,bO as eo,b2 as oo,bU as se,aX as ao,bI as ze,I as ue,J as me,C as A,j as F,m as Q,bf as to,L as Ae,dg as pe,a_ as Ke,a$ as le,b4 as lo,b5 as ne,K as Ie,at as io,bq as _e,M as qe,G as ke,n as De,dS as ro,dZ as so,b6 as Se,d4 as no,d5 as uo,l as G,dc as Ee,P as he,S as j,T as I,U as W,W as ge,cS as mo,B as fe,cF as co,be as Ge,aN as we,X as Oe}from"./index.1c77f2de.js";import{L as po}from"./Lista.ee6a025f.js";import{i as fo}from"./importarArquivoXlsx.d84b8127.js";import{g as Ue,a as Me,b as Pe}from"./g-label.2cbc7470.js";import{c as go}from"./codigosANP.a6c1a264.js";import{S as bo}from"./SeletorCfop.9e202f77.js";import{J as Qe}from"./JsonViewer.f37ff750.js";import{X as ve}from"./xlsx.13b223e3.js";const ho={descricao:{maxlength:"50",rotulo:"Descri\xE7\xE3o",tipo:"texto"},idContato:{rotulo:"Nome fornecedor",tipo:"texto"},referencia:{maxlength:"30",rotulo:"Refer\xEAncia",tipo:"texto"}},vo={idItemUtilizado:{rotulo:"Produto para composi\xE7\xE3o",tipo:"texto"},ordem:{max:"9999",min:"0",rotulo:"Ordem",tipo:"quantidade"},quantidade:{min:"0",rotulo:"Quantidade",tipo:"decimal",decimals:"4"},temporario:{total:{readonly:!0,rotulo:"Total",tipo:"decimal",decimals:"2"},unidade:{disable:!0,readonly:!0,rotuloFixo:"Unidade",tipo:"texto"},valor:{readonly:!0,rotulo:"Valor",tipo:"decimal",decimals:"2"}}},Vo={descricao:{maxlength:"8000",rotulo:"Descri\xE7\xE3o",tipo:"texto"},idItemEquipamento:{rotulo:"Equipamento",tipo:"texto"},idItemFerramenta:{rotulo:"Ferramenta",tipo:"texto"},idItemServico:{rotulo:"Servico",tipo:"texto"},ordem:{max:"9999",min:"0",rotulo:"Ordem",tipo:"quantidade"}},Co={descricao:{maxlength:"150",rotulo:"Descri\xE7\xE3o"},especificacao:{maxlength:"150",rotulo:"Especifica\xE7\xE3o"},limites:{maxlength:"150",rotulo:"Limites"}},yo={altura:{rotulo:"Altura",tipo:"decimal",decimals:"0"},armacaoCor:{rotuloFixo:"Cor",tipo:"seletor"},armacaoMaterial:{rotuloFixo:"Material",tipo:"seletor"},diagonal:{rotulo:"Diagonal",tipo:"decimal",decimals:"0"},genero:{class:"col-12 col-md-6",rotuloFixo:"G\xEAnero",tipo:"seletor"},haste:{rotulo:"Haste",tipo:"decimal",decimals:"0"},modelo:{maxlength:"100",rotulo:"Modelo",tipo:"texto"},ponte:{rotulo:"Ponte",tipo:"decimal",decimals:"0"},largura:{maxlength:"100",rotulo:"Largura",tipo:"texto"},tipoMontagem:{rotuloFixo:"Tipo de montagem",tipo:"seletor"}},qo={aplicacao:{maxlength:"10000",rotulo:"Aplica\xE7\xE3o",rows:"2",tipo:"textoArea"},capacidade:{rotulo:"Capacidade",tipo:"decimal",decimals:"2"},capacidadeUnidade:{class:"col-12 col-md-3",maxlength:"20",rotulo:"Un. Capacidade",tipo:"texto"},codigoOrigem:{rotuloFixo:"Origem",tipo:"seletor",tipo2:"numerico"},densidade:{rotulo:"Densidade",tipo:"decimal",decimals:"2"},embalagem:{class:"col-12 col-md-3",maxlength:"255",rotulo:"Embalagem",tipo:"texto"},garantiaDescricao:{maxlength:"255",rotulo:"Garantia descri\xE7\xE3o",tipo:"texto"},garantiaDias:{class:"col-12 col-md-4",min:"0",max:"9999",rotulo:"Garantia (dias)",tipo:"quantidade"},grupo:{rotuloFixo:"Grupo",tipo:"seletor"},idPerfilContabil:{class:"col-12 col-md-4",rotulo:"Perfil cont\xE1bil",tipo:"seletor"},altura:{rotulo:"Altura",tipo:"decimal",decimals:"2"},largura:{rotulo:"Largura",tipo:"decimal",decimals:"2"},comprimento:{rotulo:"Comprimento",tipo:"decimal",decimals:"2"},observacao:{maxlength:"10000",rotulo:"Observa\xE7\xE3o",rows:"4",tipo:"textoArea"},peso:{rotulo:"Peso",tipo:"decimal",decimals:"2"},subGrupo:{rotuloFixo:"Subgrupo",tipo:"seletor"},unidade:{rotuloFixo:"Unidade",tipo:"seletor"},unidade__:{valorInicial:"UN"},validadeMeses:{class:"col-12 col-md-3",min:"0",max:"9999",rotulo:"Validade (meses)",tipo:"decimal",decimals:"2"}},ko={consumoMedio:{min:"0",rotulo:"Consumo m\xE9dio",tipo:"decimal",decimals:"2"},local:{maxlength:"20",rotulo:"Local",tipo:"texto"},quantidadeMinimaCompra:{min:"0",rotulo:"Qtde compra reposi\xE7\xE3o",tipo:"decimal",decimals:"2"},quantidadeMinimaEstoque:{min:"0",rotulo:"Estoque m\xEDnimo",tipo:"decimal",decimals:"2"},tempoMedioReposicao:{min:"0",rotulo:"Tempo m\xE9dio reposi\xE7\xE3o (dias)",tipo:"quantidade"}},wo={codigoBarras:{errorMessage:"Deve ter 12 ou 13 d\xEDgitos",maxlength:"13",rotulo:"C\xF3digo de barras (GTIN ou EAN)",tipo:"texto"},descricao:{errorMessage:"O nome deve ter pelo menos 2 caracteres",maxlength:"500",rotulo:"Nome do produto",tipo:"texto"},marca:{rotuloFixo:"Marca",tipo:"seletor"},fabricante:{rotuloFixo:"Fabricante",tipo:"seletor"},ncm:{maxlength:"8",rotulo:"NCM",tipo:"texto"},catalogo:{maxlength:"8",rotulo:"Cat\xE1logo Fabricante",tipo:"texto"},percentualMarkup:{rotulo:"Lucro %",tipo:"decimal",decimals:"2"},referencia:{errorMessage:"Refer\xEAncia deve ser \xFAnica",maxlength:"30",rotulo:"Refer\xEAncia",tipo:"texto"},tipo:{rotuloFixo:"Tipo",tipo:"seletor"},utilizaComposicaoValorReposicao:{tipo:"logico"},utilizaMarkup:{tipo:"logico"},valorCustoReposicao:{rotulo:"Custo de reposi\xE7\xE3o",tipo:"decimal",decimals:"2"},valorVenda:{rotulo:"Valor de venda",tipo:"decimal",decimals:"2"}},xo={adicaoFinal:{rotulo:"at\xE9",tipo:"decimal",decimals:"2"},adicaoInicial:{rotulo:"Adi\xE7\xE3o",tipo:"decimal",decimals:"2"},alturaMinima:{rotulo:"Altura m\xEDnima",tipo:"decimal",decimals:"0"},cilindrico:{rotulo:"Cil\xEDndrico",tipo:"decimal",decimals:"2"},cor:{rotuloFixo:"Cor",tipo:"seletor"},diametro:{rotulo:"Di\xE2metro",tipo:"decimal",decimals:"0"},eixo:{rotulo:"Eixo",tipo:"decimal",decimals:"2"},eixoFinal:{rotulo:"at\xE9",tipo:"decimal",decimals:"2"},esfericoFinal:{rotulo:"at\xE9",tipo:"decimal",decimals:"2"},esfericoInicial:{rotulo:"Esf\xE9rico",tipo:"decimal",decimals:"2"},geometria:{rotulo:"Geometria",tipo:"seletor"},indiceRefracao:{rotulo:"\xCDndice refra\xE7\xE3o",tipo:"decimal",decimals:"2"},lenteTipo:{rotulo:"Tipo de lente",tipo:"seletor"},material:{rotuloFixo:"Material",tipo:"seletor"},RB1:{rotulo:"RB1",tipo:"decimal",decimals:"2"},RB2:{rotulo:"RB2",tipo:"decimal",decimals:"2"},surfacada:{rotulo:"Pronta ou surfa\xE7ada",tipo:"seletor"}},Io={procedimento:{maxlength:"10000",rotuloFixo:"Procedimento",rows:"3",tipo:"textoArea"},numeroPop:{maxlength:"50",rotulo:"N\xFAmero Pop",tipo:"texto"}},So={ativo:{tipo:"logico"},consumoMedioReal:{tipo:"quantidade"},percentualMarkupReal:{tipo:"decimal",decimals:"2"},quantidadeDisponivel:{tipo:"quantidade"},tempoMedioReposicaoReal:{tipo:"quantidade"},utilizaComposicaoPedido:{tipo:"logico"},valorCusto:{tipo:"decimal",decimals:"2"},valorCustoMedio:{tipo:"decimal",decimals:"2"},valorCustoUltimo:{tipo:"decimal",decimals:"2"}},ye={composicao:{lista:vo},fornecedor:{lista:ho},producaoFase:{lista:Vo},qualidade:{lista:Co},...yo,...qo,...ko,...wo,...xo,...So,...Io},_o={alterados:0,arquivo:null,cor:"text-negative",corFinal:"",erro:"",erros:0,incluidos:0,listaErros:[],mensagem:"",mensagemFinal:"",modalResultado:!1},Eo={data(){return{visivel:!1,importar:$utils.clonarV2(_o)}},methods:{beforeShow(){this.importar.arquivo=null,this.importar.mensagem="",this.importar.mensagemFinal="",this.importar.erro=""},hide(){this.visivel=!1},async prepareFile(l){const e=r=>new Promise((n,a)=>{const i=new FileReader;i.readAsBinaryString(r),i.onload=()=>n(i.result),i.onerror=m=>a(m)});try{const r=await e(l[0]);await this.importarArquivo(r),this.hide(),this.$q.notify({type:"positive",message:"Importa\xE7\xE3o realizada com sucesso"})}catch(r){this.importar.erro="Ocorreu erro ao importar produtos",this.$q.notifyError(this.importar.erro,r)}},templateDownload(){window.open("/statics/downloads/B15-Importar-ou-Atualizar-Produtos.xlsx","_self")},async importarArquivo(l){try{this.importar.modalResultado=!0,this.importar.mensagem="Carregando o arquivo .xlsx",this.importarLista=await $erp().item.toArray();const e={Item:ye,ItemFornecedor:ye.fornecedor.lista};await fo(l,e,this.importarCallbackParcial,this.importarCallbackErro,this.importarCallbackFinal)}catch(e){e.name&&e.name==="ErroValidacao"?(this.importar.erro=e.message,this.$q.notifyError(e.message,e)):(this.importar.erro="Ocorreu erro ao importar arquivo xlsx",this.$q.notifyError(this.importar.erro,e))}},async importarCallbackErro(l,e){this.importar.erros++,this.importar.listaErros.push({linha:l,mensagem:e})},async importarCallbackFinal(l){this.importar.incluidos+this.importar.alterados>0?this.importar.erros>0?(this.importar.corFinal="bg-warning",this.importar.mensagemFinal="Importa\xE7\xE3o realizada parcialmente!"):(this.importar.corFinal="bg-positive text-white",this.importar.mensagemFinal="Importa\xE7\xE3o conclu\xEDda com sucesso!"):this.importar.erros>0?(this.importar.corFinal="text-negative",this.importar.mensagemFinal="Importa\xE7\xE3o n\xE3o realizada!"):(this.importar.corFinal="bg-warning",this.importar.mensagemFinal="Importa\xE7\xE3o n\xE3o realizada!")},acertarFornecedores(l){for(const e of l.atual.fornecedor||[])e.id=$utils.uuid(),e.idItem=l.atual.id;for(const e of l.original.fornecedor||[]){let r=l.atual.fornecedor.find(n=>(n.idContato||"")===(e.idContato||"")&&(n.descricao||"")===(e.descricao||"")&&(n.referencia||"")===(e.referencia||""));r?r.id=e.id:l.atual.fornecedor.push(e)}},acertarCEST(l={}){const e=l.atual;if(!e)return;let r=(e.cest||"").replace(/\D/g,"").replace(/^(\d{2})(\d{3})(\d{2})/g,"$1.$2.$3").substr(0,9);e.cest=r&&r.length===9?r:""},acertarNCM(l={}){const e=l.atual;if(!e)return;const r=(e.ncm||"").replace(/\D/g,"").substr(0,8);e.ncm=r&&r.length===8?r:""},async importarCallbackParcial(l){const e=l.Item[0];l.ItemFornecedor&&(e.fornecedor=l.ItemFornecedor);const r=l.chaves.length>0?i=>l.chaves.reduce((m,s)=>m&&i[s]===e[s],!0):i=>!1,n=this.importarLista.filter(r);if(e.referencia){const i=this.importarLista.filter(m=>m.referencia===e.referencia);if(i.length>1)throw new $utils.ErroValidacao(`Refer\xEAncia deve ser \xFAnica (${e.referencia})`);if(i.length===1){if(n.length===0)throw new $utils.ErroValidacao(`Refer\xEAncia deve ser \xFAnica (${e.referencia})`);if(i[0].id!==n[0].id)throw new $utils.ErroValidacao(`Refer\xEAncia deve ser \xFAnica (${e.referencia})`)}}const a=$utils.dataAtual();if(n.length===0){const i={...$db.item.vazio,dataCadastro:a,_DataHoraUltimaAlteracao:a,...e,id:$utils.uuid()};let m={atual:i,original:{}};this.acertarNCM(m),this.acertarCEST(m),this.acertarFornecedores(m),await $db.item.grava(m),this.importarLista.push(i),this.importar.incluidos++}else if(n.length===1){let i=await $db.item.leCompleto(n[0].id);e.id=i.atual.id,Object.assign(i.atual,e),this.acertarNCM(i),this.acertarCEST(i),this.acertarFornecedores(i),await $db.item.grava(i),this.importar.alterados++}else{const i=l.chaves.map(m=>m+": "+e[m]).join(", ");throw new $utils.ErroValidacao(`Existem ${n.length} produtos no banco com a chave (${i})`)}}}};function Uo(l,e,r,n,a,i){const m=C("row");return g(),v(oe,{onBeforeShow:i.beforeShow,onHide:i.hide,modelValue:a.visivel,"onUpdate:modelValue":e[0]||(e[0]=s=>a.visivel=s)},{default:t(()=>[o(ie,{style:{width:"425px"}},{default:t(()=>[o(B,{class:"bg-primary text-white"},{default:t(()=>[o(ee,null,{default:t(()=>e[1]||(e[1]=[p(" Importar Produtos ")])),_:1})]),_:1}),o(ce,{class:"q-pa-md"},{default:t(()=>[o(Te,{factory:i.prepareFile,"hide-upload-btn":"","auto-upload":"",flat:"",bordered:"",label:"Selecione o arquivo (.xlsx)",color:"light","text-color":"tertiary",style:{width:"100%"}},null,8,["factory"]),a.importar.erro?(g(),E("div",{key:0,class:xe(["row","q-pa-sm",a.importar.cor])},P(a.importar.erro),3)):(g(),v(m,{key:1,class:"q-mt-md justify-center"},{default:t(()=>[o(_,{onClick:i.templateDownload,icon:"cloud_download",color:"primary",flat:"",label:"Baixar arquivo modelo (.xlsx)"},null,8,["onClick"])]),_:1}))]),_:1}),o(B,{class:"bg-light border-top"},{default:t(()=>[o(te),O(o(_,{label:"Fechar",flat:"",color:"tertiary",class:"q-ml-sm"},null,512),[[Y]])]),_:1})]),_:1})]),_:1},8,["onBeforeShow","onHide","modelValue"])}var Mo=H(Eo,[["render",Uo]]);const Po={data(){return{visivel:!1,campos:{marca:"",grupo:"",unidade:"",subgrupo:"",ncm:""},atualizado:{marca:"",grupo:"",unidade:"",subgrupo:"",ncm:""},opcoesMarca:[],opcoesSubgrupo:[],opcoesGrupo:[],opcoesUnidade:[],opcoesNcm:[]}},emits:["atualizar"],methods:{meta(){return ye},adicionarMarca(){this.atualizado.marca=this.campos.marca},async leOpcoesMarca(){this.opcoesMarca=(await $db.item.leValoresUnicos("marca",this.campos.marca)).map(l=>({rotulo:l,valor:l}))},async salvarMarca(){const e=(await $db.item.leNew()).filter(n=>n.marca===this.campos.marca);let r=$utils.clonarV2(e);r.map(n=>{n.marca=this.atualizado.marca});try{for(let n=0;n<e.length;n++){let a=e[n],i=r[n];$db.item.gravaItem({original:a,atual:i})}}catch(n){this.$q.notifyError("Erro ao alterar marca"),console.log(n)}this.$q.notifyPositive("Marca alterada com sucesso em "+e.length+" itens."),this.campos.marca="",this.atualizado.marca=""},adicionarGrupo(){this.atualizado.grupo=this.campos.grupo},async leOpcoesGrupo(){this.opcoesGrupo=(await $db.item.leValoresUnicos("grupo",this.campos.grupo)).map(l=>({rotulo:l,valor:l}))},async salvarGrupo(){const e=(await $db.item.leNew()).filter(n=>n.grupo===this.campos.grupo);let r=$utils.clonarV2(e);r.map(n=>{n.grupo=this.atualizado.grupo});try{for(let n=0;n<e.length;n++){let a=e[n],i=r[n];$db.item.gravaItem({original:a,atual:i})}}catch(n){this.$q.notifyError("Erro ao alterar grupo"),console.log(n)}this.$q.notifyPositive("Grupo alterado com sucesso em "+e.length+" itens."),this.campos.grupo="",this.atualizado.grupo=""},adicionarSubgrupo(){this.atualizado.subgrupo=this.campos.subgrupo},async leOpcoesSubgrupo(){this.opcoesSubgrupo=(await $db.item.leValoresUnicos("subGrupo",this.campos.subgrupo)).map(l=>({rotulo:l,valor:l}))},async salvarSubgrupo(){const e=(await $db.item.leNew()).filter(n=>n.subGrupo===this.campos.subgrupo);let r=$utils.clonarV2(e);r.map(n=>{n.subGrupo=this.atualizado.subgrupo});try{for(let n=0;n<e.length;n++){let a=e[n],i=r[n];$db.item.gravaItem({original:a,atual:i})}}catch(n){this.$q.notifyError("Erro ao alterar subgrupo"),console.log(n)}this.$q.notifyPositive("Subgrupo alterado com sucesso em "+e.length+" itens."),this.campos.subgrupo="",this.atualizado.subgrupo=""},adicionarUnidade(){this.atualizado.unidade=this.campos.unidade},async leOpcoesUnidade(){this.opcoesUnidade=(await $db.item.leValoresUnicos("unidade",this.campos.unidade)).map(l=>({rotulo:l,valor:l}))},async salvarUnidade(){const e=(await $db.item.leNew()).filter(n=>n.unidade===this.campos.unidade);let r=$utils.clonarV2(e);r.map(n=>{n.unidade=this.atualizado.unidade});try{for(let n=0;n<e.length;n++){let a=e[n],i=r[n];$db.item.gravaItem({original:a,atual:i})}}catch(n){this.$q.notifyError("Erro ao alterar unidade"),console.log(n)}this.$q.notifyPositive("Unidade alterado com sucesso em "+e.length+" itens."),this.campos.unidade="",this.atualizado.unidade=""},adicionarNcm(){this.atualizado.ncm=this.campos.ncm},async leOpcoesNcm(){this.opcoesNcm=(await $db.item.leValoresUnicos("ncm",this.campos.ncm)).map(l=>({rotulo:l,valor:l}))},async salvarNcm(){const e=(await $db.item.leNew()).filter(n=>n.ncm===this.campos.ncm);let r=$utils.clonarV2(e);r.map(n=>{n.ncm=this.atualizado.ncm});try{for(let n=0;n<e.length;n++){let a=e[n],i=r[n];$db.item.gravaItem({original:a,atual:i})}}catch(n){this.$q.notifyError("Erro ao alterar ncm"),console.log(n)}this.$q.notifyPositive("NCM alterado com sucesso em "+e.length+" itens."),this.campos.ncm="",this.atualizado.ncm=""},concluir(){this.atualizado.marca&&this.salvarMarca(),this.atualizado.grupo&&this.salvarGrupo(),this.atualizado.subgrupo&&this.salvarSubgrupo(),this.atualizado.unidade&&this.salvarUnidade(),this.atualizado.ncm&&this.salvarNcm(),this.limparCampos(),this.visivel=!1,this.$emit("atualizar")},fechar(){this.limparCampos(),this.visivel=!1},limparCampos(){this.campos.unidade="",this.atualizado.unidade="",this.campos.subgrupo="",this.atualizado.subgrupo="",this.campos.grupo="",this.atualizado.grupo="",this.campos.marca="",this.atualizado.marca="",this.campos.ncm="",this.atualizado.ncm=""}},created(){this.limparCampos()}};function zo(l,e,r,n,a,i){const m=C("g-col"),s=C("campo"),f=C("g-row");return g(),v(oe,{modelValue:a.visivel,"onUpdate:modelValue":e[10]||(e[10]=h=>a.visivel=h)},{default:t(()=>[o(ie,null,{default:t(()=>[o(ae,null,{default:t(()=>[o(B,{class:"bg-primary text-white"},{default:t(()=>[o(ee,null,{default:t(()=>e[11]||(e[11]=[p("Editar")])),_:1})]),_:1}),o(ce,{class:"q-pb-lg"},{default:t(()=>[o(f,{gutter:"sm",justify:"between"},{default:t(()=>[o(m,{col:"12",text:"tertiary bold"},{default:t(()=>e[12]||(e[12]=[p("Marca")])),_:1}),o(m,null,{default:t(()=>[o(s,w({modelValue:a.campos.marca,"onUpdate:modelValue":[e[0]||(e[0]=h=>a.campos.marca=h),i.adicionarMarca],onClick:i.leOpcoesMarca},i.meta.marca,{opcoes:a.opcoesMarca,after:[{icon:"search"}],filter:"",rotulo:"De",tipo:"seletor","popup-content-class":"editarMarcaPopup"}),null,16,["modelValue","onClick","onUpdate:modelValue","opcoes"])]),_:1}),o(m,null,{default:t(()=>[o(s,{modelValue:a.atualizado.marca,"onUpdate:modelValue":e[1]||(e[1]=h=>a.atualizado.marca=h),rotulo:"Para"},null,8,["modelValue"])]),_:1}),o(m,{col:"shrink"},{default:t(()=>[o(_,{unelevated:"",color:"primary",label:"Trocar",onClick:i.salvarMarca},null,8,["onClick"])]),_:1}),o(m,{col:"12",text:"tertiary bold",class:"q-mt-md"},{default:t(()=>e[13]||(e[13]=[p("Grupo")])),_:1}),o(m,null,{default:t(()=>[o(s,w({modelValue:a.campos.grupo,"onUpdate:modelValue":[e[2]||(e[2]=h=>a.campos.grupo=h),i.adicionarGrupo],onClick:i.leOpcoesGrupo},i.meta.grupo,{opcoes:a.opcoesGrupo,after:[{icon:"search"}],tipo:"seletor",rotulo:"De",filter:"","popup-content-class":"editarMarcaPopup"}),null,16,["modelValue","onClick","onUpdate:modelValue","opcoes"])]),_:1}),o(m,null,{default:t(()=>[o(s,{modelValue:a.atualizado.grupo,"onUpdate:modelValue":e[3]||(e[3]=h=>a.atualizado.grupo=h),rotulo:"Para"},null,8,["modelValue"])]),_:1}),o(m,{col:"shrink"},{default:t(()=>[o(_,{unelevated:"",color:"primary",label:"Trocar",onClick:i.salvarGrupo},null,8,["onClick"])]),_:1}),o(m,{col:"12",text:"tertiary bold",class:"q-mt-md"},{default:t(()=>e[14]||(e[14]=[p("Subgrupo")])),_:1}),o(m,null,{default:t(()=>[o(s,w({modelValue:a.campos.subgrupo,"onUpdate:modelValue":[e[4]||(e[4]=h=>a.campos.subgrupo=h),i.adicionarSubgrupo],onClick:i.leOpcoesSubgrupo},i.meta.subgrupo,{opcoes:a.opcoesSubgrupo,after:[{icon:"search"}],rotulo:"De",filter:"",tipo:"seletor","popup-content-class":"editarMarcaPopup"}),null,16,["modelValue","onUpdate:modelValue","onClick","opcoes"])]),_:1}),o(m,null,{default:t(()=>[o(s,{modelValue:a.atualizado.subgrupo,"onUpdate:modelValue":e[5]||(e[5]=h=>a.atualizado.subgrupo=h),rotulo:"Para"},null,8,["modelValue"])]),_:1}),o(m,{col:"shrink"},{default:t(()=>[o(_,{unelevated:"",color:"primary",label:"Trocar",onClick:i.salvarSubgrupo},null,8,["onClick"])]),_:1}),o(m,{col:"12",text:"tertiary bold",class:"q-mt-md"},{default:t(()=>e[15]||(e[15]=[p("Unidade")])),_:1}),o(m,null,{default:t(()=>[o(s,w({modelValue:a.campos.unidade,"onUpdate:modelValue":[e[6]||(e[6]=h=>a.campos.unidade=h),i.adicionarUnidade],onClick:i.leOpcoesUnidade},i.meta.unidade,{opcoes:a.opcoesUnidade,after:[{icon:"search"}],tipo:"seletor",rotulo:"De",filter:"","popup-content-class":"editarMarcaPopup"}),null,16,["modelValue","onClick","onUpdate:modelValue","opcoes"])]),_:1}),o(m,null,{default:t(()=>[o(s,{modelValue:a.atualizado.unidade,"onUpdate:modelValue":e[7]||(e[7]=h=>a.atualizado.unidade=h),rotulo:"Para"},null,8,["modelValue"])]),_:1}),o(m,{col:"shrink"},{default:t(()=>[o(_,{unelevated:"",color:"primary",label:"Trocar",onClick:i.salvarUnidade},null,8,["onClick"])]),_:1}),o(m,{col:"12",text:"tertiary bold",class:"q-mt-md"},{default:t(()=>e[16]||(e[16]=[p("NCM")])),_:1}),o(m,null,{default:t(()=>[o(s,w({modelValue:a.campos.ncm,"onUpdate:modelValue":[e[8]||(e[8]=h=>a.campos.ncm=h),i.adicionarNcm],onClick:i.leOpcoesNcm},i.meta.ncm,{opcoes:a.opcoesNcm,after:[{icon:"search"}],tipo:"seletor",rotulo:"De",filter:"","popup-content-class":"editarMarcaPopup"}),null,16,["modelValue","onClick","onUpdate:modelValue","opcoes"])]),_:1}),o(m,null,{default:t(()=>[o(s,{modelValue:a.atualizado.ncm,"onUpdate:modelValue":e[9]||(e[9]=h=>a.atualizado.ncm=h),rotulo:"Para"},null,8,["modelValue"])]),_:1}),o(m,{col:"shrink"},{default:t(()=>[o(_,{unelevated:"",color:"primary",label:"Trocar",onClick:i.salvarNcm},null,8,["onClick"])]),_:1})]),_:1})]),_:1}),o(B,{class:"bg-light border-top"},{default:t(()=>[o(te),o(_,{onClick:i.fechar,label:"Fechar",flat:"",color:"tertiary"},null,8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}var Ao=H(Po,[["render",zo]]);const Do={data(){return{visivel:!1,descricao:"",tipo:"",opcoesTipo:[]}},methods:{async criar(){try{this.$q.loading.show();const l={...$db.item.vazio,id:$utils.uuid(),descricao:(this.descricao||"").trim(),tipo:this.tipo};await $db.item.grava({atual:l}),this.resolve(l),this.visivel=!1}catch(l){$q.notifyError("Ocorreu erro ao adicionar Produto",l)}finally{$q.loading.hide()}},onHide(){this.resolve({})},show(){return this.opcoesTipo=Ce,this.tipo=this.opcoesTipo[0].valor,this.descricao="",this.texto="",this.erro="",this.visivel=!0,new Promise((l,e)=>{this.resolve=l})}}};function Oo(l,e,r,n,a,i){const m=C("campo");return g(),v(oe,{modelValue:a.visivel,"onUpdate:modelValue":e[2]||(e[2]=s=>a.visivel=s),onHide:e[3]||(e[3]=s=>i.onHide())},{default:t(()=>[o(ie,{style:{width:"425px"}},{default:t(()=>[o(ae,{onSubmit:i.criar},{default:t(()=>[o(B,{class:"bg-primary text-white"},{default:t(()=>[o(ee,null,{default:t(()=>e[4]||(e[4]=[p("Cadastrar produto")])),_:1})]),_:1}),o(ce,null,{default:t(()=>[o(m,{modelValue:a.descricao,"onUpdate:modelValue":e[0]||(e[0]=s=>a.descricao=s),rules:[s=>!!s.trim()||"Campo obrigat\xF3rio"],rotulo:"Descri\xE7\xE3o",ajuda:"Descri\xE7\xE3o do produto",autofocus:"",class:"q-mb-md"},null,8,["modelValue","rules"]),o(m,{modelValue:a.tipo,"onUpdate:modelValue":e[1]||(e[1]=s=>a.tipo=s),opcoes:a.opcoesTipo,rotulo:"Tipo",tipo:"seletor",class:"q-mb-lg","popup-content-class":"itemCriarTipoPopup"},null,8,["modelValue","opcoes"])]),_:1}),o(B,{class:"bg-light border-top"},{default:t(()=>[o(te),O(o(_,{label:"Cancelar",color:"tertiary",flat:""},null,512),[[Y]]),o(_,{label:"Criar",color:"primary",unelevated:"",type:"submit",class:"q-ml-sm"})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])}var jo=H(Do,[["render",Oo]]);const Fo={data(){return{modal:{}}},methods:{limparModal(){this.modal={visivel:!1,campos:{},optsParceiro:[],optsSincronismo:[{label:"Ativar os itens filtrados",value:"exportarFiltrados"},{label:"Ativar os itens da p\xE1gina atual",value:"exportarPaginaAtual"},{label:"Importar",value:"importar"},{label:"Exportar Estoque (todos os itens)",value:"exportarEstoque"}]}},continuar(){~["exportarFiltrados","exportarPaginaAtual"].indexOf(this.modal.campos.direcaoSincronismo)&&this.exportar(),this.modal.campos.direcaoSincronismo==="importar"&&this.importar(),this.modal.campos.direcaoSincronismo==="exportarEstoque"&&this.exportarEstoque()},async exportar(){var r,n;const l=this.eCommerce.find(a=>a.id===this.modal.campos.parceiro);let e;this.modal.campos.direcaoSincronismo==="exportarFiltrados"&&(e=await $db.item.ler({filtros:this.filtros,somenteDadosIndexados:!0})),this.modal.campos.direcaoSincronismo==="exportarPaginaAtual"&&(e=await $db.item.ler({filtros:this.filtros,limit:this.limit,page:this.page,sort:this.sort}));for(const a of(r=e==null?void 0:e.data)!=null?r:[]){const i=(n=await $db.item.ler({filtros:{id:a.id}}))==null?void 0:n.data[0],m=(await $db.itemECommerce.ler({idItem:i.id,idECommerce:l.id}))[0];let s=$utils.clonarV2(m);s&&!s.valorVendaAtivo&&(s.valorVenda=i.valorVenda||0),s||(s={id:$utils.uuid(),idECommerce:l.id,idItem:i.id,idItemNoECommerce:"",descricao:i.descricao,valorVenda:i.valorVenda,valorVendaAtivo:!1,json:JSON.stringify({})}),s.ativo=!0;try{$q.loading.show({message:`<code>Exportando...${i.id.slice(-6)}
                <br />
                ${i.descricao.slice(0,15)+(i.descricao.length>15?"...":"")}</code>`,html:!0,boxClass:"bg-grey-2 text-grey-9",spinnerColor:"primary"});const f=await $db.integracaoECommerce[l.parceiro.toLowerCase()].enviarItem({eCommerce:l,itemECommerce:s,itemGeeks:i});if(!(f!=null&&f.id))continue;s.idItemNoECommerce=f==null?void 0:f.id,await $db.itemECommerce.gravar({atual:s,original:m})}catch(f){console.error(f)}}this.limparModal(),$q.loading.hide()},toDataUrl(l,e){const r=new XMLHttpRequest;r.onload=function(){const n=new FileReader;n.onloadend=function(){e(n.result)},n.readAsDataURL(r.response)},r.open("GET",l),r.responseType="blob",r.send()},async exportarEstoque(){try{$q.loading.show();const l=this.eCommerce.find(r=>r.id===this.modal.campos.parceiro),e=await $db.integracaoECommerce[l.parceiro.toLowerCase()].exportarEstoque();e!=null&&e.idLote&&$q.notify({message:`Lote ${e.idLote} para altera\xE7\xE3o de estoque gerado com sucesso`,type:"positive"}),this.limparModal()}finally{$q.loading.hide()}},async importar(){var e,r,n,a,i,m,s,f,h,u,V,S,x,y,Z,$;const l=this.eCommerce.find(T=>T.id===this.modal.campos.parceiro);if(l.parceiro==="Uappi")try{$q.loading.show();const T=await $db.integracaoECommerce.uappi.obterCategorias({idECommerce:l.id}),K=await $db.integracaoECommerce.uappi.obterMarcas({idECommerce:l.id}),R=100;let d=!0,q=0;for(;d;){const b=await $db.integracaoECommerce.uappi.obterItem({idECommerce:l.id,offset:q,limit:100});q=q+R;for(const c of b.produtos){$q.loading.show({message:`<code>Importando...${c.sku.slice(-6)}
                  <br />
                  ${c.nome.slice(0,15)+(c.nome.length>15?"...":"")}</code>`,html:!0,boxClass:"bg-grey-2 text-grey-9",spinnerColor:"primary"});const M=(await $db.item.ler({filtros:{referencia:c.sku}})).data[0];if(M!=null&&M.id){const J=(await $db.itemECommerce.ler({idItem:M.id,idECommerce:l.id}))[0];let U;J!=null&&J.id&&(U=$utils.clonar(J)),U||(U={id:$utils.uuid(),idECommerce:l.id,idItem:M.id,json:JSON.stringify({})}),U.idItemNoECommerce=c.id,U.descricao=c.nome,U.valorVenda=c.precos.precoPor,U.valorVendaAtivo=!0,await $db.itemECommerce.gravar({atual:U,original:J})}else{const J={id:$utils.uuid(),referencia:c.sku,descricao:c.nome,tipo:(((e=T.find(X=>X.id===c.idCategoria))==null?void 0:e.nome)||"").trim(),marca:(((r=K.find(X=>X.id===c.idMarca))==null?void 0:r.nome)||"").trim(),valorVenda:c.precos.precoPor,peso:c.dimensoes.peso},U=(n=c.midias.imagens[0])==null?void 0:n.url;U&&await new Promise((X,D)=>{this.toDataUrl(U,function(re){J.imagem=re,X()})});const N={id:$utils.uuid(),idECommerce:l.id,idItem:J.id,idItemNoECommerce:c.id,descricao:J.descricao,valorVenda:J.valorVenda,valorVendaAtivo:!1,ativo:!0,json:JSON.stringify({})};await $db.item.gravaItem({atual:J}),await $db.itemECommerce.gravar({atual:N})}}b.produtos.length<R&&(d=!1)}}catch(T){console.log(T)}finally{$q.loading.hide()}if(l.parceiro==="Tray"){let T;$q.loading.show(),T=await $db.item.ler({filtros:{ativo:!0},somenteDadosIndexados:!0});for(const K of(a=T==null?void 0:T.data)!=null?a:[])try{const R=(i=await $db.item.ler({filtros:{id:K.id}}))==null?void 0:i.data[0],d=(await $db.itemECommerce.ler({idItem:R.id,idECommerce:l.id}))[0];let q=$utils.clonarV2(d);if(T=await $db.integracaoECommerce.tray.obterItem({itemGeeks:R,itemECommerce:q,eCommerce:l}),!(T!=null&&T.id))continue;$q.loading.show({message:`<code>Importando...${R.id.slice(-6)}
                  <br />
                  ${R.descricao.slice(0,15)+(R.descricao.length>15?"...":"")}</code>`,html:!0,boxClass:"bg-grey-2 text-grey-9",spinnerColor:"primary"}),q||(q={id:$utils.uuid(),idECommerce:l.id,idItem:R.id,json:JSON.stringify({})}),q.idItemNoECommerce=T.id,q.descricao=T[l.json.sincronismo.dePara.descricao],q.valorVenda=T[l.json.sincronismo.dePara.valorVenda],q.valorVendaAtivo=!0,await $db.itemECommerce.gravar({atual:q,original:d})}catch(R){console.error(R)}try{const K=await $db.integracaoECommerce.tray.obterCategorias({eCommerce:l}),R=$db.integracaoECommerce.tray.getTiposGeeksCategoriasTray();T=await $db.integracaoECommerce.tray.obterItens({eCommerce:l});for(const d of T){const q=(await $db.itemECommerce.ler({idItemNoECommerce:d.id}))[0];if(!$utils.clonarV2(q)){let c,M;const J=(s=(m=K.find(N=>N.id===d.all_categories[0]))==null?void 0:m.name)!=null?s:"";for(const N of Object.keys(R))if(R[N]===J){M=N;break}const U={id:$utils.uuid(),tipo:M};for(const N of Object.keys(l.json.sincronismo.dePara)){if(N==="codigoItem")continue;const X=l.json.sincronismo.dePara[N],D=(h=(f=l.json.sincronismo.deParaTipo)==null?void 0:f[N])!=null?h:"string";if(~X.indexOf("Properties.")){const re=X.split(".")[1];if(!(re in d.Properties))continue;D==="string"&&(U[N]=String(d.Properties[re]).trim()),D==="number"&&(U[N]=(u=Number(d.Properties[re]))!=null?u:0),D==="boolean"&&(U[N]=d.Properties[re]==="1");continue}D==="string"&&(U[N]=String((V=d[X])!=null?V:"").trim()),D==="number"&&(U[N]=(S=Number(d[X]))!=null?S:0),D==="boolean"&&(U[N]=d[X]==="1")}U.peso=$utils.arredondar((Number(d.weight)||0)/1e3,3),U.comprimento=$utils.arredondar((Number(d.length)||0)*10,2),U.altura=Number((x=d.Properties)==null?void 0:x["Altura da Arma\xE7\xE3o"])||0,U.altura||(U.altura=$utils.arredondar((Number(d.height)||0)*10,2)),U.largura=Number((y=d.Properties)==null?void 0:y["Largura da Arma\xE7\xE3o"])||0,U.largura||(U.largura=$utils.arredondar((Number(d.width)||0)*10,2)),$q.loading.show({message:`<code>Importando...${U.id.slice(-6)}
                  <br />
                  ${U.descricao.slice(0,15)+(U.descricao.length>15?"...":"")}</code>`,html:!0,boxClass:"bg-grey-2 text-grey-9",spinnerColor:"primary"}),($=(Z=d==null?void 0:d.ProductImage)==null?void 0:Z[0])!=null&&$.http&&await new Promise((N,X)=>{this.toDataUrl(d.ProductImage[0].http,function(D){U.imagem=D,N()})}),c={id:$utils.uuid(),idECommerce:l.id,idItem:U.id,idItemNoECommerce:d.id,descricao:U.descricao,valorVenda:U.valorVenda,valorVendaAtivo:!1,ativo:!0,json:JSON.stringify({})},await $db.item.gravaItem({atual:U}),await $db.itemECommerce.gravar({atual:c})}}}catch(K){console.error(K)}$q.loading.hide()}this.limparModal()},async show(l){var e;try{const{filtros:r,limit:n,page:a,sort:i}=l!=null?l:{};let m;this.filtros=r,this.limit=n,this.page=a,this.sort=i,this.limparModal(),this.modal.campos.direcaoSincronismo="exportarFiltrados",m=await $db.eCommerce.ler(),m.sort((s,f)=>new Date(s.dataHoraCriacao)<new Date(f.dataHoraCriacao)?-1:1);for(const s of m)!s.ativo||(s.json=JSON.parse(s.json),this.modal.optsParceiro.push({label:s.descricao,value:s.id}));this.eCommerce=m,this.modal.campos.parceiro=(e=this.modal.optsParceiro[0])==null?void 0:e.value,this.modal.visivel=!0}catch(r){$q.notifyError("Erro ao consultar dados de e-commerce",r)}}}};function To(l,e,r,n,a,i){return g(),v(oe,{modelValue:a.modal.visivel,"onUpdate:modelValue":e[2]||(e[2]=m=>a.modal.visivel=m)},{default:t(()=>[o(ie,{style:{width:"425px"}},{default:t(()=>[o(ae,{onSubmit:i.continuar},{default:t(()=>[o(B,{class:"bg-primary text-white"},{default:t(()=>[o(ee,null,{default:t(()=>e[3]||(e[3]=[p("e-Commerce")])),_:1})]),_:1}),o(ce,null,{default:t(()=>[o(Le,{modelValue:a.modal.campos.parceiro,"onUpdate:modelValue":e[0]||(e[0]=m=>a.modal.campos.parceiro=m),options:a.modal.optsParceiro,"emit-value":"","map-options":"",dense:"","transition-show":"jump-up","transition-hide":"jump-up",hint:"Parceiro",class:"q-mb-md","popup-content-class":"'sincEcommerceParceiroPopup'"},null,8,["modelValue","options"]),o(Je,{modelValue:a.modal.campos.direcaoSincronismo,"onUpdate:modelValue":e[1]||(e[1]=m=>a.modal.campos.direcaoSincronismo=m),options:a.modal.optsSincronismo,type:"radio"},null,8,["modelValue","options"])]),_:1}),o(B,{class:"bg-light border-top"},{default:t(()=>[o(te),O(o(_,{label:"Cancelar",color:"tertiary",flat:""},null,512),[[Y]]),o(_,{label:"continuar",color:"primary",unelevated:"",type:"submit",class:"text-white q-ml-sm"})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])}var Lo=H(Fo,[["render",To]]);const Ro={name:"ModalCombinarItens",components:{PromptItemV2:Re},data(){return{visivel:!1,itemCombinado:{origem:{},destino:{},prompt:{origem:!1,destino:!1}}}},emits:["atualizar"],methods:{async combinarItens(){$q.dialog({title:"Tem certeza?",message:"Ao continuar voc\xEA ir\xE1 combinar todas as informa\xE7\xF5es dos dois produtos em apenas um produto.",cancel:{label:"Cancelar",push:!0,color:"tertiary",flat:!0},ok:{label:"Combinar",push:!0,class:"bg-primary",textColor:"white",flat:!0}}).onOk(async()=>{try{await $utils.geeksApi({combinarProdutos:{funcao:"0FE624BB-1D3C-4D37-8F47-D303AAC8B98E",idItemCombinar:this.itemCombinado.destino.id,idItemRemover:this.itemCombinado.origem.id}})}catch(l){this.limparCampos(),this.$q.notifyError("Ocorreu um erro ao combinar produtos",l);return}finally{this.fechar(),this.$emit("atualizar")}}).onCancel(()=>{this.fechar()})},async selecionarCombinarItensOrigem(l){for(let e in l)this.itemCombinado.origem=l[e].item},async selecionarCombinarItensDestino(l){for(let e in l)this.itemCombinado.destino=l[e].item},limparCampos(){this.itemCombinado.origem={},this.itemCombinado.destino={}},fechar(){this.limparCampos(),this.visivel=!1}}};function No(l,e,r,n,a,i){const m=C("g-label"),s=C("PromptItemV2");return g(),v(oe,{modelValue:a.visivel,"onUpdate:modelValue":e[7]||(e[7]=f=>a.visivel=f)},{default:t(()=>[o(ie,{class:"no-padding",style:{width:"425px"}},{default:t(()=>[o(ae,{onSubmit:i.combinarItens},{default:t(()=>[o(B,{class:"bg-primary text-white"},{default:t(()=>[o(ee,null,{default:t(()=>e[8]||(e[8]=[p(" Combinar Produtos ")])),_:1})]),_:1}),o(ce,{class:"q-pa-lg"},{default:t(()=>[o(be,{modelValue:a.itemCombinado.origem.descricao,"onUpdate:modelValue":e[0]||(e[0]=f=>a.itemCombinado.origem.descricao=f),onClick:e[1]||(e[1]=f=>a.itemCombinado.prompt.origem=!0),color:"primary",placeholder:"Pegar dados de",dense:"",class:"q-mb-lg",hint:a.itemCombinado.origem.tipo?`Tipo: ${a.itemCombinado.origem.tipo}`:""},null,8,["modelValue","hint"]),o(be,{modelValue:a.itemCombinado.destino.descricao,"onUpdate:modelValue":e[2]||(e[2]=f=>a.itemCombinado.destino.descricao=f),onClick:e[3]||(e[3]=f=>a.itemCombinado.prompt.destino=!0),color:"primary",placeholder:"Transferir para",dense:"",hint:a.itemCombinado.destino.tipo?`Tipo: ${a.itemCombinado.destino.tipo}`:""},null,8,["modelValue","hint"]),O(o(m,{text:"caption",color:"text-red",bg:"bg-red-1","rounded-borders":"",class:"q-pa-md q-mt-lg"},{default:t(()=>e[9]||(e[9]=[p(" Produtos selecionados devem ter tipos iguais para combina\xE7\xE3o. ")])),_:1},512),[[de,a.itemCombinado.origem.tipo&&a.itemCombinado.destino.tipo&&a.itemCombinado.origem.tipo!==a.itemCombinado.destino.tipo]])]),_:1}),o(B,{class:"bg-light border-top"},{default:t(()=>[o(te),o(_,{onClick:e[4]||(e[4]=f=>i.fechar()),label:"Cancelar",color:"tertiary",flat:"",class:"q-ml-sm"}),o(_,{type:"submit",label:"Combinar",color:"primary",unelevated:"",class:"q-ml-sm",disabled:a.itemCombinado.origem.tipo!==a.itemCombinado.destino.tipo},null,8,["disabled"])]),_:1})]),_:1},8,["onSubmit"])]),_:1}),o(s,{modelValue:a.itemCombinado.prompt.origem,"onUpdate:modelValue":e[5]||(e[5]=f=>a.itemCombinado.prompt.origem=f),filtro:{ativo:!0},onSelecionarItens:i.selecionarCombinarItensOrigem,mensagemAddItem:"Item origem a ser combinado."},null,8,["modelValue","onSelecionarItens"]),o(s,{modelValue:a.itemCombinado.prompt.destino,"onUpdate:modelValue":e[6]||(e[6]=f=>a.itemCombinado.prompt.destino=f),filtro:{ativo:!0},onSelecionarItens:i.selecionarCombinarItensDestino,mensagemAddItem:"Item destino a ser combinado."},null,8,["modelValue","onSelecionarItens"])]),_:1},8,["modelValue"])}var Bo=H(Ro,[["render",No]]);const Ko={props:{label:String},data(){return{alterarDescricao:!1,alterarValorCusto:!1,alterarValorVenda:!1,visivel:!1}},methods:{fecharModal(){this.visivel=!1},opcaoConfirma(){const l={alterarDescricao:this.alterarDescricao,alterarValorCusto:this.alterarValorCusto,alterarValorVenda:this.alterarValorVenda};this.$emit("opcaoSelecionada",l)}}};function Go(l,e,r,n,a,i){const m=C("g-label"),s=C("campo");return g(),v(oe,{modelValue:a.visivel,"onUpdate:modelValue":e[3]||(e[3]=f=>a.visivel=f),persistent:""},{default:t(()=>[o(ie,{style:{width:"425px"}},{default:t(()=>[o(B,{class:"bg-primary text-white"},{default:t(()=>[o(ee,null,{default:t(()=>e[4]||(e[4]=[p(" Importar informa\xE7\xF5es ")])),_:1})]),_:1}),o(ce,null,{default:t(()=>[o(m,{text:"sub1",class:"q-mt-sm q-mb-md"},{default:t(()=>[p(P(r.label),1)]),_:1}),o(s,{modelValue:a.alterarDescricao,"onUpdate:modelValue":e[0]||(e[0]=f=>a.alterarDescricao=f),tipo:"logico",rotulo:"Descri\xE7\xE3o",class:"q-mb-lg"},null,8,["modelValue"]),o(s,{modelValue:a.alterarValorCusto,"onUpdate:modelValue":e[1]||(e[1]=f=>a.alterarValorCusto=f),tipo:"logico",rotulo:"Valor de Custo",class:"q-mb-lg"},null,8,["modelValue"]),o(s,{modelValue:a.alterarValorVenda,"onUpdate:modelValue":e[2]||(e[2]=f=>a.alterarValorVenda=f),tipo:"logico",rotulo:"Valor de Venda",class:"q-mb-sm"},null,8,["modelValue"])]),_:1}),o(B,{class:"bg-light border-top"},{default:t(()=>[o(te),O(o(_,{label:"Cancelar",color:"tertiary",flat:""},null,512),[[Y]]),O(o(_,{onClick:i.opcaoConfirma,label:"Continuar",color:"primary",unelevated:"",class:"q-ml-sm"},null,8,["onClick"]),[[Y]])]),_:1})]),_:1})]),_:1},8,["modelValue"])}var He=H(Ko,[["render",Go]]);const Qo={data(){return{visivel:!1}},methods:{trocarFoto(l){Ne(l[0],{crop:!0,outputFormat:"jpg",targetHeight:200,targetWidth:200},(e,r)=>{this.resolve(r),this.visivel=!1})},onHide(){this.resolve()},async show(){return this.visivel=!0,new Promise((l,e)=>{this.resolve=l})}},props:{modelValue:{type:String}}};function Ho(l,e,r,n,a,i){return g(),v(oe,{modelValue:a.visivel,"onUpdate:modelValue":e[0]||(e[0]=m=>a.visivel=m),onHide:e[1]||(e[1]=m=>i.onHide())},{default:t(()=>[o(ie,null,{default:t(()=>[o(B,null,{default:t(()=>[o(ee,null,{default:t(()=>e[2]||(e[2]=[p("Alterar foto")])),_:1}),O(o(_,{dense:"",flat:"",icon:"close",round:""},null,512),[[Y]])]),_:1}),o(Te,{"auto-expand":"",color:"none",extensions:".jpg,.jpeg",label:"Foto","hide-upload-button":"","hide-upload-progress":"","dark-light":"",url:"",ref:"fotoCampo",factory:i.trocarFoto},null,8,["factory"])]),_:1})]),_:1},8,["modelValue"])}var Jo=H(Qo,[["render",Ho]]);const Xo={components:{"g-row":Ue,"g-col":Me,"g-label":Pe},data(){return{descricaoECommerce:{},itemECommerce:[],loading:!1}},methods:{async atualizar(){var l;try{let e;this.permissaoFicha=await $db.permissao.objeto("item//ficha"),this.eCommerce=await $db.eCommerce.ler(),e=await $db.itemECommerce.ler({idItem:this.item.id}),e=e.filter(r=>this.eCommerce.some(n=>n.id===r.idECommerce)),this.itemECommerceOriginal=$utils.clonarV2(e);for(const r of this.eCommerce){if(!r.ativo){const n=e.findIndex(a=>a.idECommerce===r.id);n>=0&&e.splice(n,1);continue}r.json=JSON.parse((l=r.json)!=null?l:null),this.descricaoECommerce[r.id]=r.descricao,!e.some(n=>n.idECommerce===r.id)&&e.push({id:$utils.uuid(),idECommerce:r.id,idItem:this.item.id,idItemNoECommerce:"",descricao:"",valorVenda:0,valorVendaAtivo:!1,ativo:!1,json:JSON.stringify({})})}e.sort((r,n)=>new Date(r.dataHoraCriacao)<new Date(n.dataHoraCriacao)?-1:1),e.forEach(r=>{r.json=JSON.parse(r.json)}),this.itemECommerce=e;for(const r of this.itemECommerce)this.importarDadosECommerce(r).catch(n=>{console.error(n)})}catch(e){this.$q.notifyError("Erro ao consultar dados de e-commerce",e)}},async ativo_onClick(l){if(l.ativo)try{$q.loading.show(),await this.importarDadosECommerce(l)}catch(e){this.$q.notifyError(e.message)}finally{$q.loading.hide()}},valorVendaAtivo_onClick(l){l.valorVendaAtivo||(l.valorVenda=this.item.valorVenda)},async importarDadosECommerce(l){const e=this.eCommerce.find(r=>r.id===l.idECommerce);if(e.parceiro==="Tray"){let r;try{if(l.ativo&&!l.idItemNoECommerce){$q.loading.hide();try{await new Promise((n,a)=>{this.$q.dialog({title:"Tem certeza?",message:"Caso o produto j\xE1 exista no e-commerce, insira o ID no campo espec\xEDfico antes de habilit\xE1-lo, assim voc\xEA evita duplicar o produto em seu e-commerce.",cancel:{label:"CANCELAR",push:!0,color:"tertiary",flat:!0},ok:{label:"CONTINUAR SEM ID",push:!0,class:"bg-info",textColor:"white",flat:!0}}).onOk(()=>{n()}).onCancel(()=>{a()})})}catch{l.ativo=!1;return}$q.loading.show()}r=await $db.integracaoECommerce.tray.obterItem({itemGeeks:this.item,itemECommerce:l,eCommerce:e})}catch{throw l.ativo=!1,new Error("Erro ao consultar dados de e-commerce")}r||(l.descricao=this.item.descricao,l.valorVenda=this.item.valorVenda,l.idItemNoECommerce=""),r&&(l.valorVendaAtivo&&(l.valorVenda=Number(r[e.json.sincronismo.dePara.valorVenda])||0),l.descricao=r[e.json.sincronismo.dePara.descricao]||"",l.idItemNoECommerce=r[e.json.sincronismo.dePara.codigoItem]||"")}if(e.parceiro==="Uappi"){const r=await $db.integracaoECommerce.uappi.obterItem({idECommerce:e.id,idItemNoECommerce:l.idItemNoECommerce});r||(l.descricao=this.item.descricao,l.valorVenda=this.item.valorVenda,l.idItemNoECommerce=""),r&&r.erro&&console.log(r.erro),r&&!r.erro&&(l.valorVendaAtivo&&(l.valorVenda=this.extrairValorCampoItemECommerce(r,e.json.sincronismo.dePara.valorVenda,0)),l.descricao=this.extrairValorCampoItemECommerce(r,e.json.sincronismo.dePara.descricao,""),l.idItemNoECommerce=r.id||"")}},extrairValorCampoItemECommerce(l,e,r){var a;let n=$utils.clonar(e);return Array.isArray(n)&&(n=n[0]),((a=n==null?void 0:n.split("."))==null?void 0:a.reduce((i,m)=>i&&i[m],l))||r},async salvar(){try{$q.loading.show();for(const l of this.itemECommerce){const e=$utils.clonarV2(l),r=this.itemECommerceOriginal.find(n=>n.id===l.id);if(e.json=JSON.stringify(e.json),e.ativo){const n=this.eCommerce.find(i=>i.id===e.idECommerce),a=await $db.integracaoECommerce[n.parceiro.toLowerCase()].enviarItem({eCommerce:n,itemECommerce:e,itemGeeks:this.item});e.idItemNoECommerce=a==null?void 0:a.id}await $db.itemECommerce.gravar({atual:e,original:r})}await this.atualizar()}catch(l){$q.notifyError("Erro ao salvar dados de e-commerce",l)}finally{$q.loading.hide()}}},props:{item:{type:Object,required:!0}},created(){this.atualizar()}};function Yo(l,e,r,n,a,i){const m=C("g-label"),s=C("g-col"),f=C("campo"),h=C("g-row");return a.itemECommerce.length?(g(),E(z,{key:0},[o(s,{col:"12"},{default:t(()=>[o(m,{text:"h6",color:"text-tertiary"},{default:t(()=>e[0]||(e[0]=[p("E-Commerce")])),_:1}),a.loading?(g(),v(Xe,{key:0})):k("",!0)]),_:1}),(g(!0),E(z,null,L(a.itemECommerce,u=>(g(),E(z,{key:u.id},[o(s,{col:"12 sm4"},{default:t(()=>[o(m,{text:"medium",lines:"2"},{default:t(()=>[p(P(a.descricaoECommerce[u.idECommerce]),1)]),_:2},1024)]),_:2},1024),o(s,{col:"12 sm8"},{default:t(()=>[o(h,null,{default:t(()=>[o(s,{col:"3 sm-shrink",text:"center"},{default:t(()=>[o(f,{modelValue:u.ativo,"onUpdate:modelValue":[V=>u.ativo=V,V=>i.ativo_onClick(u)],tipo:"logico",noDense:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(s,{col:"9 sm"},{default:t(()=>[o(f,{modelValue:u.descricao,"onUpdate:modelValue":V=>u.descricao=V,modelModifiers:{trim:!0},tipo:"texto",maxlength:"250",rotulo:"Nome do produto",disable:!u.ativo,readonly:!u.ativo,class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue","disable","readonly"])]),_:2},1024),o(s,{col:"3 sm-shrink",text:"center"},{default:t(()=>[o(f,{modelValue:u.valorVendaAtivo,"onUpdate:modelValue":[V=>u.valorVendaAtivo=V,V=>i.valorVendaAtivo_onClick(u)],tipo:"logico",disable:!u.ativo,readonly:!u.ativo,noDense:""},null,8,["modelValue","onUpdate:modelValue","disable","readonly"])]),_:2},1024),o(s,{col:"9 sm2"},{default:t(()=>[o(f,{modelValue:u.valorVenda,"onUpdate:modelValue":V=>u.valorVenda=V,tipo:"decimal",decimals:"2",zerosDireita:"2",maxlength:"20",rotulo:"Valor de venda",disable:!u.ativo||!u.valorVendaAtivo,readonly:!u.ativo||!u.valorVendaAtivo,class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue","disable","readonly"])]),_:2},1024),o(s,{col:"9 sm2",offset:"3 sm0"},{default:t(()=>[o(f,{modelValue:u.idItemNoECommerce,"onUpdate:modelValue":V=>u.idItemNoECommerce=V,modelModifiers:{trim:!0},tipo:"texto",rotulo:"ID E-Commerce",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024)],64))),128))],64)):k("",!0)}var Wo=H(Xo,[["render",Yo]]),Zo="/assets/icon-haste.fabcabab.svg",$o="/assets/icon-altura.2b042c6f.svg",ea="/assets/icon-ponte.27b677d4.svg",oa="/assets/icon-tamanho.0525cbbb.svg",aa="/assets/icon-diagonal.59e3a230.svg";const ta={components:{modalTrocarFoto:Jo,"g-row":Ue,"g-col":Me,"g-label":Pe,Avatar:Ye,BadgeCopiarUid:We,PromptItemV2:Re,SeletorCampoTabela:Be,SeletorCest:Ze,SeletorNcm:$e,Arquivo:eo,ItemECommerce:Wo,importarDadosReferencia:He},computed:{badgeCor(){return this.item.ativo?(this.item.quantidadeDisponivel||0)<0?"negative":(this.item.quantidadeDisponivel||0)<=(this.item.quantidadeMinimaEstoque||0)?"orange":"positive":"faded"},descricaoConcatenada(){return $db.item.descricaoConcatenada(this.item)},opcoesGenero(){return[{rotulo:"Masculino",valor:"Masculino"},{rotulo:"Feminino",valor:"Feminino"},{rotulo:"Unisex",valor:"Unisex"},{rotulo:"Masculino Kids",valor:"Masculino Kids"},{rotulo:"Feminino Kids",valor:"Feminino Kids"},{rotulo:"Unisex Kids",valor:"Unisex Kids"}]},opcoesGeometria(){return[{rotulo:"Asf\xE9rica",valor:"Asf\xE9rica"},{rotulo:"Esf\xE9rica",valor:"Esf\xE9rica"},{rotulo:"T\xF3rica",valor:"T\xF3rica"}]},opcoesLenteTipo(){return[{rotulo:"Monofocal",valor:"Monofocal"},{rotulo:"Bifocal",valor:"Bifocal"},{rotulo:"Multifocal",valor:"Multifocal"}]},opcoesOrigemOld(){return[{valor:"",rotulo:""},{valor:"0",rotulo:"0 - Nacional exceto as indicadas nos c\xF3digos 3, 4, 5 e 8"},{valor:"1",rotulo:"1 - Estrangeira - Importa\xE7\xE3o direta"},{valor:"2",rotulo:"2 - Estrangeira - Adquirida no mercado interno"},{valor:"3",rotulo:"3 - Nacional, conteudo superior 40 % e inferior ou igual a 70 %"},{valor:"4",rotulo:"4 - Nacional, processos produtivos b\xE1sicos"},{valor:"5",rotulo:"5 - Nacional, conteudo inferior 40 %"},{valor:"6",rotulo:"6 - Estrangeira - Importa\xE7\xE3o direta, com similar nacional, lista CAMEX"},{valor:"7",rotulo:"7 - Estrangeira - mercado interno, sem simular, lista CAMEX"},{valor:"8",rotulo:"8 - Nacional, Conte\xFAdo de Importa\xE7\xE3o superior a 70 %"}]},opcoesSurfacada(){return[{rotulo:"Pronta",valor:"0"},{rotulo:"Surfa\xE7ada",valor:"1"}]},opcoesTipo(){return Ce},opcoesStatus(){return[{rotulo:"Linha",valor:"Linha"},{rotulo:"Fora de Linha",valor:"Fora de Linha"},{rotulo:"Promo\xE7\xE3o",valor:"Promo\xE7\xE3o"}]},meta(){return ye},temArmacao(){return["\xD3culos Sol","\xD3culos Pronto","Arma\xE7\xE3o"].includes(this.item.tipo)},temDescricaoConcatenada(){return["\xD3culos Sol","Lente"].includes(this.item.tipo)},temLente(){return["\xD3culos Sol","\xD3culos Pronto","Lente","Lente Contato"].includes(this.item.tipo)}},data(){return{tabelasPrecoOriginal:[],tabelasPreco:[],item:{},contato:{},fornecedor:[],composicao:[],producaoFase:[],qualidade:[],arquivo:[],especificacao:[],habilitaCamposControlados:!1,estoquePorEmpresa:[],opcoesOrigem:[],opcoesPerfilContabil:[],modalEquipamento:!1,modalFerramenta:!1,modalFoto:!1,modalItemUtilizado:!1,modalServico:!1,modalTratamento:!1,modalMarkup:{visivel:!1,custo:0,venda:0,markup:0,lucro:0,origem:{}},utilizaMarkupInvertido:!1,utilizaComposicaoValorReposicaoInvertido:!1,tab:"profile-tab-1",descricaoNcm:"",sistemaPai:oo(),itemCompleto:{},indiceTratamento:0,indiceComposicao:0,descricaoANP:"",rules:{referencia:[async l=>await this.verificarReferenciaExistente(l)]},permissaoImportarImagensEAN:!1,permissaoMaximoDescontoGerente:!1,permissaoPcp:!1,loadingImage:!1,mostrarCampoMix:!1,mostrarImportarDados:!1,EstoqueHeight:200,tela:{width:0,height:0}}},methods:{async atualizar({id:l}){var e;$q.loading.show();try{l||(l=this.$route.params.id),this.estoquePorEmpresa=[],this.descricaoNcm="";const r=await $db.item.leCompletoV2(l);$db.item.selecionado=r,this.item=r.item,this.item.bloquearVenda=(e=this.item.bloquearVenda)!=null?e:!1,this.composicao=r.composicao,this.fornecedor=r.fornecedor,this.qualidade=r.qualidade,this.especificacao=$lodash.orderBy(r.especificacao,["descricao","agrupamento","valor"],["asc","asc","asc"]),this.producaoFase=r==null?void 0:r.producaoFase.sort((n,a)=>{const i=Number(n.ordem),m=Number(a.ordem);return i>m?1:-1}),this.item.codigoANP&&await this.consultarCodigoAnp(this.item.codigoANP);for(const n of this.fornecedor.map(a=>a.idContato))this.contato[n]||(this.contato[n]=await $db.contato.le({id:n}));this.itemOriginal=$utils.clonarV2(r.item),this.composicaoOriginal=$utils.clonarV2(r.composicao),this.fornecedorOriginal=$utils.clonarV2(r.fornecedor),this.producaoFaseOriginal=$utils.clonarV2(r.producaoFase),this.qualidadeOriginal=$utils.clonarV2(r.qualidade),this.especificacaoOriginal=$utils.clonarV2(r.especificacao),this.arquivoOriginal=await $db.arquivo.lista({tipoArquivo:"itemImagem",idTabelaMaster:this.item.id}),this.arquivo=$utils.clonarV2(this.arquivoOriginal),this.utilizaMarkupInvertido=!this.item.utilizaMarkup,this.utilizaComposicaoValorReposicaoInvertido=!this.item.utilizaComposicaoValorReposicao,await this.leOpcoesPerfilContabil(),this.opcoesOrigem=(await se().list("impostoParametro",{filter:{impParamTipoCod:2}})).map(n=>({rotulo:n.numero.trim()+" - "+n.descr,valor:Number(n.numero)})).sort((n,a)=>Number(n.valor)-Number(a.valor));for(const n of r.composicao)await this.atualizarItemComposicao(n.idItemUtilizado);this.estoquePorEmpresa=await $db.estoqueSaldoProdutoEmpresa.leEstoquePorEmpresa(this.item.id),this.habilitaCamposControlados=!!await $db.configuracoes.leValorNumerico("item.habilitacamposcontrolados"),await this.carregarTabelasPreco()}catch(r){this.$q.notifyError("Ocorreu erro ao consultar produto",r)}finally{$q.loading.hide()}},async itemRestaurar_click(){try{$q.loading.show(),this.item.ativo=!0,await this.salvarItem()}catch(l){$q.notifyError("Ocorreu um erro ao reativar o produto.",l)}finally{$q.loading.hide()}},async verificarReferenciaExistente(l){const e=(l||"").trim().toLowerCase();return e&&(await $db.item.carregarMemoria(),$db.item.itens.find(n=>(n.referencia||"").trim().toLowerCase()===e&&n.id!==this.item.id))?(this.mostrarImportarDados=!1,"Refer\xEAncia j\xE1 existente"):(this.mostrarImportarDados=!0,!0)},removerFoto(){this.item.imagem=""},async salvarItem(){try{this.$q.loading.show(),this.completarCodigoBarras();const l=this.item.id,e={originais:{item:this.itemOriginal,composicao:this.composicaoOriginal,fornecedor:this.fornecedorOriginal,producaoFase:this.producaoFaseOriginal,qualidade:this.qualidadeOriginal,especificacao:this.especificacaoOriginal},item:this.item,composicao:this.composicao,fornecedor:this.fornecedor,producaoFase:this.producaoFase,qualidade:this.qualidade,especificacao:this.especificacao};await $db.arquivo.remove(this.arquivoOriginal.filter(r=>!this.arquivo.find(n=>n.id===r.id)));for(const r of this.arquivo){let n={};Object.keys(this.arquivoOriginal).length?n={original:this.arquivoOriginal.find(a=>a.id===r.id)||[{}],atual:r}:n={atual:r},(r==null?void 0:r.name)&&(r==null?void 0:r.editado)&&await $db.arquivo.edita(n),r!=null&&r.name||await $db.arquivo.grava(n)}await $db.item.gravaV2(e),await this.salvarTabelasPreco(),this.$refs.itemECommerce.salvar(),await this.atualizar({id:l}),$q.notifyPositive("Os dados do produto foram salvos com sucesso.")}catch(l){$q.notifyError("Ocorreu um erro ao salvar",l)}finally{$q.loading.hide()}},async itemRemover_click(){let l=!1;this.$refs.form.getValidationComponents().forEach(e=>{!e.validate()&&!l&&(l=!0)}),!l&&$q.dialog({cancel:{label:"N\xE3o",push:!0,color:"tertiary",flat:!0},title:"Inativar",message:"Ao continuar voc\xEA ir\xE1 inativar este item.",ok:{label:"Sim",push:!0,class:"bg-negative",textColor:"white",flat:!0}}).onOk(async()=>{try{$q.loading.show();const e=this.item.id;this.item.ativo=!1;const r={dadosOriginais:{item:this.itemOriginal},item:this.item};await $db.item.gravaV2(r),await this.atualizar({id:e}),$q.notifyPositive("O produto foi inativado com sucesso.")}catch(e){$q.notifyError("Ocorreu um erro ao inativar o produto",e)}finally{$q.loading.hide()}})},aoCancelar(){if(!this.verificarSeAlterouCampos()){this.$q.notifyPositive("N\xE3o h\xE1 dados alterados."),this.atualizar({id:this.item.id});return}$q.dialog({message:"Ao continuar voc\xEA ir\xE1 perder todas as modifica\xE7\xF5es.",title:"Tem certeza?",cancel:{label:"Manter",push:!0,color:"tertiary",flat:!0},ok:{label:"Continuar",push:!0,class:"bg-negative",textColor:"white",flat:!0}}).onOk(()=>{this.atualizar({id:this.item.id})})},async indexarNcms(){this.ncm=[],this.ncmIdx=void 0,$erp()._ncm.toArray().then(async l=>{l.forEach(e=>{this.ncm.push({id:e.id,ncm:e.ncm,descricao:e.descricao})}),this.ncm})},async abrirModalEquipamento(l){this.itensEquipamento=await se().list("item",{filterNi:{ativo:!0,tipo:"Equipamento"}}),this.indiceProducaoFase=l,this.modalEquipamento=!0},async abrirModalFerramenta(l){this.indiceFerramenta=l,this.modalFerramenta=!0},async abrirModalServico(l){this.itensServico=await se().list("item",{filterNi:{ativo:!0,tipo:"Servi\xE7o"}}),this.indiceServico=l,this.modalServico=!0},async abrirModalTratamento(l){this.itensTratamento=await se().list("item",{filterNi:{ativo:!0,tipo:"Tratamento"}}),this.indiceTratamento=l,this.modalTratamento=!0},async abrirModalItemUtilizado(l){this.itensAtivos=await se().list("item",{filterNi:{ativo:!0}}),this.indiceItemUtilizado=l,this.modalItemUtilizado=!0},async leOpcoesPerfilContabil(){const l=(await se().list("perfilContabil")).sort((e,r)=>e.descricao.localeCompare(r.descricao,void 0,{sensitivity:"base"})).map(e=>({rotulo:e.descricao,valor:e.id}));this.opcoesPerfilContabil=[{rotulo:"",valor:""},...l]},async selecionarEquipamento(l){const e=Object.keys(l)[0],r=l[e].item,n=this.producaoFase[this.indiceProducaoFase];n.itemEquipamento=r,n.idItemEquipamento=e,n.descricaoItemEquipamento=r.descricao||"",this.modalEquipamento=!1},async selecionarFerramenta(l){const e=Object.keys(l)[0],r=l[e].item,n=this.producaoFase[this.indiceFerramenta];n.itemFerramenta=r,n.idItemFerramenta=e,n.descricaoItemFerramenta=r.descricao||"",this.modalFerramenta=!1},async selecionarServico(l){const e=Object.keys(l)[0],r=l[e].item,n=this.producaoFase[this.indiceServico];n.itemServico=r,n.idItemServico=e,n.descricaoItemServico=r.descricao||"",this.modalServico=!1},async selecionarTratamento(l){const e=Object.keys(l)[0],r=l[e].item;await this.atualizarItemTratamento(r.id,this.indiceTratamento),this.modalTratamento=!1},async selecionarFornecedor(l){const e=await $g.promptContato.show({filtro:{ativo:!0},placeholder:"Selecione o fornecedor"});if(e!=null&&e.id){const r=this.fornecedor[l];r.id=$utils.uuid(),r.idItem=this.item.id,r.idContato=e.id,this.contato[e.id]||(this.contato[e.id]=e)}},trocarFoto(l){this.$resizeImage(l[0],{crop:!0,outputFormat:"jpg",targetHeight:200,targetWidth:200},(e,r)=>{this.imagemModalFoto=r})},async fotoTrocar_click(){const l=await this.$refs.modalTrocarFoto.show();l&&(this.item.imagem=l)},uploadClick(){this.$refs.Upload.click()},async abrirArquivo(l){const e=this.$refs.Upload.files;if(FileReader&&e&&e.length){var r=new FileReader;r.onload=()=>{Ne(e[0],{crop:!0,outputFormat:"jpg",targetHeight:200,targetWidth:200},(n,a)=>{this.item.imagem=a})},r.readAsDataURL(e[0])}},atualizarTabelasPreco(){for(const l of this.tabelasPreco.map(e=>e.id))this.atualizarTabelaPreco(l)},async atualizarTabelaPreco(l){let e=this.tabelasPreco.find(a=>a.id===l&&!a.habilitada);if(!e)return;const r=await $erp().itemTabelaPreco.get(e.id);if(!r.id)return;const n=await $db.itemTabelaPreco.obterValores(r,this.item,4)||{};e.valorVenda=n.valorVenda||0,e.maximoDesconto=n.maximoDesconto||0,e.maximoDescontoGerente=n.maximoDescontoGerente||0},async carregarTabelasPreco(){let l,e=[];l=await $erp().itemTabelaPreco.filter(r=>r.tabelaMaster===1).toArray();for(const r of l)if(r.id){let n={};const a=await $db.itemTabelaPreco.obterValores(r,this.item,4)||{};n.habilitada=!a.tabelaMaster,n.valorVenda=a.valorVenda||0,n.maximoDesconto=a.maximoDesconto||0,n.maximoDescontoGerente=a.maximoDescontoGerente||0,e.push({id:r.id,descricao:r.descricao,...n})}e=ao.exports.orderBy(e,"descricao","asc"),this.tabelasPreco=e,this.tabelasPrecoOriginal=$utils.clonarV2(e)},async salvarTabelasPreco(){let l=this.tabelasPreco.filter(e=>!e.habilitada);for(const e of l){const r=await $erp().itemTabelaPreco.filter(n=>!n.tabelaMaster&&n.idItem===this.item.id&&n.idItemTabelaPrecoPai===e.id).toArray();for(const n of r)await $erpDelete().itemTabelaPreco.delete(n.id),await $utils.sincronismoEnviar("remover","itemTabelaPreco",n.id)}l=this.tabelasPreco.filter(e=>e.habilitada);for(const e of l){const r=await $erp().itemTabelaPreco.filter(n=>!n.tabelaMaster&&n.idItem===this.item.id&&n.idItemTabelaPrecoPai===e.id).toArray();for(const n of r){let a={};n.valorVenda!==e.valorVenda&&(a.valorVenda=e.valorVenda),n.maximoDesconto!==e.maximoDesconto&&(a.maximoDesconto=e.maximoDesconto),n.maximoDescontoGerente!==e.maximoDescontoGerente&&(a.maximoDescontoGerente=e.maximoDescontoGerente),Object.keys(a).length&&(await $erpUpdate().itemTabelaPreco.update(n.id,a),await $utils.sincronismoEnviar("atualizar","itemTabelaPreco",n.id,a))}if(!r.length){const n={id:$utils.uuid(),tabelaMaster:0,descricao:this.item.descricao,idItemTabelaPrecoPai:e.id,idItem:this.item.id,valorVenda:e.valorVenda,maximoDesconto:e.maximoDesconto,maximoDescontoGerente:e.maximoDescontoGerente};await $erpPut().itemTabelaPreco.put(n),await $utils.sincronismoEnviar("adicionar","itemTabelaPreco",n.id,n)}}},async atualizarItemComposicao(l){let e=this.composicao.find(n=>l===n.idItemUtilizado)||{};e.idItemUtilizado||(e=this.composicao[0],e.idItemUtilizado=l),e.temporario||(e.temporario={});const r=await $db.item.leCompletoV2(l);e.descricaoItemUtilizado=r.item.descricao||"",e.temporario.unidade=r.item.unidade||"",e.temporario.valor=r.item.valorCustoReposicao||0,e.temporario.total=$utils.arredondar((e.temporario.valor||0)*(e.quantidade||0),2)},async atualizarItemTratamento(l,e){let r=this.composicao.find(a=>l===a.idItemUtilizado)||{};r.idItemUtilizado||(r=this.composicao[e],r.idItemUtilizado=l),r.temporario||(r.temporario={});const n=await $db.item.leCompletoV2(l);r.descricaoItemUtilizado=n.item.descricao||"",r.temporario.unidade=n.item.unidade||"",r.temporario.valor=n.item.valorCustoReposicao||0,r.temporario.total=$utils.arredondar((r.temporario.valor||0)*(r.quantidade||0),2)},async removerComposicao(l){$q.dialog({cancel:{label:"N\xE3o",push:!0,color:"tertiary",flat:!0},title:"Remover",message:"Ao continuar voc\xEA ir\xE1 remover este item.",ok:{label:"Sim",push:!0,class:"bg-negative",textColor:"white",flat:!0}}).onOk(()=>{try{this.composicao.splice(l,1),this.composicao.length===0&&this.adicionarComposicao()}catch(e){e.message&&$q.notifyError("Ocorreu um erro ao remover",e)}})},async adicionarComposicao(){this.composicao||(this.composicao=[]),this.composicao.push({idItem:this.item.id,idItemUtilizado:"",ordem:0,quantidade:1,temporario:{unidade:"",valor:0,total:0}})},async selecionarItemUtilizado(l){const e=Object.keys(l)[0],r=l[e].item;let n=this.composicao.find(a=>e===a.idItemUtilizado)||{};if(!n.idItemUtilizado){let a=this.composicao.length>0?this.composicao.length-1:0;n=this.composicao[a],n.idItemUtilizado=e}n.quantidade=l[e].quantidade,await this.atualizarItemComposicao(r.id),this.modalItemUtilizado=!1},atualizarValorVendaLucro(){if(this.utilizaMarkupInvertido){if(!!this.item.valorCustoReposicao&&!!this.item.valorVenda){const l=100*(this.item.valorVenda-this.item.valorCustoReposicao)/this.item.valorVenda;this.item.percentualMarkup=$utils.arredondar(l,2)}}else{const l=(this.item.percentualMarkup||0)/100;if(!!this.item.valorCustoReposicao&&l<1){const e=this.item.valorCustoReposicao/(1-l);e&&(this.item.valorVenda=$utils.arredondar(e,4))}}},atualizarCustoReposicao(){this.item&&this.item.id&&!this.utilizaComposicaoValorReposicaoInvertido&&(this.item.valorCustoReposicao=(this.composicao||[]).reduce((l,e)=>l+e.temporario.total,0),this.item.valorCustoReposicao||(this.item.percentualMarkup=100),this.atualizarValorVendaLucro())},completarCodigoBarras(){!this.item.codigoBarras&&!!this.item.codigoItem&&(this.item.codigoBarras=$utils.completarCodigoBarras(String(this.item.codigoItem)))},removerItemDaLista(l,e){$q.dialog({cancel:{label:"N\xE3o",push:!0,color:"tertiary",flat:!0},title:"Remover",message:"Ao continuar voc\xEA ir\xE1 remover este item.",ok:{label:"Sim",push:!0,class:"bg-negative",textColor:"white",flat:!0}}).onOk(()=>{try{l.splice(e,1)}catch(r){r.message&&$q.notifyError("Ocorreu um erro ao remover o item",r)}})},verificarSeAlterouCampos(){const l={item:this.itemOriginal,itemComposicao:this.composicaoOriginal,itemFornecedor:this.fornecedorOriginal,itemProducaoFase:this.producaoFaseOriginal,itemQualidade:this.qualidadeOriginal},e={item:this.item,itemComposicao:this.composicao,itemFornecedor:this.fornecedor,itemProducaoFase:this.producaoFase,itemQualidade:this.qualidade};for(const n of this.arquivoOriginal)if(!this.arquivo.some(a=>a.id===n.id))return!0;for(const n of this.arquivo)if(!this.arquivoOriginal.some(a=>a.id===n.id))return!0;return($utils.diferenca(l,e)||$utils.diferenca(this.tabelasPrecoOriginal,this.tabelasPreco))!==null},importarDados_click(){this.$refs.modalImportarDados.visivel=!0},async importarDadosReferencia(l){$q.loading.show();try{const e=$utils.clonarV2(this.item),r=$utils.clonarV2(this.arquivo),n=await $db.item.importarDadosProdutoReferencia({item:e,arquivosOriginal:r,alterarDescricao:l.alterarDescricao,alterarValorCusto:l.alterarValorCusto,alterarValorVenda:l.alterarValorVenda});this.arquivo=n.arquivos,this.item.descricao=n.item.descricao,this.item.referencia=n.item.referencia,this.item.tipo=n.item.tipo,this.item.marca=n.item.marca,this.item.ncm=n.item.ncm,this.item.valorCustoReposicao=n.item.valorCustoReposicao,this.item.valorVenda=n.item.valorVenda,this.item.imagem=n.item.imagem,this.item.armacaoMaterial=n.item.armacaoMaterial,this.item.amarcaoCor=n.item.amarcaoCor,this.item.tipoMontagem=n.item.tipoMontagem,this.item.modelo=n.item.modelo,this.item.haste=n.item.haste,this.item.ponte=n.item.ponte,this.item.largura=n.item.largura,this.item.material=n.item.material,this.item.cor=n.item.cor,$q.notify({message:'Lembre-se de "SALVAR" as altera\xE7\xF5es do produto.',type:"warning"}),$q.notifyPositive("Dados e Imagens importados com sucesso.")}catch(e){$q.notify({message:"N\xE3o encontramos dados ou imagens para est\xE1 refer\xEAncia.",type:"warning"}),console.error(e)}finally{$q.loading.hide()}},getFile(l){const e=new FormData,r=new Blob([l],{type:"image/jpeg"});return e.append("file",r),e.get("file")},especificacaoAdicionar(){this.especificacao.push({id:$utils.uuid(),idItem:this.item.id})},async especificacaoRemover(l){await this.removerConfirma(),l>=0&&this.especificacao.splice(l,1)},removerConfirma(){return new Promise((l,e)=>{this.$q.dialog({cancel:{label:"N\xE3o",push:!0,color:"tertiary",flat:!0},title:"Inativar",message:"Ao continuar voc\xEA ir\xE1 inativar este produto.",ok:{label:"Sim",push:!0,class:"bg-negative",textColor:"white",flat:!0}}).onOk(()=>{l()})})},async buscaEspecificacoes(l){const e=await $db.configuracoes.le({nome:`item.especificacao.${l}`});e.length>0&&await $q.dialog({title:"Especifica\xE7\xF5es",message:"O tipo selecionado possue itens de especifica\xE7\xE3o, deseja preencher?",cancel:!0,persistent:!0}).onOk(()=>{e.forEach(async r=>{let n={id:$utils.uuid(),idItem:this.item.id,descricao:r.texto,valor:r.valor};await $db.itemEspecificacao.gravar({original:{},atual:n}),this.especificacao=await $db.itemEspecificacao.ler({idItem:this.item.id})})})},async consultarCodigoAnp(){let l=go.tabelaANP.find(e=>e.value===this.item.codigoANP);l&&(this.descricaoANP=l.label),l||(this.descricaoANP="C\xF3digo n\xE3o encontrado na tabela da ANP.",this.$q.notifyError("C\xF3digo n\xE3o encontrado na tabela da ANP."))},abrirModalMarkup(){this.modalMarkup={visivel:!0,custo:this.item.valorCustoReposicao,venda:this.item.valorVenda,markup:this.item.valorVenda&&this.item.valorCustoReposicao?(this.item.valorVenda/this.item.valorCustoReposicao-1)*100:0,lucro:this.item.valorVenda===0?(this.item.valorVenda-this.item.valorCustoReposicao)/(this.item.valorVenda+1e-9)*100:(this.item.valorVenda-this.item.valorCustoReposicao)/this.item.valorVenda*100,origem:{custo:this.item.valorCustoReposicao,venda:this.item.valorVenda,lucro:this.item.percentualMarkup}}},fecharModalMarkup(l=!1){l?(this.item.valorCustoReposicao=this.modalMarkup.custo,this.item.valorVenda=this.modalMarkup.venda,this.item.percentualMarkup=this.modalMarkup.lucro):(this.item.valorCustoReposicao=this.modalMarkup.origem.custo,this.item.valorVenda=this.modalMarkup.origem.venda,this.item.percentualMarkup=this.modalMarkup.origem.lucro),this.modalMarkup={visivel:!1,custo:0,venda:0,markup:0,lucro:0,origem:{}}},calcularModalMarkup(l){const e=this.modalMarkup,r=1e-9;if(l==="custo"){e.custo<0&&this.$nextTick(()=>{e.custo=0,e.markup=0,e.lucro=0,e.venda=0}),e.markup=(e.venda/e.custo-1)*100,e.venda===0?e.lucro=(e.venda-e.custo)/(e.venda+r)*100:e.lucro=(e.venda-e.custo)/e.venda*100,this.$nextTick(()=>{e.lucro>99.99&&(e.lucro=99.99,this.calcularModalMarkup("lucro"))});return}if(l==="markup"){e.markup<-100&&this.$nextTick(()=>{e.markup=-100,this.calcularModalMarkup("markup")}),e.venda=e.custo+e.markup/100*e.custo,e.venda===0?e.lucro=(e.venda-e.custo)/(e.venda+r)*100:e.lucro=(e.venda-e.custo)/e.venda*100,this.$nextTick(()=>{e.lucro>99.99&&(e.lucro=99.99,this.calcularModalMarkup("lucro"))});return}if(l==="lucro"){e.venda=e.custo/(1-e.lucro/100),e.markup=(e.venda/e.custo-1)*100,this.$nextTick(()=>{e.lucro>99.99&&(e.lucro=99.99,this.calcularModalMarkup("lucro"))});return}if(l==="venda"){e.venda<0&&this.$nextTick(()=>{e.venda=e.custo,this.calcularModalMarkup("venda")}),e.markup=(e.venda/e.custo-1)*100,e.venda===0?e.lucro=(e.venda-e.custo)/(e.venda+r)*100:e.lucro=(e.venda-e.custo)/e.venda*100,this.$nextTick(()=>{e.lucro>99.99&&(e.lucro=99.99,this.calcularModalMarkup("lucro"))});return}},onResize(l){let e;e=window.innerWidth,parseInt(l.height),e>=1024?this.EstoqueHeight=(l.height-117).toString():this.EstoqueHeight="140"},resize(){const l=document.getElementById("ItemFicha");l&&(this.tela={width:l.offsetWidth,height:l.offsetHeight})}},watch:{utilizaComposicaoValorReposicaoInvertido(){this.item.utilizaComposicaoValorReposicao=!this.utilizaComposicaoValorReposicaoInvertido,this.atualizarCustoReposicao()},utilizaMarkupInvertido(){this.item.utilizaMarkup=!this.utilizaMarkupInvertido,this.atualizarValorVendaLucro()},descricaoConcatenada(l){this.item.descricaoConcatenada=l}},async created(){const l=JSON.parse(localStorage.getItem("clienteSistema"));this.indexarNcms(),this.permissaoMaximoDescontoGerente=await $db.permissao.objetoClienteSistema("Diretiva_Vendas_DescontoMaximoNivelGerente"),this.permissaoPcp=await $db.permissao.objetoClienteSistema("producoes"),this.mostrarCampoMix=~[53,62].indexOf(l==null?void 0:l.codigoSistema),this.permissaoImportarImagensEAN=~[53,62].indexOf(l==null?void 0:l.codigoSistema)}},la=["onUpdate:modelValue"],ia=["onUpdate:modelValue"],ra=["onUpdate:modelValue"],sa=["onUpdate:modelValue"],na=["onUpdate:modelValue"],da={key:0,class:"fit text-right"},ua={key:1,class:"fit"};function ma(l,e,r,n,a,i){const m=C("avatar"),s=C("g-col"),f=C("g-label"),h=C("BadgeCopiarUid"),u=C("campo"),V=C("SeletorCampoTabela"),S=C("SeletorNcm"),x=C("SeletorCest"),y=C("g-row"),Z=C("ItemECommerce"),$=C("arquivo"),T=C("modalTrocarFoto"),K=C("PromptItemV2"),R=C("importarDadosReferencia");return g(),v(ae,{onSubmit:i.salvarItem,ref:"form",id:"ItemFicha",class:"q-mt-md"},{default:t(()=>[o(ze,{onResize:e[0]||(e[0]=d=>i.resize())}),o(ue,null,{default:t(()=>[o(me,{class:"u-container"},{default:t(()=>[o(y,{gutter:"md",bg:"bg-white"},{default:t(()=>[o(s,{col:"12 md2",text:"center"},{default:t(()=>[o(m,{onClick:i.uploadClick,imagem:a.item.imagem,rotulo:a.item.descricao,tamanho:"160"},null,8,["onClick","imagem","rotulo"]),A("input",{ref:"Upload",type:"file",id:"Upload",onChange:e[1]||(e[1]=(...d)=>i.abrirArquivo&&i.abrirArquivo(...d)),style:{visibility:"hidden"}},null,544),(a.item.codigoBarras||a.item.referencia)&&a.mostrarImportarDados&&a.permissaoImportarImagensEAN?(g(),v(F,{key:0,name:"image",size:"sm",class:"cursor-pointer",onClick:i.importarDados_click},{default:t(()=>[o(Q,{anchor:"bottom middle",self:"center middle"},{default:t(()=>e[100]||(e[100]=[p("Importar Produto/Imagem")])),_:1})]),_:1},8,["onClick"])):k("",!0)]),_:1}),o(s,{col:"12 md7"},{default:t(()=>[o(y,{gutter:"none-y",items:"center"},{default:t(()=>[o(ze,{onResize:i.onResize},null,8,["onResize"]),o(s,null,{default:t(()=>[i.temDescricaoConcatenada?(g(),v(f,{key:0,text:"sub1 medium",color:"text-tertiary"},{default:t(()=>[p(P(i.descricaoConcatenada),1)]),_:1})):k("",!0)]),_:1}),o(s,{col:"shrink"},{default:t(()=>[o(h,{id:a.item.id,numero:a.item.codigoItem,cor:i.badgeCor},null,8,["id","numero","cor"])]),_:1}),o(s,{col:"12"},{default:t(()=>[o(u,{rules:[d=>!!(d!=null&&d.trim())||"Campo obrigat\xF3rio"],modelValue:a.item.descricao,"onUpdate:modelValue":e[2]||(e[2]=d=>a.item.descricao=d),modelModifiers:{trim:!0},tipo:"texto",rotulo:"Nome do produto",dense:"",autogrow:"",autofocus:"",maxlength:"500"},null,8,["rules","modelValue"])]),_:1}),o(s,{col:"12 sm6 md6"},{default:t(()=>[o(V,{modelValue:a.item.marca,"onUpdate:modelValue":e[3]||(e[3]=d=>a.item.marca=d),buscarSemCaractere:!0,tabela:"item",campo:"marca",label:"Marca",enableAdd:""},null,8,["modelValue"])]),_:1}),o(s,{col:"12 sm6 md6"},{default:t(()=>[o(u,{modelValue:a.item.tipo,"onUpdate:modelValue":e[4]||(e[4]=d=>a.item.tipo=d),opcoes:i.opcoesTipo,onBlur:e[5]||(e[5]=d=>i.buscaEspecificacoes(a.item.tipo)),rotuloFixo:"Tipo",tipo:"seletor",class:"q-field--with-bottom"},null,8,["modelValue","opcoes"])]),_:1}),o(s,{col:"12 sm6 md6",class:"relative-position"},{default:t(()=>[o(be,{modelValue:a.item.referencia,"onUpdate:modelValue":e[6]||(e[6]=d=>a.item.referencia=d),rules:a.rules.referencia,maxlength:"30",label:"Refer\xEAncia",dense:""},null,8,["modelValue","rules"])]),_:1}),o(s,{col:"12 sm6 md6",class:"relative-position"},{default:t(()=>[o(be,{modelValue:a.item.codigoBarras,"onUpdate:modelValue":e[7]||(e[7]=d=>a.item.codigoBarras=d),modelModifiers:{trim:!0},onBlur:i.completarCodigoBarras,type:"text",maxlength:"14",mask:"##############",label:"C\xF3digo de barras (GTIN ou EAN)",class:"q-field--with-bottom",dense:""},null,8,["modelValue","onBlur"])]),_:1}),a.item.tipo!="Servi\xE7o"?(g(),E(z,{key:0},[o(s,{col:"12 sm6 md6"},{default:t(()=>[o(S,{modelValue:a.item.ncm,"onUpdate:modelValue":e[8]||(e[8]=d=>a.item.ncm=d)},null,8,["modelValue"])]),_:1}),o(s,{col:"12 sm6 md6"},{default:t(()=>[o(x,{modelValue:a.item.cest,"onUpdate:modelValue":e[9]||(e[9]=d=>a.item.cest=d),ncm:a.item.ncm},null,8,["modelValue","ncm"])]),_:1})],64)):k("",!0),o(s,{col:"12",class:"q-mt-md"},{default:t(()=>[o(f,{text:"h6"},{default:t(()=>e[101]||(e[101]=[p("Valores")])),_:1})]),_:1}),o(s,{col:"12 sm"},{default:t(()=>[o(y,null,{default:t(()=>[o(s,{col:"3",text:"center"},{default:t(()=>[o(u,{modelValue:a.utilizaComposicaoValorReposicaoInvertido,"onUpdate:modelValue":e[10]||(e[10]=d=>a.utilizaComposicaoValorReposicaoInvertido=d),tipo:"logico",noDense:""},null,8,["modelValue"])]),_:1}),o(s,{col:"9"},{default:t(()=>[o(u,{modelValue:a.item.valorCustoReposicao,"onUpdate:modelValue":[e[11]||(e[11]=d=>a.item.valorCustoReposicao=d),i.atualizarValorVendaLucro],disable:!a.utilizaComposicaoValorReposicaoInvertido,readonly:!a.utilizaComposicaoValorReposicaoInvertido,ajuda:a.utilizaComposicaoValorReposicaoInvertido?"":"Total da composi\xE7\xE3o",tipo:"decimal",decimals:"4",zerosDireita:"2",rotulo:"Custo de reposi\xE7\xE3o"},null,8,["modelValue","onUpdate:modelValue","disable","readonly","ajuda"])]),_:1})]),_:1})]),_:1}),o(s,{col:"9 sm",offset:"3 sm0"},{default:t(()=>[o(u,w({modelValue:a.item.percentualMarkup,"onUpdate:modelValue":e[12]||(e[12]=d=>a.item.percentualMarkup=d)},i.meta.percentualMarkup,{"onUpdate:modelValue":i.atualizarValorVendaLucro,disable:a.utilizaMarkupInvertido,readonly:a.utilizaMarkupInvertido,class:"q-field--with-bottom",after:[{icon:"calculate",color:"primary",round:!0,dense:!0,flat:!0,handler:i.abrirModalMarkup}]}),null,16,["modelValue","onUpdate:modelValue","disable","readonly","after"])]),_:1}),o(s,{col:"12 sm"},{default:t(()=>[o(y,null,{default:t(()=>[o(s,{col:"3",text:"center"},{default:t(()=>[o(u,{modelValue:a.utilizaMarkupInvertido,"onUpdate:modelValue":e[13]||(e[13]=d=>a.utilizaMarkupInvertido=d),tipo:"logico",noDense:""},null,8,["modelValue"])]),_:1}),o(s,{col:"9"},{default:t(()=>[o(u,w({modelValue:a.item.valorVenda,"onUpdate:modelValue":e[14]||(e[14]=d=>a.item.valorVenda=d)},i.meta.valorVenda,{onBlur:i.atualizarTabelasPreco,"onUpdate:modelValue":i.atualizarValorVendaLucro,disable:!a.utilizaMarkupInvertido,readonly:!a.utilizaMarkupInvertido,decimals:"4",zerosDireita:"2",class:"q-field--with-bottom"}),null,16,["modelValue","onBlur","onUpdate:modelValue","disable","readonly"])]),_:1})]),_:1})]),_:1}),(a.tabelasPreco||[]).length>1?(g(),E(z,{key:1},[o(s,{col:"12",class:"q-mt-md"},{default:t(()=>[o(f,{text:"h6"},{default:t(()=>e[102]||(e[102]=[p("Tabelas de Pre\xE7o")])),_:1})]),_:1}),(g(!0),E(z,null,L(a.tabelasPreco,d=>(g(),E(z,{key:d.id},[o(s,{col:"12 sm4"},{default:t(()=>[o(f,{text:"medium",lines:"2"},{default:t(()=>[p(P(d.descricao),1)]),_:2},1024)]),_:2},1024),o(s,{col:"12 sm8"},{default:t(()=>[o(y,null,{default:t(()=>[o(s,{col:"3 sm-shrink",text:"center"},{default:t(()=>[o(u,{modelValue:d.habilitada,"onUpdate:modelValue":[q=>d.habilitada=q,q=>i.atualizarTabelaPreco(d.id)],tipo:"logico",noDense:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(s,{col:"9 sm"},{default:t(()=>[o(u,w({modelValue:d.maximoDesconto,"onUpdate:modelValue":q=>d.maximoDesconto=q,ref_for:!0},{rotulo:"Desc. M\xE1ximo (%)",tipo:"decimal",decimals:"2"},{disable:!d.habilitada,readonly:!d.habilitada,class:"q-field--with-bottom"}),null,16,["modelValue","onUpdate:modelValue","disable","readonly"])]),_:2},1024),a.permissaoMaximoDescontoGerente?(g(),v(s,{key:0,col:"9 sm",offset:"3 sm0"},{default:t(()=>[o(u,w({modelValue:d.maximoDescontoGerente,"onUpdate:modelValue":q=>d.maximoDescontoGerente=q,ref_for:!0},{rotulo:"Desc. M\xE1ximo Gerente (%)",tipo:"decimal",decimals:"2"},{disable:!d.habilitada,readonly:!d.habilitada,class:"q-field--with-bottom"}),null,16,["modelValue","onUpdate:modelValue","disable","readonly"])]),_:2},1024)):k("",!0),o(s,{col:"9 sm",offset:"3 sm0"},{default:t(()=>[o(u,w({modelValue:d.valorVenda,"onUpdate:modelValue":q=>d.valorVenda=q,ref_for:!0},{rotulo:"Valor de venda",tipo:"decimal",decimals:"4",zerosDireita:"2"},{disable:!d.habilitada,readonly:!d.habilitada,class:"q-field--with-bottom"}),null,16,["modelValue","onUpdate:modelValue","disable","readonly"])]),_:2},1024)]),_:2},1024)]),_:2},1024)],64))),128))],64)):k("",!0),a.item.id?(g(),v(Z,{key:2,item:a.item,ref:"itemECommerce"},null,8,["item"])):k("",!0),a.item.tipo!=="Servi\xE7o"&&a.habilitaCamposControlados?(g(),E(z,{key:3},[o(s,{col:"12"},{default:t(()=>[o(f,{text:"h6"},{default:t(()=>e[103]||(e[103]=[p("Produto Controlado")])),_:1})]),_:1}),o(s,{col:"12 sm4"},{default:t(()=>[o(u,{modelValue:a.item.controladoExercito,"onUpdate:modelValue":e[15]||(e[15]=d=>a.item.controladoExercito=d),rotulo:"Quantidade Ex\xE9rcito",tipo:"decimal",decimals:"4",class:"q-field--with-bottom"},null,8,["modelValue"])]),_:1}),o(s,{col:"12 sm4"},{default:t(()=>[o(u,{modelValue:a.item.controladoPoliciaFederal,"onUpdate:modelValue":e[16]||(e[16]=d=>a.item.controladoPoliciaFederal=d),rotulo:"Quantidade Pol\xEDcia Federal",tipo:"decimal",decimals:"4",class:"q-field--with-bottom"},null,8,["modelValue"])]),_:1}),o(s,{col:"12 sm4"},{default:t(()=>[o(u,{modelValue:a.item.controladoPoliciaCivil,"onUpdate:modelValue":e[17]||(e[17]=d=>a.item.controladoPoliciaCivil=d),rotulo:"Quantidade Pol\xEDcia Civil",tipo:"decimal",decimals:"4",class:"q-field--with-bottom"},null,8,["modelValue"])]),_:1})],64)):k("",!0)]),_:1})]),_:1}),o(s,{col:"12 md"},{default:t(()=>[o(y,{gutter:"md",bg:"bg-light","rounded-borders":""},{default:t(()=>[o(s,null,{default:t(()=>[a.estoquePorEmpresa.length!==0?(g(),E(z,{key:0},[o(f,{text:"sub1 medium"},{default:t(()=>e[104]||(e[104]=[p("Estoque / Custos")])),_:1}),a.estoquePorEmpresa.length!==0?(g(),v(y,{key:0,items:"stretch",text:"caption medium center"},{default:t(()=>[o(s,{col:"3",bordered:"bottom"},{default:t(()=>e[105]||(e[105]=[p("Saldo")])),_:1}),o(s,{col:"3",bordered:"bottom"},{default:t(()=>e[106]||(e[106]=[p("Custo M\xE9dio")])),_:1}),o(s,{col:"3",bordered:"bottom"},{default:t(()=>e[107]||(e[107]=[p("Custo Real")])),_:1}),o(s,{col:"3",bordered:"bottom"},{default:t(()=>e[108]||(e[108]=[p("Custo Anterior")])),_:1})]),_:1})):k("",!0)],64)):(g(),v(f,{key:1,text:"center caption medium",class:"q-pb-xl"},{default:t(()=>e[109]||(e[109]=[p("Sem informa\xE7\xE3o de estoque.")])),_:1})),o(to,{style:Ae(`height:${a.EstoqueHeight}px;`)},{default:t(()=>[(g(!0),E(z,null,L(a.estoquePorEmpresa,d=>(g(),E(z,{key:d.idEmpresa},[o(f,{text:"sub2 medium",icon:"factory xs grey-7 left",bordered:"bottom",class:"q-mt-md"},{default:t(()=>[p(P(d.nomeEmpresa),1)]),_:2},1024),(g(!0),E(z,null,L(d.estoquePorLote,(q,b)=>(g(),v(y,{key:b,items:"stretch",text:"caption center"},{default:t(()=>[o(s,{col:"12"},{default:t(()=>[o(f,{text:"sub2 medium left"},{default:t(()=>[p(P(q.tipoEstoque)+P(q.loteEmpresa?` -
                            ${q.loteEmpresa}`:""),1)]),_:2},1024)]),_:2},1024),o(s,{col:"3"},{default:t(()=>[p(P(l.$filters.numero(q.saldo,2)),1)]),_:2},1024),o(s,{col:"3"},{default:t(()=>[p(P(l.$filters.numero(q.valorCustoMedio,2)),1)]),_:2},1024),o(s,{col:"3"},{default:t(()=>[p(P(l.$filters.numero(q.valorCusto,2)),1)]),_:2},1024),o(s,{col:"3"},{default:t(()=>[p(P(l.$filters.numero(q.valorCustoAnterior,2)),1)]),_:2},1024)]),_:2},1024))),128))],64))),128))]),_:1},8,["style"])]),_:1})]),_:1})]),_:1})]),_:1}),i.temArmacao?(g(),v(y,{key:0,gutter:"md-x",bg:"bg-white",justify:"around",items:"end"},{default:t(()=>[o(s,{col:"12"},{default:t(()=>[o(f,{text:"h6"},{default:t(()=>e[110]||(e[110]=[p("Arma\xE7\xE3o")])),_:1})]),_:1}),o(s,{col:"4 sm2 md2"},{default:t(()=>[e[111]||(e[111]=A("img",{class:"fit",src:Zo},null,-1)),o(u,w(i.meta.haste,{modelValue:a.item.haste,"onUpdate:modelValue":e[18]||(e[18]=d=>a.item.haste=d),tipo:"decimal",decimals:"2",dense:"",class:"q-field--with-bottom"}),null,16,["modelValue"])]),_:1}),o(s,{col:"4 sm2 md2"},{default:t(()=>[e[112]||(e[112]=A("img",{class:"fit",src:$o},null,-1)),o(u,w(i.meta.altura,{modelValue:a.item.altura,"onUpdate:modelValue":e[19]||(e[19]=d=>a.item.altura=d),rotulo:"Altura/Vertical",tipo:"decimal",decimals:"2",dense:"",class:"q-field--with-bottom"}),null,16,["modelValue"])]),_:1}),o(s,{col:"4 sm2 md2"},{default:t(()=>[e[113]||(e[113]=A("img",{class:"fit",src:ea},null,-1)),o(u,w(i.meta.ponte,{modelValue:a.item.ponte,"onUpdate:modelValue":e[20]||(e[20]=d=>a.item.ponte=d),tipo:"decimal",decimals:"2",dense:"",class:"q-field--with-bottom"}),null,16,["modelValue"])]),_:1}),o(s,{col:"4 sm2 md2"},{default:t(()=>[e[114]||(e[114]=A("img",{class:"fit",src:oa},null,-1)),o(u,w(i.meta.largura,{modelValue:a.item.largura,"onUpdate:modelValue":e[21]||(e[21]=d=>a.item.largura=d),rotulo:"Aro total",tipo:"decimal",decimals:"2",dense:"",class:"q-field--with-bottom"}),null,16,["modelValue"])]),_:1}),o(s,{col:"4 sm2 md2"},{default:t(()=>[e[115]||(e[115]=A("img",{class:"fit",src:aa},null,-1)),o(u,w(i.meta.diagonal,{modelValue:a.item.diagonal,"onUpdate:modelValue":e[22]||(e[22]=d=>a.item.diagonal=d),rotulo:"Diagonal maior",tipo:"decimal",decimals:"2",dense:"",class:"q-field--with-bottom"}),null,16,["modelValue"])]),_:1}),o(s,{col:"12 sm4 md4"},{default:t(()=>[o(u,w({modelValue:a.item.genero,"onUpdate:modelValue":e[23]||(e[23]=d=>a.item.genero=d)},i.meta.genero,{filter:"",opcoes:i.opcoesGenero,class:"q-field--with-bottom"}),null,16,["modelValue","opcoes"])]),_:1}),o(s,{col:"12 sm4 md4"},{default:t(()=>[o(V,{modelValue:a.item.armacaoMaterial,"onUpdate:modelValue":e[24]||(e[24]=d=>a.item.armacaoMaterial=d),tabela:"item",campo:"armacaoMaterial",label:"Material",buscarSemCaractere:!0,enableAdd:""},null,8,["modelValue"])]),_:1}),o(s,{col:"12 sm4 md4"},{default:t(()=>[o(V,{modelValue:a.item.tipoMontagem,"onUpdate:modelValue":e[25]||(e[25]=d=>a.item.tipoMontagem=d),tabela:"item",campo:"tipoMontagem",label:"Montagem",buscarSemCaractere:!0,enableAdd:""},null,8,["modelValue"])]),_:1}),o(s,{col:"12 sm6 md6"},{default:t(()=>[o(u,w({modelValue:a.item.modelo,"onUpdate:modelValue":e[26]||(e[26]=d=>a.item.modelo=d)},i.meta.modelo,{class:"q-field--with-bottom"}),null,16,["modelValue"])]),_:1}),o(s,{col:"12 sm6 md6"},{default:t(()=>[o(V,{modelValue:a.item.amarcaoCor,"onUpdate:modelValue":e[27]||(e[27]=d=>a.item.amarcaoCor=d),tabela:"item",campo:"amarcaoCor",label:"Cor",buscarSemCaractere:!0,enableAdd:""},null,8,["modelValue"])]),_:1})]),_:1})):k("",!0),i.temLente?(g(),v(y,{key:1,gutter:"md-x",bg:"bg-white"},{default:t(()=>[o(s,{col:"12"},{default:t(()=>[o(f,{text:"h6"},{default:t(()=>e[116]||(e[116]=[p("Lente")])),_:1})]),_:1}),o(s,{col:"12 sm6"},{default:t(()=>[o(V,{modelValue:a.item.material,"onUpdate:modelValue":e[28]||(e[28]=d=>a.item.material=d),tabela:"item",campo:"material",label:"Material",buscarSemCaractere:!0,enableAdd:""},null,8,["modelValue"])]),_:1}),o(s,{col:"12 sm6"},{default:t(()=>[o(V,{modelValue:a.item.cor,"onUpdate:modelValue":e[29]||(e[29]=d=>a.item.cor=d),tabela:"item",campo:"cor",label:"Cor",buscarSemCaractere:!0,enableAdd:""},null,8,["modelValue"])]),_:1}),a.item.tipo==="\xD3culos Pronto"?(g(),v(s,{key:0,col:"12 sm3"},{default:t(()=>[o(u,w({modelValue:a.item.esfericoInicial,"onUpdate:modelValue":e[30]||(e[30]=d=>a.item.esfericoInicial=d)},i.meta.esfericoInicial,{tipo:"decimal",decimals:"2",class:"q-field--with-bottom"}),null,16,["modelValue"])]),_:1})):k("",!0),a.item.tipo==="Lente"?(g(),E(z,{key:1},[o(s,{col:"6 sm4"},{default:t(()=>[o(u,w(i.meta.esfericoInicial,{modelValue:a.item.esfericoInicial,"onUpdate:modelValue":e[31]||(e[31]=d=>a.item.esfericoInicial=d),tipo:"decimal",decimals:"2",rotulo:"Esf\xE9rico de",class:"q-field--with-bottom"}),null,16,["modelValue"])]),_:1}),o(s,{col:"6 sm4"},{default:t(()=>[o(u,w(i.meta.esfericoFinal,{modelValue:a.item.esfericoFinal,"onUpdate:modelValue":e[32]||(e[32]=d=>a.item.esfericoFinal=d),tipo:"decimal",decimals:"2",rotulo:"Esf\xE9rico at\xE9",class:"q-field--with-bottom"}),null,16,["modelValue"])]),_:1}),o(s,{col:"12 sm4"},{default:t(()=>[o(u,w(i.meta.cilindrico,{modelValue:a.item.cilindrico,"onUpdate:modelValue":e[33]||(e[33]=d=>a.item.cilindrico=d),tipo:"decimal",decimals:"2",class:"q-field--with-bottom"}),null,16,["modelValue"])]),_:1}),a.item.lenteTipo!=="Monofocal"?(g(),v(s,{key:0,col:"6 sm"},{default:t(()=>[o(u,w(i.meta.adicaoInicial,{modelValue:a.item.adicaoInicial,"onUpdate:modelValue":e[34]||(e[34]=d=>a.item.adicaoInicial=d),tipo:"decimal",decimals:"2",rotulo:"Adi\xE7\xE3o de",class:"q-field--with-bottom"}),null,16,["modelValue"])]),_:1})):k("",!0),a.item.lenteTipo!=="Monofocal"?(g(),v(s,{key:1,col:"6 sm"},{default:t(()=>[o(u,w(i.meta.adicaoFinal,{modelValue:a.item.adicaoFinal,"onUpdate:modelValue":e[35]||(e[35]=d=>a.item.adicaoFinal=d),tipo:"decimal",decimals:"2",rotulo:"Adi\xE7\xE3o at\xE9",class:"q-field--with-bottom"}),null,16,["modelValue"])]),_:1})):k("",!0),o(s,{col:"6 sm"},{default:t(()=>[o(u,w(i.meta.alturaMinima,{modelValue:a.item.alturaMinima,"onUpdate:modelValue":e[36]||(e[36]=d=>a.item.alturaMinima=d),tipo:"decimal",decimals:"2",class:"q-field--with-bottom"}),null,16,["modelValue"])]),_:1}),o(s,{col:"6 sm"},{default:t(()=>[o(u,w(i.meta.indiceRefracao,{modelValue:a.item.indiceRefracao,"onUpdate:modelValue":e[37]||(e[37]=d=>a.item.indiceRefracao=d),tipo:"decimal",decimals:"2",class:"q-field--with-bottom"}),null,16,["modelValue"])]),_:1}),o(s,{col:"6 sm"},{default:t(()=>[o(u,w(i.meta.diametro,{modelValue:a.item.diametro,"onUpdate:modelValue":e[38]||(e[38]=d=>a.item.diametro=d),tipo:"decimal",decimals:"2",class:"q-field--with-bottom"}),null,16,["modelValue"])]),_:1}),o(s,{col:"6 sm"},{default:t(()=>[o(u,w(i.meta.lenteTipo,{modelValue:a.item.lenteTipo,"onUpdate:modelValue":e[39]||(e[39]=d=>a.item.lenteTipo=d),opcoes:i.opcoesLenteTipo,class:"q-field--with-bottom"}),null,16,["modelValue","opcoes"])]),_:1})],64)):k("",!0),a.item.tipo==="Lente Contato"?(g(),E(z,{key:2},[o(s,{col:"6 sm3"},{default:t(()=>[o(u,w({modelValue:a.item.esfericoInicial,"onUpdate:modelValue":e[40]||(e[40]=d=>a.item.esfericoInicial=d)},i.meta.esfericoInicial,{tipo:"decimal",decimals:"2",rotulo:"Esf\xE9rico de",class:"q-field--with-bottom"}),null,16,["modelValue"])]),_:1}),o(s,{col:"6 sm3"},{default:t(()=>[o(u,w({modelValue:a.item.esfericoFinal,"onUpdate:modelValue":e[41]||(e[41]=d=>a.item.esfericoFinal=d)},i.meta.esfericoFinal,{tipo:"decimal",decimals:"2",rotulo:"Esf\xE9rico at\xE9",class:"q-field--with-bottom"}),null,16,["modelValue"])]),_:1}),o(s,{col:"6 sm3"},{default:t(()=>[o(u,w({modelValue:a.item.eixo,"onUpdate:modelValue":e[42]||(e[42]=d=>a.item.eixo=d)},i.meta.eixo,{tipo:"decimal",decimals:"2",rotulo:"Eixo de",class:"q-field--with-bottom"}),null,16,["modelValue"])]),_:1}),o(s,{col:"6 sm3"},{default:t(()=>[o(u,w({modelValue:a.item.eixoFinal,"onUpdate:modelValue":e[43]||(e[43]=d=>a.item.eixoFinal=d)},i.meta.eixoFinal,{tipo:"decimal",decimals:"2",rotulo:"Eixo at\xE9",class:"q-field--with-bottom"}),null,16,["modelValue"])]),_:1}),o(s,{col:"12 sm3"},{default:t(()=>[o(u,w({modelValue:a.item.cilindrico,"onUpdate:modelValue":e[44]||(e[44]=d=>a.item.cilindrico=d)},i.meta.cilindrico,{tipo:"decimal",decimals:"2",class:"q-field--with-bottom"}),null,16,["modelValue"])]),_:1}),o(s,{col:"12 sm3"},{default:t(()=>[o(u,w({modelValue:a.item.adicaoInicial,"onUpdate:modelValue":e[45]||(e[45]=d=>a.item.adicaoInicial=d)},i.meta.adicaoInicial,{tipo:"decimal",decimals:"2",class:"q-field--with-bottom"}),null,16,["modelValue"])]),_:1}),o(s,{col:"6 sm3"},{default:t(()=>[o(u,w({modelValue:a.item.RB1,"onUpdate:modelValue":e[46]||(e[46]=d=>a.item.RB1=d)},i.meta.RB1,{tipo:"decimal",decimals:"2",class:"q-field--with-bottom"}),null,16,["modelValue"])]),_:1}),o(s,{col:"6 sm3"},{default:t(()=>[o(u,w({modelValue:a.item.RB2,"onUpdate:modelValue":e[47]||(e[47]=d=>a.item.RB2=d)},i.meta.RB2,{tipo:"decimal",decimals:"2",class:"q-field--with-bottom"}),null,16,["modelValue"])]),_:1}),o(s,{col:"6 sm3"},{default:t(()=>[o(u,w({modelValue:a.item.diametro,"onUpdate:modelValue":e[48]||(e[48]=d=>a.item.diametro=d)},i.meta.diametro,{tipo:"decimal",decimals:"2",class:"q-field--with-bottom"}),null,16,["modelValue"])]),_:1}),o(s,{col:"6 sm3"},{default:t(()=>[o(u,w({modelValue:a.item.geometria,"onUpdate:modelValue":e[49]||(e[49]=d=>a.item.geometria=d)},i.meta.geometria,{opcoes:i.opcoesGeometria,class:"q-field--with-bottom"}),null,16,["modelValue","opcoes"])]),_:1}),o(s,{col:"6 sm3"},{default:t(()=>[o(u,w({modelValue:a.item.surfacada,"onUpdate:modelValue":e[50]||(e[50]=d=>a.item.surfacada=d)},i.meta.surfacada,{opcoes:i.opcoesSurfacada,class:"q-field--with-bottom"}),null,16,["modelValue","opcoes"])]),_:1}),o(s,{col:"6 sm3"},{default:t(()=>[o(u,w({modelValue:a.item.lenteTipo,"onUpdate:modelValue":e[51]||(e[51]=d=>a.item.lenteTipo=d)},i.meta.lenteTipo,{opcoes:i.opcoesLenteTipo,class:"q-field--with-bottom"}),null,16,["modelValue","opcoes"])]),_:1})],64)):k("",!0)]),_:1})):k("",!0),a.item.tipo==="Lente"?(g(),v(y,{key:2,gutter:"md-x",items:"center",bg:"bg-white"},{default:t(()=>[o(s,{col:"12"},{default:t(()=>[o(f,{text:"h6"},{default:t(()=>e[117]||(e[117]=[p("Tratamento")])),_:1})]),_:1}),(g(!0),E(z,null,L(a.composicao||[],(d,q)=>(g(),E(z,{key:q},[o(s,{col:"12 sm6"},{default:t(()=>[o(u,{"model-value":d.descricaoItemUtilizado,before:[{icon:"search",handler(){i.abrirModalTratamento(q)}}],onClick:b=>i.abrirModalTratamento(q),readonly:"",rotulo:"Tratamento",class:"q-field--with-bottom"},null,8,["model-value","before","onClick"]),O(A("input",{"onUpdate:modelValue":b=>d.idItemUtilizado=b,type:"hidden"},null,8,la),[[pe,d.idItemUtilizado]])]),_:2},1024),o(s,{col:"10 sm-grow"},{default:t(()=>[o(u,w({ref_for:!0},i.meta.composicao.lista.temporario.valor,{modelValue:a.composicao[q].temporario.valor,"onUpdate:modelValue":b=>a.composicao[q].temporario.valor=b,disable:!0,readonly:!0,class:"q-field--with-bottom"}),null,16,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(s,{col:"2 sm-shrink",text:"center"},{default:t(()=>[o(_,{onClick:b=>i.removerComposicao(q),icon:"delete",flat:"",round:"",dense:"",color:"tertiary",class:"q-mb-sm"},{default:t(()=>[o(Q,{anchor:"top left",self:"bottom start"},{default:t(()=>e[118]||(e[118]=[p("Remover")])),_:1})]),_:2},1032,["onClick"])]),_:2},1024)],64))),128)),o(s,{col:"12",text:"center",class:"q-mb-md"},{default:t(()=>[o(_,{onClick:i.adicionarComposicao,icon:"add",size:"sm",color:"positive",label:"Tratamento",outline:""},null,8,["onClick"])]),_:1})]),_:1})):k("",!0),o(Ke,{modelValue:a.tab,"onUpdate:modelValue":e[52]||(e[52]=d=>a.tab=d),"inline-label":"","outside-arrows":"","mobile-arrows":"",class:"bg-transparent q-mt-lg text-primary",align:"justify"},{default:t(()=>[o(le,{label:"Detalhes",name:"profile-tab-1"}),o(le,{label:"Especifica\xE7\xF5es",name:"profile-tab-5"}),o(le,{label:"Arquivos",name:"profile-images"}),o(le,{label:"Fornecedores",name:"profile-tab-2"}),a.item.tipo!=="Lente"&&a.sistemaPai!=="optisoul"||a.permissaoPcp?(g(),v(le,{key:0,label:"Composi\xE7\xE3o",name:"profile-tab-3"})):k("",!0),a.sistemaPai!=="optisoul"||a.permissaoPcp?(g(),v(le,{key:1,label:"PCP",name:"profile-tab-4"})):k("",!0)]),_:1},8,["modelValue"]),o(lo,{modelValue:a.tab,"onUpdate:modelValue":e[82]||(e[82]=d=>a.tab=d)},{default:t(()=>[o(ne,{name:"profile-tab-1",class:"bg-white q-pa-none"},{default:t(()=>[o(y,{gutter:"md",items:"top"},{default:t(()=>[o(s,{col:"12 sm9 md9"},{default:t(()=>[o(y,{gutter:"none-y"},{default:t(()=>[o(s,{col:"12 sm4"},{default:t(()=>[o(V,{modelValue:a.item.grupo,"onUpdate:modelValue":e[53]||(e[53]=d=>a.item.grupo=d),tabela:"item",campo:"grupo",label:"Grupo",buscarSemCaractere:!0,enableAdd:""},null,8,["modelValue"])]),_:1}),o(s,{col:"12 sm4"},{default:t(()=>[o(V,{modelValue:a.item.subGrupo,"onUpdate:modelValue":e[54]||(e[54]=d=>a.item.subGrupo=d),tabela:"item",campo:"subGrupo",label:"Subgrupo",buscarSemCaractere:!0,enableAdd:""},null,8,["modelValue"])]),_:1}),o(s,{col:"12 sm4"},{default:t(()=>[o(V,{modelValue:a.item.unidade,"onUpdate:modelValue":e[55]||(e[55]=d=>a.item.unidade=d),tabela:"item",campo:"unidade",label:"Unidade",buscarSemCaractere:!0,enableAdd:"",maxLength:"10"},null,8,["modelValue"])]),_:1}),o(s,{col:"6 sm4"},{default:t(()=>[o(u,w(i.meta.garantiaDias,{modelValue:a.item.garantiaDias,"onUpdate:modelValue":e[56]||(e[56]=d=>a.item.garantiaDias=d),class:"q-field--with-bottom"}),null,16,["modelValue"])]),_:1}),o(s,{col:"6 sm8"},{default:t(()=>[o(u,w({modelValue:a.item.garantiaDescricao,"onUpdate:modelValue":e[57]||(e[57]=d=>a.item.garantiaDescricao=d)},i.meta.garantiaDescricao,{class:"q-field--with-bottom"}),null,16,["modelValue"])]),_:1}),o(s,{col:"12 md4"},{default:t(()=>[o(u,w(i.meta.idPerfilContabil,{modelValue:a.item.idPerfilContabil,"onUpdate:modelValue":e[58]||(e[58]=d=>a.item.idPerfilContabil=d),filter:"",opcoes:a.opcoesPerfilContabil,onClick:i.leOpcoesPerfilContabil,class:"q-field--with-bottom"}),null,16,["modelValue","opcoes","onClick"])]),_:1}),o(s,{col:"12 md8"},{default:t(()=>[o(u,w({modelValue:a.item.codigoOrigem,"onUpdate:modelValue":e[59]||(e[59]=d=>a.item.codigoOrigem=d)},i.meta.codigoOrigem,{opcoes:a.opcoesOrigem,class:"q-field--with-bottom",style:{"white-space":"normal"}}),null,16,["modelValue","opcoes"])]),_:1})]),_:1})]),_:1}),o(s,{col:"12 sm3 md3"},{default:t(()=>[o(y,{gutter:"none-y"},{default:t(()=>[a.mostrarCampoMix?(g(),v(s,{key:0,col:"12"},{default:t(()=>[o(V,{modelValue:a.item.mix,"onUpdate:modelValue":e[60]||(e[60]=d=>a.item.mix=d),tabela:"item",campo:"mix",label:"Mix",buscarSemCaractere:!0,enableAdd:""},null,8,["modelValue"])]),_:1})):k("",!0),o(s,{col:"12"},{default:t(()=>[o(u,w(i.meta.observacao,{modelValue:a.item.observacao,"onUpdate:modelValue":e[61]||(e[61]=d=>a.item.observacao=d),class:"q-field--with-bottom"}),null,16,["modelValue"])]),_:1}),o(s,{col:"12"},{default:t(()=>[o(u,w(i.meta.aplicacao,{modelValue:a.item.aplicacao,"onUpdate:modelValue":e[62]||(e[62]=d=>a.item.aplicacao=d),class:"q-field--with-bottom"}),null,16,["modelValue"])]),_:1})]),_:1})]),_:1}),o(s,{col:"12"},{default:t(()=>[o(y,{gutter:"none-y"},{default:t(()=>[o(s,{col:"12"},{default:t(()=>[o(f,{text:"h6"},{default:t(()=>e[119]||(e[119]=[p("Caracter\xEDsticas")])),_:1})]),_:1}),o(s,{col:"4 md2"},{default:t(()=>[o(u,{modelValue:a.item.peso,"onUpdate:modelValue":e[63]||(e[63]=d=>a.item.peso=d),tipo:"decimal",decimals:"4",zerosDireita:"2",rotulo:"Peso",class:"q-field--with-bottom"},null,8,["modelValue"])]),_:1}),o(s,{col:"4 md2"},{default:t(()=>[o(u,{modelValue:a.item.pesoBruto,"onUpdate:modelValue":e[64]||(e[64]=d=>a.item.pesoBruto=d),tipo:"decimal",decimals:"4",zerosDireita:"2",rotulo:"Peso Bruto",class:"q-field--with-bottom"},null,8,["modelValue"])]),_:1}),o(s,{col:"4 md2"},{default:t(()=>[o(u,w({modelValue:a.item.densidade,"onUpdate:modelValue":e[65]||(e[65]=d=>a.item.densidade=d)},i.meta.densidade,{opcoes:{minimumValue:0,decimalPlaces:4},class:"q-field--with-bottom"}),null,16,["modelValue"])]),_:1}),o(s,{col:"4 md2"},{default:t(()=>[o(u,w({modelValue:a.item.altura,"onUpdate:modelValue":e[66]||(e[66]=d=>a.item.altura=d)},i.meta.altura,{opcoes:{minimumValue:0,decimalPlaces:4},class:"q-field--with-bottom"}),null,16,["modelValue"])]),_:1}),o(s,{col:"4 md2"},{default:t(()=>[o(u,w({col:"3",modelValue:a.item.largura,"onUpdate:modelValue":e[67]||(e[67]=d=>a.item.largura=d)},i.meta.largura,{opcoes:{minimumValue:0,decimalPlaces:4},class:"q-field--with-bottom"}),null,16,["modelValue"])]),_:1}),o(s,{col:"4 md2"},{default:t(()=>[o(u,{col:"3",modelValue:a.item.comprimento,"onUpdate:modelValue":e[68]||(e[68]=d=>a.item.comprimento=d),tipo:"decimal",decimals:"4",zerosDireita:"2",rotulo:"Comprimento",class:"q-field--with-bottom"},null,8,["modelValue"])]),_:1}),o(s,{col:"4 md"},{default:t(()=>[o(u,w({modelValue:a.item.capacidade,"onUpdate:modelValue":e[69]||(e[69]=d=>a.item.capacidade=d)},i.meta.capacidade,{opcoes:{minimumValue:0,decimalPlaces:4},class:"q-field--with-bottom"}),null,16,["modelValue"])]),_:1}),o(s,{col:"4 md"},{default:t(()=>[o(u,w({modelValue:a.item.capacidadeUnidade,"onUpdate:modelValue":e[70]||(e[70]=d=>a.item.capacidadeUnidade=d)},i.meta.capacidadeUnidade,{class:"q-field--with-bottom"}),null,16,["modelValue"])]),_:1}),o(s,{col:"4 md"},{default:t(()=>[o(u,w({modelValue:a.item.validadeMeses,"onUpdate:modelValue":e[71]||(e[71]=d=>a.item.validadeMeses=d)},i.meta.validadeMeses,{class:"q-field--with-bottom"}),null,16,["modelValue"])]),_:1}),o(s,{col:"6 sm md"},{default:t(()=>[o(u,w({modelValue:a.item.embalagem,"onUpdate:modelValue":e[72]||(e[72]=d=>a.item.embalagem=d)},i.meta.embalagem,{class:"q-field--with-bottom"}),null,16,["modelValue"])]),_:1}),o(s,{col:"6 sm md"},{default:t(()=>[o(u,{rotuloFixo:"Status",tipo:"seletor",modelValue:a.item.status,"onUpdate:modelValue":e[73]||(e[73]=d=>a.item.status=d),opcoes:i.opcoesStatus,class:"q-field--with-bottom"},null,8,["modelValue","opcoes"])]),_:1}),O(o(s,{col:"xs sm md"},{default:t(()=>[o(V,{modelValue:a.item.cor,"onUpdate:modelValue":e[74]||(e[74]=d=>a.item.cor=d),tabela:"item",campo:"cor",label:"Cor",buscarSemCaractere:!0,enableAdd:""},null,8,["modelValue"])]),_:1},512),[[de,a.item.tipo!=="\xD3culos Sol"&&a.item.tipo!=="\xD3culos Pronto"&&a.item.tipo!=="Lente"&&a.item.tipo!=="Lente Contato"]]),o(s,{col:"6 sm md"},{default:t(()=>[o(u,{modelValue:a.item.codigoANP,"onUpdate:modelValue":e[75]||(e[75]=d=>a.item.codigoANP=d),maxlength:"9",rotulo:"C\xF3digo ANP",dense:"",tipo:"texto",ajuda:a.descricaoANP,onBlur:i.consultarCodigoAnp},null,8,["modelValue","ajuda","onBlur"])]),_:1}),o(s,{col:"xs sm12 md",text:"center"},{default:t(()=>[o(u,{modelValue:a.item.bloquearVenda,"onUpdate:modelValue":e[76]||(e[76]=d=>a.item.bloquearVenda=d),tipo:"logico",rotulo:"Bloquear Venda",noDense:"",class:"q-field--with-bottom"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),o(ne,{name:"profile-tab-2",class:"bg-white q-pa-none"},{default:t(()=>[o(y,{gutter:"md",items:"center"},{default:t(()=>[(g(!0),E(z,null,L(a.fornecedor,(d,q)=>(g(),E(z,{key:q},[o(s,{col:"12 sm4"},{default:t(()=>{var b;return[o(u,w({"model-value":(b=a.contato[d.idContato])==null?void 0:b.apelido,ref_for:!0},i.meta.fornecedor.lista.idContato,{readonly:"",onClick:c=>i.selecionarFornecedor(q),before:[{icon:"search",handler(){i.selecionarFornecedor(q)}}]}),null,16,["model-value","onClick","before"]),O(A("input",{"onUpdate:modelValue":c=>d.idContato=c,type:"hidden"},null,8,ia),[[pe,d.idContato]])]}),_:2},1024),o(s,{col:"12 sm4"},{default:t(()=>[o(u,w({ref_for:!0},i.meta.fornecedor.lista.descricao,{modelValue:d.descricao,"onUpdate:modelValue":b=>d.descricao=b}),null,16,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(s,{col:"10 sm"},{default:t(()=>[o(u,w({ref_for:!0},i.meta.fornecedor.lista.referencia,{modelValue:d.referencia,"onUpdate:modelValue":b=>d.referencia=b}),null,16,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(s,{col:"2 sm-shrink",text:"center"},{default:t(()=>[o(_,{onClick:b=>i.removerItemDaLista(a.fornecedor,q),icon:"delete",flat:"",round:"",dense:"",color:"tertiary",class:"q-mt-sm"},{default:t(()=>[o(Q,{anchor:"top left",self:"bottom start"},{default:t(()=>e[120]||(e[120]=[p("Remover")])),_:1})]),_:2},1032,["onClick"])]),_:2},1024),o(s,{col:"12",class:"q-mb-sm"})],64))),128)),o(s,{col:"12",text:"center"},{default:t(()=>[o(_,{onClick:e[77]||(e[77]=()=>{this.fornecedor.push({})}),icon:"add",size:"sm",color:"positive",label:"Fornecedor",outline:""})]),_:1})]),_:1})]),_:1}),o(ne,{name:"profile-images",class:"bg-white q-pa-none"},{default:t(()=>[o(y,{gutter:"md"},{default:t(()=>[o(s,null,{default:t(()=>[o($,{resize:{crop:!0,width:1e3,height:1e3},idTabelaMaster:a.item.id,arquivo:a.arquivo,tipoArquivo:"itemImagem"},null,8,["idTabelaMaster","arquivo"])]),_:1})]),_:1})]),_:1}),o(ne,{name:"profile-tab-3",class:"bg-white q-pa-none"},{default:t(()=>[o(y,{gutter:"md",items:"center"},{default:t(()=>[(g(!0),E(z,null,L(a.composicao,(d,q)=>(g(),E(z,{key:q},[o(s,{col:"12 sm4"},{default:t(()=>[o(u,{"model-value":d.descricaoItemUtilizado,onClick:b=>i.abrirModalItemUtilizado(q),before:[{icon:"search",handler(){i.abrirModalItemUtilizado(q)}}],readonly:"",rotulo:"Produto para composi\xE7\xE3o",tipo:"texto"},null,8,["model-value","onClick","before"])]),_:2},1024),o(s,{col:"12 sm4"},{default:t(()=>[o(u,w({ref_for:!0},i.meta.composicao.lista.ordem,{modelValue:d.ordem,"onUpdate:modelValue":b=>d.ordem=b}),null,16,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(s,{col:"10 sm"},{default:t(()=>[o(u,w({ref_for:!0},i.meta.composicao.lista.quantidade,{modelValue:d.quantidade,"onUpdate:modelValue":[b=>d.quantidade=b,b=>i.atualizarItemComposicao(d.idItemUtilizado)]}),null,16,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(s,{col:"2 sm-shrink",text:"center"},{default:t(()=>[o(_,{onClick:b=>i.removerComposicao(q),icon:"delete",flat:"",round:"",dense:"",color:"tertiary",class:"q-mt-sm"},{default:t(()=>[o(Q,{anchor:"top left",self:"bottom start"},{default:t(()=>e[121]||(e[121]=[p("Remover")])),_:1})]),_:2},1032,["onClick"])]),_:2},1024),o(s,{col:"12",class:"q-mb-sm"})],64))),128)),o(s,{col:"12",text:"center"},{default:t(()=>[o(_,{onClick:i.adicionarComposicao,icon:"add",size:"sm",color:"positive",label:"Composi\xE7\xE3o",outline:""},null,8,["onClick"])]),_:1})]),_:1})]),_:1}),o(ne,{name:"profile-tab-4",class:"bg-white q-pa-none"},{default:t(()=>[o(y,{gutter:"md"},{default:t(()=>[o(s,{col:"12 sm5"},{default:t(()=>[o(u,w({modelValue:a.item.numeroPop,"onUpdate:modelValue":e[78]||(e[78]=d=>a.item.numeroPop=d)},i.meta.numeroPop,{class:"q-field--with-bottom"}),null,16,["modelValue"])]),_:1}),o(s,{col:"12 sm7"},{default:t(()=>[o(u,w({modelValue:a.item.procedimento,"onUpdate:modelValue":e[79]||(e[79]=d=>a.item.procedimento=d)},i.meta.procedimento,{class:"q-field--with-bottom"}),null,16,["modelValue"])]),_:1})]),_:1}),o(y,{gutter:"md",items:"center"},{default:t(()=>[o(s,{col:"12"},{default:t(()=>[o(f,{text:"h6"},{default:t(()=>e[122]||(e[122]=[p("Qualidade")])),_:1})]),_:1}),(g(!0),E(z,null,L(a.qualidade,(d,q)=>(g(),E(z,{key:q},[o(s,{col:"12 sm4"},{default:t(()=>[o(u,w({ref_for:!0},i.meta.qualidade.lista.descricao,{modelValue:d.descricao,"onUpdate:modelValue":b=>d.descricao=b}),null,16,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(s,{col:"12 sm4"},{default:t(()=>[o(u,w({ref_for:!0},i.meta.qualidade.lista.especificacao,{modelValue:d.especificacao,"onUpdate:modelValue":b=>d.especificacao=b}),null,16,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(s,{col:"10 sm"},{default:t(()=>[o(u,w({ref_for:!0},i.meta.qualidade.lista.limites,{modelValue:d.limites,"onUpdate:modelValue":b=>d.limites=b}),null,16,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(s,{col:"2 sm-shrink",text:"center"},{default:t(()=>[o(_,{onClick:b=>i.removerItemDaLista(a.qualidade,q),icon:"delete",flat:"",round:"",dense:"",color:"tertiary",class:"q-mt-sm"},{default:t(()=>[o(Q,{anchor:"top left",self:"bottom start"},{default:t(()=>e[123]||(e[123]=[p("Remover")])),_:1})]),_:2},1032,["onClick"])]),_:2},1024),o(s,{col:"12",class:"q-mb-sm"})],64))),128)),o(s,{col:"12",text:"center"},{default:t(()=>[o(_,{onClick:e[80]||(e[80]=()=>{this.qualidade.push({idItem:this.item.id})}),icon:"add",size:"sm",color:"positive",label:"Qualidade",outline:""})]),_:1})]),_:1}),o(y,{gutter:"md"},{default:t(()=>[o(s,{col:"12"},{default:t(()=>[o(f,{text:"h6"},{default:t(()=>e[124]||(e[124]=[p("Fase")])),_:1})]),_:1}),(g(!0),E(z,null,L(a.producaoFase,(d,q)=>(g(),E(z,{key:q},[o(s,{col:"12 sm6 md"},{default:t(()=>[o(u,w({ref_for:!0},i.meta.producaoFase.lista.ordem,{modelValue:d.ordem,"onUpdate:modelValue":b=>d.ordem=b}),null,16,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(s,{col:"12 sm6 md"},{default:t(()=>[o(u,w({ref_for:!0},i.meta.producaoFase.lista.descricao,{modelValue:d.descricao,"onUpdate:modelValue":b=>d.descricao=b}),null,16,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(s,{col:"12 sm md"},{default:t(()=>[o(u,{"model-value":d.descricaoItemEquipamento,before:[{icon:"search",handler(){i.abrirModalEquipamento(q)}}],onClick:b=>i.abrirModalEquipamento(q),readonly:"",rotulo:"Equipamento"},null,8,["model-value","before","onClick"]),O(A("input",{"onUpdate:modelValue":b=>d.idItemEquipamento=b,type:"hidden"},null,8,ra),[[pe,d.idItemEquipamento]])]),_:2},1024),o(s,{col:"12 sm md"},{default:t(()=>[o(u,{"model-value":d.descricaoItemFerramenta,before:[{icon:"search",handler(){i.abrirModalFerramenta(q)}}],onClick:b=>i.abrirModalFerramenta(q),readonly:"",rotulo:"Ferramenta"},null,8,["model-value","before","onClick"]),O(A("input",{"onUpdate:modelValue":b=>d.idItemFerramenta=b,type:"hidden"},null,8,sa),[[pe,d.idItemFerramenta]])]),_:2},1024),o(s,{col:"grow sm md"},{default:t(()=>[o(u,{"model-value":d.descricaoItemServico,before:[{icon:"search",handler(){i.abrirModalServico(q)}}],onClick:b=>i.abrirModalServico(q),readonly:"",rotulo:"Servico"},null,8,["model-value","before","onClick"]),O(A("input",{"onUpdate:modelValue":b=>d.idItemServico=b,type:"hidden"},null,8,na),[[pe,d.idItemServico]])]),_:2},1024),o(s,{col:"2 sm-shrink",text:"center"},{default:t(()=>[o(_,{onClick:b=>i.removerItemDaLista(a.producaoFase,q),icon:"delete",flat:"",round:"",dense:"",color:"tertiary",class:"q-mt-sm"},{default:t(()=>[o(Q,{anchor:"top left",self:"bottom start"},{default:t(()=>e[125]||(e[125]=[p("Remover")])),_:1})]),_:2},1032,["onClick"])]),_:2},1024),o(s,{col:"12",class:"q-mb-sm"})],64))),128)),o(s,{col:"12",text:"center"},{default:t(()=>[o(_,{onClick:e[81]||(e[81]=()=>{this.producaoFase.push({idItem:this.item.id})}),icon:"add",size:"sm",color:"positive",label:"Fase",outline:""})]),_:1})]),_:1})]),_:1}),o(ne,{name:"profile-tab-5",class:"bg-white q-pa-none"},{default:t(()=>[o(y,{gutter:"md",items:"center"},{default:t(()=>[(g(!0),E(z,null,L(a.especificacao,(d,q)=>(g(),E(z,{key:q},[o(s,{col:"12 sm4"},{default:t(()=>[o(u,{modelValue:d.descricao,"onUpdate:modelValue":b=>d.descricao=b,rotulo:"Descri\xE7\xE3o"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(s,{col:"12 sm4"},{default:t(()=>[o(u,{modelValue:d.valor,"onUpdate:modelValue":b=>d.valor=b,rotulo:"Valor"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(s,{col:"10 grow sm"},{default:t(()=>[o(u,{modelValue:d.agrupamento,"onUpdate:modelValue":b=>d.agrupamento=b,rotulo:"Agrupamento"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(s,{col:"2 sm-shrink",text:"center"},{default:t(()=>[o(_,{onClick:b=>i.especificacaoRemover(q),icon:"delete",flat:"",round:"",dense:"",color:"tertiary",class:"q-mt-sm"},null,8,["onClick"])]),_:2},1024),o(s,{col:"12",class:"q-mb-sm"})],64))),128)),o(s,{col:"12",text:"center"},{default:t(()=>[o(_,{onClick:i.especificacaoAdicionar,icon:"add",size:"sm",color:"positive",label:"Especifica\xE7\xE3o",outline:""},null,8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(y,{gutter:"lg",items:"center",text:"center"},{default:t(()=>[a.item.dataCadastro?(g(),v(s,{key:0,col:"12 sm"},{default:t(()=>[A("small",null,"Data do cadastro: "+P(l.$filters.dataHora(a.item.dataCadastro)),1)]),_:1})):k("",!0),a.item._DataHoraUltimaAlteracao?(g(),v(s,{key:1,col:"12 sm"},{default:t(()=>[A("small",null,"\xDAltima altera\xE7\xE3o: "+P(l.$filters.dataHora(a.item._DataHoraUltimaAlteracao)),1)]),_:1})):k("",!0)]),_:1})]),_:1})]),_:1}),o(Ie,{class:"bg-light",bordered:""},{default:t(()=>[o(B,{class:"bg-light text-tertiary q-pa-sm u-container"},{default:t(()=>[a.item.ativo?(g(),E("div",da,[o(_,{onClick:io(i.aoCancelar,["prevent"]),label:"Cancelar",flat:"",color:"tertiary",class:"q-ml-sm"},null,8,["onClick"]),o(_,{type:"submit",label:"Salvar",color:"primary",unelevated:"",class:"q-ml-sm"}),o(_,{onClick:i.itemRemover_click,icon:"delete",round:"",flat:"",color:"tertiary",class:"q-ml-md"},{default:t(()=>[o(Q,{anchor:"bottom middle",self:"center middle",class:"hideonmobile"},{default:t(()=>e[126]||(e[126]=[p("Inativar")])),_:1})]),_:1},8,["onClick"])])):(g(),E("div",ua,[o(f,{inline:"",text:"sub1 medium"},{default:t(()=>e[127]||(e[127]=[p("N\xE3o \xE9 poss\xEDvel editar informa\xE7\xF5es de um produto inativo.")])),_:1}),o(_,{onClick:i.itemRestaurar_click,label:"Reativar produto",color:"primary",unelevated:"",class:"q-ml-sm text-white float-right"},null,8,["onClick"])]))]),_:1})]),_:1}),o(T,{ref:"modalTrocarFoto"},null,512),o(K,{modelValue:a.modalEquipamento,"onUpdate:modelValue":e[83]||(e[83]=d=>a.modalEquipamento=d),filtro:{tipo:"Equipamento",ativo:!0},onSelecionarItens:i.selecionarEquipamento},null,8,["modelValue","onSelecionarItens"]),o(K,{modelValue:a.modalFerramenta,"onUpdate:modelValue":e[84]||(e[84]=d=>a.modalFerramenta=d),filtro:{tipo:"Ferramenta",ativo:!0},onSelecionarItens:i.selecionarFerramenta},null,8,["modelValue","onSelecionarItens"]),o(K,{modelValue:a.modalServico,"onUpdate:modelValue":e[85]||(e[85]=d=>a.modalServico=d),filtro:{tipo:"Servi\xE7o",ativo:!0},onSelecionarItens:i.selecionarServico},null,8,["modelValue","onSelecionarItens"]),o(K,{modelValue:a.modalTratamento,"onUpdate:modelValue":e[86]||(e[86]=d=>a.modalTratamento=d),filtro:{tipo:"Tratamento",ativo:!0},onSelecionarItens:i.selecionarTratamento},null,8,["modelValue","onSelecionarItens"]),o(K,{modelValue:a.modalItemUtilizado,"onUpdate:modelValue":e[87]||(e[87]=d=>a.modalItemUtilizado=d),filtro:{ativo:!0},onSelecionarItens:i.selecionarItemUtilizado},null,8,["modelValue","onSelecionarItens"]),o(R,{label:"Gostaria de importar essas informa\xE7\xF5es no produto?",onOpcaoSelecionada:i.importarDadosReferencia,ref:"modalImportarDados"},null,8,["onOpcaoSelecionada"]),o(oe,{modelValue:a.modalMarkup.visivel,"onUpdate:modelValue":e[98]||(e[98]=d=>a.modalMarkup.visivel=d),onKeyup:e[99]||(e[99]=_e(d=>i.fecharModalMarkup(),["esc"])),persistent:""},{default:t(()=>[o(qe,{container:"",view:"hHh LpR fFf",class:"bg-white rounded-borders",style:Ae(a.tela.width<=550?"height:100%;max-height:540px;":"max-width:550px;height:100%;max-height:500px;")},{default:t(()=>[e[132]||(e[132]=p(" > ")),o(ke,null,{default:t(()=>[o(B,null,{default:t(()=>[o(F,{name:"calculate",size:"sm",flat:""}),o(ee,null,{default:t(()=>e[128]||(e[128]=[p("Markup X Margem de Lucro")])),_:1})]),_:1})]),_:1}),o(ue,null,{default:t(()=>[o(me,null,{default:t(()=>[o(y,{gutter:"md",class:"q-mb-lg"},{default:t(()=>[o(s,{col:"12"},{default:t(()=>[o(f,{bordered:"","rounded-borders":"",text:"caption",class:"q-pa-sm"},{default:t(()=>e[129]||(e[129]=[A("strong",null,"N\xE3o \xE9 para ter margem\xA0de\xA0lucro superior a 99.99%",-1),p(", o c\xE1lculo do lucro \xE9 sempre sobre o valor da venda, a explica\xE7\xE3o vem da an\xE1lise que o lucro da "),A("strong",null,"EMPRESA",-1),p(" sempre \xE9 c\xE1lculado com base no "),A("strong",null,"LUCRO",-1),p(" x "),A("strong",null,"FATURAMENTO",-1),p(". ")])),_:1})]),_:1})]),_:1}),o(y,{gutter:"md-x",justify:"center"},{default:t(()=>[o(s,{col:"6 sm5"},{default:t(()=>[o(u,{modelValue:a.modalMarkup.custo,"onUpdate:modelValue":[e[88]||(e[88]=d=>a.modalMarkup.custo=d),e[89]||(e[89]=d=>i.calcularModalMarkup("custo"))],dense:"",filled:"","lazy-rules":"",tipo:"decimal",rotulo:"Custo de reposi\xE7\xE3o",decimals:"2",zerosDireita:"2","hide-bottom-space":"",class:"q-mb-lg",debounce:500},null,8,["modelValue"])]),_:1})]),_:1}),o(y,{gutter:"md-x",justify:"center"},{default:t(()=>[o(s,{col:"6 sm5"},{default:t(()=>[o(u,{modelValue:a.modalMarkup.markup,"onUpdate:modelValue":[e[90]||(e[90]=d=>a.modalMarkup.markup=d),e[91]||(e[91]=d=>i.calcularModalMarkup("markup"))],filled:"",dense:"","lazy-rules":"",rotulo:"Percentual Markup",somenteLeitura:!(a.modalMarkup.custo>0),tipo:"decimal",decimals:"2",zerosDireita:"2",suffix:"%","hide-bottom-space":"",debounce:500},null,8,["modelValue","somenteLeitura"]),o(f,{class:"q-pa-xs",style:{"font-size":"11px","line-height":"1.1"}},{default:t(()=>e[130]||(e[130]=[p(" \xC9 um \xEDndice aplicado sobre o pre\xE7o de custo para determinar o pre\xE7o de venda. ")])),_:1})]),_:1}),o(s,{col:"6 sm5"},{default:t(()=>[o(u,{modelValue:a.modalMarkup.lucro,"onUpdate:modelValue":[e[92]||(e[92]=d=>a.modalMarkup.lucro=d),e[93]||(e[93]=d=>i.calcularModalMarkup("lucro"))],filled:"",dense:"","lazy-rules":"",tipo:"decimal",rotulo:"Margem de Lucro",somenteLeitura:!(a.modalMarkup.custo>0),suffix:"%",decimals:"2",zerosDireita:"2","hide-bottom-space":"",debounce:500},null,8,["modelValue","somenteLeitura"]),o(f,{class:"q-pa-xs",style:{"font-size":"11px","line-height":"1.1"}},{default:t(()=>e[131]||(e[131]=[p(" \xC9 o percentual do pre\xE7o de venda correspondente ao lucro da opera\xE7\xE3o. ")])),_:1})]),_:1})]),_:1}),o(y,{gutter:"md-x",justify:"center"},{default:t(()=>[o(s,{col:"6 sm5"},{default:t(()=>[o(u,{modelValue:a.modalMarkup.venda,"onUpdate:modelValue":[e[94]||(e[94]=d=>a.modalMarkup.venda=d),e[95]||(e[95]=d=>i.calcularModalMarkup("venda"))],somenteLeitura:!(a.modalMarkup.custo>0),debounce:500,filled:"",dense:"","lazy-rules":"","hide-bottom-space":"",rotulo:"Valor de Venda",tipo:"decimal",decimals:"2",zerosDireita:"2",class:"q-mt-md"},null,8,["modelValue","somenteLeitura"])]),_:1})]),_:1})]),_:1})]),_:1}),o(Ie,{class:"bg-light"},{default:t(()=>[o(B,null,{default:t(()=>[o(te),o(_,{onClick:e[96]||(e[96]=d=>i.fecharModalMarkup()),flat:"",label:"Cancelar",color:"tertiary"}),o(_,{onClick:e[97]||(e[97]=d=>i.fecharModalMarkup(!0)),unelevated:"",label:"Aplicar",color:"primary",class:"q-ml-sm"})]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["modelValue"])]),_:1},8,["onSubmit"])}var ca=H(ta,[["render",ma],["__scopeId","data-v-7fe0e0c3"]]);const pa={components:{"g-row":Ue,"g-col":Me,"g-label":Pe},computed:{colunasKardex(){return[{align:"left",name:"DataHoraFinalizado",field:"dataHoraFinalizado",label:"Data Movimenta\xE7\xE3o",sortable:!0,format:this.$filters.dataHora},{align:"left",name:"DocumentoTipo",field:"documentoTipo",label:"Documento",sortable:!0},{align:"middle",name:"Acao",field:"acao",label:"A\xE7\xE3o"},{align:"right",name:"Numero",field:"numero",label:"N\xFAmero",format:e=>e||0},{align:"right",name:"Quantidade",field:"quantidade",label:"Quantidade"},{align:"left",name:"Unidade",field:"unidade",label:"Unidade"},{align:"right",name:"Saldo",field:"saldo",label:"Saldo",sortable:!0},{align:"left",name:"DescricaoContato",field:"descricaoContato",label:"Contato",format:e=>e||""},{align:"right",name:"CustoMedio",field:"custoMedio",label:"Custo M\xE9dio",format:this.$filters.dinheiro},{align:"right",name:"Custo",field:"custo",label:"Custo Real",format:this.$filters.dinheiro},{align:"right",name:"Venda",field:"venda",label:"Venda",format:this.$filters.dinheiro},{align:"right",name:"Ordem",field:"ordem",label:"Ordem",sortable:!0},{align:"right",name:"Fator",field:"fator",label:"Fator"},{align:"left",name:"DocumentoItemOperacao",field:"documentoItemOperacao",label:"Opera\xE7\xE3o Item",sortable:!0},{align:"left",name:"DocumentoItemStatus",field:"documentoItemStatus",label:"Status Item",sortable:!0},{align:"right",name:"CodigoDocumento",field:"codigoDocumento",label:"C\xF3digo Documento",sortable:!0},{align:"center",name:"observacao",field:"observacao",label:"Observa\xE7\xE3o"}]}},data(){return{estoquePorEmpresa:[],estoqueMinimoEmpresaOriginal:[],estoqueMinimoEmpresa:[],item:{ativo:!1},itemOriginal:{},ajusteData:null,ajuste:{custoDesejado:0,data:null,lote:"",planoConta:"",planoContaEstoque:"",planoContaMovimento:"",qtdeDesejada:0,qtdeDiferenca:0,qtdeMomento:0},ajusteCor:"text-primary",ajusteMensagem:"",ajusteDataSomenteLeitura:!1,codigoEmpresaSelecionada:0,ajusteRegras:{planoConta:[l=>!!this.ajuste.planoConta||"Selecione uma conta do plano de contas"],planoContaEstoque:[l=>!!this.ajuste.planoContaEstoque||"Selecione uma conta do plano de contas"],planoContaMovimento:[l=>!!this.ajuste.planoContaMovimento||"Selecione uma conta do plano de contas"],custoDesejado:[l=>l>0||"Custo deve ser maior que zero"],qtdeDesejada:[l=>this.ajuste.qtdeDesejada>=0||"Quantidade deve ser maior ou igual a zero"]},codigoEmpresaKardex:0,tipoEstoqueSelecionado:"",tipoLoteSelecionado:"",mensagemKardex:"",tabelaKardex:[],atualizandoKardex:!1,recalculandoKardex:!1,empresas:[],opcoesConta:[],opcoesPlanoConta:[{rotulo:"-",valor:""}],opcoesTipoEstoque:[{rotulo:"-",valor:""}],opcoesLoteEstoque:[{rotulo:"-",valor:""}],permissaoAjusteEstoque:!0,permissaoFicha:!0,usaLote:!1,usaLoteEmpresaKardex:!1,usaLoteEmpresaAjuste:!1}},methods:{ajustarData(){if(!!/\d{2}\/\d{2}\/\d{4}\s\d{2}:\d{2}/.test(this.ajusteData))try{let l=this.ajusteData.split("/");l=[l[1],l[0],l[2]].join("/"),l=new Date(l),this.ajuste.data=l.toISOString()}catch(l){console.log("erro: ",l.message)}},async atualizar({id:l}){if(!!l){try{const e=new Intl.DateTimeFormat("pt-BR",{dateStyle:"short",timeStyle:"medium"});this.ajuste.data=$utils.dataAtual(),this.ajusteData=e.format(new Date(this.ajuste.data)),this.permissaoFicha=await $db.permissao.objeto("item//ficha");const r=await $db.item.leCompletoV2(l);this.item=$utils.clonar(r.item),this.itemOriginal=$utils.clonar(r.item);const a=(await $db.contato.ler({filtros:{ativo:!0,empresas:!0}})).data.map(m=>m.id);let i=(await $erp().empresa.toArray()).filter(m=>~a.indexOf(m.idContato));this.empresas=i.map(m=>({rotulo:m.apelido+" - "+m.nome,valor:m.codigoContato})),this.empresas.length===0&&(this.empresas=[{rotulo:"-",valor:""}]),this.estoquePorEmpresa=await $db.estoqueSaldoProdutoEmpresa.leEstoquePorEmpresa(l),this.estoqueMinimoEmpresa=[];for(const m of i){const s=await $db.itemEstoqueMinimo.ler({idEmpresa:m.idContato,idItem:this.item.id});if(s.length===0){const f={id:$utils.uuid(),quantidadeMinimaEstoque:0,quantidadeMinimaCompra:0,tempoMedioReposicao:0,consumoMedio:0,local:"",idItem:this.item.id,idEmpresa:m.idContato,nomeEmpresa:m.apelido};this.estoqueMinimoEmpresa.push(f)}else{const f=$utils.clonar(s[0]);f.nomeEmpresa=m.apelido,this.estoqueMinimoEmpresa.push($utils.clonar(f)),this.estoqueMinimoEmpresaOriginal.push($utils.clonar(f))}}}catch(e){$q.notifyError("Ocorreu erro ao consultar produto",e)}try{const e=(await $db.configuracoes.le()).filter(n=>n.nome==="item.estoque.ajuste").sort((n,a)=>n.texto.localeCompare(a.texto));this.opcoesPlanoConta=[{rotulo:"-",valor:""},...e.map(n=>({rotulo:(n.texto||"").trim(),valor:n.valor})),{rotulo:"Especificar Contas",valor:"0"}];const r=(await $db.financeiroPlanoConta.le()).filter(n=>n.ativo&&!!n.tradutor&&n.tradutor.substr(12,5)!=="00000").sort((n,a)=>n.tradutor.localeCompare(a.tradutor));this.opcoesConta=r.map(n=>({valor:n.codigoFinanceiroPlanoConta,rotulo:(n.descricao||"").trim(),sublabel:(n.caminho||"").trim()}))}catch(e){$q.notifyError("Ocorreu erro ao consultar o plano de contas",e),this.opcoesConta=[]}this.atualizarKardex(),this.codigoEmpresaSelecionada||(this.codigoEmpresaSelecionada=this.empresas[0].valor),await this.atualizarAjustePorLote(),await this.alterarCodigoEmpresaAjuste(),await this.configLote()}},async salvarEstoqueMinimoEmpresa(l){try{const e=this.estoqueMinimoEmpresa.find(n=>n.idEmpresa===l),r=this.estoqueMinimoEmpresaOriginal.find(n=>n.idEmpresa===l);await $db.itemEstoqueMinimo.gravar({original:r,atual:e}),$q.notifyPositive("Estoque minimo do item salvo para a empresa.")}catch(e){console.log(e.message)}},async configLote(){var e;let l;this.usaLote=!1,l=await $db.configuracoes.le({nome:"usa.lote"}),this.usaLote=((e=l[0])==null?void 0:e.valor)==="1"},async salvarItem(){if(!this.verificarSeAlterouCampos()){$q.notifyPositive("N\xE3o h\xE1 dados alterados.");return}try{const l=this.item.id,e={originais:{item:this.itemOriginal},item:this.item};await $db.item.gravaV2(e),await this.atualizar({id:l}),$q.notifyPositive("Os dados foram salvos com sucesso.")}catch(l){$q.notifyError("Ocorreu um erro ao salvar",l)}},async estoqueAjustar_click(){const l=this.item.id;try{this.ajusteCor="text-primary",this.ajusteMensagem="Processando",$q.loading.show(),await $db.item.ajusteEstoque({codigoEmpresaSelecionada:this.codigoEmpresaSelecionada,idItem:this.item.id,...this.ajuste}),this.ajuste.observacao="",this.ajusteCor="text-positive",this.ajusteMensagem="Ajuste inclu\xEDdo com sucesso!",$q.notifyPositive(this.ajusteMensagem),await this.atualizar({id:l})}catch(e){let r="N\xE3o foi poss\xEDvel realizar o ajuste de estoque.";/^GError:/.test(e.message)&&(r+=` ${e.message.slice(7)}`),this.ajusteCor="text-negative",this.ajusteMensagem=r,$q.notify({type:"negative",message:r})}finally{$q.loading.hide()}},atualizarDiferenca(){this.ajuste.qtdeDiferenca=this.ajuste.qtdeDesejada-this.ajuste.qtdeMomento},async atualizarAjustePorLote(){let l=this.ajusteData;l=l.replace(", "," ");const e=`
          select top 1
            custoMedio valorCustoMedio,
            saldo
          from kardex
          where
            codigoItem = ${(this.item||{}).codigoItem||0}
            and codigoEmpresa = ${this.codigoEmpresaSelecionada||0}
            and datahorafinalizado <= '${l}'
            and tipoEstoque = 'Dispon\xEDvel'
            and ${(this.ajuste.lote||"").trim()?"loteEmpresa = '"+(this.ajuste.lote||"").trim()+"'":"(ltrim(rtrim(loteEmpresa)) = '' or loteEmpresa is null)"}
          order by ordem desc`;let r={};try{r=(await $utils.executarSql(e)||[])[0]||{}}catch{this.ajusteDataSomenteLeitura=!0,$utils.gconsole.log("ItemEstoque","atualizarAjustePorLote",this.codigoEmpresaSelecionada,this.ajuste.lote),r=(((this.estoquePorEmpresa||[]).find(m=>m.codigoEmpresa===this.codigoEmpresaSelecionada)||{}).estoquePorLote||[]).find(m=>m.tipoEstoque==="Dispon\xEDvel"&&(m.loteEmpresa||"")===this.ajuste.lote)||{}}this.ajuste.custoMomento=r.valorCustoMedio||0,this.ajuste.custoDesejado=this.ajuste.custoDesejado||r.valorCustoMedio||0,this.ajuste.qtdeMomento=r.saldo||0,this.ajuste.qtdeDesejada=this.ajuste.qtdeMomento||0,this.atualizarDiferenca(),await this.atualizarKardex()},async recalcularKardex(){try{this.recalculandoKardex=!0,await $utils.geeksApi({calculaKardex:{funcao:"9913E9FD-24A5-4C0A-9F1E-AACCDC7EAB9D",idItem:this.item.id}}),await this.atualizarKardex()}catch(l){console.log(l.message),this.mensagemKardex="N\xE3o foi poss\xEDvel recalcular o Kardex neste momento. Por favor, tente novamente!"}finally{this.recalculandoKardex=!1}},async alterarCodigoEmpresaKardex(){this.tipoLoteSelecionado="",await this.atualizarKardex()},async alterarCodigoEmpresaAjuste(){let l=!1;if(this.codigoEmpresaSelecionada){const r=(await $erp().empresa.toArray()).find(a=>a.codigoContato===this.codigoEmpresaSelecionada);let n;n=await $db.configuracoes.le({nome:"usa.lote"}),n=n.find(a=>a.idEmpresa===(r==null?void 0:r.idContato)),l=(n==null?void 0:n.valor)==="1"}this.usaLoteEmpresaAjuste=l,this.ajuste.lote=""},async atualizarKardex(){var l,e,r,n,a,i,m,s,f;if(!!this.item.id){this.atualizandoKardex=!0,this.codigoEmpresaKardex||(this.codigoEmpresaKardex=(l=this.empresas[0])==null?void 0:l.valor);try{let h,u,V,S,x=!1;if(h=await $utils.geeksApi({listaKardex:{funcao:"267A2ED1-6529-451D-8567-7015470E9CD6",idItem:this.item.id,codigoEmpresa:this.codigoEmpresaKardex}}),u=((r=(e=h==null?void 0:h.data)==null?void 0:e.listaKardex)!=null?r:[]).filter(y=>y.tipoEstoque).map(y=>y.tipoEstoque),u=Array.from(new Set(u)),u=u.map(y=>({rotulo:y,valor:y})),V=((a=(n=h==null?void 0:h.data)==null?void 0:n.listaKardex)!=null?a:[]).filter(y=>y.loteEmpresa).map(y=>y.loteEmpresa),V=Array.from(new Set(V)),V=V.map(y=>({rotulo:y,valor:y})),this.tipoEstoqueSelecionado||(this.tipoEstoqueSelecionado=(m=(i=u[0])==null?void 0:i.valor)!=null?m:""),S=((f=(s=h==null?void 0:h.data)==null?void 0:s.listaKardex)!=null?f:[]).filter(y=>y.tipoEstoque===this.tipoEstoqueSelecionado),this.tipoLoteSelecionado||(S=S.filter(y=>!y.loteEmpresa)),this.tipoLoteSelecionado&&(S=S.filter(y=>y.loteEmpresa===this.tipoLoteSelecionado)),this.codigoEmpresaKardex){const Z=(await $erp().empresa.toArray()).find($=>$.codigoContato===this.codigoEmpresaKardex);h=await $db.configuracoes.le({nome:"usa.lote"}),h=h.find($=>$.idEmpresa===(Z==null?void 0:Z.idContato)),x=(h==null?void 0:h.valor)==="1"}this.opcoesTipoEstoque=u,this.opcoesLoteEstoque=V,this.tabelaKardex=S,this.usaLoteEmpresaKardex=x,this.mensagemKardex=""}catch(h){this.mensagemKardex="\xC9 necess\xE1rio estar com a internet ativa para acessar este servi\xE7o",console.error("Mensagem ao usu\xE1rio: "+this.mensagemKardex),console.error(h)}finally{this.atualizandoKardex=!1}}},excluirAjuste(l){$q.dialog({message:"Ao continuar o ajuste ser\xE1 exclu\xEDdo.",noRefocus:!0,title:"Tem certeza?",cancel:{label:"Cancelar",push:!0,color:"tertiary",flat:!0},ok:{label:"Continuar",push:!0,class:"bg-negative",textColor:"white",flat:!0}}).onOk(async()=>{try{$q.loading.show({message:"Excluindo ajuste"});const e=`exec Sp_Estoque_ExcluirAjuste ${l}, ${this.item.codigoItem}`;await $utils.executarSql(e),await this.recalcularKardex(),await this.atualizar({id:this.item.id}),$q.notifyPositive("Ajuste exclu\xEDdo com sucesso")}catch{}finally{$q.loading.hide()}})},verificarSeAlterouCampos(){return $utils.diferenca(this.itemOriginal,this.item)!==null}},watch:{"ajuste.data"(){this.atualizarAjustePorLote()},"ajuste.lote"(){this.atualizarAjustePorLote()},codigoEmpresaSelecionada(){this.atualizarAjustePorLote()},codigoEmpresaKardex(){this.atualizarKardex()},tipoEstoqueSelecionado(){this.atualizarKardex()},"ajuste.planoConta"(){if(this.ajuste.planoConta!=="0"){const[l,e]=this.ajuste.planoConta.split(",");this.ajuste.planoContaEstoque=+l||0,this.ajuste.planoContaMovimento=+e||0}},"$route.params.id"(l){this.atualizar({id:l})}}},fa={key:0,class:"row items-center no-wrap"},ga={key:1};function ba(l,e,r,n,a,i){const m=C("g-label"),s=C("g-col"),f=C("g-row"),h=C("campo");return g(),v(ue,null,{default:t(()=>[o(me,{class:"u-container"},{default:t(()=>[o(f,{gutter:"md",bg:"bg-white",class:"q-my-md"},{default:t(()=>[(g(!0),E(z,null,L(a.estoquePorEmpresa,u=>(g(),v(s,{key:u.idEmpresa,col:"12",class:xe(a.estoquePorEmpresa.length>1?"q-my-sm":"")},{default:t(()=>[o(m,{text:"sub2 bold",icon:"factory xs grey-7 left"},{default:t(()=>[p(P(u.nomeEmpresa),1)]),_:2},1024),o(f,{justify:"around",text:"center caption medium"},{default:t(()=>[o(s,{col:"2"},{default:t(()=>e[14]||(e[14]=[p("Tipo")])),_:1}),a.usaLote?(g(),v(s,{key:0,col:"2"},{default:t(()=>e[15]||(e[15]=[p("Lote")])),_:1})):k("",!0),o(s,{col:"2"},{default:t(()=>e[16]||(e[16]=[p("Saldo")])),_:1}),o(s,{col:"2"},{default:t(()=>e[17]||(e[17]=[p("Custo M\xE9dio")])),_:1}),o(s,{col:"2"},{default:t(()=>e[18]||(e[18]=[p("Custo Real")])),_:1}),o(s,{col:"2"},{default:t(()=>e[19]||(e[19]=[p("Custo Anterior")])),_:1})]),_:1}),o(m,{bordered:"top"}),(g(!0),E(z,null,L(u.estoquePorLote,(V,S)=>(g(),v(f,{key:S,justify:"around",text:"center caption bolder"},{default:t(()=>[o(s,{col:"2"},{default:t(()=>[p(P(V.tipoEstoque||"-"),1)]),_:2},1024),a.usaLote?(g(),v(s,{key:0,col:"2"},{default:t(()=>[p(P(V.loteEmpresa||"-"),1)]),_:2},1024)):k("",!0),o(s,{col:"2"},{default:t(()=>[p(P(l.$filters.numero(V.saldo,2)),1)]),_:2},1024),o(s,{col:"2"},{default:t(()=>[p(P(l.$filters.numero(V.valorCustoMedio,2)),1)]),_:2},1024),o(s,{col:"2"},{default:t(()=>[p(P(l.$filters.numero(V.valorCusto,2)),1)]),_:2},1024),o(s,{col:"2"},{default:t(()=>[p(P(l.$filters.numero(V.valorCustoAnterior,2)),1)]),_:2},1024)]),_:2},1024))),128))]),_:2},1032,["class"]))),128)),a.estoquePorEmpresa.length===0?(g(),v(s,{key:0,col:"12"},{default:t(()=>[o(m,{text:"sub1 bold center"},{default:t(()=>e[20]||(e[20]=[p("Sem movimenta\xE7\xF5es de estoque.")])),_:1})]),_:1})):k("",!0)]),_:1}),a.item.ativo&&a.permissaoFicha?(g(),v(f,{key:0,gutter:"md",bg:"bg-white",class:"q-mb-md"},{default:t(()=>[o(s,{col:"12"},{default:t(()=>[o(m,{text:"h6"},{default:t(()=>e[21]||(e[21]=[p("Par\xE2metros")])),_:1})]),_:1}),o(s,{col:"12"},{default:t(()=>[(g(!0),E(z,null,L(a.estoqueMinimoEmpresa,u=>(g(),E(z,{key:u.idEmpresa},[o(m,{text:"sub2 bold",icon:"factory xs grey-7 left"},{default:t(()=>[p(P(u.nomeEmpresa),1)]),_:2},1024),o(f,{gutter:"none-y"},{default:t(()=>[o(s,{col:"6 sm4 md"},{default:t(()=>[o(h,{modelValue:u.quantidadeMinimaEstoque,"onUpdate:modelValue":V=>u.quantidadeMinimaEstoque=V,min:"0",rotulo:"Estoque m\xEDnimo",tipo:"decimal",decimals:"2",opcoes:{decimalPlaces:4},class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(s,{col:"6 sm4 md"},{default:t(()=>[o(h,{modelValue:u.quantidadeMinimaCompra,"onUpdate:modelValue":V=>u.quantidadeMinimaCompra=V,min:"0",rotulo:"Qtde compra reposi\xE7\xE3o",tipo:"decimal",decimalPlaces:"4",decimals:"2",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(s,{col:"12 sm4 md"},{default:t(()=>[o(h,{modelValue:u.tempoMedioReposicao,"onUpdate:modelValue":V=>u.tempoMedioReposicao=V,min:"0",rotulo:"Tempo m\xE9dio reposi\xE7\xE3o (dias)",tipo:"quantidade",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(s,{col:"6 sm md"},{default:t(()=>[o(h,{modelValue:u.consumoMedio,"onUpdate:modelValue":V=>u.consumoMedio=V,min:"0",rotulo:"Consumo m\xE9dio",tipo:"decimal",decimals:"2",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(s,{col:"6 sm md"},{default:t(()=>[o(h,{modelValue:u.local,"onUpdate:modelValue":V=>u.local=V,maxlength:"200",rotulo:"Local",tipo:"texto",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(s,{col:"12",text:"right"},{default:t(()=>[o(_,{color:"primary",label:"Salvar",type:"button",unelevated:"",onClick:V=>i.salvarEstoqueMinimoEmpresa(u.idEmpresa)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)],64))),128))]),_:1})]),_:1})):k("",!0),a.item.ativo&&a.permissaoAjusteEstoque?(g(),v(f,{key:1,gutter:"md",bg:"bg-white",class:"q-mb-md"},{default:t(()=>[o(s,{col:"12"},{default:t(()=>[o(m,{text:"h6"},{default:t(()=>e[22]||(e[22]=[p("Ajuste")])),_:1})]),_:1}),o(s,{col:"12"},{default:t(()=>[o(ae,{onSubmit:i.estoqueAjustar_click,novalidate:""},{default:t(()=>[o(f,{gutter:"none-y"},{default:t(()=>[o(s,{col:"12"},{default:t(()=>[o(h,{modelValue:a.codigoEmpresaSelecionada,"onUpdate:modelValue":[e[0]||(e[0]=u=>a.codigoEmpresaSelecionada=u),i.alterarCodigoEmpresaAjuste],rotuloFixo:"Empresa",tipo:"seletor",opcoes:a.empresas,class:"q-field--with-bottom"},null,8,["modelValue","opcoes","onUpdate:modelValue"])]),_:1}),o(s,{col:"12 sm"},{default:t(()=>[o(be,{modelValue:a.ajusteData,"onUpdate:modelValue":[e[3]||(e[3]=u=>a.ajusteData=u),i.ajustarData],mask:"##/##/#### ##:##",dense:"",class:"q-field--with-bottom"},{prepend:t(()=>[o(F,{name:"event",class:"cursor-pointer"},{default:t(()=>[o(De,{"transition-show":"scale","transition-hide":"scale"},{default:t(()=>[o(ro,{modelValue:a.ajusteData,"onUpdate:modelValue":[e[1]||(e[1]=u=>a.ajusteData=u),i.ajustarData],mask:"DD/MM/YYYY HH:mm"},{default:t(()=>[o(f,{items:"center",justify:"end"},{default:t(()=>[O(o(_,{label:"Fechar",color:"primary",flat:""},null,512),[[Y]])]),_:1})]),_:1},8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1})]),append:t(()=>[o(F,{name:"access_time",class:"cursor-pointer"},{default:t(()=>[o(De,{"transition-show":"scale","transition-hide":"scale"},{default:t(()=>[o(so,{modelValue:a.ajusteData,"onUpdate:modelValue":[e[2]||(e[2]=u=>a.ajusteData=u),i.ajustarData],mask:"DD/MM/YYYY HH:mm",format24h:""},{default:t(()=>[o(f,{class:"row items-center justify-end"},{default:t(()=>[O(o(_,{label:"Fechar",color:"primary",flat:""},null,512),[[Y]])]),_:1})]),_:1},8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","onUpdate:modelValue"])]),_:1}),o(s,{col:"12 sm"},{default:t(()=>[o(h,{modelValue:a.ajuste.custoDesejado,"onUpdate:modelValue":e[4]||(e[4]=u=>a.ajuste.custoDesejado=u),rotulo:"Custo desejado",tipo:"decimal",decimals:"2",class:"q-field--with-bottom"},null,8,["modelValue"])]),_:1}),a.usaLoteEmpresaAjuste?(g(),v(s,{key:0,col:"12 md"},{default:t(()=>[o(h,{modelValue:a.ajuste.lote,"onUpdate:modelValue":e[5]||(e[5]=u=>a.ajuste.lote=u),modelModifiers:{trim:!0},rotulo:"Lote",tipo:"texto",maxlength:"50",class:"q-field--with-bottom"},null,8,["modelValue"])]),_:1})):k("",!0),o(s,{col:"12"},{default:t(()=>[o(h,{modelValue:a.ajuste.observacao,"onUpdate:modelValue":e[6]||(e[6]=u=>a.ajuste.observacao=u),modelModifiers:{trim:!0},rotulo:"Observa\xE7\xF5es",tipo:"texto",maxlength:"500",class:"q-field--with-bottom"},null,8,["modelValue"])]),_:1}),o(s,{col:"12 sm"},{default:t(()=>[o(h,{modelValue:a.ajuste.planoConta,"onUpdate:modelValue":e[7]||(e[7]=u=>a.ajuste.planoConta=u),opcoes:a.opcoesPlanoConta,rules:a.ajusteRegras.planoConta,errorMessage:"Obrigat\xF3rio",rotuloFixo:"Plano de contas",tipo:"seletor"},null,8,["modelValue","opcoes","rules"])]),_:1}),a.ajuste.planoConta==="0"?(g(),E(z,{key:1},[o(s,{col:"12 sm"},{default:t(()=>[o(h,{modelValue:a.ajuste.planoContaEstoque,"onUpdate:modelValue":e[8]||(e[8]=u=>a.ajuste.planoContaEstoque=u),filter:"",errorMessage:"Obrigat\xF3rio",rotuloFixo:"Conta estoque",tipo:"seletor",opcoes:a.opcoesConta,rules:a.ajusteRegras.planoContaEstoque},null,8,["modelValue","opcoes","rules"])]),_:1}),o(s,{col:"12 sm"},{default:t(()=>[o(h,{modelValue:a.ajuste.planoContaMovimento,"onUpdate:modelValue":e[9]||(e[9]=u=>a.ajuste.planoContaMovimento=u),filter:"",errorMessage:"Obrigat\xF3rio",rotuloFixo:"Conta movimento",tipo:"seletor",opcoes:a.opcoesConta,rules:a.ajusteRegras.planoContaMovimento},null,8,["modelValue","opcoes","rules"])]),_:1})],64)):k("",!0),o(s,{col:"12"},{default:t(()=>[o(f,{items:"top"},{default:t(()=>[o(s,{col:"6 sm"},{default:t(()=>[o(m,{text:"caption"},{default:t(()=>e[23]||(e[23]=[p("Saldo atual")])),_:1}),o(m,null,{default:t(()=>[p(P(l.$filters.numero(a.ajuste.qtdeMomento,4))+" ",1),e[24]||(e[24]=A("span",{class:"float-right"},"+",-1))]),_:1})]),_:1}),o(s,{col:"6 sm"},{default:t(()=>[o(m,{text:"caption"},{default:t(()=>e[25]||(e[25]=[p("Diferen\xE7a")])),_:1}),o(m,null,{default:t(()=>[p(P(l.$filters.numero(a.ajuste.qtdeDiferenca,4))+" ",1),e[26]||(e[26]=A("span",{class:"float-right"},"=",-1))]),_:1})]),_:1}),o(s,{col:"12 sm"},{default:t(()=>[o(h,{modelValue:a.ajuste.qtdeDesejada,"onUpdate:modelValue":[e[10]||(e[10]=u=>a.ajuste.qtdeDesejada=u),i.atualizarDiferenca],rotulo:"Saldo desejado",tipo:"decimal",decimals:"4",rules:a.ajusteRegras.qtdeDesejada},null,8,["modelValue","onUpdate:modelValue","rules"])]),_:1})]),_:1})]),_:1}),o(s,{col:"12"},{default:t(()=>[o(m,{text:"right"},{default:t(()=>[A("span",{class:xe(["q-pa-sm",a.ajusteCor])},P(a.ajusteMensagem),3),o(_,{color:"primary",label:"Ajustar",type:"submit",unelevated:""})]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1})):k("",!0),a.item.ativo?(g(),v(f,{key:2,gutter:"md",bg:"bg-white",class:"q-mb-lg"},{default:t(()=>[o(s,{col:"12"},{default:t(()=>[o(m,{text:"h6"},{default:t(()=>e[27]||(e[27]=[p("Hist\xF3rico de Movimenta\xE7\xF5es (Kardex)")])),_:1})]),_:1}),o(s,{col:"12",class:"q-mb-sm"},{default:t(()=>[o(f,{gutter:"none-y"},{default:t(()=>[o(s,{col:"6 sm"},{default:t(()=>[o(h,{modelValue:a.codigoEmpresaKardex,"onUpdate:modelValue":[e[11]||(e[11]=u=>a.codigoEmpresaKardex=u),i.alterarCodigoEmpresaKardex],opcoes:a.empresas,rotuloFixo:"Empresa",tipo:"seletor"},null,8,["modelValue","onUpdate:modelValue","opcoes"])]),_:1}),o(s,{col:"2"},{default:t(()=>[o(h,{modelValue:a.tipoEstoqueSelecionado,"onUpdate:modelValue":[e[12]||(e[12]=u=>a.tipoEstoqueSelecionado=u),i.atualizarKardex],opcoes:a.opcoesTipoEstoque,"rotulo-fixo":"Tipo de estoque",tipo:"seletor"},null,8,["modelValue","onUpdate:modelValue","opcoes"])]),_:1}),a.usaLoteEmpresaKardex?(g(),v(s,{key:0,col:"2"},{default:t(()=>[o(h,{modelValue:a.tipoLoteSelecionado,"onUpdate:modelValue":[e[13]||(e[13]=u=>a.tipoLoteSelecionado=u),i.atualizarKardex],opcoes:a.opcoesLoteEstoque,"rotulo-fixo":"Lote",tipo:"seletor",clearable:""},null,8,["modelValue","onUpdate:modelValue","opcoes"])]),_:1})):k("",!0),o(s,{col:"2 sm-shrink",offset:"0 md1",text:"right"},{default:t(()=>[o(_,{onClick:i.recalcularKardex,loading:a.recalculandoKardex,label:"Recalcular",color:"primary"},null,8,["onClick","loading"]),o(_,{onClick:i.atualizarKardex,loading:a.atualizandoKardex,icon:"mdi-reload",flat:"",round:"",class:"q-ml-sm"},null,8,["onClick","loading"])]),_:1})]),_:1})]),_:1}),a.mensagemKardex?(g(),v(s,{key:0,col:"12"},{default:t(()=>[o(m,{text:"center sub1 medium",color:"text-negative",class:"q-pb-sm"},{default:t(()=>[p(P(a.mensagemKardex),1)]),_:1})]),_:1})):k("",!0),o(s,{col:"12"},{default:t(()=>[o(Se,{rows:a.tabelaKardex,columns:i.colunasKardex,"row-key":"name",bordered:"",class:"no-shadow"},{body:t(u=>[o(no,{props:u},{default:t(()=>[(g(!0),E(z,null,L(u.cols,V=>(g(),v(uo,{key:V.name,props:u},{default:t(()=>[V.field==="acao"?(g(),E("div",fa,[a.permissaoAjusteEstoque&&(u.cols.find(S=>S.field==="documentoTipo")||{}).value==="Estoque"&&(u.cols.find(S=>S.field==="documentoItemOperacao")||{}).value!=="Manipula\xE7\xE3o"?(g(),v(_,{key:0,onClick:S=>i.excluirAjuste((u.cols.find(x=>x.field==="codigoDocumento")||{}).value),icon:"mdi-trash-can-outline",size:"sm",round:"",dense:"",class:"q-mr-sm"},{default:t(()=>[o(Q,{anchor:"bottom middle",self:"center middle",class:"hideonmobile"},{default:t(()=>e[28]||(e[28]=[p("Excluir ajuste")])),_:1})]),_:2},1032,["onClick"])):k("",!0)])):(g(),E("div",ga,P(V.value),1))]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),_:1},8,["rows","columns"])]),_:1})]),_:1})):k("",!0)]),_:1})]),_:1})}var ha=H(pa,[["render",ba]]);const va={data(){return{item:{}}},methods:{async atualizar(){var l;try{const e=(l=this.params)==null?void 0:l.idItem;this.itemOriginal=await $erp().item.get(e),this.item=$utils.clonarV2(this.itemOriginal)}catch(e){console.log(e.message)}},async salvar(){try{const l={};if(this.item.fiscalBlocoKCodigoAntigo!==this.itemOriginal.fiscalBlocoKCodigoAntigo&&(l.fiscalBlocoKCodigoAntigo=this.item.fiscalBlocoKCodigoAntigo),this.item.fiscalBlocoKTipo!==this.itemOriginal.fiscalBlocoKTipo&&(l.fiscalBlocoKTipo=this.item.fiscalBlocoKTipo),!(Object.keys(l).length>0)){$q.notify({message:"N\xE3o h\xE1 dados alterados.",type:"positive"});return}await $db.item.gravarSimplesV1(this.item.id,l),await this.atualizar(),$q.notify({message:"Dados salvos com sucesso.",type:"positive"})}catch(l){console.log(l.message),$q.notify({message:"Ocorreu um erro ao salvar os dados. Por favor, tente novamente.",type:"negative"})}}},props:{params:{type:Object}},watch:{params(){this.atualizar()}}};function Va(l,e,r,n,a,i){const m=C("campo"),s=C("g-col"),f=C("g-row");return g(),E("div",null,[o(ae,{onSubmit:i.salvar},{default:t(()=>[o(f,{gutter:"md"},{default:t(()=>[o(s,{col:"12 sm6"},{default:t(()=>[o(m,{modelValue:a.item.fiscalBlocoKCodigoAntigo,"onUpdate:modelValue":e[0]||(e[0]=h=>a.item.fiscalBlocoKCodigoAntigo=h),rotulo:"C\xF3digo Antigo",filled:""},null,8,["modelValue"])]),_:1}),o(s,{class:"12 sm6"},{default:t(()=>[o(m,{modelValue:a.item.fiscalBlocoKTipo,"onUpdate:modelValue":e[1]||(e[1]=h=>a.item.fiscalBlocoKTipo=h),rotulo:"Tipo do Item",filled:""},null,8,["modelValue"])]),_:1}),o(s,{col:"12",text:"right"},{default:t(()=>[o(G,{class:"q-mb-sm"}),o(_,{type:"submit",label:"Salvar",color:"primary",unelevated:""})]),_:1})]),_:1})]),_:1},8,["onSubmit"])])}var Ca=H(va,[["render",Va]]);const ya={data(){return{composicao:[]}},methods:{async atualizar(){await $tryLoading(async()=>{var l;this.composicaoOriginal=await $db.hibrido.lista({table:"itemSped0221",where:{idItem:(l=this.params)==null?void 0:l.idItem}}),this.composicao=$utils.clonarV2(this.composicaoOriginal)})},async adicionarComposicao(){var l;this.composicao.push({id:$utils.uuid(),idItem:(l=this.params)==null?void 0:l.idItem,idItemAtomico:"",quantidadeAtomico:1})},async removerComposicao(l){!await $q.dialogSimNao({title:"Remover",message:"Ao continuar voc\xEA ir\xE1 remover este item"})||this.composicao.splice(l,1)},async salvar(){await $tryLoading(async()=>{this.composicao=this.composicao.filter(({idItemAtomico:l,quantidadeAtomico:e})=>e>0&&l),await $db.hibrido.gravaLista("itemSped0221",{atual:this.composicao,original:this.composicaoOriginal})},{mensagem:"Gravando..."}),await this.atualizar()}},props:{params:{type:Object}},watch:{params(){this.atualizar()}}};function qa(l,e,r,n,a,i){const m=C("SeletorItem"),s=C("g-col"),f=C("campo"),h=C("g-row");return g(),E("div",null,[o(ae,{onSubmit:i.salvar},{default:t(()=>[o(h,{gutter:"md",items:"center"},{default:t(()=>[(g(!0),E(z,null,L(a.composicao,(u,V)=>(g(),E(z,{key:V},[o(s,{col:"12 sm6"},{default:t(()=>[o(m,{modelValue:u.idItemAtomico,"onUpdate:modelValue":S=>u.idItemAtomico=S,rotulo:"Produto"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(s,{col:"12 sm5"},{default:t(()=>[o(f,{modelValue:u.quantidadeAtomico,"onUpdate:modelValue":S=>u.quantidadeAtomico=S,rotulo:"Quantidade at\xF4mica",tipo:"decimal",decimals:"4",min:"0"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(s,{col:"2 sm-shrink",text:"center"},{default:t(()=>[o(_,{onClick:S=>i.removerComposicao(V),icon:"delete",flat:"",round:"",dense:"",color:"tertiary",class:"q-mt-sm"},{default:t(()=>[o(Q,{anchor:"top left",self:"bottom start"},{default:t(()=>e[0]||(e[0]=[p("Excluir")])),_:1})]),_:2},1032,["onClick"])]),_:2},1024),o(s,{col:"12",class:"q-mb-sm"})],64))),128)),o(s,{col:"12",text:"center"},{default:t(()=>[o(_,{onClick:i.adicionarComposicao,icon:"add",size:"sm",color:"positive",label:"Adicionar produto",outline:""},null,8,["onClick"])]),_:1})]),_:1}),o(h,{gutter:"md"},{default:t(()=>[o(s,{col:"12",text:"right"},{default:t(()=>[o(G,{class:"q-mb-sm"}),o(_,{type:"submit",label:"Salvar",color:"primary",unelevated:""})]),_:1})]),_:1})]),_:1},8,["onSubmit"])])}var ka=H(ya,[["render",qa]]);const je={vBCSTRet:0,pST:0,vICMSSTRet:0,vICMSSubstituto:0},wa={data(){return{item:{},json:{icmsSTRet:{...je}},mostrarCampos:!1,opcoesCampos:[{value:!1,label:"OCULTAR"},{value:!0,label:"MOSTRAR"}]}},methods:{async atualizar(){var l,e,r,n;try{const a=(l=this.params)==null?void 0:l.idItem;this.item=await $erp().item.get(a),this.json=(n=JSON.parse((r=(e=this.item)==null?void 0:e.json)!=null?r:null))!=null?n:{},this.json.icmsSTRet&&(this.mostrarCampos=!0),this.json.icmsSTRet||(this.json.icmsSTRet={...je})}catch(a){console.log(a.message)}},calcularvICMSSTRet(){this.json.icmsSTRet.vICMSSTRet=$utils.arredondar(this.json.icmsSTRet.vBCSTRet*(this.json.icmsSTRet.pST/100),4)},async salvar(){try{this.mostrarCampos||delete this.json.icmsSTRet,await $db.item.gravarSimplesV1(this.item.id,{json:JSON.stringify(this.json)}),await this.atualizar(),$q.notify({message:"Dados salvos com sucesso.",type:"positive"})}catch(l){console.log(l.message),$q.notify({message:"Ocorreu um erro ao salvar os dados. Por favor, tente novamente.",type:"negative"})}}},props:{params:{type:Object}},watch:{params(){this.atualizar()}}};function xa(l,e,r,n,a,i){const m=C("g-col"),s=C("campo"),f=C("g-row");return g(),E("div",null,[o(f,{gutter:"md"},{default:t(()=>[o(m,{col:"12",text:"right"},{default:t(()=>[o(Ee,{modelValue:a.mostrarCampos,"onUpdate:modelValue":e[0]||(e[0]=h=>a.mostrarCampos=h),options:a.opcoesCampos,"toggle-color":"primary",unelevated:"",class:"float-right"},null,8,["modelValue","options"]),o(G,{class:"q-mt-xl"})]),_:1}),o(m,{col:"12"},{default:t(()=>[o(ae,{onSubmit:i.salvar},{default:t(()=>[a.mostrarCampos?(g(),v(f,{key:0},{default:t(()=>[o(m,{col:"12 sm6 md3"},{default:t(()=>[o(s,{modelValue:a.json.icmsSTRet.vBCSTRet,"onUpdate:modelValue":e[1]||(e[1]=h=>a.json.icmsSTRet.vBCSTRet=h),onBlur:i.calcularvICMSSTRet,filled:"",dica:"vBCSTRet",tipo:"decimal",decimals:"4",rotulo:"Valor da BC do ICMS ST retido anteriormente"},null,8,["modelValue","onBlur"])]),_:1}),o(m,{col:"12 sm6 md3"},{default:t(()=>[o(s,{modelValue:a.json.icmsSTRet.pST,"onUpdate:modelValue":e[2]||(e[2]=h=>a.json.icmsSTRet.pST=h),onBlur:i.calcularvICMSSTRet,suffix:"%",filled:"",tipo:"decimal",decimals:"2",rotulo:"Aliquota suportada pelo consumidor final",dica:"pST"},null,8,["modelValue","onBlur"])]),_:1}),o(m,{col:"12 sm6 md3"},{default:t(()=>[o(s,{modelValue:a.json.icmsSTRet.vICMSSTRet,"onUpdate:modelValue":e[3]||(e[3]=h=>a.json.icmsSTRet.vICMSSTRet=h),"somente-leitura":"",filled:"",dica:"vICMSSTRet = vBCSTRet * (pST / 100)",tipo:"decimal",decimals:"4",rotulo:"Valor do ICMS ST retido anteriormente"},null,8,["modelValue"])]),_:1}),o(m,{col:"12 sm6 md3"},{default:t(()=>[o(s,{modelValue:a.json.icmsSTRet.vICMSSubstituto,"onUpdate:modelValue":e[4]||(e[4]=h=>a.json.icmsSTRet.vICMSSubstituto=h),tipo:"decimal",decimals:"4",filled:"",dica:"vICMSSubstituto (campo opcional)",rotulo:"Valor do ICMS Pr\xF3prio do Substituto",ajuda:"Cobrado em opera\xE7\xE3o anterior"},null,8,["modelValue"])]),_:1}),o(m,{col:"12",text:"right"},{default:t(()=>[o(G,{class:"q-mb-sm"}),o(_,{type:"submit",label:"Salvar",color:"primary",unelevated:""})]),_:1})]),_:1})):k("",!0)]),_:1},8,["onSubmit"])]),_:1})]),_:1})])}var Ia=H(wa,[["render",xa]]);const Sa={data(){return{item:{},opcaoNCM:0,opcoesNCM:[{value:0,label:"PADR\xC3O"},{value:1,label:"PERSONALIZADO"}],ufsDescricao:[],ufsNcm:[]}},methods:{async atualizar({id:l}){var e;try{this.obterUfs(),this.item=await $erp().item.get(l);const n=(JSON.parse(((e=this.item)==null?void 0:e.json)||null)||{}).impostoST;if(this.opcaoNCM=1,!n){this.opcaoNCM=0;return}for(const a of this.ufsNcm)!~n.indexOf(a.uf)||(a.st=!0)}catch(r){console.log(r.message)}},descricaoUF(l){const e=this.ufsDescricao.find(r=>r.sigla===l);return`${e.nome} (${e.sigla})`},desmarcarTodos(){for(const l of this.ufsNcm)l.st=!1},inverterSelecao(){for(const l of this.ufsNcm)l.st=!l.st},obterUfs(){this.ufsNcm=[{uf:"AC",st:!1},{uf:"AL",st:!1},{uf:"AP",st:!1},{uf:"AM",st:!1},{uf:"BA",st:!1},{uf:"CE",st:!1},{uf:"DF",st:!1},{uf:"ES",st:!1},{uf:"GO",st:!1},{uf:"MA",st:!1},{uf:"MT",st:!1},{uf:"MS",st:!1},{uf:"MG",st:!1},{uf:"PA",st:!1},{uf:"PB",st:!1},{uf:"PR",st:!1},{uf:"PE",st:!1},{uf:"PI",st:!1},{uf:"RJ",st:!1},{uf:"RN",st:!1},{uf:"RS",st:!1},{uf:"RO",st:!1},{uf:"RR",st:!1},{uf:"SC",st:!1},{uf:"SP",st:!1},{uf:"SE",st:!1},{uf:"TO",st:!1}]},obterUfsDescricao(){this.ufsDescricao=[{nome:"Acre",sigla:"AC"},{nome:"Alagoas",sigla:"AL"},{nome:"Amap\xE1",sigla:"AP"},{nome:"Amazonas",sigla:"AM"},{nome:"Bahia",sigla:"BA"},{nome:"Cear\xE1",sigla:"CE"},{nome:"Distrito Federal",sigla:"DF"},{nome:"Esp\xEDrito Santo",sigla:"ES"},{nome:"Goi\xE1s",sigla:"GO"},{nome:"Maranh\xE3o",sigla:"MA"},{nome:"Mato Grosso",sigla:"MT"},{nome:"Mato Grosso do Sul",sigla:"MS"},{nome:"Minas Gerais",sigla:"MG"},{nome:"Par\xE1",sigla:"PA"},{nome:"Para\xEDba",sigla:"PB"},{nome:"Paran\xE1",sigla:"PR"},{nome:"Pernambuco",sigla:"PE"},{nome:"Piau\xED",sigla:"PI"},{nome:"Rio de Janeiro",sigla:"RJ"},{nome:"Rio Grande do Norte",sigla:"RN"},{nome:"Rio Grande do Sul",sigla:"RS"},{nome:"Rond\xF4nia",sigla:"RO"},{nome:"Roraima",sigla:"RR"},{nome:"Santa Catarina",sigla:"SC"},{nome:"S\xE3o Paulo",sigla:"SP"},{nome:"Sergipe",sigla:"SE"},{nome:"Tocantins",sigla:"TO"}]},async salvar(){var l;try{const e=JSON.parse(((l=this.item)==null?void 0:l.json)||null)||{},r=e.impostoST||[],n=this.ufsNcm.filter(a=>a.st).map(a=>a.uf);e.impostoST=n,this.opcaoNCM===0&&delete e.impostoST,await $db.item.gravarSimplesV1(this.item.id,{json:JSON.stringify(e)}),await this.atualizar({id:this.item.id}),$q.notify({message:"Dados salvos com sucesso.",type:"positive"})}catch(e){console.log(e.message),$q.notify({message:"Ocorreu um erro ao salvar os dados. Por favor, tente novamente.",type:"negative"})}}},beforeMount(){this.obterUfsDescricao()}};function _a(l,e,r,n,a,i){const m=C("g-label"),s=C("g-col"),f=C("g-row");return g(),E("div",null,[o(f,{gutter:"md",items:"center"},{default:t(()=>[o(s,{col:"12"},{default:t(()=>[o(m,{text:"sub1 medium",inline:"",class:"q-mt-xs"},{default:t(()=>e[1]||(e[1]=[p("Substitui\xE7\xE3o Tribut\xE1ria por UF")])),_:1}),o(Ee,{modelValue:a.opcaoNCM,"onUpdate:modelValue":e[0]||(e[0]=h=>a.opcaoNCM=h),options:a.opcoesNCM,"toggle-color":"primary",unelevated:"",class:"float-right"},null,8,["modelValue","options"]),o(G,{class:"q-mt-md"})]),_:1}),o(s,{col:"12"},{default:t(()=>[a.opcaoNCM===0?(g(),v(f,{key:0,gutter:"none"},{default:t(()=>[o(s,null,{default:t(()=>[o(m,{text:"body1 medium center"},{default:t(()=>e[2]||(e[2]=[p("Padr\xE3o")])),_:1})]),_:1})]),_:1})):k("",!0),a.opcaoNCM===1?(g(),v(f,{key:1,gutter:"none"},{default:t(()=>[o(s,{col:"12",text:"right"},{default:t(()=>[o(_,{onClick:i.desmarcarTodos,label:"Desmarcar todos",icon:"remove_done",size:"sm",unelevated:""},null,8,["onClick"]),o(_,{onClick:i.inverterSelecao,label:"Inverter sele\xE7\xE3o",icon:"rule",size:"sm",unelevated:""},null,8,["onClick"]),o(G)]),_:1}),o(s,{col:"12"},{default:t(()=>[o(he,{link:"","no-border":"",separator:""},{default:t(()=>[(g(!0),E(z,null,L(a.ufsNcm,h=>(g(),v(j,{key:h.uf,class:"q-pa-sm"},{default:t(()=>[o(I,null,{default:t(()=>[o(W,null,{default:t(()=>[p(P(i.descricaoUF(h.uf)),1)]),_:2},1024)]),_:2},1024),o(I,{side:""},{default:t(()=>[o(ge,{color:"blue",modelValue:h.st,"onUpdate:modelValue":u=>h.st=u,val:"1"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})):k("",!0)]),_:1}),o(s,{col:"12",text:"right"},{default:t(()=>[o(G,{class:"q-mb-sm"}),o(_,{class:"q-ml-sm",unelevated:"",color:"primary",label:"Salvar",onClick:i.salvar},null,8,["onClick"])]),_:1})]),_:1})])}var Ea=H(Sa,[["render",_a]]);const Fe={id:"",descricao:"",finalidade:100,json:{contribuinte:[{descricao:"Venda",interna:"",internaST:"",interestadual:"",interestadualST:""},{descricao:"Devolu\xE7\xE3o",interna:"",internaST:"",interestadual:"",interestadualST:""}],naoContribuinte:[{descricao:"Venda",interna:"",internaST:"",interestadual:"",interestadualST:""},{descricao:"Devolu\xE7\xE3o",interna:"",internaST:"",interestadual:"",interestadualST:""}]}},Ve={show:!1,titulo:"",documento:{}},Ua={components:{SeletorCfop:bo},data(){return{documentos:[],columnsContribuinte:[{name:"descricao",align:"left",label:"PJ Contribuinte",field:"descricao",sortable:!1},{name:"interna",align:"left",label:"Interna",field:"interna",sortable:!1},{name:"internaST",align:"left",label:"Interna ST",field:"internaST",sortable:!1},{name:"interestadual",align:"left",label:"Interestadual",field:"interestadual",sortable:!1},{name:"interestadualST",align:"left",label:"Interestadual ST",field:"interestadualST",sortable:!1}],columnsNaoContribuinte:[{name:"descricao",align:"left",label:"PF/PJ N\xE3o Contribuinte",field:"descricao",sortable:!1},{name:"interna",align:"left",label:"Interna",field:"interna",sortable:!1},{name:"internaST",align:"left",label:"Interna ST",field:"internaST",sortable:!1},{name:"interestadual",align:"left",label:"Interestadual",field:"interestadual",sortable:!1},{name:"interestadualST",align:"left",label:"Interestadual ST",field:"interestadualST",sortable:!1}],opcoesFinalidade:[{label:"Revenda",value:99},{label:"Consumo",value:100}],opcaoOperacoes:0,opcoesOperacoes:[{value:0,label:"PADR\xC3O"},{value:1,label:"PERSONALIZADO"}],modal:{},validations:{required:[l=>l.length||"Campo obrigat\xF3rio"]}}},methods:{async alternarOpcoesOperacoes(){var l,e;if(this.opcaoOperacoes===0)try{const r=(l=this.params)==null?void 0:l.idItem;let n,a;if(n=await $erp().item.get(r),a=(e=JSON.parse((n==null?void 0:n.json)||null))!=null?e:{},!a.documentosOperacao)return;await new Promise((i,m)=>{$q.dialog({message:"Deseja alterar para opera\xE7\xF5es padr\xE3o?",title:"Descartar",cancel:{label:"Cancelar",push:!0,color:"tertiary",flat:!0},ok:{label:"Descartar",push:!0,class:"bg-negative",textColor:"white",flat:!0}}).onOk(()=>{i()}).onCancel(()=>{m("Rejected")})}),delete a.documentosOperacao,await $db.item.gravarSimplesV1(r,{json:JSON.stringify(a)}),await this.carregarDocumentosPadrao(),this.documentos=$utils.clonarV2(this.documentosPadrao),$q.notify({message:"Os dados de opera\xE7\xF5es foram salvos com sucesso",type:"positive"})}catch(r){if(r==="Rejected"){this.opcaoOperacoes=1;return}console.log(r.message),$q.notify({message:"Ocorreu um erro ao salvar os dados de opera\xE7\xF5es. Por favor, tente novamente.",type:"negative"})}},async atualizar(){var l,e;this.modal=$utils.clonarV2(Ve);try{const r=(l=this.params)==null?void 0:l.idItem;let n,a,i,m;if(i=await $erp().item.get(r),m=(e=JSON.parse((i==null?void 0:i.json)||null))!=null?e:{},a=m.documentosOperacao,await this.carregarDocumentosPadrao(),n=$utils.clonarV2(this.documentosPadrao),this.opcaoOperacoes=0,a){this.opcaoOperacoes=1;for(const s of Object.keys(a)){const f=n.find(h=>h.id===s);f.json=a[s]}}this.documentos=n}catch(r){console.log(r.message)}},alterar(l){const e=this.documentos.find(r=>r.id===l);this.modal.documento=$utils.clonarV2(e),this.modal.titulo="Alterar opera\xE7\xE3o",this.modal.show=!0},async carregarDocumentosPadrao(){this.modal=$utils.clonarV2(Ve);try{let l;this.documentosPadrao=await $db.documentoOperacao.ler();for(const e of this.documentosPadrao){if(!e.json){e.json=$utils.clonarV2(Fe.json);continue}e.json=JSON.parse(e.json)}}catch(l){console.log(l.message)}},descricaoFinalidade(l){var r;const e=this.documentos.find(n=>n.id===l);return(r=this.opcoesFinalidade.find(n=>n.value===e.finalidade))==null?void 0:r.label},async salvar(){var l,e,r;try{const n=(l=this.params)==null?void 0:l.idItem,a=this.modal.documento.id,i={contribuinte:this.modal.documento.json.contribuinte,naoContribuinte:this.modal.documento.json.naoContribuinte};let m,s,f;if(m=await $erp().item.get(n),s=(e=JSON.parse((m==null?void 0:m.json)||null))!=null?e:{},f=(r=s.documentosOperacao)!=null?r:{},$lodash.isEqual(f[a],i)){console.log("iguais");return}f[a]=i,s.documentosOperacao=f,await $db.item.gravarSimplesV1(n,{json:JSON.stringify(s)}),$q.notify({message:"Dados salvos com sucesso.",type:"positive"})}catch(n){console.log(n.message),$q.notify({message:"Ocorreu um erro ao salvar os dados. Por favor, tente novamente.",type:"negative"})}finally{this.atualizar()}},voltar(l){l.stopPropagation();const e=this.documentos.find(n=>n.id===this.modal.documento.id);let r={};if(e||(r=$utils.diferencaObjetos(Fe,this.modal.documento)),e&&(r=$utils.diferencaObjetos(e,this.modal.documento)),delete r.id,!Object.keys(r).length){this.modal=$utils.clonarV2(Ve);return}$q.dialog({message:"Deseja descartar as modifica\xE7\xF5es?",title:"Descartar",cancel:{label:"Cancelar",push:!0,color:"tertiary",flat:!0},ok:{label:"Descartar",push:!0,class:"bg-negative",textColor:"white",flat:!0}}).onOk(()=>{this.modal=$utils.clonarV2(Ve)})}},props:{params:{type:Object}},watch:{params(){this.atualizar()}}};function Ma(l,e,r,n,a,i){const m=C("g-col"),s=C("BadgeCopiarUid"),f=C("g-row"),h=C("campo"),u=C("badge"),V=C("g-label"),S=C("SeletorCfop");return g(),E("div",null,[o(f,{gutter:"md",items:"center"},{default:t(()=>[o(m,{col:"12",text:"right"},{default:t(()=>[o(Ee,{modelValue:a.opcaoOperacoes,"onUpdate:modelValue":[e[0]||(e[0]=x=>a.opcaoOperacoes=x),i.alternarOpcoesOperacoes],options:a.opcoesOperacoes,"toggle-color":"primary",unelevated:""},null,8,["modelValue","onUpdate:modelValue","options"]),o(G,{class:"q-mt-md"})]),_:1}),o(m,{col:"12"},{default:t(()=>[o(he,{"no-border":""},{default:t(()=>[(g(!0),E(z,null,L(a.documentos,x=>(g(),E(z,{key:x.id},[o(j,{class:"q-pa-sm bg-light rounded-borders"},{default:t(()=>[o(I,{avatar:""},{default:t(()=>[o(s,{id:x.id,cor:x.ativo?"positive":"tertiary",dica:x.ativo?"Ativado":"Desativado"},null,8,["id","cor","dica"])]),_:2},1024),o(I,null,{default:t(()=>[p(P(x.descricao),1)]),_:2},1024),o(I,{avatar:""},{default:t(()=>[o(mo,{color:"tertiary"},{default:t(()=>[p(P(i.descricaoFinalidade(x.id)),1)]),_:2},1024)]),_:2},1024),x.ativo&&a.opcaoOperacoes===1?(g(),v(I,{key:0,avatar:""},{default:t(()=>[o(_,{onClick:y=>i.alterar(x.id),icon:"edit",round:"",flat:"",dense:"",color:"primary"},null,8,["onClick"])]),_:2},1024)):k("",!0)]),_:2},1024),x.json?(g(),v(j,{key:0,class:"q-pa-sm"},{default:t(()=>[x.json.contribuinte[0].interna!=""||x.json.naoContribuinte[0].interna!=""?(g(),v(I,{key:0,class:"q-mb-md"},{default:t(()=>[o(f,null,{default:t(()=>[x.json.contribuinte[0].interna?(g(),v(m,{key:0,col:"12 md6"},{default:t(()=>[o(Se,{rows:x.json.contribuinte,columns:a.columnsContribuinte,"row-key":"descricao",flat:"",dense:"","hide-bottom":""},null,8,["rows","columns"])]),_:2},1024)):k("",!0),x.json.naoContribuinte[0].interna?(g(),v(m,{key:1,col:"12 md6"},{default:t(()=>[o(Se,{rows:x.json.naoContribuinte,columns:a.columnsNaoContribuinte,"row-key":"descricao",flat:"",dense:"","hide-bottom":""},null,8,["rows","columns"])]),_:2},1024)):k("",!0)]),_:2},1024)]),_:2},1024)):(g(),v(I,{key:1},{default:t(()=>[o(G)]),_:1}))]),_:2},1024)):k("",!0)],64))),128))]),_:1})]),_:1})]),_:1}),o(oe,{modelValue:a.modal.show,"onUpdate:modelValue":e[2]||(e[2]=x=>a.modal.show=x),onKeyup:_e(i.voltar,["esc"]),"content-css":{maxWidth:"80vw"},maximized:"",persistent:""},{default:t(()=>[o(qe,{container:"",class:"bg-light"},{default:t(()=>[o(ae,{onSubmit:i.salvar},{default:t(()=>[o(ke,null,{default:t(()=>[o(B,null,{default:t(()=>[o(_,{onClick:i.voltar,icon:"arrow_back",round:"",flat:"",dense:""},null,8,["onClick"]),o(ee,null,{default:t(()=>[p(P(a.modal.titulo),1)]),_:1}),o(_,{label:"Salvar",type:"submit",color:"white","text-color":"primary",unelevated:""})]),_:1})]),_:1}),o(ue,null,{default:t(()=>[o(me,{class:"u-container"},{default:t(()=>[o(f,{gutter:"md",bg:"bg-white","rounded-borders":"",class:"q-my-md"},{default:t(()=>[o(m,{col:"12"},{default:t(()=>[o(h,{modelValue:a.modal.documento.descricao,"onUpdate:modelValue":e[1]||(e[1]=x=>a.modal.documento.descricao=x),rules:a.validations.required,rotulo:"Descri\xE7\xE3o",somenteLeitura:"",filled:"","hide-bottom-space":""},null,8,["modelValue","rules"])]),_:1}),o(m,{col:"12"},{default:t(()=>[o(f,null,{default:t(()=>[o(m,{class:"shrink"},{default:t(()=>[e[3]||(e[3]=p(" Finalidade: ")),o(u,{cor:"tertiary",escuro:"",class:"q-ml-sm"},{default:t(()=>[p(P(i.descricaoFinalidade(a.modal.documento.id)),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),o(f,{gutter:"md",bg:"bg-white","rounded-borders":""},{default:t(()=>[o(m,{col:"12"},{default:t(()=>[o(V,{text:"h6"},{default:t(()=>e[4]||(e[4]=[p("PJ Contribuinte")])),_:1})]),_:1}),o(m,{col:"12"},{default:t(()=>[o(f,{items:"center"},{default:t(()=>[o(m,{col:"12 md"},{default:t(()=>e[5]||(e[5]=[p(" \xA0\xA0\xA0 ")])),_:1}),o(m,{col:"6 md"},{default:t(()=>[o(V,{text:"body2 bold"},{default:t(()=>e[6]||(e[6]=[p("Interna")])),_:1}),o(G)]),_:1}),o(m,{col:"6 md"},{default:t(()=>[o(V,{text:"body2 bold"},{default:t(()=>e[7]||(e[7]=[p("Interna ST")])),_:1}),o(G)]),_:1}),o(m,{col:"6 md"},{default:t(()=>[o(V,{text:"body2 bold"},{default:t(()=>e[8]||(e[8]=[p("Interestadual")])),_:1}),o(G)]),_:1}),o(m,{col:"6 md"},{default:t(()=>[o(V,{text:"body2 bold"},{default:t(()=>e[9]||(e[9]=[p("Interestadual ST")])),_:1}),o(G)]),_:1})]),_:1}),(g(!0),E(z,null,L(a.modal.documento.json.contribuinte,x=>(g(),v(f,{key:x.descricao,items:"center"},{default:t(()=>[o(m,{col:"12 md",mg:"lg-b"},{default:t(()=>[o(V,{text:"body2 bold"},{default:t(()=>[p(P(x.descricao),1)]),_:2},1024)]),_:2},1024),o(m,{col:"6 md",mg:"lg-b"},{default:t(()=>[o(S,{modelValue:x.interna,"onUpdate:modelValue":y=>x.interna=y,rules:a.validations.required},null,8,["modelValue","onUpdate:modelValue","rules"])]),_:2},1024),o(m,{col:"6 md",mg:"lg-b"},{default:t(()=>[o(S,{modelValue:x.internaST,"onUpdate:modelValue":y=>x.internaST=y,rules:a.validations.required},null,8,["modelValue","onUpdate:modelValue","rules"])]),_:2},1024),o(m,{col:"6 md",mg:"lg-b"},{default:t(()=>[o(S,{modelValue:x.interestadual,"onUpdate:modelValue":y=>x.interestadual=y,rules:a.validations.required},null,8,["modelValue","onUpdate:modelValue","rules"])]),_:2},1024),o(m,{col:"6 md",mg:"lg-b"},{default:t(()=>[o(S,{modelValue:x.interestadualST,"onUpdate:modelValue":y=>x.interestadualST=y,rules:a.validations.required},null,8,["modelValue","onUpdate:modelValue","rules"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),a.modal.documento.finalidade===100?(g(),v(f,{key:0,gutter:"md",bg:"bg-white","rounded-borders":""},{default:t(()=>[o(m,{col:"12"},{default:t(()=>[o(V,{text:"h6"},{default:t(()=>e[10]||(e[10]=[p("PF/PJ N\xE3o Contribuinte")])),_:1})]),_:1}),o(m,{col:"12"},{default:t(()=>[o(f,{items:"center"},{default:t(()=>[o(m,{col:"12 md"},{default:t(()=>e[11]||(e[11]=[p(" \xA0\xA0\xA0 ")])),_:1}),o(m,{col:"12 md"},{default:t(()=>[o(V,{text:"body2 bold"},{default:t(()=>e[12]||(e[12]=[p("Interna")])),_:1}),o(G)]),_:1}),o(m,{col:"12 md"},{default:t(()=>[o(V,{text:"body2 bold"},{default:t(()=>e[13]||(e[13]=[p("Interna ST")])),_:1}),o(G)]),_:1}),o(m,{col:"12 md"},{default:t(()=>[o(V,{text:"body2 bold"},{default:t(()=>e[14]||(e[14]=[p("Interestadual")])),_:1}),o(G)]),_:1}),o(m,{col:"12 md"},{default:t(()=>[o(V,{text:"body2 bold"},{default:t(()=>e[15]||(e[15]=[p("Interestadual ST")])),_:1}),o(G)]),_:1})]),_:1}),(g(!0),E(z,null,L(a.modal.documento.json.naoContribuinte,x=>(g(),v(f,{key:x.descricao,items:"center"},{default:t(()=>[o(m,{col:"12 md",mg:"lg-b"},{default:t(()=>[o(V,{text:"body2 bold"},{default:t(()=>[p(P(x.descricao),1)]),_:2},1024)]),_:2},1024),o(m,{col:"6 md",mg:"lg-b"},{default:t(()=>[o(S,{modelValue:x.interna,"onUpdate:modelValue":y=>x.interna=y,rules:a.validations.required},null,8,["modelValue","onUpdate:modelValue","rules"])]),_:2},1024),o(m,{col:"6 md",mg:"lg-b"},{default:t(()=>[o(S,{modelValue:x.internaST,"onUpdate:modelValue":y=>x.internaST=y,rules:a.validations.required},null,8,["modelValue","onUpdate:modelValue","rules"])]),_:2},1024),o(m,{col:"6 md",mg:"lg-b"},{default:t(()=>[o(S,{modelValue:x.interestadual,"onUpdate:modelValue":y=>x.interestadual=y,rules:a.validations.required},null,8,["modelValue","onUpdate:modelValue","rules"])]),_:2},1024),o(m,{col:"6 md",mg:"lg-b"},{default:t(()=>[o(S,{modelValue:x.interestadualST,"onUpdate:modelValue":y=>x.interestadualST=y,rules:a.validations.required},null,8,["modelValue","onUpdate:modelValue","rules"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})):k("",!0)]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue","onKeyup"])])}var Pa=H(Ua,[["render",Ma]]);const za={components:{BlocoK:Ca,Bloco221:ka,ICMSSTRet:Ia,NCM:Ea,Operacoes:Pa},data(){return{operacoesParams:{},ICMSSTRetParams:{},blocoKParams:{},bloco221Params:{}}},methods:{async atualizar({id:l}){this.operacoesParams={idItem:l},this.ICMSSTRetParams={idItem:l},this.blocoKParams={idItem:l},this.bloco221Params={idItem:l},await this.$refs.NCM.atualizar({id:l})}}};function Aa(l,e,r,n,a,i){const m=C("Operacoes"),s=C("g-col"),f=C("NCM"),h=C("ICMSSTRet"),u=C("BlocoK"),V=C("Bloco221"),S=C("g-row");return g(),v(ue,null,{default:t(()=>[o(me,{class:"u-container"},{default:t(()=>[o(S,{gutter:"md",bg:"bg-white",class:"q-my-md"},{default:t(()=>[o(s,{col:"12"},{default:t(()=>[o(fe,{group:"somegroup",icon:"explore",label:"Opera\xE7\xF5es",class:"expansion-impostos border-full rounded-borders"},{default:t(()=>[o(m,{params:a.operacoesParams},null,8,["params"])]),_:1})]),_:1}),o(s,{col:"12"},{default:t(()=>[o(fe,{group:"somegroup",icon:"explore",label:"NCM",class:"expansion-impostos border-full rounded-borders"},{default:t(()=>[o(f,{ref:"NCM"},null,512)]),_:1})]),_:1}),o(s,{col:"12"},{default:t(()=>[o(fe,{group:"somegroup",icon:"explore",class:"expansion-impostos border-full rounded-borders",label:"ICMS Retido Anteriormente por Substitui\xE7\xE3o Tribut\xE1ria"},{default:t(()=>[o(h,{params:a.ICMSSTRetParams},null,8,["params"])]),_:1})]),_:1}),o(s,{col:"12"},{default:t(()=>[o(fe,{group:"somegroup",icon:"explore",label:"Bloco K",class:"expansion-impostos border-full rounded-borders"},{default:t(()=>[o(u,{params:a.blocoKParams},null,8,["params"])]),_:1})]),_:1}),o(s,{col:"12"},{default:t(()=>[o(fe,{group:"somegroup",icon:"explore",label:"SPED 0221",class:"expansion-impostos border-full rounded-borders"},{default:t(()=>[o(V,{params:a.bloco221Params},null,8,["params"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}var Da=H(za,[["render",Aa]]);const Oa={components:{itemFicha:ca,ItemEstoque:ha,Impostos:Da,Tutorial:co,JsonViewer:Qe},data(){return{item:{id:""},visivel:!1,abas:[],abaSelecionada:"ItemFicha",abaAnterior:"ItemFicha",objetoPai:"item",permissaoFicha:!1,permissaoEcommerce:!1,permissaoEstoque:!1}},emits:["atualizar"],methods:{trocarAba_click(l){let e=!1;try{e=this.$refs[this.abaAnterior].verificarSeAlterouCampos()}catch{}e?$q.dialog({message:"Deseja descartar suas modifica\xE7\xF5es?",title:"Aten\xE7\xE3o!",cancel:{label:"Cancelar",push:!0,color:"tertiary",flat:!0},ok:{label:"Descartar",push:!0,class:"bg-negative",textColor:"white",flat:!0}}).onOk(()=>{this.abaAnterior=this.abaSelecionada}).onCancel(()=>{this.abaSelecionada=this.abaAnterior}):this.abaAnterior=this.abaSelecionada},async fechar(){this.visivel=!1,this.$emit("atualizar"),this.$router.push({name:"Item"})},async duplicarItem(l){try{const e=await $db.item.duplica(l);await this.atualizar({id:e.id}),this.$emit("atualizar",{id:e.id}),this.$q.notifyPositive("O produto foi duplicado com sucesso.")}catch(e){this.$q.notifyError("Ocorreu erro ao duplicar Produto",e)}},removerFoto(l){$q.dialog({message:"Deseja remover a foto?",cancel:{label:"N\xC3O",push:!0,color:"tertiary",flat:!0},ok:{label:"SIM",push:!0,class:"bg-negative",textColor:"white",flat:!0}}).onOk(()=>{l.imagem="",this.$refs.ItemFicha.removerFoto()})},async atualizar({id:l}){var e;try{this.$q.loading.show();const r=JSON.parse((e=localStorage.getItem("clienteSistema"))!=null?e:null),n=(await $plataforma.objeto.where({nomeObjeto:this.objetoPai}).toArray()).find(s=>s.id);if(!((n==null?void 0:n.id)&&(r==null?void 0:r.idSistema)))return;let a=await $plataforma.sistemaObjeto.where({idPai:n.id,idSistema:r.idSistema}).toArray();if(!a.length)return;const i=await $plataforma.objeto.where("id").anyOf(a.map(s=>s.idObjeto)).toArray();if(!i.length)return;a=a.sort((s,f)=>(s.ordem||0)>(f.ordem||0)?1:-1);const m=[];for(const s of a){const f=i.find(u=>u.id===s.idObjeto),h=JSON.parse(f.rota||null)||{};!await $db.permissao.objeto(f.nomeObjeto)||f.tipo==="componente"&&!f.menuPrincipal&&(f.menuDesenvolvimento&&!($db.usuario.logado.desenvolvedor&&$db.usuario.logado.desenvolvedor())||m.push({icon:f.icone||"",label:f.descricao||"",to:{name:h.name||""}}))}this.abas=m,this.permissaoFicha=await $db.permissao.objeto("item//ficha"),this.permissaoEstoque=await $db.permissao.objeto("item//estoque"),this.permissaoEcommerce=await $db.permissao.objeto("item//ecommerce"),this.abaSelecionada==="ItemFicha"&&!this.permissaoFicha&&(this.abaSelecionada="ItemEstoque"),this.item=await $db.item.leNew({id:l}),await this.$refs.ItemFicha.atualizar({id:l}),await this.$refs.ItemEstoque.atualizar({id:l}),await this.$refs.Impostos.atualizar({id:l})}finally{this.$q.loading.hide()}},async show({id:l}){this.visivel=!0,await this.atualizar({id:l})},async mostrarJsonViewer(){await this.$refs.jsonViewer.show(this)}}};function ja(l,e,r,n,a,i){const m=C("avatar"),s=C("Tutorial"),f=C("itemFicha"),h=C("ItemEstoque"),u=C("Impostos"),V=C("JsonViewer");return g(),v(oe,{modelValue:a.visivel,"onUpdate:modelValue":e[4]||(e[4]=S=>a.visivel=S),onKeyup:_e(i.fechar,["esc"]),persistent:"",maximized:""},{default:t(()=>[o(qe,{view:"hHh LpR fFf",container:"",class:"bg-light"},{default:t(()=>[o(ke,{class:"bg-gradiente"},{default:t(()=>[o(B,{color:"transparent",class:"q-pa-sm"},{default:t(()=>[O(o(_,{onClick:i.fechar,icon:"arrow_back",round:"",flat:"",dense:""},null,8,["onClick"]),[[Y]]),o(m,{imagem:a.item.imagem,rotulo:a.item.descricao,tamanho:"40"},null,8,["imagem","rotulo"]),o(ee,null,{default:t(()=>[p(P(a.item.descricao||"Item"),1)]),_:1}),o(s,{componente:"ItemModalFicha"}),O(o(_,{icon:"more_vert",size:"md",flat:"",dense:"",round:""},{default:t(()=>[o(Ge,null,{default:t(()=>[o(he,{link:"","no-border":"",separator:""},{default:t(()=>[O((g(),v(j,{onClick:e[0]||(e[0]=S=>i.duplicarItem(a.item.id)),clickable:""},{default:t(()=>[o(I,{avatar:""},{default:t(()=>[o(F,{name:"control_point_duplicate"})]),_:1}),o(I,null,{default:t(()=>e[5]||(e[5]=[p(" Duplicar Produto/Servi\xE7o ")])),_:1})]),_:1})),[[Y]]),O((g(),v(j,{onClick:e[1]||(e[1]=S=>i.removerFoto(a.item)),clickable:""},{default:t(()=>[o(I,{avatar:""},{default:t(()=>[o(F,{name:"mdi-image-remove"})]),_:1}),o(I,null,{default:t(()=>e[6]||(e[6]=[p(" Remover Foto ")])),_:1})]),_:1})),[[Y]]),l.$db.usuario.desenvolvedor()?O((g(),v(j,{key:0,onClick:e[2]||(e[2]=S=>i.mostrarJsonViewer(this)),clickable:""},{default:t(()=>[o(I,{avatar:""},{default:t(()=>[o(F,{name:"mdi-image-remove"})]),_:1}),o(I,null,{default:t(()=>e[7]||(e[7]=[p(" Ver Objeto ")])),_:1})]),_:1})),[[Y]]):k("",!0)]),_:1})]),_:1})]),_:1},512),[[de,a.permissaoFicha]])]),_:1}),o(Ke,{modelValue:a.abaSelecionada,"onUpdate:modelValue":[e[3]||(e[3]=S=>a.abaSelecionada=S),i.trocarAba_click],align:"justify",color:"transparent","text-color":"white","indicator-color":"light-blue-4",class:"ModalAWrapper q-px-none u-container"},{default:t(()=>[(g(!0),E(z,null,L(a.abas,(S,x)=>(g(),v(le,{key:x,icon:S.icon,label:S.label,name:S.to.name,class:"ModalA-aba"},null,8,["icon","label","name"]))),128))]),_:1},8,["modelValue","onUpdate:modelValue"])]),_:1}),O(o(f,{ref:"ItemFicha"},null,512),[[de,a.abaSelecionada==="ItemFicha"]]),O(o(h,{ref:"ItemEstoque"},null,512),[[de,a.abaSelecionada==="ItemEstoque"]]),O(o(u,{ref:"Impostos"},null,512),[[de,a.abaSelecionada==="ItemImpostos"]]),o(V,{ref:"jsonViewer"},null,512)]),_:1})]),_:1},8,["modelValue","onKeyup"])}var Fa=H(Oa,[["render",ja]]);const Ta={components:{Lista:po,importarItens:Mo,editarMarca:Ao,itemCriar:jo,sincronizarECommerce:Lo,itemFicha:Fa,combinarItens:Bo,SeletorCampoTabela:Be,importarDadosReferencia:He,JsonViewer:Qe},computed:{opcoesStatus(){return[{rotulo:"Linha",valor:"Linha"},{rotulo:"Fora de Linha",valor:"Fora de Linha"},{rotulo:"Promo\xE7\xE3o",valor:"Promo\xE7\xE3o"}]}},data(){return{sistemaPai:$utils.sistemaPai(),clienteSistema:JSON.parse(localStorage.getItem("clienteSistema")),usuario:JSON.parse(localStorage.getItem("usuario")),permissaoImportarImagensEAN:!1,permissaoFicha:!1,permissaoEstoque:!1,permissaoCatalogoVirtual:!1,listaOriginal:[],lista:[],listaLayout:{},mostrar:{header:!0,barraTopo:!0,toolbarTitulo:!0,icone:"extension",titulo:"Produtos e Servi\xE7os",buscar:!0,filtroAvancado:!0,btnAjuda:!0,btnAtualizar:!0,btnNovo:!0,toolbarAcoes:!0,checkBox:!0,btnRemover:!1,btnRestaurar:!1,centralizaTabs:!1,btnDetalhes:!0,btnExportaXLS:!0,btnMenuMais:!0,toolbarAdicao:!1,bannerMsg:"",conexao:{icone:"offline",iconeTamanho:"xs",cor:"grey-5",rotulo:null,dica:"Offline",denso:!0,flat:!0,escuro:!1}},busca:"",filtrosOriginal:{},filtros:{ativo:null,descricaoAplicacao:null,codigoItem:null,referencia:null,codigoBarras:null,marca:null,fornecedores:null,grupo:null,subGrupo:null,status:null,estoque:null,tipo:null,numeroCompra:null,idDocumento:null,catalogoVirtualChecked:!1,ordenacao:"descricaoConcatenada",direcao:"asc"},opcoesMarca:[],opcoesGrupo:[],opcoesTipo:[],opcoesOrdenacao:[{value:"codigoItem",label:"C\xF3digo Item"},{value:"descricaoConcatenada",label:"Descri\xE7\xE3o"},{value:"dataCadastro",label:"Data de Cadastro"},{value:"valorVenda",label:"Valor de Venda"},{value:"quantidadeDisponivel",label:"Quantidade Dispon\xEDvel"}],opcoesDirecao:[{value:"asc",label:"Crescente"},{value:"desc",label:"Decrescente"}],detalhes:!1,checkBox:!1,tabSelecionada:{valor:"Ativos"},tabs:[{valor:"Ativos",rotulo:"Ativos"},{valor:"Excluidos",rotulo:"Inativos"},{valor:"Todos",rotulo:"Todos"}],paginacao:{atual:1,maximo:1,total:1,limite:25},campos:{codigoBarras:"",descricao:"",marca:"",referencia:"",tipo:"Produto",valorCustoReposicao:0,valorVenda:0},impressaoEtiquetas:{visivel:!1,opcoesEmpresas:[],empresaSelecionada:null,limpar:!1},catalogoVirtualChecked:{},mostrarOpcaoSincronizarECommerce:!1,opcoesTabelasPrecoFull:[],opcoesTabelasPreco:[],mainPular:0,opcoesPlanoConta:[],modeloImpressaoSelecionada:null,empresaSelecionada:null,tabelaPreco:null,opcoesEmpresas:[],opcoesModeloImpressao:[]}},methods:{atualizarValorVendaLucro(l){if(this.listaLayout[l.id].utilizaMarkupInvertido){if(!!l.valorCustoReposicao&&!!l.valorVenda){const e=100*(l.valorVenda-l.valorCustoReposicao)/l.valorVenda;l.percentualMarkup=$utils.arredondar(e,2)}}else{const e=(l.percentualMarkup||0)/100;if(!!l.valorCustoReposicao&&e<1){const r=l.valorCustoReposicao/(1-e);r&&(l.valorVenda=$utils.arredondar(r,4))}}},atualizarCustoReposicao(l){l&&l.id&&!this.listaLayout[l.id].utilizaComposicaoValorReposicaoInvertido&&(l.valorCustoReposicao=(l.composicao||[]).reduce((e,r)=>e+r.temporario.total,0),l.valorCustoReposicao||(l.percentualMarkup=100),this.atualizarValorVendaLucro(l))},async atualizar(l){var e,r,n,a,i,m,s,f,h,u,V,S,x,y,Z,$,T,K,R,d;try{$q.loading.show(),this.lista=[],this.tabSelecionadaAnt!==this.tabSelecionada.valor&&(this.paginacao.atual=1),this.tabSelecionadaAnt=this.tabSelecionada.valor;let{buscarDadosRecentes:q}=l!=null?l:{},b={};q&&(b=await $utils.localIDB.getItem({objectStore:"dadosRecentes",id:"ItemLista_"+((e=this.usuario)==null?void 0:e.id)}),b!=null&&b._id&&(this.tabSelecionada.valor=(b==null?void 0:b.tabSelecionada)||"Ativos",this.busca=(b==null?void 0:b.busca)||"",this.filtros={descricaoAplicacao:((r=b==null?void 0:b.filtros)==null?void 0:r.descricaoAplicacao)||null,codigoItem:((n=b==null?void 0:b.filtros)==null?void 0:n.codigoItem)||null,referencia:((a=b==null?void 0:b.filtros)==null?void 0:a.referencia)||null,codigoBarras:((i=b==null?void 0:b.filtros)==null?void 0:i.codigoBarras)||null,marca:((m=b==null?void 0:b.filtros)==null?void 0:m.marca)||null,fornecedores:((s=b==null?void 0:b.filtros)==null?void 0:s.fornecedores)||null,grupo:((f=b==null?void 0:b.filtros)==null?void 0:f.grupo)||null,subGrupo:((h=b==null?void 0:b.filtros)==null?void 0:h.subGrupo)||null,status:((u=b==null?void 0:b.filtros)==null?void 0:u.status)||null,estoque:((V=b==null?void 0:b.filtros)==null?void 0:V.estoque)||null,tipo:((S=b==null?void 0:b.filtros)==null?void 0:S.tipo)||null,numeroCompra:((x=b==null?void 0:b.filtros)==null?void 0:x.numeroCompra)||null,idDocumento:((y=b==null?void 0:b.filtros)==null?void 0:y.idDocumento)||null,catalogoVirtualChecked:((Z=b==null?void 0:b.filtros)==null?void 0:Z.catalogoVirtualChecked)||!1,ordenacao:(($=b==null?void 0:b.filtros)==null?void 0:$.ordenacao)||"descricaoConcatenada",direcao:((T=b==null?void 0:b.filtros)==null?void 0:T.direcao)||"asc"},this.compareObject(this.filtrosOriginal,this.filtros,["termoBusca","ativo","ordenacao","direcao"])&&(this.$refs.itemLista.filtros=!0)));const c=$utils.eliminarVazios(this.filtros);if(delete c.ativo,this.tabSelecionada.valor==="Ativos"&&(c.ativo=!0),this.tabSelecionada.valor==="Excluidos"&&(c.ativo=!1),c.catalogoVirtualChecked){delete c.catalogoVirtualChecked,c.ids=[];for(const D of Object.keys(this.catalogoVirtualChecked))!this.catalogoVirtualChecked[D]||c.ids.push(D)}this.busca=(l==null?void 0:l.id)||this.busca,this.itemListaFiltro={termoBusca:this.busca,...c},this.itemListaFiltro.termoBusca&&/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/.test(this.busca)&&(this.paginacao.atual=1,this.tabSelecionada.valor="Todos",delete this.filtros.ativo,delete this.itemListaFiltro.ativo,delete c.ativo);const M=[this.filtros.ordenacao],J=[this.filtros.direcao],U=await $db.item.ler({filtros:this.itemListaFiltro,limit:this.paginacao.limite,page:this.paginacao.atual,sort:M,dir:J});U.total||(U.total=U.total=U.data.length),U.totalPages||(U.totalPages=1);let N=!0,X=!0;for(const D of U.data)this.listaLayout.hasOwnProperty(D.id)||(this.listaLayout[D.id]={id:D.id,ativo:D.ativo,descricaoConcatenada:D.descricaoConcatenada,valorVenda:D.valorVenda||0,detalhes:!1,remover:!1,utilizaMarkupInvertido:!D.utilizaMarkup,utilizaComposicaoValorReposicaoInvertido:!D.utilizaComposicaoValorReposicao}),this.listaLayout[D.id].remover||(N=!1),this.listaLayout[D.id].detalhes||(X=!1);this.$refs.itemLista.checkbox=(K=U==null?void 0:U.data)!=null&&K.length?N:!1,this.$refs.itemLista.detalhes=(R=U==null?void 0:U.data)!=null&&R.length?X:!1,this.listaOriginal=$utils.clonarV2(U.data),this.lista=U.data;for(const D of this.lista)D.id in this.catalogoVirtualChecked||(this.catalogoVirtualChecked[D.id]=!1);this.paginacao.total=U.total,this.paginacao.maximo=U.totalPages,b={_id:"ItemLista_"+((d=this.usuario)==null?void 0:d.id),tabSelecionada:this.tabSelecionada.valor,busca:this.busca||"",filtros:$utils.clonar(this.filtros)},await $utils.localIDB.setItem({objectStore:"dadosRecentes",data:b})}catch(q){$q.notifyError("Erro ao carregar produtos.",q)}finally{$q.loading.hide()}},toggleCatalogoVirtual(l){const e=l==="on";$q.dialog({title:`${e?"Habilitar":"Desabilitar"} itens para o cat\xE1logo virtual`,options:{type:"radio",model:"opt1",items:[{label:"Todos os itens da p\xE1gina atual",value:"opt1"},{label:"Todos os itens filtrados",value:"opt2"}]},cancel:{label:"N\xE3o",push:!0,color:"textiary",flat:!0},ok:{label:"Sim",push:!0,class:"bg-primary",textColor:"white",flat:!0}}).onOk(async r=>{var n;if($q.loading.show(),r==="opt1")for(const a of this.lista)this.catalogoVirtualChecked[a.id]=e;if(r==="opt2"){const a=await $db.item.ler({filtros:this.itemListaFiltro,somenteDadosIndexados:!0});for(const i of(n=a.data)!=null?n:[])this.catalogoVirtualChecked[i.id]=e}await this.salvarCatalogoVirtual(),$q.loading.hide()})},async salvarCatalogoVirtual(){var r;$q.loading.show();const e=(r=(await this.$utils.geeksApi({site:{funcao:"84C328A7-CEA7-4762-A703-C59DE8D53BF5"}})).data.site)!=null?r:{};e.itens=[];for(const n of Object.keys(this.catalogoVirtualChecked))!this.catalogoVirtualChecked[n]||e.itens.push(n);await this.$utils.geeksApi({site:{funcao:"E981897C-A205-441E-99DE-BECD16CB261A",...$utils.clonarV2(e)}}),this.$q.notifyPositive("Salvo com sucesso!"),$q.loading.hide()},async removerItem(l){$q.dialog({cancel:{label:"N\xE3o",push:!0,color:"tertiary",flat:!0},title:"Inativar",message:"Ao continuar voc\xEA ir\xE1 inativar este produto.",ok:{label:"Sim",push:!0,class:"bg-negative",textColor:"white",flat:!0}}).onOk(async()=>{try{$q.loading.show();const e=$utils.clonar(l);l.ativo=!1,await $db.item.grava({atual:l,original:e}),$q.notifyPositive("O produto foi inativado com sucesso.")}catch(e){$q.notifyError("Ocorreu um erro ao inativar o produto.",e)}finally{$q.loading.hide()}})},async duplicarItem(l){try{const e=await $db.item.duplica(l.id);this.abrirItem(e.id),this.busca=e.id,await this.atualizar(),this.$q.notifyPositive("O produto foi duplicado com sucesso.")}catch(e){this.$q.notifyError("Ocorreu erro ao duplicar produto.",e)}},async abrirItem(l){!(this.permissaoFicha||this.permissaoEstoque)||this.$router.replace({params:{id:l}}).finally(async()=>{this.$refs.itemFicha.abaAnterior="ItemFicha",this.$refs.itemFicha.abaSelecionada="ItemFicha",await this.$refs.itemFicha.show({id:l})})},async restaurarItem(l){$q.dialog({title:"Reativar produto",message:"Deseja reativar este produto?",cancel:{label:"N\xE3o",push:!0,color:"tertiary",flat:!0},ok:{label:"Sim",push:!0,class:"bg-negative",textColor:"white",flat:!0}}).onOk(async()=>{try{$q.loading.show();let e=$utils.clonarV2(l);l.ativo=!0,await $db.item.grava({atual:l,original:e}),$q.notifyPositive("O produto foi reativado com sucesso.")}catch(e){$q.notifyError("Ocorreu um erro ao reativar o produto.",e)}finally{$q.loading.hide()}})},async limparFiltrosClick(){this.filtros=$utils.clonar(this.filtrosOriginal),await this.atualizar()},async filtroFornecedor_click(){const l=await $g.promptContato.show({filtro:{ativo:!0}});l.nome&&(this.filtros.fornecedores=l.apelido)},async leOpcoesMarca(){this.opcoesMarca=(await $db.item.leValoresUnicos("marca")).map(l=>({rotulo:l,valor:l}))},async leOpcoesGrupo(){this.opcoesGrupo=(await $db.item.leValoresUnicos("grupo")).map(l=>({rotulo:l,valor:l}))},async leOpcoesTipo(){this.opcoesTipo=Ce},async criarClick(){const l=await this.$refs.itemCriar.show();!l.id||(this.busca=l.id,await this.atualizar(),this.abrirEdicaoCompleta(l.id))},async sincronizarECommercePorModal_click(){await this.$refs.sincronizarECommerce.show({filtros:this.itemListaFiltro,limit:this.paginacao.limite,page:this.paginacao.atual,sort:this.paginacao.ordenacao})},async buscarItem(){const l=await $g.promptItem.show({filtro:{ativo:!0}});l.acao&&Object.keys(l.itensSelecionados)[0]&&this.abrirItem(Object.keys(l.itensSelecionados)[0])},checkBoxClick(){for(const l of this.lista)this.listaLayout[l.id].remover=this.checkBox,this.tabSelecionada.valor==="Ativos"&&(this.mostrar.btnRemover=this.checkBox),this.tabSelecionada.valor==="Excluidos"&&(this.mostrar.btnRestaurar=this.checkBox)},verificarListaLayout(l){{let e=!0;for(const r of this.lista)this.listaLayout[r.id].remover||(e=!1);this.tabSelecionada.valor==="Ativos"&&(this.mostrar.btnRemover=Object.values(this.listaLayout).some(r=>r.ativo===!0&&r.remover===!0)),this.tabSelecionada.valor==="Excluidos"&&(this.mostrar.btnRestaurar=Object.values(this.listaLayout).some(r=>r.ativo===!1&&r.remover===!0)),this.checkbox=e,this.$refs.itemLista.checkbox=e}{let e=!0;for(const r of this.lista)this.listaLayout[r.id].detalhes||(e=!1);this.detalhes=e,this.$refs.itemLista.detalhes=e}},async removerClick(){$q.dialog({title:"Inativar produtos",message:"Deseja inativar todos os produtos selecionados?",cancel:{label:"N\xE3o",push:!0,color:"tertiary",flat:!0},ok:{label:"Sim",push:!0,class:"bg-negative",textColor:"white",flat:!0}}).onOk(async()=>{for(let l of this.lista)if(this.listaLayout[l.id].remover){const e=$utils.clonarV2(l);l.ativo=!1;try{await $db.item.grava({original:e,atual:l})}catch{$q.notify("Houve um erro ao inativar os produtos. Tente novamente")}}})},async restaurarClick(){$q.dialog({title:"Reativar produtos",message:"Deseja reativar todos os produtos selecionados?",cancel:{label:"N\xE3o",push:!0,color:"tertiary",flat:!0},ok:{label:"Sim",push:!0,class:"bg-negative",textColor:"white",flat:!0}}).onOk(async()=>{for(let l of this.lista)if(this.listaLayout[l.id].remover){let e=$utils.clonarV2(l);l.ativo=!0;try{await $db.item.grava({original:e,atual:l})}catch{$q.notify("Houve um erro ao reativar os produtos. Tente novamente")}}})},detalhesClick(){this.detalhes=!this.detalhes,this.lista.forEach(l=>{this.abrirDetalhes(l,this.detalhes)})},async abrirDetalhes(l,e){if(this.listaLayout[l.id].detalhes=e||!this.listaLayout[l.id].detalhes,this.listaLayout[l.id].detalhes){let r=await $db.item.leCompleto(l.id);this.listaLayout[l.id].fornecedor=r.atual.fornecedor}this.verificarListaLayout("detalhes")},importarItensClick(){this.$refs.importarItens.visivel=!0},importarDadosClick(){this.$refs.modalImportarDados.visivel=!0},combinarItensClick(){this.$refs.combinarItens.visivel=!0},editarMarcaClick(){this.$refs.editarMarca.visivel=!0},async adicionarItem(){if(this.campos.descricao.length<2){$q.notifyError("favor preencher a descri\xE7\xE3o do produto");return}let l={};try{this.completarCodigoBarras(),l={...$db.item.vazio,id:$utils.uuid(),ativo:!0,tipo:this.campos.tipo,marca:this.campos.marca,descricao:this.campos.descricao,referencia:this.campos.referencia,valorVenda:this.campos.valorVenda,codigoBarras:this.campos.codigoBarras,valorCustoReposicao:this.campos.valorCustoReposicao},$q.loading.show(),await $db.item.grava({atual:l}),this.busca=l.id,this.atualizar(),$q.notifyPositive("Os dados do produto foram salvos com sucesso."),this.campos={ativo:!0,codigoBarras:"",descricao:"",marca:"",referencia:"",tipo:"Produto",valorCustoReposicao:0,valorVenda:0}}catch(e){$q.notifyError("Ocorreu um erro ao salvar.",e)}finally{$q.loading.hide()}},abrirEdicaoCompleta(l){$q.dialog({title:"Produto Cadastrado!",message:"Deseja abrir a edi\xE7\xE3o completa?",persistent:"Sim",cancel:{label:"N\xE3o",push:!0,color:"tertiary",flat:!0},ok:{label:"Sim",push:!0,class:"bg-primary",textColor:"white",flat:!0}}).onOk(()=>{this.abrirItem(l)})},async exportaXLSClick(){try{$q.loading.show();const l=$utils.eliminarVazios(this.filtros);delete l.ativo,this.tabSelecionada.valor==="Ativos"&&(l.ativo=!0),this.tabSelecionada.valaor==="Excluidos"&&(l.ativo=!1);const r=(await $db.item.leRefatorado({filtros:l,limit:999999,page:1,sort:"descricao"})).data;for(let i=0;i<r.length;i++){const m=r[i];delete m.imagem}const n=ve.utils.book_new(),a=ve.utils.json_to_sheet(r,{header:Object.keys(r[0])});ve.utils.book_append_sheet(n,a,"itens"),ve.writeFile(n,"itens.xlsx")}catch(l){$q.notifyError("Erro iniciar",l)}finally{$q.loading.hide()}},async salvarItem(l){let e=await $erp().item.get(l.id),r=$utils.clonarV2(l);try{await $db.item.gravaItem({original:e,atual:r}),this.$q.notifyPositive("Produto alterado com sucesso")}catch(n){console.error(n),this.$q.notifyError("Ocorreu um erro ao alterar o produto."),this.atualizar()}},completarCodigoBarras(){!this.campos.codigoBarras&&!!this.campos.codigoItem&&(this.campos.codigoBarras=$utils.completarCodigoBarras(String(this.campos.codigoItem)))},criarMarca(){$q.dialog({title:"Cadastrar marca",prompt:{model:"",isValid:l=>l.length<=50,type:"text",class:"bg-light"},cancel:{label:"N\xE3o",push:!0,color:"tertiary",flat:!0},ok:{label:"Sim",push:!0,class:"bg-primary",textColor:"white",flat:!0}}).onOk(l=>{try{if(!l){alert("Favor preencher");return}if(l.length>50){alert("M\xE1ximo 50 caracteres");return}if(this.opcoesMarca.find(e=>e.rotulo.toUpperCase()===l.toUpperCase())){alert("Nome j\xE1 existente");return}this.campos.marca=l,$q.notifyPositive("Marca criada com sucesso.")}catch(e){$q.notifyError("Ocorreu um erro ao criar marca.",e)}})},async importarDadosReferencia(l){$q.loading.show();const e=await $db.item.ler({filtros:this.itemListaFiltro});for(const r of e.data)try{const n=$utils.clonarV2(r),a=await $db.arquivo.lista({tipoArquivo:"-",idTabelaMaster:r.id}),i=$utils.clonarV2(a),m=await $db.item.importarDadosProdutoReferencia({item:r,arquivosOriginal:i,alterarDescricao:l.alterarDescricao,alterarValorCusto:l.alterarValorCusto,alterarValorVenda:l.alterarValorVenda});await $db.item.grava({atual:m.item,original:n}),m.arquivos.forEach(f=>{a.find(u=>u.arquivo===f.arquivo)||$db.arquivo.grava({atual:f,original:{}})}),$q.notifyPositive(`Imagens e dados importados com sucesso para o produto ${r.descricao}`)}catch(n){$q.notify({message:`N\xE3o encontramos imagens ou dados para a refer\xEAncia do produto ${r.descricao}`,type:"warning"}),console.error(n)}await this.atualizar(),$q.loading.hide()},async getImagesFromApi(l){try{const r=(await $utils.geeksApi({getImagesFromApi:{funcao:"DB75E495-D0F8-4F09-BB51-9F028BB87D8B",ean:l.codigoBarras}})).data.getImagesFromApi.replace(/(\[*\]*'*)/g,""),n=[];for(const a of r.split(",")){const i=await this.getImageB6FromApi(a);n.push({id:$utils.uuid(),dataCriacao:$utils.dataAtual(),nome:a,idTabelaMaster:l.id,arquivo:i})}return n}catch(e){console.log(e)}finally{$q.loading.hide()}},async getImageB6FromApi(l){const e=await $utils.geeksApi({getImagesFromApi:{funcao:"E480B438-2555-4936-B04D-77EC188E0ADB",path:l}});return e==null?void 0:e.data.getImagesFromApi},async mostrarJsonViewer(){await this.$refs.jsonViewer.show(this)},async validarImprimirEtiquetas(){try{if(this.lista.some(l=>this.listaLayout[l.id].remover)){const l=await $db.hibrido.lista({table:"empresa"});l.length>0&&(this.impressaoEtiquetas.opcoesEmpresas=[{label:"Todos os estoques",value:"todos"},...l.filter(e=>e.ativo===!0).map(e=>({label:e.apelido||e.nome,value:e.idContato}))]),this.impressaoEtiquetas.visivel=!0}else $q.notify("Selecione os produtos clicando na checkbox para montar a impress\xE3o.")}catch(l){$q.notifyError("Erro ao validar impress\xE3o de etiquetas. ",l)}},async imprimirEtiquetas(){var l,e;try{$q.loading.show();const r=this.impressaoEtiquetas;let n=await $db.etiqueta.ler({cpfUsuarioLogado:this.usuario.numeroDocumentoNacional})||[];if(r!=null&&r.limpar){for(const a of n)await $db.etiqueta.remover(a.id);n=[]}for(const a of Object.values(this.listaLayout))if(a.remover){let i=1;if(r!=null&&r.empresaSelecionada){const f=await $db.estoqueSaldoProdutoEmpresa.leEstoquePorEmpresa(a.id);if(((l=r==null?void 0:r.empresaSelecionada)==null?void 0:l.value)==="todos")i=f.length?f.reduce((h,u)=>{var S;const V=((S=u.estoquePorLote)==null?void 0:S.reduce((x,y)=>x+(y.saldo||0),0))||0;return h+V},0):0;else{i=0;for(const h of f)for(const u of h.estoquePorLote)u.idEmpresa===((e=r==null?void 0:r.empresaSelecionada)==null?void 0:e.value)&&(i+=u.saldo)}i=i>=0?i:0}if(n.length){const s=n.find(f=>f.idItem===a.id)||null;i+=(s==null?void 0:s.quantidadeEtiquetas)>0?s==null?void 0:s.quantidadeEtiquetas:0,s&&await $db.etiqueta.remover(s.id)}const m={id:$utils.uuid(),idItem:a.id,nomeProduto:a.descricaoConcatenada,valor:a.valorVenda||0,quantidadeEtiquetas:i||0,cpfUsuarioLogado:this.usuario.numeroDocumentoNacional,dataHoraEmissao:$utils.dataAtual()};await $db.etiqueta.gravar({atual:m})}this.$router.push({name:"EtiquetasLista"})}catch(r){$q.notifyError("Erro ao imprimir etiquetas.",r)}finally{$q.loading.hide()}},compareObject(l,e,r=[]){const n=Object.keys(l);for(const a of n)if(!r.includes(a)){if(typeof l[a]=="object"&&l[a]!==null){if(!this.compareObject(l[a],e[a],r))continue;return!0}else if(l[a]!==e[a])return!0}return!1}},async mounted(){const l=await $db.configuracoes.le({nome:"importarImagensEAN"});if(this.filtrosOriginal=$utils.clonar(this.filtros),this.permissaoImportarImagensEAN=l.some(e=>Number(e.valor)===1),this.permissaoFicha=await $db.permissao.objeto("item//ficha"),this.permissaoEstoque=await $db.permissao.objeto("item//estoque"),this.permissaoCatalogoVirtual=await $db.permissao.objeto("site"),$db.eCommerce.ler().then(e=>{this.mostrarOpcaoSincronizarECommerce=e.some(r=>r.ativo)}),Ce[1].valor,await this.atualizar({buscarDadosRecentes:!0,id:null}),this.permissaoCatalogoVirtual)try{this.$utils.geeksApi({site:{funcao:"84C328A7-CEA7-4762-A703-C59DE8D53BF5"}}).then(e=>{var r,n,a;for(const i of(a=(n=(r=e.data)==null?void 0:r.site)==null?void 0:n.itens)!=null?a:[])!$db.item.itens.some(m=>m.id===i)||(this.catalogoVirtualChecked[i]=!0)})}catch(e){console.error(e)}if(this.$route.params.id){const e=this.$route.params.id;this.$route.path===`/item/${e}/ficha`&&(await this.$refs.itemFicha.show({id:e}),this.$refs.itemFicha.abaAnterior="ItemFicha",this.$refs.itemFicha.abaSelecionada="ItemFicha"),this.$route.path===`/item/${e}/estoque`&&(await this.$refs.itemFicha.show({id:e}),this.$refs.itemFicha.abaAnterior="ItemEstoque",this.$refs.itemFicha.abaSelecionada="ItemEstoque")}this.$route.params.id&&this.$route.params.id.length&&(this.abrirItem(this.$route.params.id),this.busca=this.$route.params.id)}},La={id:"ItemLista"},Ra={class:"mw80 text-center"},Na={class:"text-weight-medium"},Ba={class:"q-ml-sm"},Ka={style:{"white-space":"pre-line"}};function Ga(l,e,r,n,a,i){const m=C("campo"),s=C("SeletorCampoTabela"),f=C("BadgeCopiarUid"),h=C("avatar"),u=C("badge"),V=C("g-label"),S=C("g-col"),x=C("g-row"),y=C("Lista"),Z=C("itemFicha"),$=C("editarMarca"),T=C("importarItens"),K=C("combinarItens"),R=C("itemCriar"),d=C("sincronizarECommerce"),q=C("importarDadosReferencia"),b=C("JsonViewer");return g(),E("div",La,[o(y,{ref:"itemLista",busca:a.busca,"onUpdate:busca":e[29]||(e[29]=c=>a.busca=c),checkBox:a.checkBox,"onUpdate:checkBox":e[30]||(e[30]=c=>a.checkBox=c),onAtualizar:i.atualizar,onCheckBoxClick:i.checkBoxClick,onCriarClick:i.criarClick,onDetalhesClick:i.detalhesClick,onExportaXLSClick:i.exportaXLSClick,onLimparFiltrosClick:i.limparFiltrosClick,onRemoverClick:i.removerClick,onRestaurarClick:i.restaurarClick,lista:a.lista,permissao:a.permissaoFicha,tabSelecionada:a.tabSelecionada,tabs:a.tabs,paginacao:a.paginacao,mostrar:a.mostrar},{menuExtras:t(()=>[a.permissaoFicha?(g(),v(j,{key:0,onClick:e[0]||(e[0]=c=>i.importarItensClick()),clickable:""},{default:t(()=>[o(I,{avatar:""},{default:t(()=>[o(F,{name:"publish",size:"sm"})]),_:1}),o(I,null,{default:t(()=>e[34]||(e[34]=[p("Importar")])),_:1})]),_:1})):k("",!0),a.permissaoFicha?(g(),v(j,{key:1,onClick:e[1]||(e[1]=c=>i.exportaXLSClick()),clickable:"",class:"hideondesktop"},{default:t(()=>[o(I,{avatar:""},{default:t(()=>[o(F,{name:"mdi-download",size:"sm"})]),_:1}),o(I,null,{default:t(()=>e[35]||(e[35]=[p("Exportar")])),_:1})]),_:1})):k("",!0),a.permissaoFicha&&a.sistemaPai==="optisoul"&&a.permissaoImportarImagensEAN?(g(),v(j,{key:2,onClick:i.importarDadosClick,clickable:""},{default:t(()=>[o(I,{avatar:""},{default:t(()=>[o(F,{name:"mdi-image"})]),_:1}),o(I,null,{default:t(()=>e[36]||(e[36]=[p("Importar Produtos/Imagens")])),_:1})]),_:1},8,["onClick"])):k("",!0),o(j,{onClick:e[2]||(e[2]=c=>l.$imprimir("catalogo-pdf")),clickable:""},{default:t(()=>[o(I,{avatar:""},{default:t(()=>[o(F,{name:"print",size:"sm"})]),_:1}),o(I,null,{default:t(()=>e[37]||(e[37]=[p("Cat\xE1logo PDF")])),_:1})]),_:1}),a.permissaoFicha?(g(),v(j,{key:3,onClick:e[3]||(e[3]=c=>i.combinarItensClick()),clickable:""},{default:t(()=>[o(I,{avatar:""},{default:t(()=>[o(F,{name:"compare_arrows",size:"sm"})]),_:1}),o(I,null,{default:t(()=>e[38]||(e[38]=[p("Combinar")])),_:1})]),_:1})):k("",!0),a.permissaoFicha?(g(),v(j,{key:4,onClick:e[4]||(e[4]=c=>i.editarMarcaClick()),clickable:""},{default:t(()=>[o(I,{avatar:""},{default:t(()=>[o(F,{name:"edit",size:"sm"})]),_:1}),o(I,null,{default:t(()=>e[39]||(e[39]=[p("Marca, Grupo, Subgrupo, UN e NCM")])),_:1})]),_:1})):k("",!0),a.permissaoCatalogoVirtual?(g(),v(j,{key:5,onClick:e[5]||(e[5]=c=>i.toggleCatalogoVirtual("on")),clickable:""},{default:t(()=>[o(I,{avatar:""},{default:t(()=>[o(F,{name:"toggle_on",size:"sm"})]),_:1}),o(I,null,{default:t(()=>e[40]||(e[40]=[p("Habilitar itens para o cat\xE1logo virtual")])),_:1})]),_:1})):k("",!0),a.permissaoCatalogoVirtual?(g(),v(j,{key:6,onClick:e[6]||(e[6]=c=>i.toggleCatalogoVirtual("off")),clickable:""},{default:t(()=>[o(I,{avatar:""},{default:t(()=>[o(F,{name:"toggle_off",size:"sm"})]),_:1}),o(I,null,{default:t(()=>e[41]||(e[41]=[p("Desabilitar itens para o cat\xE1logo virtual")])),_:1})]),_:1})):k("",!0),a.mostrarOpcaoSincronizarECommerce?(g(),v(j,{key:7,onClick:e[7]||(e[7]=c=>i.sincronizarECommercePorModal_click()),clickable:""},{default:t(()=>[o(I,{avatar:""},{default:t(()=>[o(F,{name:"shopping_cart",size:"sm"})]),_:1}),o(I,null,{default:t(()=>e[42]||(e[42]=[p("e-Commerce")])),_:1})]),_:1})):k("",!0),l.$db.usuario.desenvolvedor()?O((g(),v(j,{key:8,clickable:"",onClick:e[8]||(e[8]=c=>i.mostrarJsonViewer())},{default:t(()=>[o(I,{avatar:""},{default:t(()=>[o(F,{name:"mdi-file-replace",size:"sm"})]),_:1}),o(I,null,{default:t(()=>e[43]||(e[43]=[p("Ver Objeto")])),_:1})]),_:1})),[[Y]]):k("",!0),o(j,{onClick:e[9]||(e[9]=c=>i.validarImprimirEtiquetas()),clickable:""},{default:t(()=>[o(I,{avatar:""},{default:t(()=>[o(F,{name:"mdi-barcode",size:"sm"})]),_:1}),o(I,null,{default:t(()=>e[44]||(e[44]=[p("Imprimir Etiquetas")])),_:1})]),_:1})]),filtroCampos:t(()=>[o(m,{modelValue:a.filtros.descricaoAplicacao,"onUpdate:modelValue":e[10]||(e[10]=c=>a.filtros.descricaoAplicacao=c),dense:"",rotulo:"Descri\xE7\xE3o/Aplica\xE7\xE3o",class:"col-12 q-field--with-bottom"},null,8,["modelValue"]),o(m,{modelValue:a.filtros.codigoItem,"onUpdate:modelValue":e[11]||(e[11]=c=>a.filtros.codigoItem=c),rotulo:"C\xF3digo",prefix:"#",tipo:"decimal",decimals:"0",zerosDireita:"0",dense:"",class:"col-12 q-field--with-bottom"},null,8,["modelValue"]),o(m,{modelValue:a.filtros.referencia,"onUpdate:modelValue":e[12]||(e[12]=c=>a.filtros.referencia=c),rotulo:"Refer\xEAncia",dense:"",class:"col-12 q-field--with-bottom"},null,8,["modelValue"]),o(m,{modelValue:a.filtros.codigoBarras,"onUpdate:modelValue":e[13]||(e[13]=c=>a.filtros.codigoBarras=c),rotulo:"C\xF3d. Barras",dense:"",class:"col-12 q-field--with-bottom"},null,8,["modelValue"]),o(s,{modelValue:a.filtros.marca,"onUpdate:modelValue":e[14]||(e[14]=c=>a.filtros.marca=c),buscarSemCaractere:!0,dense:"",label:"Marca",tabela:"item",campo:"marca"},null,8,["modelValue"]),o(m,{modelValue:a.filtros.fornecedores,"onUpdate:modelValue":e[15]||(e[15]=c=>a.filtros.fornecedores=c),dense:"",class:"q-field--with-bottom",after:[{icon:"search",handler:i.filtroFornecedor_click}],rotulo:"Fornecedor"},null,8,["modelValue","after"]),o(s,{modelValue:a.filtros.grupo,"onUpdate:modelValue":e[16]||(e[16]=c=>a.filtros.grupo=c),buscarSemCaractere:!0,dense:"",tabela:"item",campo:"grupo",label:"Grupo"},null,8,["modelValue"]),o(s,{modelValue:a.filtros.subGrupo,"onUpdate:modelValue":e[17]||(e[17]=c=>a.filtros.subGrupo=c),buscarSemCaractere:!0,dense:"",tabela:"item",campo:"subGrupo",label:"Subgrupo"},null,8,["modelValue"]),o(m,{modelValue:a.filtros.status,"onUpdate:modelValue":e[18]||(e[18]=c=>a.filtros.status=c),opcoes:i.opcoesStatus,dense:"",rotuloFixo:"Status",tipo:"seletor",class:"q-field--with-bottom"},null,8,["modelValue","opcoes"]),o(m,{modelValue:a.filtros.estoque,"onUpdate:modelValue":e[19]||(e[19]=c=>a.filtros.estoque=c),rotulo:"Estoque",prefix:">",tipo:"decimal",decimals:"4",dense:"",class:"q-field--with-bottom"},null,8,["modelValue"]),o(m,{modelValue:a.filtros.tipo,"onUpdate:modelValue":e[20]||(e[20]=c=>a.filtros.tipo=c),onClick:i.leOpcoesTipo,opcoes:a.opcoesTipo,filter:"",dense:"",rotuloFixo:"Tipo",tipo:"seletor",class:"q-field--with-bottom"},null,8,["modelValue","onClick","opcoes"]),o(m,{modelValue:a.filtros.numeroCompra,"onUpdate:modelValue":e[21]||(e[21]=c=>a.filtros.numeroCompra=c),rotulo:"N\xFAmero Compra",prefix:"#",tipo:"decimal",decimals:"0",zerosDireita:"0",dense:"",class:"q-field--with-bottom"},null,8,["modelValue"]),o(m,{modelValue:a.filtros.idDocumento,"onUpdate:modelValue":e[22]||(e[22]=c=>a.filtros.idDocumento=c),dense:"",clearable:"",rotulo:"ID Documento",class:"col-12 q-field--with-bottom"},null,8,["modelValue"]),o(m,{modelValue:a.filtros.ordenacao,"onUpdate:modelValue":e[23]||(e[23]=c=>a.filtros.ordenacao=c),options:a.opcoesOrdenacao,dense:"",rotuloFixo:"Ordenar por",tipo:"seletor",class:"q-mt-lg"},null,8,["modelValue","options"]),o(m,{modelValue:a.filtros.direcao,"onUpdate:modelValue":e[24]||(e[24]=c=>a.filtros.direcao=c),options:a.opcoesDirecao,dense:"",rotuloFixo:"Dire\xE7\xE3o",tipo:"seletor",class:"q-mt-sm"},null,8,["modelValue","options"]),o(m,{modelValue:a.paginacao.limite,"onUpdate:modelValue":e[25]||(e[25]=c=>a.paginacao.limite=c),rotulo:"Quantidade por p\xE1gina",tipo:"quantidade",min:"1",dense:"",class:"q-mt-xl"},null,8,["modelValue"]),a.permissaoCatalogoVirtual?O((g(),v(j,{key:0,tag:"label",class:"q-pa-none q-mt-xl"},{default:t(()=>[o(I,{avatar:""},{default:t(()=>[o(we,{modelValue:a.filtros.catalogoVirtualChecked,"onUpdate:modelValue":e[26]||(e[26]=c=>a.filtros.catalogoVirtualChecked=c)},null,8,["modelValue"])]),_:1}),o(I,null,{default:t(()=>[o(W,null,{default:t(()=>e[45]||(e[45]=[p("Cat\xE1logo Virtual")])),_:1}),o(W,{caption:""},{default:t(()=>e[46]||(e[46]=[p("Exibir apenas produtos habilitados")])),_:1})]),_:1})]),_:1})),[[Oe]]):k("",!0)]),itemLista:t(()=>[o(he,{bordered:"",class:"bg-white q-mb-xs rounded-borders"},{default:t(()=>[(g(!0),E(z,null,L(a.lista,c=>(g(),E("div",{key:c.id,class:"itemHover"},[o(j,{"manual-focus":"",class:"q-py-sm q-px-xs items-center"},{default:t(()=>[o(I,{class:"hideonmobile col-auto no-margin"},{default:t(()=>[o(j,{class:"q-pa-none"},{default:t(()=>[o(I,{side:"",class:"col-auto q-pa-none"},{default:t(()=>[o(we,{modelValue:a.listaLayout[c.id].remover,"onUpdate:modelValue":M=>a.listaLayout[c.id].remover=M,onClick:e[27]||(e[27]=M=>i.verificarListaLayout("checkbox"))},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),a.permissaoCatalogoVirtual?O((g(),v(I,{key:0,side:"",class:"col-auto q-pa-none q-pl-sm"},{default:t(()=>[o(ge,{modelValue:a.catalogoVirtualChecked[c.id],"onUpdate:modelValue":[M=>a.catalogoVirtualChecked[c.id]=M,i.salvarCatalogoVirtual],dense:""},null,8,["modelValue","onUpdate:modelValue"]),o(Q,{anchor:"bottom middle",self:"center middle"},{default:t(()=>e[47]||(e[47]=[p(" Cat\xE1logo Virtual ")])),_:1})]),_:2},1024)),[[Oe]]):k("",!0),o(I,{side:"",class:"col-auto q-pa-none"},{default:t(()=>[A("div",Ra,[o(f,{id:c.id,numero:c.codigoItem,cor:c.ativo?"positive":"tertiary",dica:"C\xF3digo Item"},null,8,["id","numero","cor"])])]),_:2},1024)]),_:2},1024)]),_:2},1024),o(I,{class:"col-md col-lg col-xl no-margin"},{default:t(()=>[o(j,{class:"q-pa-none"},{default:t(()=>[o(I,{onClick:M=>i.abrirItem(c.id),class:"col-auto items-center"},{default:t(()=>[o(h,{imagem:c.imagem,rotulo:c.descricaoConcatenada,tamanho:"40",style:{display:"flex","align-self":"center"}},null,8,["imagem","rotulo"]),o(ge,{modelValue:a.catalogoVirtualChecked[c.id],"onUpdate:modelValue":[M=>a.catalogoVirtualChecked[c.id]=M,i.salvarCatalogoVirtual],dense:"",class:"hideondesktop q-mt-md"},null,8,["modelValue","onUpdate:modelValue"]),o(we,{modelValue:a.listaLayout[c.id].remover,"onUpdate:modelValue":M=>a.listaLayout[c.id].remover=M,onClick:e[28]||(e[28]=M=>i.verificarListaLayout("checkbox")),class:"hideondesktop q-mt-sm"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["onClick"]),o(I,{onClick:M=>i.abrirItem(c.id),class:"col cursor-pointer"},{default:t(()=>[o(W,{lines:"2",class:"text-weight-bold"},{default:t(()=>[A("span",null,[p(P(c.descricaoConcatenada)+" ",1),o(Q,{anchor:"bottom middle",self:"center middle"},{default:t(()=>e[48]||(e[48]=[p(" Descri\xE7\xE3o ")])),_:1})])]),_:2},1024),c.marca?(g(),v(W,{key:0,caption:""},{default:t(()=>[A("span",null,[o(F,{name:"bookmarks"}),p(" "+P(c.marca)+" ",1),o(Q,{anchor:"bottom middle",self:"center middle"},{default:t(()=>e[49]||(e[49]=[p("Marca")])),_:1})])]),_:2},1024)):k("",!0),c.referencia?(g(),v(W,{key:1,caption:""},{default:t(()=>[A("span",null,[o(F,{name:"route"}),p(" "+P(c.referencia)+" ",1),o(Q,{anchor:"bottom middle",self:"center middle"},{default:t(()=>e[50]||(e[50]=[p("Refer\xEAncia")])),_:1})])]),_:2},1024)):k("",!0),o(I,{class:"hideondesktop q-mt-sm"},{default:t(()=>[A("div",null,[o(f,{id:c.id,numero:c.codigoItem,cor:c.ativo?"positive":"tertiary",class:"q-mr-xs"},null,8,["id","numero","cor"]),c.tipo?(g(),v(u,{key:0,rotulo:c.tipo,cor:"tertiary",escuro:""},null,8,["rotulo"])):k("",!0),o(W,{class:"text-weight-bold q-mt-md text-right"},{default:t(()=>[p(P(l.$filters.numeroZerosDireita(c.valorVenda,4,2)),1)]),_:2},1024)])]),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024),o(I,{onClick:M=>i.abrirItem(c.id),class:"hideonmobile maxw160 q-pl-sm no-margin text-center cursor-pointer"},{default:t(()=>[c.grupo?(g(),v(W,{key:0,caption:"",lines:"2"},{default:t(()=>[A("span",null,[p(P(c.grupo)+" ",1),o(Q,{anchor:"bottom middle",self:"center middle"},{default:t(()=>e[51]||(e[51]=[p(" Grupo ")])),_:1})])]),_:2},1024)):k("",!0),c.grupo?(g(),v(W,{key:1,caption:"",lines:"2"},{default:t(()=>[A("span",null,[p(P(c.subGrupo)+" ",1),o(Q,{anchor:"bottom middle",self:"center middle"},{default:t(()=>e[52]||(e[52]=[p(" Subgrupo ")])),_:1})])]),_:2},1024)):k("",!0)]),_:2},1032,["onClick"]),o(I,{onClick:M=>i.abrirItem(c.id),class:"hideonmobile maxw100 q-pl-sm no-margin cursor-pointer"},{default:t(()=>[o(W,{class:"text-center"},{default:t(()=>[o(u,{rotulo:c.tipo,dica:"Tipo do produto",cor:"tertiary",escuro:"",class:"col-auto q-mx-auto"},null,8,["rotulo"])]),_:2},1024),c.dataCadastro&&a.filtros.ordenacao==="dataCadastro"?(g(),v(W,{key:0,caption:"",class:"text-center"},{default:t(()=>[A("span",null,[o(F,{name:"mdi-calendar-today",class:"q-mr-xs"}),A("span",Na,P(l.$filters.data(c==null?void 0:c.dataCadastro)),1),o(Q,{anchor:"bottom middle",self:"center middle"},{default:t(()=>[p(" Cadastrado \xE1s "+P(l.$filters.hora(c==null?void 0:c.dataCadastro)),1)]),_:2},1024)])]),_:2},1024)):k("",!0)]),_:2},1032,["onClick"]),o(I,{onClick:M=>i.abrirItem(c.id),class:"hideonmobile maxw100 q-pl-sm no-margin cursor-pointer"},{default:t(()=>[o(W,{caption:"",class:"text-weight-bold text-right"},{default:t(()=>[A("span",null,[p(P(l.$filters.numeroZerosDireita(c.valorVenda,4,2))+" ",1),o(Q,{anchor:"bottom middle",self:"center middle"},{default:t(()=>e[53]||(e[53]=[p(" Valor de venda ")])),_:1})])]),_:2},1024)]),_:2},1032,["onClick"]),o(I,{class:"col-auto no-margin"},{default:t(()=>[o(j,{class:"q-pa-none"},{default:t(()=>[o(I,{class:"hideonmobile no-margin",style:{"max-width":"32px"}},{default:t(()=>[o(_,{onClick:M=>i.abrirDetalhes(c),size:"md",color:"tertiary",round:"",flat:"",dense:"",icon:a.listaLayout[c.id].detalhes?"keyboard_arrow_up":"keyboard_arrow_down"},null,8,["onClick","icon"])]),_:2},1024),o(I,{class:"hideonmobile no-margin",style:{"max-width":"32px"}},{default:t(()=>[a.permissaoFicha||a.permissaoEstoque?(g(),v(_,{key:0,onClick:M=>i.abrirItem(c.id),icon:"edit",size:"md",color:"primary",round:"",flat:"",dense:""},null,8,["onClick"])):k("",!0)]),_:2},1024),o(I,{class:"no-margin",style:{"max-width":"32px"}},{default:t(()=>[o(_,{icon:"more_vert",size:"md",round:"",flat:"",dense:""},{default:t(()=>[o(Ge,null,{default:t(()=>[O((g(),v(he,{link:"","no-border":"",separator:""},{default:t(()=>[a.permissaoFicha||a.permissaoEstoque?(g(),v(j,{key:0,clickable:"",onClick:M=>i.abrirItem(c.id),class:"hideondesktop"},{default:t(()=>[o(I,{avatar:""},{default:t(()=>[o(F,{name:"edit"})]),_:1}),o(I,null,{default:t(()=>e[54]||(e[54]=[p("Editar")])),_:1})]),_:2},1032,["onClick"])):k("",!0),o(j,{onClick:M=>i.abrirDetalhes(c),clickable:"",class:"hideondesktop"},{default:t(()=>[o(I,{avatar:""},{default:t(()=>[o(F,{name:a.listaLayout[c.id].detalhes?"keyboard_arrow_up":"keyboard_arrow_down"},null,8,["name"])]),_:2},1024),o(I,null,{default:t(()=>e[55]||(e[55]=[p("Mais Detalhes")])),_:1})]),_:2},1032,["onClick"]),c.ativo&&a.permissaoFicha?(g(),v(j,{key:1,onClick:M=>i.removerItem(c),clickable:""},{default:t(()=>[o(I,{avatar:""},{default:t(()=>[o(F,{name:"delete"})]),_:1}),o(I,null,{default:t(()=>e[56]||(e[56]=[p("Inativar")])),_:1})]),_:2},1032,["onClick"])):k("",!0),!c.ativo&&a.permissaoFicha?(g(),v(j,{key:2,onClick:M=>i.restaurarItem(c),clickable:""},{default:t(()=>[o(I,{avatar:""},{default:t(()=>[o(F,{name:"restore_from_trash"})]),_:1}),o(I,null,{default:t(()=>e[57]||(e[57]=[p("Reativar")])),_:1})]),_:2},1032,["onClick"])):k("",!0),a.permissaoFicha?(g(),v(j,{key:3,onClick:M=>i.duplicarItem(c),clickable:""},{default:t(()=>[o(I,{avatar:""},{default:t(()=>[o(F,{name:"control_point_duplicate"})]),_:1}),o(I,null,{default:t(()=>[o(W,null,{default:t(()=>e[58]||(e[58]=[p("Duplicar")])),_:1}),o(W,{caption:""},{default:t(()=>e[59]||(e[59]=[p("Produto/Servi\xE7o")])),_:1})]),_:1})]),_:2},1032,["onClick"])):k("",!0)]),_:2},1024)),[[Y]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),a.listaLayout[c.id].detalhes?(g(),v(x,{key:0,gutter:"md-x lg-y"},{default:t(()=>[o(S,{col:"12 sm6 md3",bordered:""},{default:t(()=>[o(V,{icon:"business xs tertiary left"},{default:t(()=>e[60]||(e[60]=[p("Fornecedor (s)")])),_:1}),(g(!0),E(z,null,L(a.listaLayout[c.id].fornecedor,M=>(g(),v(V,{key:M.idContato,class:"q-mt-xs",lines:"1"},{default:t(()=>[p(P(M.contato.nome),1)]),_:2},1024))),128))]),_:2},1024),o(S,{col:"12 sm6 md3",bordered:""},{default:t(()=>[o(V,{icon:"inventory_2 xs tertiary left"},{default:t(()=>e[61]||(e[61]=[p("Estoque")])),_:1}),o(V,{class:"q-ml-lg"},{default:t(()=>[e[62]||(e[62]=p(" Quantidade: ")),A("strong",Ba,P(c.quantidadeDisponivel),1),o(u,{rotulo:c.unidade,cor:"tertiary",escuro:"",class:"q-ml-md",dica:"Tipo"},null,8,["rotulo"])]),_:2},1024),o(V,{icon:"mdi-barcode sm tertiary left",class:"q-mt-md"},{default:t(()=>[A("span",null,[p(P(c.codigoBarras)+" ",1),o(Q,{anchor:"bottom middle",self:"center middle"},{default:t(()=>e[63]||(e[63]=[p("C\xF3digo de Barras")])),_:1})])]),_:2},1024),A("div",null,[A("span",Ka,P(c.address),1)])]),_:2},1024),o(S,{col:"12 md6",bordered:""},{default:t(()=>[a.permissaoFicha?(g(),v(x,{key:0},{default:t(()=>[o(S,{col:"2 md-auto"},{default:t(()=>[o(ge,{modelValue:a.listaLayout[c.id].utilizaComposicaoValorReposicaoInvertido,"onUpdate:modelValue":[M=>a.listaLayout[c.id].utilizaComposicaoValorReposicaoInvertido=M,M=>i.atualizarCustoReposicao(c)],"checked-icon":"check","unchecked-icon":"clear",size:"sm"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(S,{col:"10 md"},{default:t(()=>[o(m,{class:"full-width no-shadow",dense:"",rotulo:"Custo de reposi\xE7\xE3o",tipo:"decimal",decimals:"2",modelValue:c.valorCustoReposicao,"onUpdate:modelValue":M=>c.valorCustoReposicao=M,onBlur:M=>i.atualizarValorVendaLucro(c),ajuda:a.listaLayout[c.id].utilizaComposicaoValorReposicaoInvertido?"":"Total da composi\xE7\xE3o",disable:!a.listaLayout[c.id].utilizaComposicaoValorReposicaoInvertido,readonly:!a.listaLayout[c.id].utilizaComposicaoValorReposicaoInvertido},null,8,["modelValue","onUpdate:modelValue","onBlur","ajuda","disable","readonly"])]),_:2},1024),o(S,{col:"10 md",offset:"2 md0"},{default:t(()=>[o(m,{class:"full-width no-shadow q-field--with-bottom",dense:"",rotulo:"Lucro %",tipo:"decimal",decimals:"2",modelValue:c.percentualMarkup,"onUpdate:modelValue":M=>c.percentualMarkup=M,onBlur:M=>i.atualizarValorVendaLucro(c),disable:a.listaLayout[c.id].utilizaMarkupInvertido,readonly:a.listaLayout[c.id].utilizaMarkupInvertido},null,8,["modelValue","onUpdate:modelValue","onBlur","disable","readonly"])]),_:2},1024),o(S,{col:"2 md-auto"},{default:t(()=>[o(ge,{modelValue:a.listaLayout[c.id].utilizaMarkupInvertido,"onUpdate:modelValue":M=>a.listaLayout[c.id].utilizaMarkupInvertido=M,"checked-icon":"check","unchecked-icon":"clear",size:"sm"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(S,{col:"10 md"},{default:t(()=>[o(m,{class:"full-width no-shadow q-field--with-bottom",dense:"",rotulo:"Valor de venda",tipo:"decimal",decimals:"4",zerosDireita:"2",modelValue:c.valorVenda,"onUpdate:modelValue":M=>c.valorVenda=M,onBlur:M=>i.atualizarValorVendaLucro(c),disable:!a.listaLayout[c.id].utilizaMarkupInvertido,readonly:!a.listaLayout[c.id].utilizaMarkupInvertido},null,8,["modelValue","onUpdate:modelValue","onBlur","disable","readonly"])]),_:2},1024),o(S,{col:"12 md-auto"},{default:t(()=>[o(_,{onClick:M=>i.salvarItem(c),color:"primary",label:"Salvar",size:"md",unelevated:"",class:"full-width no-shadow"},null,8,["onClick"])]),_:2},1024)]),_:2},1024)):k("",!0)]),_:2},1024)]),_:2},1024)):k("",!0),c.id?(g(),v(G,{key:1})):k("",!0)]))),128))]),_:1})]),_:1},8,["busca","checkBox","onAtualizar","onCheckBoxClick","onCriarClick","onDetalhesClick","onExportaXLSClick","onLimparFiltrosClick","onRemoverClick","onRestaurarClick","lista","permissao","tabSelecionada","tabs","paginacao","mostrar"]),o(Z,{ref:"itemFicha",onAtualizar:i.atualizar},null,8,["onAtualizar"]),o($,{ref:"editarMarca",onAtualizar:i.atualizar},null,8,["onAtualizar"]),o(T,{ref:"importarItens"},null,512),o(K,{ref:"combinarItens",onAtualizar:i.atualizar},null,8,["onAtualizar"]),o(R,{ref:"itemCriar"},null,512),o(d,{ref:"sincronizarECommerce"},null,512),o(q,{ref:"modalImportarDados",onOpcaoSelecionada:i.importarDadosReferencia,label:"Gostaria de importar essas informa\xE7\xF5es nos produtos da lista?"},null,8,["onOpcaoSelecionada"]),o(b,{ref:"jsonViewer"},null,512),o(oe,{modelValue:a.impressaoEtiquetas.visivel,"onUpdate:modelValue":e[33]||(e[33]=c=>a.impressaoEtiquetas.visivel=c)},{default:t(()=>[o(qe,{container:"",view:"hHh LpR fFf",class:"bg-white rounded-borders",style:{height:"100%","max-height":"400px"}},{default:t(()=>[o(ae,{onSubmit:i.imprimirEtiquetas,autocorrect:"off",autocapitalize:"off",autocomplete:"off",spellcheck:"false",novalidate:""},{default:t(()=>[o(ke,null,{default:t(()=>[o(B,{class:"bg-primary text-white"},{default:t(()=>[o(ee,null,{default:t(()=>[o(F,{name:"mdi-tag-plus",size:"sm",class:"q-mr-sm"}),e[64]||(e[64]=p(" Imprimir Etiquetas "))]),_:1})]),_:1})]),_:1}),o(ue,null,{default:t(()=>[o(me,{class:"q-pa-md"},{default:t(()=>[o(V,{class:"q-pb-lg"},{default:t(()=>e[65]||(e[65]=[p(" Ao selecionar um estoque a quantidade de etiquetas ser\xE1 preenchida automaticamente ou deixe em branco para adicionar a quantidade de 1 etiqueta por item selecionado. ")])),_:1}),o(Le,{modelValue:a.impressaoEtiquetas.empresaSelecionada,"onUpdate:modelValue":e[31]||(e[31]=c=>a.impressaoEtiquetas.empresaSelecionada=c),options:a.impressaoEtiquetas.opcoesEmpresas,"option-value":"id","option-label":"label",label:"Empresa estoque","emit-value":"","map-options":"",filled:"",clearable:""},null,8,["modelValue","options"]),o(m,{modelValue:a.impressaoEtiquetas.limpar,"onUpdate:modelValue":e[32]||(e[32]=c=>a.impressaoEtiquetas.limpar=c),tipo:"logico",class:"q-pt-xl",rotulo:"Limpar lista de etiquetas anterior."},null,8,["modelValue"])]),_:1})]),_:1}),o(Ie,{class:"bg-light"},{default:t(()=>[o(B,null,{default:t(()=>[o(te),O(o(_,{label:"Cancelar",color:"tertiary",flat:"",class:"q-mr-sm"},null,512),[[Y]]),o(_,{label:"Confirmar",color:"primary",type:"submit",unelevated:""})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])])}var Qa=H(Ta,[["render",Ga],["__scopeId","data-v-22ed27d1"]]),ot=Object.freeze(Object.defineProperty({__proto__:null,default:Qa},Symbol.toStringTag,{value:"Module"}));export{ot as I,Qa as a,Fa as b,ha as c,ca as i};
