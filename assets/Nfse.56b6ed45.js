import{_ as O,bt as L,r as R,o as b,p as D,f as s,w as i,M as T,G as k,h as w,Q as E,i as I,k as f,d as C,e as S,bf as z,H as M,S as A,T as F,j as Q,N as j,I as H,J as P,E as J,aL as B,t as U,v as N,as as g,C as q,K as X,br as K,D as G}from"./index.d84ea451.js";import{o as h}from"./optionsNfse.12d4a18d.js";import{J as x}from"./JsonViewer.f4a92f7e.js";const W={components:{JsonViewer:x},data(){return{showModal:!1,opcoesNatureza:[],opcoesTipoRps:[],opcoesRegimeEspecialTributacao:[],opcoesStatusRps:[],opcoesSimNao:[],opcoesUF:[],opcoesInformacoesServicos:[],telefoneTipos:[],situacaoNfse:"Rascunho",nfse:{},opcoesCidadeIbge:[],JsonViewer:x}},emits:["atualizar"],methods:{onHide(){this.$router.replace({params:{id:""}})},trocouServico(u){const e=this.opcoesInformacoesServicos.find(m=>m.codigo===u);this.nfse.servico.itemListaServico=e.codigo,this.nfse.servico.codigoCnae=e.codigoCNAE,this.nfse.servico.codigoTributacaoMunicipio=e.codigoTributacao,this.nfse.servico.valores.aliquota=parseFloat(e.iss)},async abrirModalTomador(){var o,d,a,c,r;const u={ativo:!0},e=await $g.promptContato.show({filtro:u,placeholder:"Selecione"});if(!e)return;if(!e.nome){$q.notifyError("\xC9 preciso informar a Raz\xE3o Social do Intermedi\xE1rio");return}if(!(((d=(o=e.numeroDocumentoNacional)==null?void 0:o.replace(/\D/g,""))==null?void 0:d.length)===11||((c=(a=e.numeroDocumentoNacional)==null?void 0:a.replace(/\D/g,""))==null?void 0:c.length)===14)){$q.notifyError("\xC9 preciso informar o CPF/CNPJ do Intermedi\xE1rio");return}const t=await $db.contatoEndereco.leEnderecoPrincipal(e.id);if(!(t!=null&&t.id)){$q.notifyError("\xC9 preciso informar um endere\xE7o principal na ficha do contato.");return}this.nfse.tomador.razaoSocial=e.nome,this.nfse.tomador.documento=e.numeroDocumentoNacional.match(/\d+/g).join(""),this.nfse.tomador.endereco.numero=t.numero,this.nfse.tomador.endereco.rua=t.logradouro,this.nfse.tomador.endereco.bairro=t.bairro,this.nfse.tomador.endereco.cidade=t.ibgeCod,this.nfse.tomador.endereco.estado=t.uf,this.nfse.tomador.endereco.complemento=(r=t==null?void 0:t.complemento)!=null?r:"",this.nfse.tomador.endereco.cep=t.cep,this.opcoesCidadeIbge.push({valor:t.ibgeCod,rotulo:t.municipio+"-"+t.uf}),console.log(this.nfse),console.log(this.opcoesCidadeIbge)},async show(u,e,m){var n,V,v,l;let t=null,o=null,d=null,a=null;if(u&&(d=await $db.hibrido.le({table:"documentoFiscalEletronico",id:u}),a=JSON.parse(d.json),t=(await $erp().empresa.toArray()).find(p=>p.numeroDocumentoNacional.replace(/\D/g,"")===d.cpfCnpjEmitente)),t!=null&&t.idContato&&(o=(await $db.empresa.le({idContato:t.idContato}))[0]),o&&(e={nfseItensListaDeServico:JSON.parse((n=o.nfseItensListaDeServico)!=null?n:null)}),a!=null&&a.rps)this.nfse=a.rps,this.situacaoNfse=d.situacao;else{if(this.situacaoNfse="Rascunho",this.nfse=$utils.clonarV2($db.nfse.modelo),this.nfse.dataHoraCriacao=$utils.dataAtual(),m){const p=m==null?void 0:m.rps,y=(Number((V=p==null?void 0:p.identificacaoRps)==null?void 0:V.numero)||0)+1;this.nfse.identificacaoRps.numero=y.toString(),this.nfse.identificacaoRps.serie=(v=p==null?void 0:p.identificacaoRps)==null?void 0:v.serie,this.nfse.numeroLote=this.nfse.numeroLote||y.toString()}this.nfse.prestador.documento=e.documento,this.nfse.prestador.razaoSocial=e.nome,this.nfse.prestador.inscricaoMunicipal=e.inscricaoMunicipal,this.nfse.inscricaoMunicipal=e.inscricaoMunicipal,this.nfse.optanteSimplesNacional=e.nfseOptanteSimples,this.nfse.incentivadorCultural=e.nfseIncentivadorCultural,this.nfse.naturezaOperacao=e.nfseNaturezaOperacao,this.nfse.regimeEspecialTributacao=e.nfseRegimeTributario,this.nfse.servico.discriminacao=e.nfseDescricaoServico,this.nfse.servico.valores.aliquota=e.nfseAliquotaIss,this.nfse.servico.municipioPrestacaoServico=e.ibgeCod,this.opcoesCidadeIbge.push({valor:e.ibgeCod,rotulo:e.cidadeUf})}this.opcoesInformacoesServicos=e==null?void 0:e.nfseItensListaDeServico;const c=(l=$utils.clonarV2(d))!=null?l:{};let r={};delete c.rps,this.documentoFiscalEletronico=$utils.clonarV2(c),c.id&&(r=(await $db.hibrido.lista({table:"documentoFiscalEletronicoXml",where:{idDocumentoFiscalEletronico:c.id}}))[0]),this.documentoFiscalEletronico.id||(this.documentoFiscalEletronico.id=$utils.uuid()),this.documentoFiscalEletronicoOriginal=$utils.clonarV2(c),this.documentoFiscalEletronicoXmlOriginal=$utils.clonarV2(r),this.nfseOriginal=$utils.clonarV2(this.nfse),this.showModal=!0},async emitir(){var m,t,o,d,a,c;if(!await this.$refs.nfseForm.validate())return;let e;this.situacaoNfse==="Rascunho"&&(e="Enviando..."),this.situacaoNfse==="Protocolada"&&(e="Checando...");try{$q.loading.show({message:`${e}`,html:!0,boxClass:"bg-grey-2 text-grey-9",spinnerColor:"primary"}),this.nfse.dataEmissao=$utils.dataAtual();let r={...this.nfse,id:(m=this.documentoFiscalEletronico)==null?void 0:m.id};const{nfse:n,situacao:V}=await $db.nfse.emitir({nfse:r,aguardarRetorno:!0});if(this.nfse=n,this.situacaoNfse=(t=n.error)!=null&&t.message?"Rascunho":V,V==="Enviada"&&(await this.salvar(async v=>{$q.loading.show({message:"Solicitando URL...",html:!0,boxClass:"bg-grey-2 text-grey-9",spinnerColor:"primary"}),await $db.nfse.solicitarURLImpressao(v)}),$q.notifyPositive("NFS-e emitida!")),V!=="Enviada"){const v=Object.values((a=(d=(o=n.error)==null?void 0:o.data)==null?void 0:d.fields)!=null?a:{});if(v.length>0)for(const l of v)$q.notifyError(l);else(c=n.error)!=null&&c.message?$q.notifyError(n.error.message):(typeof n.mensagemDeRetorno=="string"&&$q.notifyError(n.mensagemDeRetorno),typeof n.mensagemDeRetorno!="string"&&$q.notifyError("Erro de valida\xE7\xE3o"));await this.salvar()}}catch(r){let n=r.message.replace("db.nfse.sincronizarLote: ","");n.length!==r.message&&$q.notifyError(n),n.length===r.message&&($q.notifyError("Falha ao emitir NFS-e"),console.error(r.message)),console.log(this.nfse)}finally{$q.loading.hide()}},async salvar(u){if(!await this.$refs.nfseForm.validate())return;const m=this.documentoFiscalEletronico.id||$utils.uuid(),t=this.documentoFiscalEletronicoOriginal.dataHoraCriacao||$utils.dataAtual(),o={id:m,tipo:"NFSe",tpAmb:"2",situacao:this.situacaoNfse,mod:"",serie:"",nNF:"",chNFe:"",vNF:0,dhEmi:L.formatarDataNFe(new Date(this.nfse.dataEmissao)),cpfCnpjEmitente:this.nfse.prestador.documento,xNomeEmitente:this.nfse.prestador.razaoSocial,cpfCnpjDestinatario:this.nfse.tomador.documento,xNomeDestinatario:this.nfse.tomador.razaoSocial,dataHoraEmissao:this.nfse.dataEmissao,dataHoraCriacao:t,protocoloRetorno:this.nfse.protocoloRetorno,xml:this.nfse.xml,pdf:this.nfse.pdf,json:JSON.stringify({rps:this.nfse})},d={id:this.documentoFiscalEletronicoXmlOriginal.id||$utils.uuid(),tipo:o.tipo,situacao:o.situacao,tpAmb:o.tpAmb,dataHoraEnvio:this.nfse.dataEmissao,cpfCnpjEmitente:this.nfse.prestador.documento,xmlEnvio:this.nfse.xml,idDocumentoFiscalEletronico:o.id};try{await $db.documentoFiscalEletronico.grava({atual:o,original:this.documentoFiscalEletronicoOriginal}),await $db.documentoFiscalEletronicoXml.grava({atual:d,original:this.documentoFiscalEletronicoXmlOriginal}),u&&await u(o.id),this.hide(),this.$emit("atualizar",{id:m})}catch(a){$q.notifyError(a.message)}},voltar(u){u.stopPropagation();let e=$utils.diferencaObjetos(this.nfseOriginal,this.nfse);if(!Object.keys(e).length){this.hide();return}$q.dialog({message:"Deseja descartar as modifica\xE7\xF5es?",title:"Descartar",cancel:{label:"Cancelar",push:!0,color:"tertiary",flat:!0},ok:{label:"Descartar",push:!0,class:"bg-negative",textColor:"white",flat:!0}}).onOk(()=>{this.hide()})},hide(){this.showModal=!1},setarValorLiquidoNfse(){const{valorServicos:u,valorPis:e,valorCofins:m,valorInss:t,valorIr:o,valorCsll:d,descontoIncondicionado:a,descontoCondicionado:c}=this.nfse.servico.valores,r=u-e-m-t-o-d-a-c;this.nfse.servico.valores.valorLiquidoNfse=r},async mostrarJsonViewer(){await this.$refs.jsonViewer.show(this)}},beforeMount(){this.opcoesNatureza=h.opcoesNatureza,this.opcoesTipoRps=h.opcoesTipoRps,this.opcoesRegimeEspecialTributacao=h.opcoesRegimeEspecialTributacao,this.opcoesStatusRps=h.opcoesStatusRps,this.opcoesSimNao=h.opcoesSimNao,this.telefoneTipos=h.telefoneTipos,this.opcoesUF=h.opcoesUF},watch:{"nfse.servico.valores.valorServicos":function(){const{valorServicos:u,descontoIncondicionado:e}=this.nfse.servico.valores;this.nfse.servico.valores.baseCalculo=u-e,this.setarValorLiquidoNfse()},"nfse.servico.valores.descontoIncondicionado":function(){const{valorServicos:u,descontoIncondicionado:e}=this.nfse.servico.valores;this.nfse.servico.valores.baseCalculo=u-e,this.setarValorLiquidoNfse()},"nfse.servico.valores.descontoCondicionado":function(){this.setarValorLiquidoNfse()},"nfse.servico.valores.valorPis":function(){this.setarValorLiquidoNfse()},"nfse.servico.valores.valorCofins":function(){this.setarValorLiquidoNfse()},"nfse.servico.valores.valorInss":function(){this.setarValorLiquidoNfse()},"nfse.servico.valores.valorIr":function(){this.setarValorLiquidoNfse()},"nfse.servico.valores.valorCsll":function(){this.setarValorLiquidoNfse()},"nfse.servico.valores.baseCalculo":async function(){const{baseCalculo:u,aliquota:e}=this.nfse.servico.valores,m=$utils.arredondar(u*(e/100),3);let t=String(this.nfse.servico.municipioPrestacaoServico)!=="3543402";if(!t){const o=await $db.configuracoes.leValorComFiltroEmpresa("nfse.motor");t=(o==null?void 0:o.toLowerCase())==="plugnotas"}t||(this.nfse.servico.valores.valorIss=$utils.arredondaAbnt5891(m)),t&&(this.nfse.servico.valores.valorIss=parseFloat(m.toFixed(2)))},"nfse.servico.valores.aliquota":async function(){const{baseCalculo:u,aliquota:e}=this.nfse.servico.valores,m=$utils.arredondar(u*(e/100),3);let t=String(this.nfse.servico.municipioPrestacaoServico)!=="3543402";if(!t){const o=await $db.configuracoes.leValorComFiltroEmpresa("nfse.motor");t=(o==null?void 0:o.toLowerCase())==="plugnotas"}t||(this.nfse.servico.valores.valorIss=$utils.arredondaAbnt5891(m)),t&&(this.nfse.servico.valores.valorIss=parseFloat(m.toFixed(2)))}}},Y={id:"NFSe"},Z={class:"q-ml-md"};function _(u,e,m,t,o,d){const a=R("g-col"),c=R("g-label"),r=R("campo"),n=R("g-row"),V=R("badge"),v=R("JsonViewer");return b(),D("div",Y,[s(G,{modelValue:o.showModal,"onUpdate:modelValue":e[48]||(e[48]=l=>o.showModal=l),onKeyup:K(d.voltar,["esc"]),onHide:d.onHide,maximized:"",persistent:""},{default:i(()=>[s(T,{container:"",view:"hHh LpR fFf",class:"bg-light"},{default:i(()=>[s(k,null,{default:i(()=>[s(w,{class:"q-px-sm"},{default:i(()=>[s(E,{onClick:d.voltar,icon:"arrow_back",dense:"",flat:"",round:""},null,8,["onClick"]),s(I,null,{default:i(()=>e[49]||(e[49]=[f("NFS-e")])),_:1}),o.situacaoNfse==="Rascunho"?(b(),C(E,{key:0,onClick:e[0]||(e[0]=l=>d.salvar()),label:"Salvar",color:"white","text-color":"primary",unelevated:"",class:"q-mr-sm"})):S("",!0),u.$db.usuario.desenvolvedor()?(b(),C(E,{key:1,icon:"more_vert",round:"",flat:""},{default:i(()=>[s(z,null,{default:i(()=>[M((b(),C(A,{onClick:e[1]||(e[1]=l=>d.mostrarJsonViewer()),clickable:""},{default:i(()=>[s(F,{avatar:""},{default:i(()=>[s(Q,{name:"mdi-file-replace",size:"sm"})]),_:1}),s(F,null,{default:i(()=>e[50]||(e[50]=[f("Ver Objeto")])),_:1})]),_:1})),[[j]])]),_:1})]),_:1})):S("",!0)]),_:1})]),_:1}),s(H,null,{default:i(()=>[s(P,{class:"u-container"},{default:i(()=>[s(J,{ref:"nfseForm",class:"q-py-lg"},{default:i(()=>[s(n,{gutter:"md"},{default:i(()=>[o.nfse.mensagemDeRetorno?(b(),C(a,{key:0,col:"12",bg:"bg-white",mg:"md-b","rounded-borders":""},{default:i(()=>[s(B,{class:"bg-red-5 text-white text-center text-weight-medium"},{default:i(()=>[f(U(o.nfse.mensagemDeRetorno),1)]),_:1})]),_:1})):S("",!0),s(a,{col:"12",bg:"bg-white",mg:"lg-b","rounded-borders":""},{default:i(()=>[s(c,{text:"body1 medium",class:"q-pa-sm"},{default:i(()=>e[51]||(e[51]=[f("Informa\xE7\xF5es da Nota Fiscal Eletr\xF4nica")])),_:1}),s(n,{gutter:"sm"},{default:i(()=>[s(a,{col:"12 md2"},{default:i(()=>[s(N,{label:"N\xFAmero do Lote",modelValue:o.nfse.numeroLote,"onUpdate:modelValue":e[2]||(e[2]=l=>o.nfse.numeroLote=l),readonly:"",dense:""},null,8,["modelValue"])]),_:1}),s(a,{col:"12 md2"},{default:i(()=>[s(N,{label:"N\xFAmero do RPS",modelValue:o.nfse.identificacaoRps.numero,"onUpdate:modelValue":[e[3]||(e[3]=l=>o.nfse.identificacaoRps.numero=l),e[4]||(e[4]=()=>{o.nfse.numeroLote=o.nfse.identificacaoRps.numero})],readonly:o.situacaoNfse!=="Rascunho",rules:[l=>!!l||"Campo Obrigat\xF3rio"],mask:"#","reverse-fill-mask":"",dense:""},null,8,["modelValue","readonly","rules"])]),_:1}),s(a,{col:"12 md1"},{default:i(()=>[s(N,{label:"Serie do RPS",modelValue:o.nfse.identificacaoRps.serie,"onUpdate:modelValue":e[5]||(e[5]=l=>o.nfse.identificacaoRps.serie=l),readonly:o.situacaoNfse!=="Rascunho",rules:[l=>!!l||"Campo Obrigat\xF3rio"],mask:"#","reverse-fill-mask":"",dense:""},null,8,["modelValue","readonly","rules"])]),_:1}),s(a,{col:"12 md1"},{default:i(()=>[s(g,{modelValue:o.nfse.identificacaoRps.tipo,"onUpdate:modelValue":e[6]||(e[6]=l=>o.nfse.identificacaoRps.tipo=l),options:o.opcoesTipoRps,label:"Tipo RPS",readonly:o.situacaoNfse!=="Rascunho",rules:[l=>!!l||"Campo Obrigat\xF3rio"],"emit-value":"","map-options":"",dense:""},null,8,["modelValue","options","readonly","rules"])]),_:1}),s(a,{col:"12 md3"},{default:i(()=>[s(r,{rotulo:"Data de emiss\xE3o NFS-e",tipo:"dataHora",modelValue:o.nfse.dataEmissao,"onUpdate:modelValue":e[7]||(e[7]=l=>o.nfse.dataEmissao=l),"somente-leitura":""},null,8,["modelValue"])]),_:1}),s(a,{col:"12 md3"},{default:i(()=>[s(r,{rotulo:"Data de cria\xE7\xE3o RPS",tipo:"dataHora",modelValue:o.nfse.dataHoraCriacao,"onUpdate:modelValue":e[8]||(e[8]=l=>o.nfse.dataHoraCriacao=l),"somente-leitura":""},null,8,["modelValue"])]),_:1})]),_:1}),s(n,{gutter:"sm"},{default:i(()=>[s(a,{col:"12 md6"},{default:i(()=>[s(g,{modelValue:o.nfse.naturezaOperacao,"onUpdate:modelValue":e[9]||(e[9]=l=>o.nfse.naturezaOperacao=l),options:o.opcoesNatureza,readonly:o.situacaoNfse!=="Rascunho",rules:[l=>!!l||"Campo Obrigat\xF3rio"],label:"Natureza da Opera\xE7\xE3o","emit-value":"","map-options":"",dense:""},null,8,["modelValue","options","readonly","rules"])]),_:1}),s(a,{col:"12 md6"},{default:i(()=>[s(g,{modelValue:o.nfse.regimeEspecialTributacao,"onUpdate:modelValue":e[10]||(e[10]=l=>o.nfse.regimeEspecialTributacao=l),options:o.opcoesRegimeEspecialTributacao,readonly:o.situacaoNfse!=="Rascunho",rules:[l=>!!l||"Campo Obrigat\xF3rio"],label:"Regime Especial Tributa\xE7\xE3o","emit-value":"","map-options":"",dense:""},null,8,["modelValue","options","readonly","rules"])]),_:1})]),_:1}),s(n,{gutter:"sm"},{default:i(()=>[s(a,{col:"12 md4"},{default:i(()=>[s(g,{modelValue:o.nfse.status,"onUpdate:modelValue":e[11]||(e[11]=l=>o.nfse.status=l),options:o.opcoesStatusRps,readonly:"","emit-value":"",rules:[l=>!!l||"Campo Obrigat\xF3rio"],label:"Status","map-options":"",dense:""},null,8,["modelValue","options","rules"])]),_:1}),s(a,{col:"12 md4"},{default:i(()=>[s(g,{modelValue:o.nfse.optanteSimplesNacional,"onUpdate:modelValue":e[12]||(e[12]=l=>o.nfse.optanteSimplesNacional=l),options:o.opcoesSimNao,"map-options":"",readonly:o.situacaoNfse!=="Rascunho",rules:[l=>!!l||"Campo Obrigat\xF3rio"],label:"Optante Simples Nacional","emit-value":"",dense:""},null,8,["modelValue","options","readonly","rules"])]),_:1}),s(a,{col:"12 md4"},{default:i(()=>[s(g,{modelValue:o.nfse.incentivadorCultural,"onUpdate:modelValue":e[13]||(e[13]=l=>o.nfse.incentivadorCultural=l),options:o.opcoesSimNao,"emit-value":"",readonly:o.situacaoNfse!=="Rascunho",rules:[l=>!!l||"Campo Obrigat\xF3rio"],label:"Incentivador Cultural","map-options":"",dense:""},null,8,["modelValue","options","readonly","rules"])]),_:1})]),_:1})]),_:1}),s(a,{col:"12",bg:"bg-white",mg:"lg-b","rounded-borders":""},{default:i(()=>[s(c,{text:"body1 medium",class:"q-pa-sm"},{default:i(()=>e[52]||(e[52]=[f("RPS Substitu\xEDdo")])),_:1}),s(n,{gutter:"sm"},{default:i(()=>[s(a,{col:"6"},{default:i(()=>[s(r,{modelValue:o.nfse.numeroRPSSubstituido,"onUpdate:modelValue":e[14]||(e[14]=l=>o.nfse.numeroRPSSubstituido=l),rotulo:"N\xFAmero do RPS","somente-leitura":o.situacaoNfse!=="Rascunho"},null,8,["modelValue","somente-leitura"])]),_:1}),s(a,{col:"6"},{default:i(()=>[s(r,{modelValue:o.nfse.protocoloRetorno,"onUpdate:modelValue":e[15]||(e[15]=l=>o.nfse.protocoloRetorno=l),rotulo:"Protocolo de retorno","somente-leitura":o.situacaoNfse!=="Rascunho"},null,8,["modelValue","somente-leitura"])]),_:1})]),_:1})]),_:1}),s(a,{col:"12",bg:"bg-white",mg:"lg-b","rounded-borders":""},{default:i(()=>[s(c,{text:"body1 medium",class:"q-pa-sm"},{default:i(()=>e[53]||(e[53]=[f("Prestador")])),_:1}),s(n,{gutter:"sm"},{default:i(()=>[s(a,{col:"12 md6"},{default:i(()=>[s(r,{modelValue:o.nfse.prestador.documento,"onUpdate:modelValue":e[16]||(e[16]=l=>o.nfse.prestador.documento=l),"somente-leitura":"",rules:[l=>!!l||"Campo Obrigat\xF3rio"],rotulo:"CNPJ"},null,8,["modelValue","rules"])]),_:1}),s(a,{col:"12 md6"},{default:i(()=>[s(r,{modelValue:o.nfse.prestador.inscricaoMunicipal,"onUpdate:modelValue":e[17]||(e[17]=l=>o.nfse.prestador.inscricaoMunicipal=l),"somente-leitura":"",rules:[l=>!!l||"Campo Obrigat\xF3rio"],rotulo:"Inscri\xE7\xE3o Municipal"},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1}),s(a,{col:"12",bg:"bg-white",mg:"lg-b","rounded-borders":""},{default:i(()=>[s(c,{text:"body1 medium",class:"q-pa-sm"},{default:i(()=>e[54]||(e[54]=[f("Tomador")])),_:1}),s(n,{gutter:"sm"},{default:i(()=>[s(a,{col:"12"},{default:i(()=>[s(r,{modelValue:o.nfse.tomador.razaoSocial,"onUpdate:modelValue":e[18]||(e[18]=l=>o.nfse.tomador.razaoSocial=l),rotulo:"Selecione o Tomador",before:[{icon:"search",handler:d.abrirModalTomador}],"somente-leitura":""},null,8,["modelValue","before"])]),_:1})]),_:1}),s(n,{gutter:"sm"},{default:i(()=>[s(a,{col:"12 md6"},{default:i(()=>[s(r,{modelValue:o.nfse.tomador.razaoSocial,"onUpdate:modelValue":e[19]||(e[19]=l=>o.nfse.tomador.razaoSocial=l),rotulo:"Nome/Raz\xE3o Social","somente-leitura":o.situacaoNfse!=="Rascunho"},null,8,["modelValue","somente-leitura"])]),_:1}),s(a,{col:"12 md6"},{default:i(()=>[s(r,{modelValue:o.nfse.tomador.documento,"onUpdate:modelValue":e[20]||(e[20]=l=>o.nfse.tomador.documento=l),"somente-leitura":"",rotulo:"CNPJ/CPF"},null,8,["modelValue"])]),_:1})]),_:1}),s(n,{gutter:"sm"},{default:i(()=>[s(a,{col:"12 md6"},{default:i(()=>[s(N,{modelValue:o.nfse.tomador.endereco.cep,"onUpdate:modelValue":e[21]||(e[21]=l=>o.nfse.tomador.endereco.cep=l),mask:"#####-###",readonly:o.situacaoNfse!=="Rascunho",dense:"",label:"CEP"},null,8,["modelValue","readonly"])]),_:1}),s(a,{col:"12 md6"},{default:i(()=>[s(r,{modelValue:o.nfse.tomador.endereco.rua,"onUpdate:modelValue":e[22]||(e[22]=l=>o.nfse.tomador.endereco.rua=l),rotulo:"Rua","somente-leitura":o.situacaoNfse!=="Rascunho"},null,8,["modelValue","somente-leitura"])]),_:1}),s(a,{col:"12 md6"},{default:i(()=>[s(r,{modelValue:o.nfse.tomador.endereco.numero,"onUpdate:modelValue":e[23]||(e[23]=l=>o.nfse.tomador.endereco.numero=l),rotulo:"Numero","somente-leitura":o.situacaoNfse!=="Rascunho"},null,8,["modelValue","somente-leitura"])]),_:1}),s(a,{col:"12 md6"},{default:i(()=>[s(r,{modelValue:o.nfse.tomador.endereco.bairro,"onUpdate:modelValue":e[24]||(e[24]=l=>o.nfse.tomador.endereco.bairro=l),rotulo:"Bairro","somente-leitura":o.situacaoNfse!=="Rascunho"},null,8,["modelValue","somente-leitura"])]),_:1}),s(a,{col:"12 md6"},{default:i(()=>[s(N,{modelValue:o.nfse.tomador.endereco.cidade,"onUpdate:modelValue":e[25]||(e[25]=l=>o.nfse.tomador.endereco.cidade=l),"reverse-fill-mask":"",dense:"",mask:"#",readonly:o.situacaoNfse!=="Rascunho",label:"Cidade (C\xF3digo Municipal)"},null,8,["modelValue","readonly"])]),_:1}),s(a,{col:"12 md6"},{default:i(()=>[s(g,{modelValue:o.nfse.tomador.endereco.estado,"onUpdate:modelValue":e[26]||(e[26]=l=>o.nfse.tomador.endereco.estado=l),options:o.opcoesUF,readonly:o.situacaoNfse!=="Rascunho",dense:"",label:"UF"},null,8,["modelValue","options","readonly"])]),_:1})]),_:1})]),_:1}),s(a,{col:"12",bg:"bg-white",mg:"lg-b","rounded-borders":""},{default:i(()=>[s(c,{text:"body1 medium",class:"q-pa-sm"},{default:i(()=>e[55]||(e[55]=[f("Constru\xE7\xE3o Civil")])),_:1}),s(n,{gutter:"sm"},{default:i(()=>[s(a,{col:"12 md6"},{default:i(()=>[s(r,{modelValue:o.nfse.codigoObra,"onUpdate:modelValue":e[27]||(e[27]=l=>o.nfse.codigoObra=l),rotulo:"C\xF3digo de Obra","somente-leitura":o.situacaoNfse!=="Rascunho"},null,8,["modelValue","somente-leitura"])]),_:1}),s(a,{col:"12 md6"},{default:i(()=>[s(r,{modelValue:o.nfse.codigoART,"onUpdate:modelValue":e[28]||(e[28]=l=>o.nfse.codigoART=l),rotulo:"C\xF3digo ART","somente-leitura":o.situacaoNfse!=="Rascunho"},null,8,["modelValue","somente-leitura"])]),_:1})]),_:1})]),_:1}),s(a,{col:"12",bg:"bg-white",mg:"lg-b","rounded-borders":""},{default:i(()=>[s(c,{text:"body1 medium",class:"q-pa-sm"},{default:i(()=>e[56]||(e[56]=[f("Discrimina\xE7\xE3o dos Servi\xE7os")])),_:1}),s(n,{gutter:"sm"},{default:i(()=>[s(a,{col:"12"},{default:i(()=>[s(r,{modelValue:o.nfse.servico.discriminacao,"onUpdate:modelValue":e[29]||(e[29]=l=>o.nfse.servico.discriminacao=l),"somente-leitura":o.situacaoNfse!=="Rascunho",rows:"2",rules:[l=>!!l||"Campo Obrigat\xF3rio"],tipo:"textoArea",rotulo:"Discrimina\xE7\xE3o dos Servi\xE7os"},null,8,["modelValue","somente-leitura","rules"])]),_:1})]),_:1})]),_:1}),s(a,{col:"12",bg:"bg-white",mg:"lg-b","rounded-borders":""},{default:i(()=>[s(c,{text:"body1 medium",class:"q-pa-sm"},{default:i(()=>e[57]||(e[57]=[f("Informa\xE7\xF5es de servi\xE7os")])),_:1}),s(n,{gutter:"sm"},{default:i(()=>[s(a,{class:"col-12 col-md-4"},{default:i(()=>[s(g,{modelValue:o.nfse.servico.itemListaServico,options:o.opcoesInformacoesServicos,label:"Servi\xE7os","option-value":l=>l.codigo,"option-label":l=>l?l.descricao:"","emit-value":"","map-options":"",dense:"",readonly:o.situacaoNfse!=="Rascunho","onUpdate:modelValue":d.trocouServico},null,8,["modelValue","options","option-value","option-label","readonly","onUpdate:modelValue"])]),_:1}),s(a,{class:"col-12 col-md-2"},{default:i(()=>[s(N,{modelValue:o.nfse.servico.itemListaServico,"onUpdate:modelValue":e[30]||(e[30]=l=>o.nfse.servico.itemListaServico=l),rules:[l=>!!l||"Campo Obrigat\xF3rio"],label:"C\xF3digo de Item da Lista de Servi\xE7o",readonly:"",dense:""},null,8,["modelValue","rules"])]),_:1}),s(a,{class:"col-12 col-md-2"},{default:i(()=>[s(N,{modelValue:o.nfse.servico.codigoCnae,"onUpdate:modelValue":e[31]||(e[31]=l=>o.nfse.servico.codigoCnae=l),label:"C\xF3digo CNAE",rules:[l=>!!l||"Campo Obrigat\xF3rio"],dense:"",readonly:""},null,8,["modelValue","rules"])]),_:1}),s(a,{class:"col-12 col-md-2"},{default:i(()=>[s(N,{modelValue:o.nfse.servico.codigoTributacaoMunicipio,"onUpdate:modelValue":e[32]||(e[32]=l=>o.nfse.servico.codigoTributacaoMunicipio=l),readonly:"",dense:"",rules:[l=>!!l||"Campo Obrigat\xF3rio"],label:"C\xF3digo de Tributa\xE7\xE3o"},null,8,["modelValue","rules"])]),_:1}),s(a,{class:"col-12 col-md-2"},{default:i(()=>[q("div",{class:"col",onClick:e[34]||(e[34]=(...l)=>u.carregarEquipamentos&&u.carregarEquipamentos(...l))},[s(r,{modelValue:o.nfse.servico.municipioPrestacaoServico,"onUpdate:modelValue":e[33]||(e[33]=l=>o.nfse.servico.municipioPrestacaoServico=l),tipo:"seletor",opcoes:o.opcoesCidadeIbge,rotulo:"C\xF3digo Munic\xEDpio IBGE"},null,8,["modelValue","opcoes"])])]),_:1})]),_:1})]),_:1}),s(a,{col:"12",bg:"bg-white","rounded-borders":""},{default:i(()=>[s(c,{text:"body1 medium",class:"q-pa-sm"},{default:i(()=>e[58]||(e[58]=[f("Valores")])),_:1}),s(n,{gutter:"sm"},{default:i(()=>[s(a,{col:"12 sm6 md3"},{default:i(()=>[s(g,{modelValue:o.nfse.servico.valores.issRetido,"onUpdate:modelValue":e[35]||(e[35]=l=>o.nfse.servico.valores.issRetido=l),options:o.opcoesSimNao,readonly:o.situacaoNfse!=="Rascunho",rules:[l=>!!l||"Campo Obrigat\xF3rio"],label:"ISS Retido","map-options":"",dense:"","emit-value":""},null,8,["modelValue","options","readonly","rules"])]),_:1}),s(a,{col:"12 sm6 md3"},{default:i(()=>[s(r,{modelValue:o.nfse.servico.valores.valorServicos,"onUpdate:modelValue":e[36]||(e[36]=l=>o.nfse.servico.valores.valorServicos=l),decimals:"4",value:"0",prefix:"R$","somente-leitura":o.situacaoNfse!=="Rascunho",rotulo:"Valor dos Servi\xE7os",tipo:"decimal"},null,8,["modelValue","somente-leitura"])]),_:1}),s(a,{col:"12 sm6 md3"},{default:i(()=>[s(r,{modelValue:o.nfse.servico.valores.valorPis,"onUpdate:modelValue":e[37]||(e[37]=l=>o.nfse.servico.valores.valorPis=l),value:"0",prefix:"R$",decimals:"2","somente-leitura":o.situacaoNfse!=="Rascunho",rotulo:"Valor PIS",tipo:"decimal"},null,8,["modelValue","somente-leitura"])]),_:1}),s(a,{col:"12 sm6 md3"},{default:i(()=>[s(r,{modelValue:o.nfse.servico.valores.valorCofins,"onUpdate:modelValue":e[38]||(e[38]=l=>o.nfse.servico.valores.valorCofins=l),value:"0",prefix:"R$",tipo:"decimal","somente-leitura":o.situacaoNfse!=="Rascunho",rotulo:"Valor COFINS",decimals:"2"},null,8,["modelValue","somente-leitura"])]),_:1}),s(a,{col:"12 sm6 md3"},{default:i(()=>[s(r,{modelValue:o.nfse.servico.valores.valorInss,"onUpdate:modelValue":e[39]||(e[39]=l=>o.nfse.servico.valores.valorInss=l),value:"0",prefix:"R$",decimals:"2","somente-leitura":o.situacaoNfse!=="Rascunho",tipo:"decimal",rotulo:"Valor INSS"},null,8,["modelValue","somente-leitura"])]),_:1}),s(a,{col:"12 sm6 md3"},{default:i(()=>[s(r,{modelValue:o.nfse.servico.valores.valorIr,"onUpdate:modelValue":e[40]||(e[40]=l=>o.nfse.servico.valores.valorIr=l),value:"0",prefix:"R$",decimals:"2","somente-leitura":o.situacaoNfse!=="Rascunho",rotulo:"Valor IR",tipo:"decimal"},null,8,["modelValue","somente-leitura"])]),_:1}),s(a,{col:"12 sm6 md3"},{default:i(()=>[s(r,{modelValue:o.nfse.servico.valores.valorCsll,"onUpdate:modelValue":e[41]||(e[41]=l=>o.nfse.servico.valores.valorCsll=l),value:"0",prefix:"R$",decimals:"2","somente-leitura":o.situacaoNfse!=="Rascunho",rotulo:"Valor CSLL",tipo:"decimal"},null,8,["modelValue","somente-leitura"])]),_:1}),s(a,{col:"12 sm6 md3"},{default:i(()=>[s(r,{modelValue:o.nfse.servico.valores.valorIss,"onUpdate:modelValue":e[42]||(e[42]=l=>o.nfse.servico.valores.valorIss=l),value:"0",prefix:"R$",decimals:"2",rotulo:"Valor ISS",tipo:"decimal","somente-leitura":""},null,8,["modelValue"])]),_:1}),s(a,{col:"12 sm6 md3"},{default:i(()=>[s(r,{modelValue:o.nfse.servico.valores.baseCalculo,"onUpdate:modelValue":e[43]||(e[43]=l=>o.nfse.servico.valores.baseCalculo=l),value:"0",prefix:"R$",decimals:"2",tipo:"decimal",rotulo:"Base Calculo","somente-leitura":""},null,8,["modelValue"])]),_:1}),s(a,{col:"12 sm6 md3"},{default:i(()=>[s(r,{modelValue:o.nfse.servico.valores.aliquota,"onUpdate:modelValue":e[44]||(e[44]=l=>o.nfse.servico.valores.aliquota=l),rotulo:"Aliquota",value:"2","somente-leitura":o.situacaoNfse!=="Rascunho",suffix:"%",decimals:"2",tipo:"decimal"},null,8,["modelValue","somente-leitura"])]),_:1}),s(a,{col:"12 sm6 md3"},{default:i(()=>[s(r,{modelValue:o.nfse.servico.valores.valorLiquidoNfse,"onUpdate:modelValue":e[45]||(e[45]=l=>o.nfse.servico.valores.valorLiquidoNfse=l),value:"0",prefix:"R$",decimals:"2",tipo:"decimal","somente-leitura":"",rotulo:"Valor Liquido Nfse"},null,8,["modelValue"])]),_:1}),s(a,{col:"12 sm6 md3"},{default:i(()=>[s(r,{modelValue:o.nfse.servico.valores.descontoCondicionado,"onUpdate:modelValue":e[46]||(e[46]=l=>o.nfse.servico.valores.descontoCondicionado=l),value:"0",tipo:"decimal",decimals:"2","somente-leitura":o.situacaoNfse!=="Rascunho",prefix:"R$",rotulo:"Desconto Condicionado"},null,8,["modelValue","somente-leitura"])]),_:1}),s(a,{col:"12 sm6 md3"},{default:i(()=>[s(r,{modelValue:o.nfse.servico.valores.descontoIncondicionado,"onUpdate:modelValue":e[47]||(e[47]=l=>o.nfse.servico.valores.descontoIncondicionado=l),rotulo:"Desconto Incondicionado","somente-leitura":o.situacaoNfse!=="Rascunho",value:"0",prefix:"R$",decimals:"2",tipo:"decimal"},null,8,["modelValue","somente-leitura"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1}),s(X,{class:"bg-white shadow-1",bordered:""},{default:i(()=>[s(w,{class:"u-container"},{default:i(()=>[s(I,{class:"text-tertiary text-weight-regular",style:{"font-size":"16px",display:"flex","align-items":"center"}},{default:i(()=>{var l,p,y;return[e[59]||(e[59]=f(" TOTAL ")),q("span",Z," R$ "+U(u.$filters.numero((y=(p=(l=o.nfse.servico)==null?void 0:l.valores)==null?void 0:p.valorServicos)!=null?y:0,2)),1),o.situacaoNfse?(b(),C(V,{key:0,rotulo:o.situacaoNfse,escuro:"",cor:"tertiary",class:"q-ml-md"},null,8,["rotulo"])):S("",!0)]}),_:1}),~["Rascunho"].indexOf(o.situacaoNfse)?(b(),C(E,{key:0,onClick:d.emitir,label:"Emitir",color:"primary",unelevated:"",class:"q-ml-sm"},null,8,["onClick"])):S("",!0),~["Protocolada"].indexOf(o.situacaoNfse)?(b(),C(E,{key:1,onClick:d.emitir,label:"Checar envio",color:"primary",unelevated:"",class:"q-ml-sm"},null,8,["onClick"])):S("",!0)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onKeyup","onHide"]),s(v,{ref:"jsonViewer"},null,512)])}var se=O(W,[["render",_]]);export{se as N};
