import{_ as Ce,ax as le,aX as Ee,bO as ye,bl as _e,o as n,d as c,w as t,f as e,M as qe,C as y,at as xe,G as Ve,h as fe,i as Be,j as k,k as r,H as $,Q as O,N as se,J as Pe,I as De,S as h,T as s,U as f,t as u,e as v,P as X,cI as ze,p as x,F as I,x as S,aZ as Ie,m as Q,X as me,aN as ue,l as ie,as as Ne,cJ as Te,aP as Se,K as Re,aU as He,D as Ae,aw as U,cK as Qe,b2 as Me,r as Y,cL as de,be as re,b3 as we,A as Le,bI as Ue,q as Fe}from"./index.343e05cd.js";import{e as Oe}from"./emitirNFe.35117289.js";import{n as je}from"./nfePrincipal.0e880fea.js";import{F as Ge}from"./FaturaModal.bd38b93e.js";import{D as Je}from"./DocumentosFiscais.4098253e.js";import{M as Ke}from"./ModalHistoricoStatus.24bca540.js";const We={computed:{visivel:{get(){return this.modelValue},async set(i){this.$emit("update:modelValue",i)}},ativarBotaoEmissaoBoleto(){var a,F,p,o;const i=Number((F=(a=this.boletos)==null?void 0:a.financeiroBanco)==null?void 0:F.value);return Number.isInteger(i)&&i&&((o=(p=this.boletos)==null?void 0:p.condicoesPagamento)==null?void 0:o.find(g=>g.checked))}},data(){return{boletos:{codigoFinanceiroBanco:"",condicoesPagamento:[],bancos:[],emitidos:!1,emitir:!1,loading:!1,cancelarAtualizarBoletos:!1}}},emits:["update:modelValue"],methods:{async atualizar(){var i,a,F,p,o;try{if((i=this.fatura)!=null&&i.id){this.boletos={codigoFinanceiroBanco:"",condicoesPagamento:[],bancos:[],emitidos:!1,emitir:!1,loading:!1,cancelarAtualizarBoletos:!1};const g=[],E=await le().formaPagamento.toArray(),D=await le().empresa.where({idContato:(a=this.fatura)==null?void 0:a.idEmpresa}).toArray();if(await(await $db.hibrido.lista({table:"documentoCondicaoPagamento",where:{idDocumento:(F=this.fatura)==null?void 0:F.id}})).forEach(C=>{const T=E.find(_=>_.id===C.idFormaPagamento&&_.tipo===99&&_.tipoFinanceiro==="T\xEDtulo em aberto");T&&g.push({dataVencimento:C.dataVencimento,descricao:T.descricao,idFinanceiroTitulo:C.idFinanceiroTitulo,codigoFinanceiroBoleto:"",checked:!1,disable:!0,valor:C.valor})}),!g.length)return;const A=[];await le().financeiroBanco.each(C=>{if(!!C.ativo){if(C.id==="7D07229E-B35E-42AA-A312-78313BE61B2F"){A.push(C);return}C.idEmpresa&&D.find(T=>T.id===C.idEmpresa)&&A.push(C)}});const j=[...new Set(A.map(C=>C.codigoBanco))],L=[];await le()._banco.each(C=>{j.find(T=>T===C.codigoBanco)&&L.push(C)}),this.boletos.condicoesPagamento=Ee.exports.orderBy(g,"dataVencimento","asc");const H=[];for(const C of A){const T=L.find(d=>d.codigoBanco===C.codigoBanco)||{};if(!T)continue;const _=(T.descricao||"").trim(),w=(C.agencia||"").trim(),V=(C.conta||"").trim();if(!T.arquivoBoleto||!_||!w||!V)continue;let l=_+" - Ag. "+w+" C/C "+V;H.push({arquivoBoleto:T.arquivoBoleto,label:l,value:C.codigoFinanceiroBanco})}H.length&&(this.boletos.financeiroBanco=H[0],this.boletos.bancos=H);const G=(await $db.hibrido.lista({table:"documentoFiscalEletronico",where:{idDocumento:(p=this.fatura)==null?void 0:p.id}})).find(C=>C.situacao==="Emitido")||null;for(const C of(o=this.boletos)==null?void 0:o.condicoesPagamento)C.checked=!1,C.disable=!0,C.codigoFinanceiroBoleto="",C.codigoFinanceiroTitulo="",C.banco={};this.boletos.docFiscal=G,this.boletos.financeiroBanco=this.boletos.bancos[0],this.$nextTick().then(async()=>{await this.atualizarBoletos()})}}catch(g){console.error("ERRO: ",g)}},async atualizarBoletos(){var i;try{let a,F,p,o;o=(i=this.boletos)==null?void 0:i.condicoesPagamento,p=o.reduce((E,D)=>E+"'"+D.idFinanceiroTitulo+"',",""),p=p.slice(0,p.length-1),a=`
            select
              fTitulo.id,
              fTitulo.codigoFinanceiroTitulo,
              fBoleto.codigoFinanceiroBoleto,
              fBoleto.dataEmissao,
              b.descricao,
              fBanco.agencia,
              fBanco.conta,
              b.arquivoBoleto
            from financeiroTitulo fTitulo
              left join financeiroBoleto fBoleto on(fBoleto.codigoFinanceiroBoleto = fTitulo.codigoFinanceiroBoleto)
              left join financeiroBanco fBanco on(fBanco.CodigoFinanceiroBanco = fBoleto.codigoFinanceiroBanco)
              left join _banco b on(b.codigoBanco = fBanco.codigoBanco)
            where fTitulo.id in (${p})
          `,this.boletos.cancelarAtualizarBoletos=!1;let g=0;do{try{F=await ye(a),g=0}catch(E){F=[],++g%3===0&&this.$q.notifyError(E.message)}for(const E of F){const D=o.find(N=>N.idFinanceiroTitulo===E.id);D&&(E.codigoFinanceiroBoleto&&(D.codigoFinanceiroBoleto=E.codigoFinanceiroBoleto,D.banco={descricao:E.descricao,dataEmissao:E.dataEmissao,agencia:E.agencia,conta:E.conta,arquivoBoleto:E.arquivoBoleto}),E.codigoFinanceiroTitulo&&(D.codigoFinanceiroTitulo=E.codigoFinanceiroTitulo,D.disable=!1))}if(F.length===o.length||this.boletos.cancelarAtualizarBoletos)break;await _e(5e3)}while(1)}catch{$q.notify({message:"N\xE3o foi poss\xEDvel atualizar os boletos.",type:"tertiary"})}},async emitirImprimirBoleto(){var E,D,N,A,j,L,H,G,C,T;this.boletos.loading=!0;let i,a,F,p={},o=[];F=(D=(E=this.boletos)==null?void 0:E.condicoesPagamento)==null?void 0:D.filter(_=>_.checked);for(const _ of F){if(_.codigoFinanceiroBoleto&&(_.banco||{}).arquivoBoleto){if(!p[_.banco.arquivoBoleto]){p[_.banco.arquivoBoleto]=[_.codigoFinanceiroBoleto];continue}p[_.banco.arquivoBoleto].push(_.codigoFinanceiroBoleto);continue}o.push(_.codigoFinanceiroTitulo)}if((o==null?void 0:o.length)&&((A=(N=this.boletos)==null?void 0:N.financeiroBanco)==null?void 0:A.value)){let _,w,V,l=0,d=0,m,B="";if(this.cancelarEmitirBoletos=!1,(j=this.boletos)!=null&&j.docFiscal&&(B=`${this.boletos.docFiscal.nNF} / S\xE9rie ${this.boletos.docFiscal.serie} | `),m=(G=((H=(L=this.boletos)==null?void 0:L.bancos)==null?void 0:H.find(q=>{var z,P;return q.value===((P=(z=this.boletos)==null?void 0:z.financeiroBanco)==null?void 0:P.value)}))||{})==null?void 0:G.arquivoBoleto,!m){this.$q.notifyError("Arquivo boleto n\xE3o encontrado");return}i=`sp_financeiro_boletoEmitir ${(T=(C=this.boletos)==null?void 0:C.financeiroBanco)==null?void 0:T.value}, '${o==null?void 0:o.join(",")}', '${B}'`;do{if(this.cancelarEmitirBoletos)break;try{a=await ye(i),l=0}catch(q){a=[],++l%3===0&&this.$q.notifyError(q.message)}if(_=(a||[])[0],w=((_||{}).Msg||"").trim(),V=((_||{}).Retorno||"").trim(),w==="Boleto Gerado com sucesso!"&&V){const q=V.substring(0,V.length-1).split(",");if(!p[m]){p[m]=q;break}for(const z of q)p[m].push(z);break}else++d%3===0&&this.$q.notifyError(w);await _e(5e3)}while(1)}let g=JSON.parse(localStorage.getItem("clienteSistema"))||{};for(const _ in p){let w;w="https://rel.storage.b15.com.br/Relatorios/"+_+".html?",w+="CodigoFinanceiroBoleto="+p[_].join(","),w+="&Banco="+g.bancoDeDados,w+="&URLServidor="+g.urlServidor,this.$imprimir("tela-de-boleto-automatico",btoa(w))}await this.atualizarBoletos(),this.boletos.loading=!1},checkboxTodos(i){var a,F,p,o,g,E,D,N,A,j,L,H,G,C,T,_,w,V,l,d;if(i==="emitidos"&&((p=(F=(a=this.boletos)==null?void 0:a.condicoesPagamento)==null?void 0:F.filter(m=>!m.disable&&m.codigoFinanceiroBoleto))==null?void 0:p.length))for(const m of(g=(o=this.boletos)==null?void 0:o.condicoesPagamento)==null?void 0:g.filter(B=>!B.disable&&B.codigoFinanceiroBoleto))m.checked=!!this.boletos.emitidos;if(i==="emitir"&&((N=(D=(E=this.boletos)==null?void 0:E.condicoesPagamento)==null?void 0:D.filter(m=>!m.disable&&!m.codigoFinanceiroBoleto))==null?void 0:N.length))for(const m of(j=(A=this.boletos)==null?void 0:A.condicoesPagamento)==null?void 0:j.filter(B=>!B.disable&&!B.codigoFinanceiroBoleto))m.checked=!!this.boletos.emitir;if(!i){if((G=(H=(L=this.boletos)==null?void 0:L.condicoesPagamento)==null?void 0:H.filter(m=>!m.disable&&m.codigoFinanceiroBoleto))!=null&&G.length){const m=(T=(C=this.boletos)==null?void 0:C.condicoesPagamento)==null?void 0:T.filter(B=>!B.disable&&B.codigoFinanceiroBoleto);this.boletos.emitidos=m.reduce((B,q)=>B&&q.checked,!0)}if((V=(w=(_=this.boletos)==null?void 0:_.condicoesPagamento)==null?void 0:w.filter(m=>!m.disable&&!m.codigoFinanceiroBoleto))!=null&&V.length){const m=(d=(l=this.boletos)==null?void 0:l.condicoesPagamento)==null?void 0:d.filter(B=>!B.disable&&!B.codigoFinanceiroBoleto);this.boletos.emitir=m.reduce((B,q)=>B&&q.checked,!0)}}},async fetchAndRenderHTMLInIframe(i){return new Promise((a,F)=>{const p=document.createElement("iframe");p.style.display="none",document.body.appendChild(p),p.onload=async()=>{try{const o=p.contentWindow.document.body.innerHTML;document.body.removeChild(p),a(o)}catch(o){F(o)}},p.onerror=()=>{F(new Error("Erro ao carregar o iframe"))},p.src=i})},async enviarBoletoEmailAutomatico(i,a,F){try{const{showLoading:p,successMsg:o,errorMsg:g}={},D={host:"smtp.gmail.com",port:587,ssl:!0,auth:{user:"auto@geekssolucoes.com.br",pass:"xpto@9@9"},from:a,to:F,subject:"Boleto Automatico",text:"Boleto envio automatico",attachments:[{name:"boleto.pdf",content:i,method:"url2pdf"}]},N=await axios({baseURL:"https://api.b15.com.br",method:"post",url:"/email/v2",data:D});this.$q.notifyPositive((N==null?void 0:N.status)===200&&o?o:N.data.message)}catch(p){this.$q.notifyError("Erro ao enviar o boleto",p)}}},props:{modelValue:{type:Boolean,required:!0},fatura:{type:Object,required:!0,default:()=>({})}},watch:{async visivel(i){i&&await this.atualizar()}}},Xe={class:"text-weight-medium q-px-xs"},Ze={class:"text-weight-medium q-px-xs"},Ye={class:"text-weight-bold q-pr-xs"},$e={class:"text-weight-bold q-pr-xs"},et={class:"text-weight-bold q-pr-xs"},tt={class:"text-weight-medium float-right"};function at(i,a,F,p,o,g){return n(),c(Ae,{modelValue:g.visivel,"onUpdate:modelValue":a[8]||(a[8]=E=>g.visivel=E)},{default:t(()=>[e(qe,{container:"",view:"hHh LpR fFf",class:"bg-white rounded-borders",style:{height:"100%","max-height":"500px"}},{default:t(()=>[y("form",{onSubmit:a[7]||(a[7]=xe(E=>g.emitirImprimirBoleto(),["prevent"])),class:"q-pa-sm"},[e(Ve,null,{default:t(()=>[e(fe,null,{default:t(()=>[e(Be,null,{default:t(()=>[e(k,{name:"receipt_long",size:"sm",class:"q-mr-sm"}),a[9]||(a[9]=r(" Emiss\xE3o de Boleto "))]),_:1}),$(e(O,{icon:"close",flat:"",round:"",dense:""},null,512),[[se]])]),_:1})]),_:1}),e(Pe,null,{default:t(()=>[e(De,null,{default:t(()=>{var E,D,N,A,j,L,H,G,C,T,_;return[(E=o.boletos)!=null&&E.docFiscal?(n(),c(h,{key:0,class:"q-py-none q-px-sm"},{default:t(()=>[e(s,{class:"no-margin"},{default:t(()=>[e(f,{header:""},{default:t(()=>{var w,V,l,d;return[e(k,{name:"insert_drive_file",size:"xs",class:"q-mr-xs"}),a[10]||(a[10]=r(" Nota fiscal: ")),y("span",Xe,u((V=(w=o.boletos)==null?void 0:w.docFiscal)==null?void 0:V.nNF),1),a[11]||(a[11]=r(" | S\xE9rie: ")),y("span",Ze,u((d=(l=o.boletos)==null?void 0:l.docFiscal)==null?void 0:d.serie),1)]}),_:1})]),_:1})]),_:1})):v("",!0),(A=(N=(D=o.boletos)==null?void 0:D.condicoesPagamento)==null?void 0:N.filter(w=>w.disable))!=null&&A.length?(n(),c(X,{key:1,dense:"",highlight:"",bordered:"","rounded-borders":"",class:"q-pa-none q-mx-sm q-my-lg"},{default:t(()=>{var w,V;return[e(f,{header:"",class:"text-weight-medium text-center"},{default:t(()=>[e(ze,{size:"xs",class:"q-mr-sm"}),a[12]||(a[12]=r(" Recuperando informa\xE7\xF5es do servidor... "))]),_:1}),(n(!0),x(I,null,S((V=(w=o.boletos)==null?void 0:w.condicoesPagamento)==null?void 0:V.filter(l=>l.disable),(l,d)=>$((n(),c(h,{key:d,tag:"label"},{default:t(()=>[e(s,{side:""},{default:t(()=>[l!=null&&l.disable?(n(),c(Ie,{key:0})):v("",!0)]),_:2},1024),e(s,null,{default:t(()=>[e(f,null,{default:t(()=>[r(u(l==null?void 0:l.descricao),1)]),_:2},1024)]),_:2},1024),e(s,null,{default:t(()=>[e(f,{class:"text-weight-medium text-center"},{default:t(()=>[y("span",null,[r(u(i.$filters.data(l==null?void 0:l.dataVencimento))+" ",1),e(Q,{anchor:"bottom middle",self:"center middle"},{default:t(()=>a[13]||(a[13]=[r(" Data de Vencimento ")])),_:1})])]),_:2},1024)]),_:2},1024),e(s,null,{default:t(()=>[e(f,{class:"text-weight-medium text-right"},{default:t(()=>[r(u(i.$filters.numero(l==null?void 0:l.valor,2)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)),[[me]])),128))]}),_:1})):v("",!0),(H=(L=(j=o.boletos)==null?void 0:j.condicoesPagamento)==null?void 0:L.filter(w=>!w.disable&&w.codigoFinanceiroBoleto))!=null&&H.length?(n(),c(X,{key:2,dense:"",highlight:"",bordered:"","rounded-borders":"",class:"q-pa-none q-mx-sm q-my-lg"},{default:t(()=>{var w,V;return[e(f,{header:"",class:"text-weight-medium"},{default:t(()=>[y("span",null,[e(ue,{modelValue:o.boletos.emitidos,"onUpdate:modelValue":[a[0]||(a[0]=l=>o.boletos.emitidos=l),a[1]||(a[1]=l=>g.checkboxTodos("emitidos"))]},null,8,["modelValue"]),e(Q,{anchor:"bottom middle",self:"center middle"},{default:t(()=>[r(u(o.boletos.emitidos?"Desmarcar Todos":"Marcar Todos"),1)]),_:1})]),a[14]||(a[14]=r(" Boletos Emitidos "))]),_:1}),(n(!0),x(I,null,S((V=(w=o.boletos)==null?void 0:w.condicoesPagamento)==null?void 0:V.filter(l=>!l.disable&&l.codigoFinanceiroBoleto),(l,d)=>$((n(),c(h,{key:d,tag:"label"},{default:t(()=>[e(s,{side:""},{default:t(()=>[e(ue,{modelValue:l.checked,"onUpdate:modelValue":[m=>l.checked=m,a[2]||(a[2]=m=>g.checkboxTodos())]},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(s,null,{default:t(()=>[e(f,null,{default:t(()=>[e(h,{class:"q-pa-none",style:{"min-height":"22px"}},{default:t(()=>[e(s,null,{default:t(()=>[e(f,null,{default:t(()=>[r(u(l==null?void 0:l.descricao),1)]),_:2},1024)]),_:2},1024),e(s,null,{default:t(()=>[e(f,{class:"text-weight-medium text-center"},{default:t(()=>[y("span",null,[r(u(i.$filters.data(l==null?void 0:l.dataVencimento))+" ",1),e(Q,{anchor:"bottom middle",self:"center middle"},{default:t(()=>a[15]||(a[15]=[r(" Data de Vencimento ")])),_:1})])]),_:2},1024)]),_:2},1024),e(s,null,{default:t(()=>[e(f,{class:"text-weight-medium text-right"},{default:t(()=>[r(u(i.$filters.numero(l==null?void 0:l.valor,2)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(ie,{class:"q-mx-sm"}),e(f,{caption:""},{default:t(()=>{var m,B,q,z;return[y("span",Ye,u((m=l==null?void 0:l.banco)==null?void 0:m.descricao)+",",1),a[16]||(a[16]=r(" Ag.: ")),y("span",$e,u((B=l==null?void 0:l.banco)==null?void 0:B.agencia)+",",1),a[17]||(a[17]=r(" C/C: ")),y("span",et,u((q=l==null?void 0:l.banco)==null?void 0:q.conta),1),y("span",tt,[r(u(i.$filters.data((z=l==null?void 0:l.banco)==null?void 0:z.dataEmissao))+" ",1),e(Q,{anchor:"bottom middle",self:"center middle"},{default:t(()=>{var P;return[r(" Emitido \xE1s "+u(i.$filters.hora((P=l==null?void 0:l.banco)==null?void 0:P.dataEmissao)),1)]}),_:2},1024)])]}),_:2},1024)]),_:2},1024)]),_:2},1024)),[[me]])),128))]}),_:1})):v("",!0),(T=(C=(G=o.boletos)==null?void 0:G.condicoesPagamento)==null?void 0:C.filter(w=>!w.disable&&!w.codigoFinanceiroBoleto))!=null&&T.length?(n(),c(X,{key:3,dense:"",highlight:"",bordered:"","rounded-borders":"",class:"q-pa-none q-mx-sm q-my-lg"},{default:t(()=>{var w,V;return[e(f,{header:"",class:"text-weight-medium"},{default:t(()=>[y("span",null,[e(ue,{modelValue:o.boletos.emitir,"onUpdate:modelValue":[a[3]||(a[3]=l=>o.boletos.emitir=l),a[4]||(a[4]=l=>g.checkboxTodos("emitir"))]},null,8,["modelValue"]),e(Q,{anchor:"bottom middle",self:"center middle"},{default:t(()=>[r(u(o.boletos.emitir?"Desmarcar Todos":"Marcar Todos"),1)]),_:1})]),a[18]||(a[18]=r(" Boletos a Emitir "))]),_:1}),e(h,{class:"q-pa-none"},{default:t(()=>[e(s,null,{default:t(()=>[e(Ne,{modelValue:o.boletos.financeiroBanco,"onUpdate:modelValue":a[5]||(a[5]=l=>o.boletos.financeiroBanco=l),options:o.boletos.bancos,dense:"",filled:"",label:"Op\xE7\xF5es de Bancos",class:"q-field--with-bottom"},null,8,["modelValue","options"])]),_:1})]),_:1}),(n(!0),x(I,null,S((V=(w=o.boletos)==null?void 0:w.condicoesPagamento)==null?void 0:V.filter(l=>!l.disable&&!l.codigoFinanceiroBoleto),(l,d)=>$((n(),c(h,{key:d,tag:"label"},{default:t(()=>[e(s,{side:""},{default:t(()=>[e(ue,{modelValue:l.checked,"onUpdate:modelValue":[m=>l.checked=m,a[6]||(a[6]=m=>g.checkboxTodos())]},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(s,null,{default:t(()=>[e(f,null,{default:t(()=>[r(u(l==null?void 0:l.descricao),1)]),_:2},1024)]),_:2},1024),e(s,null,{default:t(()=>[e(f,{class:"text-weight-medium text-center"},{default:t(()=>[y("span",null,[r(u(i.$filters.data(l==null?void 0:l.dataVencimento))+" ",1),e(Q,{anchor:"bottom middle",self:"center middle"},{default:t(()=>a[19]||(a[19]=[r(" Data de Vencimento ")])),_:1})])]),_:2},1024)]),_:2},1024),e(s,null,{default:t(()=>[e(f,{class:"text-weight-medium text-right"},{default:t(()=>[r(u(i.$filters.numero(l==null?void 0:l.valor,2)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)),[[me]])),128))]}),_:1})):v("",!0),e(Te,{showing:(_=o.boletos)==null?void 0:_.loading},{default:t(()=>[e(Se,{size:"50px",color:"primary"})]),_:1},8,["showing"])]}),_:1})]),_:1}),e(Re,{class:"bg-light"},{default:t(()=>[e(fe,null,{default:t(()=>[e(He),$(e(O,{label:"Cancelar",color:"tertiary",flat:"",class:"q-mr-sm"},null,512),[[se]]),e(O,{disable:!g.ativarBotaoEmissaoBoleto,type:"submit",label:"Imprimir",color:"primary",unelevated:""},null,8,["disable"])]),_:1})]),_:1})],32)]),_:1})]),_:1},8,["modelValue"])}var ot=Ce(We,[["render",at]]);const lt={components:{FaturaModal:Ge,nfePrincipal:je,DocumentosFiscais:Je,ModalHistoricoStatus:Ke,EmitirBoletos:ot},computed:{config(){return U.configuracoes.valores},mostrarOpcaoRemoverFatura(){return this.dados.fatura.status==="Aberta"&&!this.dados.vendas.length&&!this.dados.documentosEnvelope.length&&!this.dados.carnes.length&&!this.dados.condicaoPagamento.length}},data(){return{dbUsuario:U.usuario,width:0,dados:{fatura:{}},contatos:{},detalhesVisivel:!1,sistemaPai:"",configImpressaoCarne:[],configImpressaoConvenio:[],configImpressaoFatura:[],configImpressaoEnvelope:[],boletos:{visivel:!1,fatura:{},btnEmitirBoleto:!1},podeEditar:!1,mostrarBotaoEnviarAvaliacao:!1,mostrarBotaoEnviarPedidosProtheus:!1,mostrarBotaoEmitirCupom:!1}},emits:["executar","carregou","verificarListaLayout"],mixins:[Qe,Oe],props:{id:{required:!0,type:String},layout:{type:String,default:"card"}},methods:{async enviarPedidosProtheus(i){await $db.fatura.enviarPedidosProtheus(i)},async removerFatura(){try{await new Promise((i,a)=>{this.$q.dialog({message:"Esta a\xE7\xE3o ir\xE1 remover esta fatura.",noRefocus:!0,preventClose:!0,title:"Tem certeza?",cancel:{label:"CANCELAR",push:!0,color:"tertiary",flat:!0},ok:{label:"CONTINUAR",push:!0,class:"bg-negative",textColor:"white",flat:!0}}).onOk(()=>{i()}).onCancel(()=>{a()})})}catch{return}this.dados.fatura.id?(await U.fatura.remover(this.dados.fatura.id),this.$emit("executar","atualizar")):this.$q.notify("N\xE3o foi poss\xEDvel realizar a opera\xE7\xE3o")},abrirEmitirBoletos(i){this.boletos.visivel=!0,this.boletos.fatura=i},alternarDetalhes(i){this.detalhesVisivel=!this.detalhesVisivel,this.layout==="lista"&&this.$emit("verificarListaLayout",{id:i,acao:"detalhes",estado:this.detalhesVisivel})},async atualizar(){const i={},a=await U.fatura.leCompleto(this.id);if(a.vendas.sort((p,o)=>new Date(p.dataHoraFinalizado)<new Date(o.dataHoraFinalizado)?-1:1),a.documentosEnvelope.sort((p,o)=>new Date(p.dataHoraFinalizado)<new Date(o.dataHoraFinalizado)?-1:1),a.carnes.sort((p,o)=>new Date(p.dataVencimento)<new Date(o.dataVencimento)?-1:1),a.vendas)for(const p of a.vendas)i[p.idContatoVendedor]||(i[p.idContatoVendedor]=await U.contato.le({id:p.idContatoVendedor})),i[p.idContatoDigitador]||(i[p.idContatoDigitador]=await U.contato.le({id:p.idContatoDigitador}));if(a.documentosEnvelope)for(const p of a.documentosEnvelope)i[p.idContatoVendedor]||(i[p.idContatoVendedor]=await U.contato.le({id:p.idContatoVendedor})),i[p.idContatoDigitador]||(i[p.idContatoDigitador]=await U.contato.le({id:p.idContatoDigitador}));if(a.fatura.idContato){const p=a.fatura.idContato;i[p]||(i[p]=await U.contato.le({id:p}))}if(a.fatura.idEmpresa){const p=a.fatura.idEmpresa;i[p]||(i[p]=await U.contato.le({id:p}))}if(a.fatura){let p=[],o=[];for(const g of a.vendas)p.push(g.idContatoVendedor),o.push(g.idContatoDigitador);for(const g of a.documentosEnvelope)p.push(g.idContatoVendedor),o.push(g.idContatoDigitador);a.fatura.vendedores=[...new Set(p)],a.fatura.digitadores=[...new Set(o)]}this.contatos=i,this.dados=a,this.condicaoPagamento=a.condicaoPagamento,await this.resumeCondicaoPagamento();const F=(await U.contato.ler({filtros:{ativo:!0,empresas:!0}})).data;this.podeEditar=!1,F.find(p=>p.id===a.fatura.idEmpresa)&&(this.podeEditar=!0),await this.configuraVisibilidadeBotoes(),await this.configuraVisibilidadeBtnBoletos(),await this.configuraImpressaoCarne(a.fatura.idEmpresa),await this.configuraImpressaoConvenio(a.fatura.idEmpresa),await this.configuraImpressaoEnvelope(a.fatura.idEmpresa),await this.configuraImpressaoFatura(a.fatura.idEmpresa),this.$nextTick(()=>{a.fatura.id===localStorage.getItem("idFatura")&&(this.podeEditar&&this.$refs.faturaModal.mostrar({id:this.dados.fatura.id}),localStorage.removeItem("idFatura"))})},editar(){this.$refs.faturaModal.mostrar({id:this.dados.fatura.id})},async executar(i){switch(i){case"atualizar":case"finalizar":case"retornarOrcamento":case"remover":this.$emit("executar","atualizar");return}await this.atualizar()},async sendReview(i){try{this.$q.loading.show();const a=[],F=this.contatos[i.idContato],p=await $api.bten.send(F,i);for(let o=0;o<p.length;o++){const g=p[o];g.status?a.push(g.telefone):this.$q.notifyError(`Falha ao enviar NPS para ${g.telefone}!`)}this.$q.loading.hide(),a.length&&this.$q.notifyPositive(`NPS enviado para ${a.join(",")}!`)}catch(a){if(a.name==="GeeksException"){this.$q.notifyAlert(a.message);return}this.$q.notifyError("N\xE3o foi possivel enviar NPS para o contato.",a)}finally{this.$q.loading.hide()}},fechouNFe(i){i&&$utils.emitter.emit("atualizarDocumentosFiscais")},async configuraImpressaoConvenio(i){const a=await U.configuracoes.porNome("impressao.convenio",i);this.configImpressaoConvenio=[...a.length?a.map(F=>({texto:"Imprimir Conv\xEAnio",...F})):[{valor:"convenio",texto:"Imprimir Conv\xEAnio"}]]},async configuraImpressaoCarne(i){const a=await U.configuracoes.porNome("impressao.carne",i);this.configImpressaoCarne=[...a.length?a.map(F=>({texto:"Imprimir Carn\xEA",...F})):[{valor:"carne-crediario",texto:"Reimprimir carn\xEA e notas promiss\xF3rias da fatura"}]]},async configuraImpressaoEnvelope(i){const a=await U.configuracoes.porNome("impressao.envelope",i);this.configImpressaoEnvelope=[...a.length?a.map(F=>({texto:"Imprimir Envelope",...F})):[{valor:"envelope",texto:"Imprimir Envelope"},{valor:"envelopeMini",texto:"Imprimir Envelope Mini"}]]},async configuraImpressaoFatura(i){const a=await U.configuracoes.porNome("impressao.fatura",i),F=[{valor:"invoice",texto:"Fatura (Invoice)"},{valor:"fatura-recibo",texto:"Recibo"}];this.sistemaPai==="optisoul"&&F.push({valor:"termoGarantia",texto:"Termo de Garantia"}),this.configImpressaoFatura=[...a.length?a.map(p=>({texto:"Imprimir Fatura",...p})):F]},async configuraVisibilidadeBotoes(){var p,o,g,E,D;let i,a,F;i=await $db.configuracoes.leValorComFiltroEmpresa("integrador.idDispositivo",this.dados.fatura.idEmpresa),this.mostrarBotaoEmitirCupom=!!i,i=await $db.configuracoes.porNome("integracao.bten.business"),a=(o=(p=i[0])==null?void 0:p.valor)!=null?o:!1,i=await $db.configuracoes.porNome("integracao.bten.authorization"),F=(E=(g=i[0])==null?void 0:g.valor)!=null?E:!1,this.mostrarBotaoEnviarAvaliacao=a&&F,i=await $db.configuracoes.porNome("protheus.credentials"),this.mostrarBotaoEnviarPedidosProtheus=!!((D=i[0])!=null&&D.valor)&&!!this.dados.fatura.dataHoraFinalizado},async configuraVisibilidadeBtnBoletos(){var i,a,F,p,o,g,E,D;try{if((a=(i=this.dados)==null?void 0:i.fatura)!=null&&a.id){const N=[],A=await le().formaPagamento.toArray(),j=await le().empresa.where({idContato:(p=(F=this.dados)==null?void 0:F.fatura)==null?void 0:p.idEmpresa}).toArray();if(await(await $db.hibrido.lista({table:"documentoCondicaoPagamento",where:{idDocumento:(g=(o=this.dados)==null?void 0:o.fatura)==null?void 0:g.id}})).forEach(_=>{const w=A.find(V=>V.id===_.idFormaPagamento&&V.tipo===99&&V.tipoFinanceiro==="T\xEDtulo em aberto");w&&N.push({descricao:w.descricao})}),!N.length)return;const H=[];await le().financeiroBanco.each(_=>{if(!!_.ativo){if(_.id==="7D07229E-B35E-42AA-A312-78313BE61B2F"){H.push(_);return}_.idEmpresa&&j.find(w=>w.id===_.idEmpresa)&&H.push(_)}});const G=[...new Set(H.map(_=>_.codigoBanco))],C=[];await le()._banco.each(_=>{G.find(w=>w===b.codigoBanco)&&C.push(_)});const T=[];for(const _ of H){C.find(V=>V.codigoBanco===_.codigoBanco);T.push({codigoBanco:_.codigoBanco})}this.boletos.btnEmitirBoleto=!!((E=N||[])!=null&&E.length)&&!!((D=T||[])!=null&&D.length)}}catch(N){console.error("ERRO: ",N)}},onResize(){this.width=window.innerWidth}},async mounted(){this.sistemaPai=Me(),await this.atualizar(),this.$emit("carregou")}},it={id:"FaturaCard"},st={class:"col-12 col-md-6 q-pl-none"},rt={class:"q-item-section"},nt={class:"col-3 col-md hideonmobile"},dt={class:"text-left q-my-none"},ut={class:"col-3 col-md hideonmobile"},mt={class:"text-left q-my-none"},ft={class:"col-6 col-md hideonmobile"},ct={class:"text-right text-h5 text-positive text-weight-bold q-my-none"},pt={class:"text-right text-weight-normal text-tertiary text-body2 q-my-none"},bt={class:"col-12 col-md-6"},gt={class:"col-12 col-md-6 full-height items-end hideonmobile"},vt={class:"col-6"},ht={class:"text-left q-my-none hideondesktop"},kt={class:"text-left q-my-none"},yt={class:"col-6"},_t={class:"text-right text-weight-normal text-tertiary text-body2 q-my-none"},wt={class:"text-right text-h5 text-positive text-weight-bold q-my-none"},Ft={class:"col-12 full-height items-end"},Ct={class:"col-12 col-md-6"},Bt={class:"text-subtitle1 text-weight-bold q-ma-none items-center"},Et={class:"col-12 col-md-4"},qt={class:"q-ma-none"},xt={class:"col-12 col-md-2 text-right"},Vt={class:"q-ma-none"},Pt={class:"mw80 text-center"},Dt={key:0},zt={key:1},It={style:{"margin-left":"14px"}},Nt={style:{"margin-left":"14px"}},Tt={class:"float-right text-weight-medium text-right q-ml-sm",style:{"min-width":"70px"}};function St(i,a,F,p,o,g){const E=Y("avatar"),D=Y("badge"),N=Y("BadgeCopiarUid"),A=Y("row"),j=Y("documentos-fiscais"),L=Y("g-label"),H=Y("g-col"),G=Y("DocumentosFiscais"),C=Y("g-row"),T=Y("fatura-modal"),_=Y("modal-historico-status"),w=Y("nfePrincipal"),V=Y("EmitirBoletos");return n(),x("div",it,[F.layout==="card"?(n(),x(I,{key:0},[o.dados.fatura.id?(n(),c(Le,{key:0,class:"extratoItem bg-grey-1 q-pa-sm no-shadow"},{default:t(()=>[e(A,{class:"items-center q-mx-none q-px-none q-mb-sm"},{default:t(()=>[y("div",st,[e(fe,{class:"q-pa-none"},{default:t(()=>{var l,d,m,B,q,z;return[e(E,{imagem:(o.contatos[o.dados.fatura.idContato]||{}).imagem,rotulo:o.dados.fatura.descricaoContato,tamanho:"40",style:{float:"left"}},null,8,["imagem","rotulo"]),e(Be,null,{default:t(()=>[y("div",rt,[e(f,null,{default:t(()=>[r(u((o.contatos[o.dados.fatura.idContato]||{}).apelido),1)]),_:1}),(o.contatos[o.dados.fatura.idContato]||{}).nome!==(o.contatos[o.dados.fatura.idContato]||{}).apelido?(n(),c(f,{key:0,caption:""},{default:t(()=>[r(u((o.contatos[o.dados.fatura.idContato]||{}).nome),1)]),_:1})):v("",!0)])]),_:1}),e(D,{rotulo:o.dados.fatura.status,cor:"tertiary",escuro:"",class:"q-mr-sm"},null,8,["rotulo"]),e(N,{id:(d=(l=o.dados)==null?void 0:l.fatura)==null?void 0:d.id,numero:(B=(m=o.dados)==null?void 0:m.fatura)==null?void 0:B.numero,cor:((z=(q=o.dados)==null?void 0:q.fatura)==null?void 0:z.status)==="Finalizada"?"positive":"tertiary",escuro:""},null,8,["id","numero","cor"])]}),_:1})]),y("div",nt,[y("p",dt,[o.dados.fatura.dataHoraEmissao?(n(),c(k,{key:0,name:"mdi-calendar-today "})):v("",!0),r(" "+u(i.$filters.data(o.dados.fatura.dataHoraEmissao))+" ",1),e(Q,null,{default:t(()=>a[36]||(a[36]=[r(" Emiss\xE3o ")])),_:1})])]),y("div",ut,[y("p",mt,[o.dados.fatura.dataHoraFinalizado?(n(),c(k,{key:0,name:"mdi-calendar-check"})):v("",!0),r(" "+u(i.$filters.data(o.dados.fatura.dataHoraFinalizado))+" ",1),e(Q,null,{default:t(()=>a[37]||(a[37]=[r(" Finalizado ")])),_:1})])]),y("div",ft,[y("p",ct,u(i.$filters.numero(o.dados.fatura.totalDocumento,2)),1),y("p",pt,u(i.$filters.numero(o.dados.fatura.subTotal,2)),1)])]),_:1}),e(ie,{class:"hideondesktop q-mb-sm"}),e(A,{class:"q-mx-none q-px-none items-end"},{default:t(()=>[y("div",bt,[e(X,{class:"no-border text-tertiary"},{default:t(()=>[(n(!0),x(I,null,S(o.dados.vendas,l=>(n(),c(h,{key:l.id,class:"items-center q-pa-none q-mb-xs",style:{"min-height":"auto"}},{default:t(()=>[e(s,{avatar:"",class:"mw80"},{default:t(()=>[e(f,null,{default:t(()=>[r(u(l.tipo)+" ",1),e(de,{dark:"",color:"tertiary",denso:"",round:""},{default:t(()=>[r("#"+u(parseInt(l.numero)||(l.id||"").slice(-6)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(s,null,{default:t(()=>[e(f,null,{default:t(()=>[r(u(i.$filters.data(l.dataHoraFinalizado))+" - "+u((o.contatos[l.idContatoVendedor]||{}).apelido)+" ",1),e(Q,null,{default:t(()=>a[38]||(a[38]=[r(" Data Finalizado - Vendedor ")])),_:1})]),_:2},1024)]),_:2},1024),e(s,{avatar:"",class:"mw50"},{default:t(()=>[e(de,{dark:"",rounded:"",color:"tertiary",denso:""},{default:t(()=>[r(u(l.status),1)]),_:2},1024)]),_:2},1024),e(s,{right:"",top:"",class:"mw50"},{default:t(()=>[e(f,null,{default:t(()=>[r(u(i.$filters.numero(l.totalDocumento,2)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}),e(X,{class:"no-border text-tertiary"},{default:t(()=>[(n(!0),x(I,null,S(o.dados.documentosEnvelope,l=>(n(),c(h,{key:l.id,class:"items-center q-pa-none q-mb-xs",style:{"min-height":"auto"}},{default:t(()=>[e(s,{avatar:"",class:"mw80"},{default:t(()=>[e(f,null,{default:t(()=>[r(u(l.tipo)+" ",1),e(de,{dark:"",color:"tertiary",denso:"",round:""},{default:t(()=>[r("#"+u(parseInt(l.numero)||(l.id||"").slice(-6)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(s,null,{default:t(()=>[e(f,null,{default:t(()=>[r(u(i.$filters.data(l.dataHoraFinalizado))+" - "+u((o.contatos[l.idContatoVendedor]||{}).apelido)+" ",1),e(Q,null,{default:t(()=>a[39]||(a[39]=[r(" Data Finalizado - Vendedor ")])),_:1})]),_:2},1024)]),_:2},1024),e(s,{avatar:"",class:"mw50"},{default:t(()=>[e(de,{dark:"",rounded:"",color:"tertiary",denso:""},{default:t(()=>[r(u(l.status),1)]),_:2},1024)]),_:2},1024),e(s,{right:"",top:"",class:"mw50"},{default:t(()=>[e(f,null,{default:t(()=>[r(u(i.$filters.numero(l.totalDocumento,2)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}),e(X,{class:"no-border text-tertiary"},{default:t(()=>[(n(!0),x(I,null,S(o.dados.carnes,l=>(n(),c(h,{key:l.id,class:"q-pa-none q-mb-xs",style:{"min-height":"auto"}},{default:t(()=>[e(s,{avatar:"",class:"mw80"},{default:t(()=>[e(f,null,{default:t(()=>[a[40]||(a[40]=r(" Carn\xEA ")),e(de,{dark:"",color:"tertiary",denso:"",round:""},{default:t(()=>[r("#"+u((l.id||"").slice(-6)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(s,null,{default:t(()=>[e(f,null,{default:t(()=>[r(u(i.$filters.data(l.dataVencimento)),1)]),_:2},1024)]),_:2},1024),e(s,null,{default:t(()=>[e(f,null,{default:t(()=>[r(u(l.formaDePagamento),1)]),_:2},1024)]),_:2},1024),e(s,{right:"",top:""},{default:t(()=>[e(f,null,{default:t(()=>[r(u(i.$filters.numero(l.valorTotal,2)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),y("div",gt,[e(ie,{class:"hideondesktop q-mb-sm q-mt-xs"}),e(O,{rounded:"",dense:"",flat:"",icon:"more_vert",color:"tertiary",class:"no-shadow q-ma-xs",size:"md",style:{float:"right"}},{default:t(()=>[e(re,null,{default:t(()=>[$((n(),c(X,{link:"",separator:""},{default:t(()=>[o.dados.fatura.id?(n(),c(h,{key:0,clickable:"",onClick:a[0]||(a[0]=l=>i.$refs.documentosFiscais.emitirCupom(o.dados.fatura.id))},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[e(k,{name:"account_balance"})]),_:1}),e(s,null,{default:t(()=>[e(f,null,{default:t(()=>a[41]||(a[41]=[r("Emitir cupom")])),_:1})]),_:1})]),_:1})):v("",!0),i.$utils.mapearStatus(o.dados.fatura).permiteNota?(n(),x(I,{key:1},[e(h,{clickable:"",onClick:a[1]||(a[1]=l=>i.emitirNFeV2({idFatura:o.dados.fatura.id},1,"Venda"))},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[e(k,{name:"account_balance"})]),_:1}),e(s,null,{default:t(()=>[e(f,null,{default:t(()=>a[42]||(a[42]=[r("NFe de Sa\xEDda/Venda")])),_:1})]),_:1})]),_:1}),e(h,{clickable:"",onClick:a[2]||(a[2]=l=>i.emitirNFeV2({idFatura:o.dados.fatura.id},0,"Devolu\xE7\xE3o"))},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[e(k,{name:"account_balance"})]),_:1}),e(s,null,{default:t(()=>[e(f,null,{default:t(()=>a[43]||(a[43]=[r("NFe de Entrada/Devolu\xE7\xE3o")])),_:1})]),_:1})]),_:1}),e(h,{clickable:"",onClick:a[3]||(a[3]=l=>i.emitirNFeV2({idFatura:o.dados.fatura.id},1,"Remessa"))},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[e(k,{name:"account_balance"})]),_:1}),e(s,null,{default:t(()=>[e(f,null,{default:t(()=>a[44]||(a[44]=[r("NFe de Remessa")])),_:1})]),_:1})]),_:1})],64)):v("",!0),g.mostrarOpcaoRemoverFatura?(n(),c(h,{key:2,clickable:"",onClick:a[4]||(a[4]=l=>g.removerFatura())},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[e(k,{name:"mdi-trash-can"})]),_:1}),e(s,null,{default:t(()=>a[45]||(a[45]=[r("Remover Fatura")])),_:1})]),_:1})):v("",!0),e(h,{clickable:"",onClick:a[5]||(a[5]=l=>i.$refs.modalHistoricoStatus.mostrar({idDocumento:o.dados.fatura.id}))},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[e(k,{name:"history"})]),_:1}),e(s,null,{default:t(()=>a[46]||(a[46]=[r("Hist\xF3rico do Status")])),_:1})]),_:1}),o.mostrarBotaoEnviarAvaliacao&&o.dados.fatura.status==="Finalizada"?(n(),c(h,{key:3,clickable:"",onClick:a[6]||(a[6]=l=>g.sendReview(o.dados.fatura))},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[e(k,{name:"mdi-file-replace-outline"})]),_:1}),e(s,null,{default:t(()=>a[47]||(a[47]=[r("Enviar Avalia\xE7\xE3o")])),_:1})]),_:1})):v("",!0),o.mostrarBotaoEnviarPedidosProtheus?(n(),c(h,{key:4,clickable:"",onClick:a[7]||(a[7]=l=>g.enviarPedidosProtheus(o.dados.fatura.id))},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[e(k,{name:"send"})]),_:1}),e(s,null,{default:t(()=>a[48]||(a[48]=[r("Enviar Pedidos - Protheus")])),_:1})]),_:1})):v("",!0)]),_:1})),[[se]])]),_:1})]),_:1}),o.podeEditar?(n(),c(O,{key:0,rounded:"",dense:"",flat:"",icon:"edit",color:"primary",class:"no-shadow q-ma-xs",size:"md",onClick:g.editar,style:{float:"right"}},null,8,["onClick"])):v("",!0),e(O,{rounded:"",dense:"",flat:"",icon:"print",color:"primary",class:"no-shadow q-ma-xs",size:"md",style:{float:"right"}},{default:t(()=>[e(re,null,{default:t(()=>[$((n(),c(X,{link:"",separator:""},{default:t(()=>{var l;return[(l=o.boletos)!=null&&l.btnEmitirBoleto?(n(),c(h,{key:0,clickable:"",onClick:a[8]||(a[8]=d=>{var m;return g.abrirEmitirBoletos((m=o.dados)==null?void 0:m.fatura)})},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[e(k,{name:"mdi-printer"})]),_:1}),e(s,null,{default:t(()=>[e(f,null,{default:t(()=>a[49]||(a[49]=[r("Emitir Boleto")])),_:1})]),_:1})]),_:1})):v("",!0),(n(!0),x(I,null,S(o.configImpressaoFatura,d=>(n(),c(h,{clickable:"",key:d.valor,onClick:m=>i.$imprimir(d.valor,(o.dados.fatura||{}).id||"0")},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[e(k,{name:"print"})]),_:1}),e(s,null,{default:t(()=>[e(f,null,{default:t(()=>[r(u(d.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),o.sistemaPai==="optisoul"?(n(!0),x(I,{key:1},S(o.configImpressaoEnvelope,d=>(n(),c(h,{clickable:"",key:d.valor,onClick:m=>i.$imprimir(d.valor,(o.dados.fatura||{}).id||"0")},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[e(k,{name:"print"})]),_:1}),e(s,null,{default:t(()=>[e(f,null,{default:t(()=>[r(u(d.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):v("",!0),(n(!0),x(I,null,S(o.configImpressaoCarne,d=>(n(),c(h,{clickable:"",key:d.valor,onClick:m=>i.$imprimir(d.valor,(o.dados.fatura||{}).id||"0")},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[e(k,{name:"print"})]),_:1}),e(s,null,{default:t(()=>[e(f,null,{default:t(()=>[r(u(d.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),(n(!0),x(I,null,S(o.configImpressaoConvenio,d=>(n(),c(h,{clickable:"",key:d.valor,onClick:m=>i.$imprimir(d.valor,(o.dados.fatura||{}).id||"0")},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[e(k,{name:"print"})]),_:1}),e(s,null,{default:t(()=>[e(f,null,{default:t(()=>[r(u(d.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]}),_:1})),[[se]])]),_:1})]),_:1}),e(O,{rounded:"",dense:"",flat:"",icon:o.detalhesVisivel?"keyboard_arrow_up":"keyboard_arrow_down",size:"md",class:"no-shadow q-ma-xs",color:"tertiary",style:{float:"right"},onClick:g.alternarDetalhes},null,8,["icon","onClick"])])]),_:1}),e(ie,{class:"hideondesktop q-mb-sm q-mt-xs"}),e(A,{class:"hideondesktop"},{default:t(()=>[y("div",vt,[y("p",ht,[o.dados.fatura.dataHoraEmissao?(n(),c(k,{key:0,name:"mdi-calendar-today"})):v("",!0),r(" "+u(i.$filters.data(o.dados.fatura.dataHoraEmissao))+" ",1),e(Q,null,{default:t(()=>a[50]||(a[50]=[r(" Emiss\xE3o ")])),_:1})]),y("p",kt,[o.dados.fatura.dataHoraFinalizado?(n(),c(k,{key:0,name:"mdi-calendar-check"})):v("",!0),r(" "+u(i.$filters.data(o.dados.fatura.dataHoraFinalizado))+" ",1),o.dados.fatura.dataHoraFinalizado?(n(),c(Q,{key:1},{default:t(()=>a[51]||(a[51]=[r(" Finalizado ")])),_:1})):v("",!0)])]),y("div",yt,[y("p",_t,u(i.$filters.numero(o.dados.fatura.subTotal,2)),1),y("p",wt,u(i.$filters.numero(o.dados.fatura.totalDocumento,2)),1)]),y("div",Ft,[e(ie,{class:"hideondesktop q-mb-sm q-mt-xs"}),e(O,{rounded:"",dense:"",flat:"",icon:"more_vert",color:"tertiary",class:"no-shadow q-ma-xs",size:"md",style:{float:"right"}},{default:t(()=>[e(re,null,{default:t(()=>[$((n(),c(X,{link:"",separator:""},{default:t(()=>[o.mostrarBotaoEmitirCupom&&o.dados.fatura.id?(n(),c(h,{key:0,clickable:"",onClick:a[9]||(a[9]=l=>i.$refs.documentosFiscais.emitirCupom(o.dados.fatura.id))},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[e(k,{name:"account_balance"})]),_:1}),e(s,null,{default:t(()=>[e(f,null,{default:t(()=>a[52]||(a[52]=[r("Emitir cupom")])),_:1})]),_:1})]),_:1})):v("",!0),i.$utils.mapearStatus(o.dados.fatura).permiteNota?(n(),x(I,{key:1},[e(h,{clickable:"",onClick:a[10]||(a[10]=l=>i.emitirNFeV2({idFatura:o.dados.fatura.id},1,"Venda"))},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[e(k,{name:"account_balance"})]),_:1}),e(s,null,{default:t(()=>[e(f,null,{default:t(()=>a[53]||(a[53]=[r("NFe de Sa\xEDda/Venda")])),_:1})]),_:1})]),_:1}),e(h,{clickable:"",onClick:a[11]||(a[11]=l=>i.emitirNFeV2({idFatura:o.dados.fatura.id},0,"Devolu\xE7\xE3o"))},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[e(k,{name:"account_balance"})]),_:1}),e(s,null,{default:t(()=>[e(f,null,{default:t(()=>a[54]||(a[54]=[r("NFe de Entrada/Devolu\xE7\xE3o")])),_:1})]),_:1})]),_:1}),e(h,{clickable:"",onClick:a[12]||(a[12]=l=>i.emitirNFeV2({idFatura:o.dados.fatura.id},1,"Remessa"))},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[e(k,{name:"account_balance"})]),_:1}),e(s,null,{default:t(()=>[e(f,null,{default:t(()=>a[55]||(a[55]=[r("NFe de Remessa")])),_:1})]),_:1})]),_:1})],64)):v("",!0),g.mostrarOpcaoRemoverFatura?(n(),c(h,{key:2,clickable:"",onClick:a[13]||(a[13]=l=>g.removerFatura())},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[e(k,{name:"mdi-trash-can"})]),_:1}),e(s,null,{default:t(()=>a[56]||(a[56]=[r("Remover Fatura")])),_:1})]),_:1})):v("",!0),e(h,{clickable:"",onClick:a[14]||(a[14]=l=>i.$refs.modalHistoricoStatus.mostrar({idDocumento:o.dados.fatura.id}))},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[e(k,{name:"history"})]),_:1}),e(s,null,{default:t(()=>a[57]||(a[57]=[r("Hist\xF3rico do Status")])),_:1})]),_:1}),o.mostrarBotaoEnviarAvaliacao&&o.dados.fatura.status==="Finalizada"?(n(),c(h,{key:3,clickable:"",onClick:a[15]||(a[15]=l=>g.sendReview(o.dados.fatura))},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[e(k,{name:"mdi-file-replace-outline"})]),_:1}),e(s,null,{default:t(()=>a[58]||(a[58]=[r("Enviar Avalia\xE7\xE3o")])),_:1})]),_:1})):v("",!0),o.mostrarBotaoEnviarPedidosProtheus?(n(),c(h,{key:4,clickable:"",onClick:a[16]||(a[16]=l=>g.enviarPedidosProtheus(o.dados.fatura.id))},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[e(k,{name:"send"})]),_:1}),e(s,null,{default:t(()=>a[59]||(a[59]=[r("Enviar Pedidos - Protheus")])),_:1})]),_:1})):v("",!0)]),_:1})),[[se]])]),_:1})]),_:1}),o.podeEditar?(n(),c(O,{key:0,rounded:"",dense:"",flat:"",icon:"edit",color:"primary",class:"no-shadow q-ma-xs",size:"md",onClick:g.editar,style:{float:"right"}},null,8,["onClick"])):v("",!0),e(O,{rounded:"",dense:"",flat:"",icon:"print",color:"primary",class:"no-shadow q-ma-xs",size:"md",style:{float:"right"}},{default:t(()=>[e(re,null,{default:t(()=>[e(X,{link:"",separator:""},{default:t(()=>{var l;return[(l=o.boletos)!=null&&l.btnEmitirBoleto?(n(),c(h,{key:0,clickable:"",onClick:a[17]||(a[17]=d=>{var m;return g.abrirEmitirBoletos((m=o.dados)==null?void 0:m.fatura)})},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[e(k,{name:"mdi-printer"})]),_:1}),e(s,null,{default:t(()=>[e(f,null,{default:t(()=>a[60]||(a[60]=[r("Emitir Boleto")])),_:1})]),_:1})]),_:1})):v("",!0),(n(!0),x(I,null,S(o.configImpressaoFatura,d=>(n(),c(h,{clickable:"",key:d.valor,onClick:m=>i.$imprimir(d.valor,(o.dados.fatura||{}).id||"0")},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[e(k,{name:"print"})]),_:1}),e(s,null,{default:t(()=>[e(f,null,{default:t(()=>[r(u(d.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),o.sistemaPai==="optisoul"?(n(!0),x(I,{key:1},S(o.configImpressaoEnvelope,d=>(n(),c(h,{clickable:"",key:d.valor,onClick:m=>i.$imprimir(d.valor,(o.dados.fatura||{}).id||"0")},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[e(k,{name:"print"})]),_:1}),e(s,null,{default:t(()=>[e(f,null,{default:t(()=>[r(u(d.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):v("",!0),(n(!0),x(I,null,S(o.configImpressaoCarne,d=>(n(),c(h,{clickable:"",key:d.valor,onClick:m=>i.$imprimir(d.valor,(o.dados.fatura||{}).id||"0")},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[e(k,{name:"print"})]),_:1}),e(s,null,{default:t(()=>[e(f,null,{default:t(()=>[r(u(d.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),(n(!0),x(I,null,S(o.configImpressaoConvenio,d=>(n(),c(h,{clickable:"",key:d.valor,onClick:m=>i.$imprimir(d.valor,(o.dados.fatura||{}).id||"0")},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[e(k,{name:"print"})]),_:1}),e(s,null,{default:t(()=>[e(f,null,{default:t(()=>[r(u(d.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]}),_:1})]),_:1})]),_:1}),e(O,{rounded:"",dense:"",flat:"",icon:o.detalhesVisivel?"keyboard_arrow_up":"keyboard_arrow_down",size:"md",class:"no-shadow q-ma-xs",color:"tertiary",style:{float:"right"},onClick:g.alternarDetalhes},null,8,["icon","onClick"])])]),_:1}),o.detalhesVisivel?(n(),c(ie,{key:0,class:"hideondesktop q-my-sm"})):v("",!0),$(e(A,{class:"items-start q-mx-none q-px-none q-mt-md"},{default:t(()=>[y("div",Ct,[y("p",Bt,[e(k,{name:"business"}),r(" "+u(o.dados.fatura.descricaoEmpresa),1)]),e(j,{ref:"documentosFiscais",idFatura:o.dados.fatura.id},null,8,["idFatura"])]),y("div",Et,[a[61]||(a[61]=y("p",{class:"text-subtitle1 text-weight-bold q-ma-none"}," Faturamento ",-1)),y("p",qt,u(o.dados.fatura.observacaoFaturamento),1),e(X,{class:"no-border"},{default:t(()=>[(n(!0),x(I,null,S(i.condicaoPagamentoResumo,l=>(n(),c(h,{key:l.id,class:"q-pa-none row",style:{"min-height":"auto"}},{default:t(()=>[e(s,null,{default:t(()=>[e(f,null,{default:t(()=>[r(u(l.formaPagamento),1)]),_:2},1024)]),_:2},1024),e(s,{class:"text-right"},{default:t(()=>[e(f,null,{default:t(()=>[r(u(i.$filters.numero(l.valor,2))+u(l.parcelas>1?` (em ${l.parcelas}x)`:""),1)]),_:2},1024)]),_:2},1024),e(s,{right:""},{default:t(()=>[e(f,null,{default:t(()=>[r(u(i.$filters.data(l.dataVencimento)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),y("div",xt,[a[62]||(a[62]=y("p",{class:"text-subtitle1 text-weight-bold q-ma-none"}," Desconto ",-1)),y("p",Vt,u(i.$filters.numero(o.dados.fatura.totalDesconto,2)),1)])]),_:1},512),[[we,o.detalhesVisivel]])]),_:1})):v("",!0)],64)):v("",!0),F.layout==="lista"?(n(),x(I,{key:1},[e(Ue,{onResize:g.onResize},null,8,["onResize"]),o.dados.fatura.id?(n(),c(h,{key:0,clickable:"","manual-focus":"",class:"q-py-sm q-px-xs items-center"},{default:t(()=>[e(s,{class:"hideonmobile col-auto no-margin"},{default:t(()=>{var l,d,m,B,q,z;return[y("div",Pt,[e(N,{id:(d=(l=o.dados)==null?void 0:l.fatura)==null?void 0:d.id,numero:(B=(m=o.dados)==null?void 0:m.fatura)==null?void 0:B.numero,cor:((z=(q=o.dados)==null?void 0:q.fatura)==null?void 0:z.status)==="Finalizada"?"positive":"tertiary"},null,8,["id","numero","cor"])])]}),_:1}),e(s,{class:"col-md col-lg col-xl no-margin"},{default:t(()=>[e(h,{class:"q-pa-none"},{default:t(()=>[e(s,{onClick:a[18]||(a[18]=l=>g.editar()),class:"col-auto items-center"},{default:t(()=>{var l,d,m,B,q;return[e(E,{imagem:(m=o.contatos[(d=(l=o.dados)==null?void 0:l.fatura)==null?void 0:d.idContato]||{})==null?void 0:m.imagem,tamanho:"40",rotulo:(q=(B=o.dados)==null?void 0:B.fatura)==null?void 0:q.descricaoContato,style:{display:"flex","align-self":"center"}},null,8,["imagem","rotulo"])]}),_:1}),e(s,{onClick:a[19]||(a[19]=l=>g.editar()),class:"col"},{default:t(()=>{var l,d,m,B,q,z;return[e(f,{lines:"2",class:"text-weight-bold"},{default:t(()=>{var P,R,J;return[y("span",null,[r(u((J=o.contatos[(R=(P=o.dados)==null?void 0:P.fatura)==null?void 0:R.idContato]||{})==null?void 0:J.apelido)+" ",1),e(Q,{anchor:"bottom middle",self:"center middle"},{default:t(()=>a[63]||(a[63]=[r("Cliente")])),_:1})])]}),_:1}),e(f,{caption:"",class:"hideondesktop"},{default:t(()=>{var P,R,J,ee,K,W;return[e(N,{id:(R=(P=o.dados)==null?void 0:P.fatura)==null?void 0:R.id,numero:(ee=(J=o.dados)==null?void 0:J.fatura)==null?void 0:ee.numero,cor:((W=(K=o.dados)==null?void 0:K.fatura)==null?void 0:W.status)==="Finalizada"?"positive":"tertiary",class:"q-mr-sm"},null,8,["id","numero","cor"])]}),_:1}),o.contatos[o.dados.fatura.idEmpresa]?(n(),c(f,{key:0,caption:"",lines:"2"},{default:t(()=>{var P,R;return[y("span",null,[e(k,{name:"business"}),r(" "+u(((P=o.contatos[o.dados.fatura.idEmpresa])==null?void 0:P.apelido)||((R=o.contatos[o.dados.fatura.idEmpresa])==null?void 0:R.nome))+" ",1),e(Q,{anchor:"bottom middle",self:"center middle"},{default:t(()=>a[64]||(a[64]=[r(" Empresa ")])),_:1})])]}),_:1})):v("",!0),((m=(d=(l=o.dados)==null?void 0:l.fatura)==null?void 0:d.vendedores)==null?void 0:m.filter(Boolean).length)||((z=(q=(B=o.dados)==null?void 0:B.fatura)==null?void 0:q.digitadores)==null?void 0:z.filter(Boolean).length)?(n(),c(f,{key:1,caption:"",lines:"2"},{default:t(()=>{var P,R,J,ee,K,W,ae,oe,ce,pe,be,ge,ve,he,ke;return[e(k,{name:"mdi-account-tie",style:{"margin-right":"2px"}}),(J=(R=(P=o.dados)==null?void 0:P.fatura)==null?void 0:R.vendedores)!=null&&J.filter(Boolean).length?(n(),x("span",Dt,[r(u((W=(K=(ee=o.dados)==null?void 0:ee.fatura)==null?void 0:K.vendedores)==null?void 0:W.map(Z=>{var M;return(M=o.contatos[Z])==null?void 0:M.apelido}).filter(Boolean).join(", "))+" ",1),e(Q,{anchor:"bottom middle",self:"center middle"},{default:t(()=>{var Z,M,te;return[r(u(((te=(M=(Z=o.dados)==null?void 0:Z.fatura)==null?void 0:M.vendedores)==null?void 0:te.length)>1?"Vendedores":"Vendedor"),1)]}),_:1})])):v("",!0),((ce=(oe=(ae=o.dados)==null?void 0:ae.fatura)==null?void 0:oe.digitadores)==null?void 0:ce.filter(Boolean).length)&&((ge=(be=(pe=o.dados)==null?void 0:pe.fatura)==null?void 0:be.digitadores)==null?void 0:ge.some(Z=>{var M,te,ne;return!((ne=(te=(M=o.dados)==null?void 0:M.fatura)==null?void 0:te.vendedores)!=null&&ne.includes(Z))}))?(n(),x("span",zt,[r(" | "+u((ke=(he=(ve=o.dados)==null?void 0:ve.fatura)==null?void 0:he.digitadores)==null?void 0:ke.filter(Z=>{var M,te,ne;return!((ne=(te=(M=o.dados)==null?void 0:M.fatura)==null?void 0:te.vendedores)!=null&&ne.includes(Z))}).map(Z=>{var M;return(M=o.contatos[Z])==null?void 0:M.apelido}).filter(Boolean).join(", "))+" ",1),e(Q,{anchor:"bottom middle",self:"center middle"},{default:t(()=>{var Z,M,te;return[r(u(((te=(M=(Z=o.dados)==null?void 0:Z.fatura)==null?void 0:M.digitadores)==null?void 0:te.length)>1?"Digitadores":"Digitador"),1)]}),_:1})])):v("",!0)]}),_:1})):v("",!0),e(s,{class:"hideondesktop q-mt-sm"},{default:t(()=>[e(h,{class:"q-pa-none",style:{"min-height":"36px!important"}},{default:t(()=>[e(s,{top:"",class:"col-5 no-margin"},{default:t(()=>{var P,R,J,ee;return[(R=(P=o.dados)==null?void 0:P.fatura)!=null&&R.dataHoraEmissao?(n(),c(f,{key:0,caption:""},{default:t(()=>{var K,W;return[e(k,{name:"mdi-calendar-today",style:{position:"absolute","margin-top":"2px"}}),y("span",It,u(i.$filters.data((W=(K=o.dados)==null?void 0:K.fatura)==null?void 0:W.dataHoraEmissao)),1)]}),_:1})):v("",!0),(ee=(J=o.dados)==null?void 0:J.fatura)!=null&&ee.dataHoraFinalizado?(n(),c(f,{key:1,caption:""},{default:t(()=>{var K,W;return[e(k,{name:"mdi-calendar",style:{position:"absolute","margin-top":"2px"}}),y("span",Nt,u(i.$filters.data((W=(K=o.dados)==null?void 0:K.fatura)==null?void 0:W.dataHoraFinalizado)),1)]}),_:1})):v("",!0)]}),_:1}),e(s,{top:"",class:"col-7 no-margin text-right"},{default:t(()=>{var P,R,J,ee,K,W;return[(R=(P=o.dados)==null?void 0:P.fatura)!=null&&R.totalDocumento?(n(),c(f,{key:0,caption:"",class:"text-weight-bold"},{default:t(()=>{var ae,oe;return[r(u(i.$filters.numero((oe=(ae=o.dados)==null?void 0:ae.fatura)==null?void 0:oe.totalDocumento,2)),1)]}),_:1})):v("",!0),((ee=(J=o.dados)==null?void 0:J.fatura)==null?void 0:ee.subTotal)!==((W=(K=o.dados)==null?void 0:K.fatura)==null?void 0:W.totalDocumento)?(n(),c(f,{key:1,caption:""},{default:t(()=>{var ae,oe;return[r(u(i.$filters.numero((oe=(ae=o.dados)==null?void 0:ae.fatura)==null?void 0:oe.subTotal,2)),1)]}),_:1})):v("",!0)]}),_:1})]),_:1})]),_:1})]}),_:1})]),_:1})]),_:1}),e(s,{onClick:a[20]||(a[20]=l=>g.editar()),class:"hideonmobile maxw100 q-pl-sm no-margin"},{default:t(()=>{var l,d,m,B;return[(d=(l=o.dados)==null?void 0:l.fatura)!=null&&d.dataHoraEmissao?(n(),c(f,{key:0,caption:"",class:"text-weight-medium"},{default:t(()=>{var q,z;return[y("span",null,[e(k,{name:"mdi-calendar-today"}),r(" "+u(i.$filters.data((z=(q=o.dados)==null?void 0:q.fatura)==null?void 0:z.dataHoraEmissao))+" ",1),e(Q,{anchor:"bottom middle",self:"center middle"},{default:t(()=>{var P,R;return[r(" Emitido \xE0s "+u(i.$filters.hora((R=(P=o.dados)==null?void 0:P.fatura)==null?void 0:R.dataHoraEmissao)),1)]}),_:1})])]}),_:1})):v("",!0),(B=(m=o.dados)==null?void 0:m.fatura)!=null&&B.dataHoraFinalizado?(n(),c(f,{key:1,caption:"",class:"text-weight-medium"},{default:t(()=>{var q,z;return[y("span",null,[e(k,{name:"mdi-calendar"}),r(" "+u(i.$filters.data((z=(q=o.dados)==null?void 0:q.fatura)==null?void 0:z.dataHoraFinalizado))+" ",1),e(Q,{anchor:"bottom middle",self:"center middle"},{default:t(()=>{var P,R;return[r(" Finalizado \xE1s "+u(i.$filters.hora((R=(P=o.dados)==null?void 0:P.fatura)==null?void 0:R.dataHoraFinalizado)),1)]}),_:1})])]}),_:1})):v("",!0)]}),_:1}),e(s,{onClick:a[21]||(a[21]=l=>g.editar()),class:"hideonmobile maxw120 q-pl-sm no-margin"},{default:t(()=>{var l,d,m,B;return[(d=(l=o.dados)==null?void 0:l.fatura)!=null&&d.totalDocumento?(n(),c(f,{key:0,class:"text-weight-bold text-right"},{default:t(()=>{var q,z;return[y("span",null,[r(u(i.$filters.numero((z=(q=o.dados)==null?void 0:q.fatura)==null?void 0:z.totalDocumento,2))+" ",1),e(Q,{anchor:"bottom middle",self:"center middle"},{default:t(()=>a[65]||(a[65]=[r(" Total ")])),_:1})])]}),_:1})):v("",!0),(B=(m=o.dados)==null?void 0:m.fatura)!=null&&B.subTotal?(n(),c(f,{key:1,class:"text-caption text-right"},{default:t(()=>{var q,z;return[y("span",null,[r(u(i.$filters.numero((z=(q=o.dados)==null?void 0:q.fatura)==null?void 0:z.subTotal,2))+" ",1),e(Q,{anchor:"bottom middle",self:"center middle"},{default:t(()=>a[66]||(a[66]=[r(" Subtotal ")])),_:1})])]}),_:1})):v("",!0)]}),_:1}),e(s,{class:"col-auto q-pl-sm no-margin"},{default:t(()=>[e(h,{class:"q-pa-none"},{default:t(()=>[e(s,{class:"hideonmobile no-margin"},{default:t(()=>[e(O,{onClick:a[22]||(a[22]=l=>{var d,m;return g.alternarDetalhes((m=(d=o.dados)==null?void 0:d.fatura)==null?void 0:m.id)}),round:"",flat:"",dense:"",size:"md",color:"tertiary",icon:o.detalhesVisivel?"keyboard_arrow_up":"keyboard_arrow_down"},null,8,["icon"])]),_:1}),e(s,{class:"hideonmobile no-margin"},{default:t(()=>[o.podeEditar?(n(),c(O,{key:0,onClick:a[23]||(a[23]=l=>g.editar()),icon:"edit",size:"md",color:"primary",round:"",flat:"",dense:""})):v("",!0)]),_:1}),e(s,{class:"hideonmobile no-margin"},{default:t(()=>[e(O,{icon:"print",size:"md",round:"",flat:"",dense:"",class:"hideonmobile"},{default:t(()=>[e(re,null,{default:t(()=>[$((n(),c(X,{link:"","no-border":"",separator:""},{default:t(()=>{var l;return[(l=o.boletos)!=null&&l.btnEmitirBoleto?(n(),c(h,{key:0,onClick:a[24]||(a[24]=d=>{var m;return g.abrirEmitirBoletos((m=o.dados)==null?void 0:m.fatura)}),clickable:""},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[e(k,{name:"mdi-printer"})]),_:1}),e(s,null,{default:t(()=>[e(f,null,{default:t(()=>a[67]||(a[67]=[r("Emitir Boleto")])),_:1})]),_:1})]),_:1})):v("",!0),(n(!0),x(I,null,S(o.configImpressaoFatura,d=>(n(),c(h,{key:d.valor,onClick:m=>i.$imprimir(d.valor,(o.dados.fatura||{}).id||"0"),clickable:""},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[e(k,{name:"print"})]),_:1}),e(s,null,{default:t(()=>[e(f,null,{default:t(()=>[r(u(d.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),o.sistemaPai==="optisoul"?(n(!0),x(I,{key:1},S(o.configImpressaoEnvelope,d=>(n(),c(h,{clickable:"",key:d.valor,onClick:m=>i.$imprimir(d.valor,(o.dados.fatura||{}).id||"0")},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[e(k,{name:"print"})]),_:1}),e(s,null,{default:t(()=>[e(f,null,{default:t(()=>[r(u(d.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):v("",!0),(n(!0),x(I,null,S(o.configImpressaoCarne,d=>(n(),c(h,{key:d.valor,onClick:m=>i.$imprimir(d.valor,(o.dados.fatura||{}).id||"0"),clickable:""},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[e(k,{name:"print"})]),_:1}),e(s,null,{default:t(()=>[e(f,null,{default:t(()=>[r(u(d.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),(n(!0),x(I,null,S(o.configImpressaoConvenio,d=>(n(),c(h,{key:d.valor,onClick:m=>i.$imprimir(d.valor,(o.dados.fatura||{}).id||"0"),clickable:""},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[e(k,{name:"print"})]),_:1}),e(s,null,{default:t(()=>[e(f,null,{default:t(()=>[r(u(d.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]}),_:1})),[[se]])]),_:1})]),_:1})]),_:1}),e(s,{class:"no-margin"},{default:t(()=>[e(O,{icon:"more_vert",size:"md",round:"",flat:"",dense:""},{default:t(()=>[e(re,null,{default:t(()=>[$((n(),c(X,{link:"","no-border":"",separator:""},{default:t(()=>{var l;return[o.podeEditar?(n(),c(h,{key:0,onClick:a[25]||(a[25]=d=>g.editar()),clickable:"",class:"hideondesktop"},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[e(k,{name:"edit"})]),_:1}),e(s,null,{default:t(()=>a[68]||(a[68]=[r(" Editar ")])),_:1})]),_:1})):v("",!0),e(h,{onClick:a[26]||(a[26]=d=>{var m,B;return g.alternarDetalhes((B=(m=o.dados)==null?void 0:m.fatura)==null?void 0:B.id)}),clickable:"",class:"hideondesktop"},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[e(k,{name:o.detalhesVisivel?"keyboard_arrow_up":"keyboard_arrow_down"},null,8,["name"])]),_:1}),e(s,null,{default:t(()=>a[69]||(a[69]=[r(" Detalhes ")])),_:1})]),_:1}),o.dados.fatura.id?(n(),c(h,{key:1,clickable:"",onClick:a[27]||(a[27]=d=>i.$refs.documentosFiscais.emitirCupom(o.dados.fatura.id))},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[e(k,{name:"account_balance"})]),_:1}),e(s,null,{default:t(()=>[e(f,null,{default:t(()=>a[70]||(a[70]=[r("Emitir cupom")])),_:1})]),_:1})]),_:1})):v("",!0),i.$utils.mapearStatus(o.dados.fatura).permiteNota?(n(),c(h,{key:2,clickable:"",onClick:a[28]||(a[28]=d=>i.emitirNFeV2({idFatura:o.dados.fatura.id},1,"Venda"))},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[e(k,{name:"account_balance"})]),_:1}),e(s,null,{default:t(()=>[e(f,null,{default:t(()=>a[71]||(a[71]=[r("NFe de Sa\xEDda/Venda")])),_:1})]),_:1})]),_:1})):v("",!0),i.$utils.mapearStatus(o.dados.fatura).permiteNota?(n(),c(h,{key:3,clickable:"",onClick:a[29]||(a[29]=d=>i.emitirNFeV2({idFatura:o.dados.fatura.id},0,"Devolu\xE7\xE3o"))},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[e(k,{name:"account_balance"})]),_:1}),e(s,null,{default:t(()=>[e(f,null,{default:t(()=>a[72]||(a[72]=[r("NFe de Entrada/Devolu\xE7\xE3o")])),_:1})]),_:1})]),_:1})):v("",!0),i.$utils.mapearStatus(o.dados.fatura).permiteNota?(n(),c(h,{key:4,clickable:"",onClick:a[30]||(a[30]=d=>i.emitirNFeV2({idFatura:o.dados.fatura.id},1,"Remessa"))},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[e(k,{name:"account_balance"})]),_:1}),e(s,null,{default:t(()=>[e(f,null,{default:t(()=>a[73]||(a[73]=[r("NFe de Remessa")])),_:1})]),_:1})]),_:1})):v("",!0),g.mostrarOpcaoRemoverFatura?(n(),c(h,{key:5,clickable:"",onClick:a[31]||(a[31]=d=>g.removerFatura())},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[e(k,{name:"mdi-trash-can"})]),_:1}),e(s,null,{default:t(()=>[e(f,null,{default:t(()=>a[74]||(a[74]=[r("Remover Fatura")])),_:1})]),_:1})]),_:1})):v("",!0),e(h,{clickable:"",onClick:a[32]||(a[32]=d=>i.$refs.modalHistoricoStatus.mostrar({idDocumento:o.dados.fatura.id}))},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[e(k,{name:"history"})]),_:1}),e(s,null,{default:t(()=>[e(f,null,{default:t(()=>a[75]||(a[75]=[r("Hist\xF3rico do Status")])),_:1})]),_:1})]),_:1}),o.mostrarBotaoEnviarAvaliacao&&o.dados.fatura.status==="Finalizada"?(n(),c(h,{key:6,onClick:a[33]||(a[33]=d=>g.sendReview(o.dados.fatura)),clickable:""},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[e(k,{name:"mdi-file-replace-outline"})]),_:1}),e(s,null,{default:t(()=>[e(f,null,{default:t(()=>a[76]||(a[76]=[r("Enviar Avalia\xE7\xE3o")])),_:1})]),_:1})]),_:1})):v("",!0),(l=o.boletos)!=null&&l.btnEmitirBoleto?(n(),c(h,{key:7,clickable:"",onClick:a[34]||(a[34]=d=>{var m;return g.abrirEmitirBoletos((m=o.dados)==null?void 0:m.fatura)}),class:"hideondesktop"},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[e(k,{name:"mdi-printer"})]),_:1}),e(s,null,{default:t(()=>[e(f,null,{default:t(()=>a[77]||(a[77]=[r("Emitir Boleto")])),_:1})]),_:1})]),_:1})):v("",!0),(n(!0),x(I,null,S(o.configImpressaoFatura,d=>(n(),c(h,{key:d.valor,onClick:m=>i.$imprimir(d.valor,(o.dados.fatura||{}).id||"0"),clickable:"",class:"hideondesktop"},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[e(k,{name:"print"})]),_:1}),e(s,null,{default:t(()=>[e(f,null,{default:t(()=>[r(u(d.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),o.sistemaPai==="optisoul"?(n(!0),x(I,{key:8},S(o.configImpressaoEnvelope,d=>(n(),c(h,{clickable:"",class:"hideondesktop",key:d.valor,onClick:m=>i.$imprimir(d.valor,(o.dados.fatura||{}).id||"0")},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[e(k,{name:"print"})]),_:1}),e(s,null,{default:t(()=>[e(f,null,{default:t(()=>[r(u(d.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):v("",!0),(n(!0),x(I,null,S(o.configImpressaoCarne,d=>(n(),c(h,{key:d.valor,onClick:m=>i.$imprimir(d.valor,(o.dados.fatura||{}).id||"0"),clickable:"",class:"hideondesktop"},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[e(k,{name:"print"})]),_:1}),e(s,null,{default:t(()=>[e(f,null,{default:t(()=>[r(u(d.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),(n(!0),x(I,null,S(o.configImpressaoConvenio,d=>(n(),c(h,{key:d.valor,onClick:m=>i.$imprimir(d.valor,(o.dados.fatura||{}).id||"0"),clickable:"",class:"hideondesktop"},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[e(k,{name:"print"})]),_:1}),e(s,null,{default:t(()=>[e(f,null,{default:t(()=>[r(u(d.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]}),_:1})),[[se]])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):v("",!0),$(e(C,{gutter:"md-x lg-y"},{default:t(()=>[o.dados.fatura.totalDesconto?(n(),c(H,{key:0,col:"xs12"},{default:t(()=>[e(L,{caption:o.width<=992,text:"sub2 regular",class:Fe(["q-pr-sm",`${o.width<=992?"text-left":"text-right"}`])},{default:t(()=>[a[78]||(a[78]=r(" Desconto: ")),y("span",Tt,u(i.$filters.numero(o.dados.fatura.totalDesconto,2)),1)]),_:1},8,["caption","class"])]),_:1})):v("",!0),e(H,{col:"xs12 md6",bordered:""},{default:t(()=>[o.dados.fatura.observacaoFaturamento||i.condicaoPagamentoResumo.length||o.dados.fatura.totalDesconto?(n(),c(L,{key:0,icon:`attach_money ${o.width<=992?"15px":"xs"} tertiary`,caption:o.width<=992,text:"sub2 medium",class:"q-mb-md"},{default:t(()=>a[79]||(a[79]=[r(" Faturamento ")])),_:1},8,["icon","caption"])):v("",!0),o.dados.fatura.observacaoFaturamento?(n(),c(L,{key:1,text:"sub2 regular",class:"q-mb-md q-mx-xs",caption:o.width<=992},{default:t(()=>[a[80]||(a[80]=y("span",{class:"text-weight-medium q-pr-sm"},"Obs.:",-1)),r(" "+u(o.dados.fatura.observacaoFaturamento),1)]),_:1},8,["caption"])):v("",!0),i.condicaoPagamentoResumo.length?(n(),c(X,{key:2},{default:t(()=>[(n(!0),x(I,null,S(i.condicaoPagamentoResumo,l=>(n(),c(h,{key:l.id,class:Fe([`${i.condicaoPagamentoResumo.length>1?"border-bottom":""}`,"q-px-sm q-py-none q-mb-md"])},{default:t(()=>[e(s,null,{default:t(()=>[e(f,{class:"text-weight-medium",caption:o.width<=992},{default:t(()=>[r(u(l.formaPagamento),1)]),_:2},1032,["caption"]),e(s,{class:"hideondesktop"},{default:t(()=>[e(h,{class:"q-pa-none"},{default:t(()=>[e(s,{class:"maxw80 no-margin"},{default:t(()=>[e(f,{caption:"",class:"text-weight-medium"},{default:t(()=>[r(u(i.$filters.data(l.dataVencimento)),1)]),_:2},1024),e(f,{caption:""},{default:t(()=>[r(u(i.$filters.hora(l.dataVencimento)),1)]),_:2},1024)]),_:2},1024),e(s,{class:"no-margin"},{default:t(()=>[e(f,{class:"text-right text-weight-medium",caption:o.width<=992},{default:t(()=>[r(u(i.$filters.numero(l.valor,2)),1)]),_:2},1032,["caption"]),l.parcelas?(n(),c(f,{key:0,caption:"",class:"text-right"},{default:t(()=>[r(u(l.parcelas>1?`(${l.parcelas}x)`:""),1)]),_:2},1024)):v("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(s,{class:"maxw80 no-margin hideonmobile"},{default:t(()=>[e(f,{class:"text-weight-medium",caption:o.width<=992},{default:t(()=>[r(u(i.$filters.data(l.dataVencimento)),1)]),_:2},1032,["caption"]),e(f,{caption:""},{default:t(()=>[r(u(i.$filters.hora(l.dataVencimento)),1)]),_:2},1024)]),_:2},1024),e(s,{class:"maxw100 no-margin hideonmobile"},{default:t(()=>[e(f,{class:"text-right text-weight-medium",caption:o.width<=992},{default:t(()=>[r(u(i.$filters.numero(l.valor,2)),1)]),_:2},1032,["caption"]),l.parcelas?(n(),c(f,{key:0,caption:"",class:"text-right"},{default:t(()=>[r(u(l.parcelas>1?`(${l.parcelas}x)`:""),1)]),_:2},1024)):v("",!0)]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1})):v("",!0)]),_:1}),e(H,{col:"xs12 md6",bordered:""},{default:t(()=>[e(G,{idFatura:o.dados.fatura.id,ref:"documentosFiscais"},null,8,["idFatura"])]),_:1})]),_:1},512),[[we,o.dados.fatura.id&&o.detalhesVisivel]]),o.dados.fatura.id?(n(),c(ie,{key:1})):v("",!0)],64)):v("",!0),e(T,{onExecutar:g.executar,ref:"faturaModal"},null,8,["onExecutar"]),e(_,{ref:"modalHistoricoStatus"},null,512),e(w,{onFechar:g.fechouNFe},null,8,["onFechar"]),e(V,{modelValue:o.boletos.visivel,"onUpdate:modelValue":a[35]||(a[35]=l=>o.boletos.visivel=l),fatura:o.boletos.fatura},null,8,["modelValue","fatura"])])}var Ut=Ce(lt,[["render",St]]);export{Ut as F};
