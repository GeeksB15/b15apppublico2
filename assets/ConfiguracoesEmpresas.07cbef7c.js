import{ab as no,ac as uo,cV as co,af as mo,ai as te,aj as U,cW as po,bL as go,ak as qe,cX as fo,cY as vo,cZ as _e,c_ as De,c$ as ve,d0 as bo,a6 as p,d1 as ho,d2 as Ee,a$ as le,a_ as Ne,a7 as W,j as Qe,b6 as be,b5 as Co,bO as K,d3 as So,an as yo,d4 as wo,ap as Ie,d5 as ko,_ as xo,Y as Vo,r as R,o as _,p as A,C as f,F as $,x as re,d as Y,w as i,f as o,h as ie,i as se,t as S,k as V,e as X,Q as k,A as M,M as de,at as Ue,G as me,H as B,N as J,I as pe,b4 as he,L as Pe,as as ne,S as ge,T as G,U as fe,b7 as Le,d6 as Ae,d7 as Q,D as ee,J as Te,d8 as qo,O as F,v as Z,R as Oe,aU as _o,aN as Ce,P as Do,l as He,cU as Eo}from"./index.92f60ec7.js";import{Q as No}from"./QUploader.6d18e55d.js";import{o as Se}from"./optionsNfse.12d4a18d.js";import"./use-file.48ae5cd0.js";const Io=["rgb(255,204,204)","rgb(255,230,204)","rgb(255,255,204)","rgb(204,255,204)","rgb(204,255,230)","rgb(204,255,255)","rgb(204,230,255)","rgb(204,204,255)","rgb(230,204,255)","rgb(255,204,255)","rgb(255,153,153)","rgb(255,204,153)","rgb(255,255,153)","rgb(153,255,153)","rgb(153,255,204)","rgb(153,255,255)","rgb(153,204,255)","rgb(153,153,255)","rgb(204,153,255)","rgb(255,153,255)","rgb(255,102,102)","rgb(255,179,102)","rgb(255,255,102)","rgb(102,255,102)","rgb(102,255,179)","rgb(102,255,255)","rgb(102,179,255)","rgb(102,102,255)","rgb(179,102,255)","rgb(255,102,255)","rgb(255,51,51)","rgb(255,153,51)","rgb(255,255,51)","rgb(51,255,51)","rgb(51,255,153)","rgb(51,255,255)","rgb(51,153,255)","rgb(51,51,255)","rgb(153,51,255)","rgb(255,51,255)","rgb(255,0,0)","rgb(255,128,0)","rgb(255,255,0)","rgb(0,255,0)","rgb(0,255,128)","rgb(0,255,255)","rgb(0,128,255)","rgb(0,0,255)","rgb(128,0,255)","rgb(255,0,255)","rgb(245,0,0)","rgb(245,123,0)","rgb(245,245,0)","rgb(0,245,0)","rgb(0,245,123)","rgb(0,245,245)","rgb(0,123,245)","rgb(0,0,245)","rgb(123,0,245)","rgb(245,0,245)","rgb(214,0,0)","rgb(214,108,0)","rgb(214,214,0)","rgb(0,214,0)","rgb(0,214,108)","rgb(0,214,214)","rgb(0,108,214)","rgb(0,0,214)","rgb(108,0,214)","rgb(214,0,214)","rgb(163,0,0)","rgb(163,82,0)","rgb(163,163,0)","rgb(0,163,0)","rgb(0,163,82)","rgb(0,163,163)","rgb(0,82,163)","rgb(0,0,163)","rgb(82,0,163)","rgb(163,0,163)","rgb(92,0,0)","rgb(92,46,0)","rgb(92,92,0)","rgb(0,92,0)","rgb(0,92,46)","rgb(0,92,92)","rgb(0,46,92)","rgb(0,0,92)","rgb(46,0,92)","rgb(92,0,92)","rgb(255,255,255)","rgb(205,205,205)","rgb(178,178,178)","rgb(153,153,153)","rgb(127,127,127)","rgb(102,102,102)","rgb(76,76,76)","rgb(51,51,51)","rgb(25,25,25)","rgb(0,0,0)"],Be="M5 5 h10 v10 h-10 v-10 z",Uo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAAH0lEQVQoU2NkYGAwZkAFZ5G5jPRRgOYEVDeB3EBjBQBOZwTVugIGyAAAAABJRU5ErkJggg==";var Me=no({name:"QColor",props:{...uo,...co,modelValue:String,defaultValue:String,defaultView:{type:String,default:"spectrum",validator:l=>["spectrum","tune","palette"].includes(l)},formatModel:{type:String,default:"auto",validator:l=>["auto","hex","rgb","hexa","rgba"].includes(l)},palette:Array,noHeader:Boolean,noHeaderTabs:Boolean,noFooter:Boolean,square:Boolean,flat:Boolean,bordered:Boolean,disable:Boolean,readonly:Boolean},emits:["update:modelValue","change"],setup(l,{emit:e}){const{proxy:s}=yo(),{$q:u}=s,a=mo(l,u),{getCache:c}=wo(),E=te(null),q=te(null),w=U(()=>l.formatModel==="auto"?null:l.formatModel.indexOf("hex")!==-1),N=U(()=>l.formatModel==="auto"?null:l.formatModel.indexOf("a")!==-1),P=te(l.formatModel==="auto"?l.modelValue===void 0||l.modelValue===null||l.modelValue===""||l.modelValue.startsWith("#")?"hex":"rgb":l.formatModel.startsWith("hex")?"hex":"rgb"),L=te(l.defaultView),n=te(ue(l.modelValue||l.defaultValue)),x=U(()=>l.disable!==!0&&l.readonly!==!0),z=U(()=>l.modelValue===void 0||l.modelValue===null||l.modelValue===""||l.modelValue.startsWith("#")),y=U(()=>w.value!==null?w.value:z.value),O=U(()=>({type:"hidden",name:l.name,value:n.value[y.value===!0?"hex":"rgb"]})),t=ho(O),d=U(()=>N.value!==null?N.value:n.value.a!==void 0),m=U(()=>({backgroundColor:n.value.rgb||"#000"})),b=U(()=>`q-color-picker__header-content q-color-picker__header-content--${(n.value.a!==void 0&&n.value.a<65?!0:po(n.value)>.4)?"light":"dark"}`),j=U(()=>({background:`hsl(${n.value.h},100%,50%)`})),Fe=U(()=>({top:`${100-n.value.v}%`,[u.lang.rtl===!0?"right":"left"]:`${n.value.s}%`})),ze=U(()=>l.palette!==void 0&&l.palette.length!==0?l.palette:Io),Re=U(()=>"q-color-picker"+(l.bordered===!0?" q-color-picker--bordered":"")+(l.square===!0?" q-color-picker--square no-border-radius":"")+(l.flat===!0?" q-color-picker--flat no-shadow":"")+(l.disable===!0?" disabled":"")+(a.value===!0?" q-color-picker--dark q-dark":"")),Ge=U(()=>l.disable===!0?{"aria-disabled":"true"}:{}),je=U(()=>[[go,Ye,void 0,{prevent:!0,stop:!0,mouse:!0}]]);qe(()=>l.modelValue,r=>{const g=ue(r||l.defaultValue);g.hex!==n.value.hex&&(n.value=g)}),qe(()=>l.defaultValue,r=>{if(!l.modelValue&&r){const g=ue(r);g.hex!==n.value.hex&&(n.value=g)}});function oe(r,g){n.value.hex=_e(r),n.value.rgb=De(r),n.value.r=r.r,n.value.g=r.g,n.value.b=r.b,n.value.a=r.a;const h=n.value[y.value===!0?"hex":"rgb"];e("update:modelValue",h),g===!0&&e("change",h)}function ue(r){const g=N.value!==void 0?N.value:l.formatModel==="auto"?null:l.formatModel.indexOf("a")!==-1;if(typeof r!="string"||r.length===0||fo.anyColor(r.replace(/ /g,""))!==!0)return{h:0,s:0,v:0,r:0,g:0,b:0,a:g===!0?100:void 0,hex:void 0,rgb:void 0};const h=vo(r);return g===!0&&h.a===void 0&&(h.a=100),h.hex=_e(h),h.rgb=De(h),Object.assign(h,ve(h))}function ce(r,g,h){const C=E.value;if(C===null)return;const T=C.clientWidth,v=C.clientHeight,H=C.getBoundingClientRect();let I=Math.min(T,Math.max(0,r-H.left));u.lang.rtl===!0&&(I=T-I);const ae=Math.min(v,Math.max(0,g-H.top)),xe=Math.round(100*I/T),Ve=Math.round(100*Math.max(0,Math.min(1,-(ae/v)+1))),so=Ee({h:n.value.h,s:xe,v:Ve,a:d.value===!0?n.value.a:void 0});n.value.s=xe,n.value.v=Ve,oe(so,h)}function ye(r,g){const h=Math.round(r),C=Ee({h,s:n.value.s,v:n.value.v,a:d.value===!0?n.value.a:void 0});n.value.h=h,oe(C,g)}function Je(r){ye(r,!0)}function D(r,g,h,C,T){if(C!==void 0&&W(C),!/^[0-9]+$/.test(r)){T===!0&&s.$forceUpdate();return}const v=Math.floor(Number(r));if(v<0||v>h){T===!0&&s.$forceUpdate();return}const H={r:g==="r"?v:n.value.r,g:g==="g"?v:n.value.g,b:g==="b"?v:n.value.b,a:d.value===!0?g==="a"?v:n.value.a:void 0};if(g!=="a"){const I=ve(H);n.value.h=I.h,n.value.s=I.s,n.value.v=I.v}if(oe(H,T),C!==void 0&&T!==!0&&C.target.selectionEnd!==void 0){const I=C.target.selectionEnd;Ie(()=>{C.target.setSelectionRange(I,I)})}}function we(r,g){let h;const C=r.target.value;if(W(r),P.value==="hex"){if(C.length!==(d.value===!0?9:7)||!/^#[0-9A-Fa-f]+$/.test(C))return!0;h=ko(C)}else{let v;if(C.endsWith(")"))if(d.value!==!0&&C.startsWith("rgb(")){if(v=C.substring(4,C.length-1).split(",").map(H=>parseInt(H,10)),v.length!==3||!/^rgb\([0-9]{1,3},[0-9]{1,3},[0-9]{1,3}\)$/.test(C))return!0}else if(d.value===!0&&C.startsWith("rgba(")){if(v=C.substring(5,C.length-1).split(","),v.length!==4||!/^rgba\([0-9]{1,3},[0-9]{1,3},[0-9]{1,3},(0|0\.[0-9]+[1-9]|0\.[1-9]+|1)\)$/.test(C))return!0;for(let I=0;I<3;I++){const ae=parseInt(v[I],10);if(ae<0||ae>255)return!0;v[I]=ae}const H=parseFloat(v[3]);if(H<0||H>1)return!0;v[3]=H}else return!0;else return!0;if(v[0]<0||v[0]>255||v[1]<0||v[1]>255||v[2]<0||v[2]>255||d.value===!0&&(v[3]<0||v[3]>1))return!0;h={r:v[0],g:v[1],b:v[2],a:d.value===!0?v[3]*100:void 0}}const T=ve(h);if(n.value.h=T.h,n.value.s=T.s,n.value.v=T.v,oe(h,g),g!==!0){const v=r.target.selectionEnd;Ie(()=>{r.target.setSelectionRange(v,v)})}}function We(r){const g=ue(r),h={r:g.r,g:g.g,b:g.b,a:g.a};h.a===void 0&&(h.a=n.value.a),n.value.h=g.h,n.value.s=g.s,n.value.v=g.v,oe(h,!0)}function Ye(r){r.isFinal?ce(r.position.left,r.position.top,!0):Xe(r)}const Xe=bo(r=>{ce(r.position.left,r.position.top)},20);function Ze(r){ce(r.pageX-window.pageXOffset,r.pageY-window.pageYOffset,!0)}function Ke(r){ce(r.pageX-window.pageXOffset,r.pageY-window.pageYOffset)}function ke(r){q.value!==null&&(q.value.$el.style.opacity=r?1:0)}function $e(r){P.value=r}function eo(){const r=[];return l.noHeaderTabs!==!0&&r.push(p(Ne,{class:"q-color-picker__header-tabs",modelValue:P.value,dense:!0,align:"justify","onUpdate:modelValue":$e},()=>[p(le,{label:"HEX"+(d.value===!0?"A":""),name:"hex",ripple:!1}),p(le,{label:"RGB"+(d.value===!0?"A":""),name:"rgb",ripple:!1})])),r.push(p("div",{class:"q-color-picker__header-banner row flex-center no-wrap"},[p("input",{class:"fit",value:n.value[P.value],...x.value!==!0?{readonly:!0}:{},...c("topIn",{onInput:g=>{ke(we(g)===!0)},onChange:W,onBlur:g=>{we(g,!0)===!0&&s.$forceUpdate(),ke(!1)}})}),p(Qe,{ref:q,class:"q-color-picker__error-icon absolute no-pointer-events",name:u.iconSet.type.negative})])),p("div",{class:"q-color-picker__header relative-position overflow-hidden"},[p("div",{class:"q-color-picker__header-bg absolute-full"}),p("div",{class:b.value,style:m.value},r)])}function oo(){return p(Co,{modelValue:L.value,animated:!0},()=>[p(be,{class:"q-color-picker__spectrum-tab overflow-hidden",name:"spectrum"},lo),p(be,{class:"q-pa-md q-color-picker__tune-tab",name:"tune"},ro),p(be,{class:"q-color-picker__palette-tab",name:"palette"},io)])}function ao(r){L.value=r}function to(){return p("div",{class:"q-color-picker__footer relative-position overflow-hidden"},[p(Ne,{class:"absolute-full",modelValue:L.value,dense:!0,align:"justify","onUpdate:modelValue":ao},()=>[p(le,{icon:u.iconSet.colorPicker.spectrum,name:"spectrum",ripple:!1}),p(le,{icon:u.iconSet.colorPicker.tune,name:"tune",ripple:!1}),p(le,{icon:u.iconSet.colorPicker.palette,name:"palette",ripple:!1})])])}function lo(){const r={ref:E,class:"q-color-picker__spectrum non-selectable relative-position cursor-pointer"+(x.value!==!0?" readonly":""),style:j.value,...x.value===!0?{onClick:Ze,onMousedown:Ke}:{}},g=[p("div",{style:{paddingBottom:"100%"}}),p("div",{class:"q-color-picker__spectrum-white absolute-full"}),p("div",{class:"q-color-picker__spectrum-black absolute-full"}),p("div",{class:"absolute",style:Fe.value},[n.value.hex!==void 0?p("div",{class:"q-color-picker__spectrum-circle"}):null])],h=[p(K,{class:"q-color-picker__hue non-selectable",modelValue:n.value.h,min:0,max:360,trackSize:"8px",innerTrackColor:"transparent",selectionColor:"transparent",readonly:x.value!==!0,thumbPath:Be,"onUpdate:modelValue":ye,onChange:Je})];return d.value===!0&&h.push(p(K,{class:"q-color-picker__alpha non-selectable",modelValue:n.value.a,min:0,max:100,trackSize:"8px",trackColor:"white",innerTrackColor:"transparent",selectionColor:"transparent",trackImg:Uo,readonly:x.value!==!0,hideSelection:!0,thumbPath:Be,...c("alphaSlide",{"onUpdate:modelValue":C=>D(C,"a",100),onChange:C=>D(C,"a",100,void 0,!0)})})),[So("div",r,g,"spec",x.value,()=>je.value),p("div",{class:"q-color-picker__sliders"},h)]}function ro(){return[p("div",{class:"row items-center no-wrap"},[p("div","R"),p(K,{modelValue:n.value.r,min:0,max:255,color:"red",dark:a.value,readonly:x.value!==!0,...c("rSlide",{"onUpdate:modelValue":r=>D(r,"r",255),onChange:r=>D(r,"r",255,void 0,!0)})}),p("input",{value:n.value.r,maxlength:3,readonly:x.value!==!0,onChange:W,...c("rIn",{onInput:r=>D(r.target.value,"r",255,r),onBlur:r=>D(r.target.value,"r",255,r,!0)})})]),p("div",{class:"row items-center no-wrap"},[p("div","G"),p(K,{modelValue:n.value.g,min:0,max:255,color:"green",dark:a.value,readonly:x.value!==!0,...c("gSlide",{"onUpdate:modelValue":r=>D(r,"g",255),onChange:r=>D(r,"g",255,void 0,!0)})}),p("input",{value:n.value.g,maxlength:3,readonly:x.value!==!0,onChange:W,...c("gIn",{onInput:r=>D(r.target.value,"g",255,r),onBlur:r=>D(r.target.value,"g",255,r,!0)})})]),p("div",{class:"row items-center no-wrap"},[p("div","B"),p(K,{modelValue:n.value.b,min:0,max:255,color:"blue",readonly:x.value!==!0,dark:a.value,...c("bSlide",{"onUpdate:modelValue":r=>D(r,"b",255),onChange:r=>D(r,"b",255,void 0,!0)})}),p("input",{value:n.value.b,maxlength:3,readonly:x.value!==!0,onChange:W,...c("bIn",{onInput:r=>D(r.target.value,"b",255,r),onBlur:r=>D(r.target.value,"b",255,r,!0)})})]),d.value===!0?p("div",{class:"row items-center no-wrap"},[p("div","A"),p(K,{modelValue:n.value.a,color:"grey",readonly:x.value!==!0,dark:a.value,...c("aSlide",{"onUpdate:modelValue":r=>D(r,"a",100),onChange:r=>D(r,"a",100,void 0,!0)})}),p("input",{value:n.value.a,maxlength:3,readonly:x.value!==!0,onChange:W,...c("aIn",{onInput:r=>D(r.target.value,"a",100,r),onBlur:r=>D(r.target.value,"a",100,r,!0)})})]):null]}function io(){const r=g=>p("div",{class:"q-color-picker__cube col-auto",style:{backgroundColor:g},...x.value===!0?c("palette#"+g,{onClick:()=>{We(g)}}):{}});return[p("div",{class:"row items-center q-color-picker__palette-rows"+(x.value===!0?" q-color-picker__palette-rows--editable":"")},ze.value.map(r))]}return()=>{const r=[oo()];return l.name!==void 0&&l.disable!==!0&&t(r,"push"),l.noHeader!==!0&&r.unshift(eo()),l.noFooter!==!0&&r.push(to()),p("div",{class:Re.value,...Ge.value},r)}}});const Po={components:{Avatar:Vo},data(){return{certificado:{arquivo:"",senha:""},itemHistoricoIssModelo:{data:"",aliquota:0},itemListaDeServicoModelo:{codigo:"",codigoCNAE:"",codigoNBS:"",codigoTributacao:"",descricao:"",iss:0},itemHistoricoIssModal:!1,itemListaDeServicoModal:!1,dbUsuario:$db.usuario,empresa:{},itemHistoricoIss:{},itemListaDeServico:{},historicoIss:[],itensListaDeServico:[],empresas:[],modalCertificado:!1,modalEmpresa:!1,simENaoOpcoes:Se.opcoesSimNao,naturezaOperacaoOpcoes:Se.opcoesNatureza,regimeTributarioOpcoes:Se.opcoesRegimeEspecialTributacao,resultado:{erro:0,final:"",listaNCMErros:[],percentagem:0,sucesso:0,titulo:"Importando...",total:0,visivel:!1},colunasTabelaHistoricoIss:[{name:"data",label:"Data",field:"data",align:"center"},{name:"aliquota",label:"Aliquota",field:"aliquota",align:"center"},{name:"acao",label:"A\xE7\xF5es",align:"center"}],colunasTabelaItensListaServico:[{name:"codigo",label:"C\xF3digo",field:"codigo",align:"center"},{name:"codigoCNAE",label:"C\xF3digo CNAE",field:"codigoCNAE",align:"center"},{name:"codigoNBS",label:"C\xF3digo NBS",field:"codigoNBS",align:"center"},{name:"codigoTributacao",label:"C\xF3digo de tributa\xE7\xE3o",field:"codigoTributacao",align:"center"},{name:"descricao",label:"Descri\xE7\xE3o",field:"descricao",align:"center"},{name:"iss",label:"Aliquota",field:"iss",align:"center"},{name:"acao",label:"A\xE7\xF5es",align:"center"}],empresaUsuarios:{empresa:"",usuario:[],mostrar:!1}}},methods:{async atualizar(){try{const l=localStorage.getItem("clienteSistema");$utils.verificarErro(!l,"Ocorreu erro ao consultar clienteSistema"),this.clienteSistema=JSON.parse(l);const e=await $db.empresa.leOnlinePlat({codigoClienteSistema:this.clienteSistema.codigoClienteSistema});for(const s of e){const u=await $db.contato.leOnline({codigoContato:s.codigoContato});s.contato=u[0]||{}}this.empresas=e}catch(l){this.$q.notifyError("Ocorreu erro ao consultar empresas",l)}},async abrirPromptContatoEmpresa(){const l=await $g.promptContato.show({filtro:{ativo:!0},placeholder:"Selecione a empresa"});(l||{}).id&&this.criarEmpresa(l.id,l)},abrirModalEmpresa(l){try{this.modalEmpresa=!0,this.empresa=l,this.historicoIss=l.nfseHistoricoIss?JSON.parse(l.nfseHistoricoIss):[],this.itensListaDeServico=l.nfseItensListaDeServico?JSON.parse(l.nfseItensListaDeServico):[]}catch(e){this.$q.notifyError("Ocorreu erro ao abrir empresa",e)}},abrirSiteIbpt(){window.open("https://deolhonoimposto.ibpt.org.br/Site/PassoPasso")},adicionarCertificado(l){this.certificado.arquivo=l[0]},async configurarEmpresa(){var w,N,P,L,n,x,z,y,O,t;const l=new Headers,e=new FormData;let s,u,a,c,E,q;try{a=await $db.configuracoes.le({nome:"integrador.servidor.opcoes"}),E=(P=JSON.parse((N=(w=a==null?void 0:a[0])==null?void 0:w.valor)!=null?N:null))!=null?P:[],E=E.filter(d=>d.motor==="node")}catch(d){console.error(d),$q.notify({type:"negative",message:"Erro ao obter configura\xE7\xE3o 'integrador.servidor.opcoes'."});return}if(q=await $db.contatoEndereco.leEnderecoPrincipal(this.empresa.contato.id),!q.ufCod){$q.notify({message:"Favor completar os dados da empresa (UFCod)!",type:"negative"});return}a=await $db.configuracoes.le({nome:"nfe.homologacao"}),c=((L=a[0])==null?void 0:L.valor)==="1"?2:1,l.append("Content-Type","application/json;charset=utf-8"),e.append("cnpj",(n=this.empresa.numeroDocumentoNacional)==null?void 0:n.replace(/\D/g,"")),e.append("razaoSocial",this.empresa.nome),e.append("certificadoArquivo",this.certificado.arquivo),e.append("certificadoSenha",this.certificado.senha),e.append("ufCod",q.ufCod),e.append("ambiente",c),e.append("identificadorCSC",c===1?this.empresa.hashCSCProducao:this.empresa.hashCSCHomologacao),e.append("tokenCSC",c===1?this.empresa.tokenCSCProducao:this.empresa.tokenCSCHomologacao),e.append("bancoDeDados",localStorage.getItem("bancoDeDados")),e.append("cpfUsuario",(z=(x=$db.usuario)==null?void 0:x.logado)==null?void 0:z.numeroDocumentoNacional),e.append("nomeUsuario",(O=(y=$db.usuario)==null?void 0:y.logado)==null?void 0:O.nome);for(const d of E){let m=this.logPadrao("nfe configurar-empresa");try{if(m.dados={empresa:this.empresa.numeroDocumentoNacional},s=await fetch(`${d.url}/nfe/configurar-empresa`,{method:"POST",mode:"cors",body:e}),u=await s.json(),m.dados.resposta=u,!s.ok)throw new Error((u==null?void 0:u.message)||(u==null?void 0:u.error)||"Erro desconhecido");if(m.mensagem=`${d.descricao}|NF-e: ${u.xMotivo}`,u.cStat==="1")$q.notify({type:"positive",message:m.mensagem});else throw new Error(`GError:${u.xMotivo}`)}catch(b){/GError:.+/.test(b.message)?(m.mensagem=`${d.descricao}|NF-e: ${b.message.slice(7)}`,$q.notify({type:"negative",message:m.mensagem})):(m.mensagem=`${d.descricao}|NF-e: N\xE3o foi poss\xEDvel concluir a opera\xE7\xE3o.`,$q.notify({type:"negative",message:m.mensagem}))}finally{$db.log.gravar(m)}m=this.logPadrao("nfse configurar-empresa");try{if(m.dados={empresa:this.empresa.numeroDocumentoNacional},s=await fetch(`${d.url}/nfse/configurar-empresa`,{method:"POST",headers:l,mode:"cors",body:JSON.stringify({cnpj:(t=this.empresa.numeroDocumentoNacional)==null?void 0:t.replace(/\D/g,""),razaoSocial:this.empresa.nome,certificadoSenha:this.certificado.senha,ibgeCod:q.ibgeCod,ambiente:1})}),u=await s.json(),m.dados.resposta=u,!s.ok)throw new Error((u==null?void 0:u.message)||"Erro desconhecido");if(m.mensagem=`${d.descricao}|NFS-e: ${u.xMotivo}`,u.cStat==="1"&&$q.notify({type:"positive",message:m.mensagem}),u.cStat!=="1")throw new Error(`GError:${u.xMotivo}`)}catch(b){/GError:.+/.test(b.message)?(m.mensagem=`${d.descricao}|NFS-e: ${b.message.slice(7)}`,$q.notify({type:"negative",message:m.mensagem})):(m.mensagem=`${d.descricao}|NFS-e: N\xE3o foi poss\xEDvel concluir a opera\xE7\xE3o.`,$q.notify({type:"negative",message:m.mensagem}))}finally{$db.log.gravar(m)}}},async enviarCertificado(){var u,a,c,E,q,w,N,P,L,n,x,z;const l=this.logPadrao("enviarCertificado");await $db.contatoEndereco.leEnderecoPrincipal(this.empresa.contato.id),await $erp().contato.get(this.empresa.contato.id);let e=!1;(u=this.empresa)!=null&&u.nfseCodigoServico&&(e=!0),$utils.verificarErro(!this.certificado.arquivo,"Certificado n\xE3o selecionado"),$utils.verificarErro(!this.certificado.senha,"Senha obrigat\xF3ria"),await this.configurarEmpresa(),this.certificado.error={};let s;if(s=!0,!s){const y=await $db.configuracoes.leValorComFiltroEmpresa("nfse.motor");s=(y==null?void 0:y.toLowerCase())==="plugnotas"}if(l.dados={emiteNFSe:e,plugNotas:s},e&&s){let y,O,t,d,m,b;if(y=await $api.plugnotas.certificado.cadastrar(this.certificado.arquivo,this.certificado.senha),O=(w=(a=y==null?void 0:y.data)==null?void 0:a.id)!=null?w:(q=(E=(c=y==null?void 0:y.error)==null?void 0:c.data)==null?void 0:E.current)==null?void 0:q.id,!O&&((N=y==null?void 0:y.error)==null?void 0:N.message)){l.mensagem=`PlugNotas: ${(P=y==null?void 0:y.error)==null?void 0:P.message}`,$q.notifyError(l.mensagem),$db.log.gravar(l);return}t=(L=this.empresa.numeroDocumentoNacional)==null?void 0:L.replace(/\D/g,""),d=await $api.plugnotas.empresa.consultar(t),m=await this.cadastrarEmpresaPlugNotas(O),((x=(n=d==null?void 0:d.error)==null?void 0:n.data)==null?void 0:x.cpfCnpj)===t&&(b=await $api.plugnotas.empresa.cadastrar(m)),d!=null&&d.cpfCnpj&&(b=await $api.plugnotas.empresa.alterar(d.cpfCnpj,m)),l.dados={empresaPlugNotas:m,cadastro:b},(z=b==null?void 0:b.error)!=null&&z.message&&(l.mensagem=`PlugNotas: ${b.error.message}`,$q.notifyError(l.mensagem),this.certificado.error=b.error),b!=null&&b.message&&(l.mensagem=`PlugNotas: ${b.message}`,$q.notifyPositive(l.mensagem),this.modalCertificado=!1)}$db.log.gravar(l)},async cadastrarEmpresaPlugNotas(l){var w,N;const e=await $db.contato.le({id:this.empresa.contato.id}),s=await $db.contatoEndereco.leEnderecoPrincipal(this.empresa.contato.id);let a=(await $erp().contatoTelefone.where("idContato").equals(this.empresa.contato.id).toArray()||[]).find(P=>P.tipoTelefone==="Principal"),c=a.telefone.substr(0,2),E=a.telefone.substr(3);return{cpfCnpj:(w=this.empresa.contato.numeroDocumentoNacional)==null?void 0:w.replace(/\D/g,""),inscricaoMunicipal:e.numeroDocumentoMunicipal,inscricaoEstadual:(N=this.empresa.numeroDocumentoEstadual)!=null?N:null,razaoSocial:this.empresa.contato.nome,nomeFantasia:this.empresa.contato.apelido,certificado:l,simplesNacional:!0,regimeTributario:1,incentivoFiscal:!0,incentivadorCultural:!0,regimeTributarioEspecial:5,endereco:{bairro:s.bairro,cep:s.cep,codigoCidade:s.ibgeCod,estado:s.uf,logradouro:s.logradouro,numero:s.numero,tipoLogradouro:"Logradouro",codigoPais:s.codigoPais,complemento:s.complemento,descricaoCidade:s.municipio,descricaoPais:s.pais},telefone:{numero:`${E}`,ddd:`${c}`},email:e.emailNfe||e.email,nfse:{ativo:!0,tipoContrato:0,config:{producao:!0,rps:{lote:1,numeracao:[{numero:1,serie:"1"}]},email:{envio:!0},calculoAutomaticoIbpt:{ativo:!0}}}}},async removerEmpresa(l){$q.dialog({title:"Tem certeza?",message:"Ao continuar voc\xEA ir\xE1 remover esta empresa.",preventClose:!0,cancel:{label:"Cancelar",push:!0,color:"tertiary",flat:!0},ok:{label:"Remover",push:!0,class:"bg-negative",textColor:"white",flat:!0}}).onOk(async()=>{const e=this.logPadrao("removerEmpresa");try{$q.loading.show(),await $db.empresa.removeOnline(l),e.documentoId=l.id,e.dados=l,await this.atualizar(),e.mensagem="A empresa foi removida com sucesso.",$q.notifyPositive(e.mensagem)}catch(s){e.mensagem="Ocorreu um erro ao remover empresa",$q.notifyError(e.mensagem,s),e.mensagem+=" - "+s.toString()}finally{$q.loading.hide(),$db.log.gravar(e)}})},async criarEmpresa(l,e){const s=this.logPadrao("criarEmpresa");try{if(!l)return;const a={...this.empresas.find(c=>c.idContato===e.id)||{},idContato:e.id,codigoContato:e.codigoContato,nome:e.nome,apelido:e.apelido,numeroDocumentoNacional:e.numeroDocumentoNacional,numeroDocumentoEstadual:e.numeroDocumentoEstadual,codigoClienteSistema:this.clienteSistema.codigoClienteSistema,idClienteSistema:this.clienteSistema.idClienteSistema};s.dados=a,await $db.empresa.gravaOnline({atual:a}),await this.atualizar(),s.mensagem="Empresa salva com sucesso",$q.notifyPositive(s.mensagem)}catch(u){s.mensagem="Ocorreu erro ao salvar empresa",$q.notifyError(s.mensagem,u),s.mensagem+=" - "+u.toString()}finally{$db.log.gravar(s)}},async gravarEmpresa(){const l=this.logPadrao("gravarEmpresa");try{this.empresa.nfseHistoricoIss=JSON.stringify(this.historicoIss),this.empresa.nfseItensListaDeServico=JSON.stringify(this.itensListaDeServico);const e={...this.empresa,idContato:this.empresa.contato.id,codigoClienteSistema:this.clienteSistema.codigoClienteSistema,idClienteSistema:this.clienteSistema.idClienteSistema};l.dados=e,await $db.empresa.gravaOnline({atual:e}),await this.atualizar(),l.mensagem="Empresa salva com sucesso",$q.notifyPositive(l.mensagem),this.modalEmpresa=!1}catch(e){l.mensagem="Ocorreu erro ao salvar empresa",this.$q.notifyError(l.mensagem,e),l.mensagem+=" - "+e.toString()}finally{$db.log.gravar(l)}},async empresaUsuarios_click(l){this.clienteSistema=JSON.parse(localStorage.getItem("clienteSistema"))||{};const e=await $utils.geeksApi({grupo:{funcao:"9C93290F-BEDD-4051-A0F5-FA01D961CCF4",codigoClienteSistema:this.clienteSistema.codigoClienteSistema},usuario:{funcao:"E4E43C26-D0B7-4CFB-9F13-BBFA9F11E847",codigoClienteSistema:this.clienteSistema.codigoClienteSistema},permissao:{funcao:"E0982E1C-87EC-4506-8293-675407D3312C",empresaCnpj:l.numeroDocumentoNacional}});for(const s of e.data.usuario)s.ativo=!!e.data.permissao.find(u=>u.usuarioCpf===s.numeroDocumentoNacional),s.ativoOriginal=s.ativo;this.empresaUsuarios.grupo=e.data.grupo.sort((s,u)=>{var a,c;return((a=s.descricao)==null?void 0:a.toLowerCase())<((c=u.descricao)==null?void 0:c.toLowerCase())?-1:1}).map(s=>(s.ativo=!1,s.aberto=!0,s)),this.empresaUsuarios.usuario=e.data.usuario.sort((s,u)=>{var a,c;return((a=s.nome)==null?void 0:a.toLowerCase())<((c=u.nome)==null?void 0:c.toLowerCase())?-1:1}),this.empresaUsuarios.empresa=$utils.clonarV2(l),this.empresaUsuarios.empresa.ativo=!1,this.empresaUsuarios.mostrar=!this.empresaUsuarios.mostrar,this.empresaUsuarios_pai_atualizar()},async empresaUsuarios_gravar_click(l){const e=[],s=[];for(const u of this.empresaUsuarios.usuario)u.ativo!==u.ativoOriginal&&(u.ativo?e.push(u.numeroDocumentoNacional):s.push(u.numeroDocumentoNacional));console.log("ativar",e,e.join(",")),console.log("inativar",s,s.join(",")),await $utils.geeksApi({ret:{funcao:"A28E375E-DD31-4580-B8CF-07F6D2254044",ativar:e,inativar:s,empresaCnpj:this.empresaUsuarios.empresa.numeroDocumentoNacional}})},empresaUsuarios_ativar_todos_click(l,e){l==="empresa"&&(this.empresaUsuarios.grupo.forEach(s=>{s.ativo=this.empresaUsuarios.empresa.ativo}),this.empresaUsuarios.usuario.forEach(s=>{s.ativo=this.empresaUsuarios.empresa.ativo})),l==="grupo"&&this.empresaUsuarios.usuario.filter(s=>s.codigoGrupo===e.codigoGrupo).forEach(s=>{s.ativo=e.ativo}),this.empresaUsuarios_pai_atualizar()},empresaUsuarios_pai_atualizar(){let l=this.empresaUsuarios.usuario[0].ativo;for(const e of this.empresaUsuarios.usuario)if(e.ativo!==l){l=null;break}this.empresaUsuarios.empresa.ativo=l;for(const e of this.empresaUsuarios.grupo){let s=this.empresaUsuarios.usuario.filter(u=>u.codigoGrupo===e.codigoGrupo)[0].ativo;for(const u of this.empresaUsuarios.usuario.filter(a=>a.codigoGrupo===e.codigoGrupo))if(u.ativo!==s){s=null;break}e.ativo=s}},adicionarHistorico(){if(this.itemHistoricoIss.data.length!==10){this.$q.notifyError("A data precisa ser v\xE1lida");return}this.historicoIss.push(this.itemHistoricoIss),this.itemHistoricoIssModal=!1},adicionarItemListaDeServico(){if(!this.itemListaDeServico.codigo||!this.itemListaDeServico.codigoCNAE||!this.itemListaDeServico.codigoNBS||!this.itemListaDeServico.codigoTributacao||!this.itemListaDeServico.descricao||!this.itemListaDeServico.iss){this.$q.notifyError("Preencha os campos");return}this.itemListaDeServico.id===void 0?this.itensListaDeServico.push(this.itemListaDeServico):this.itensListaDeServico[this.itemListaDeServico.id]={codigo:this.itemListaDeServico.codigo,codigoCNAE:this.itemListaDeServico.codigoCNAE,codigoNBS:this.itemListaDeServico.codigoNBS,codigoTributacao:this.itemListaDeServico.codigoTributacao,descricao:this.itemListaDeServico.descricao,iss:this.itemListaDeServico.iss},this.itemListaDeServicoModal=!1},removerHistoricoIss(l){this.historicoIss.splice(l,1)},removerItemListaDeServico(l){this.itensListaDeServico[l].codigo===this.empresa.nfseCodigoServico?$q.dialog({title:"Deletar item da lista de servi\xE7o",message:"Esse item est\xE1 sendo usado nos valores padr\xF5es, ao deletar o mesmo ser\xE1 eliminado, deseja continuar?",cancel:!0}).onOk(()=>{this.empresa.nfseCodigoServico="",this.itensListaDeServico.splice(l,1)}):this.itensListaDeServico.splice(l,1)},editarItemListaDeServico(l){const e=this.itensListaDeServico[l];e.id=l,this.itemListaDeServico={...e},this.itemListaDeServicoModal=!0},logPadrao(l){var e;return{documentoTipo:"Configura\xE7\xE3o Empresas",documentoId:(e=this.empresa)==null?void 0:e.id,mensagem:l,dados:{}}}},created(){this.atualizar()}},Lo={class:"ConfiguracoesEmpresas u-container"},Ao={class:"q-mt-md no-shadow"},To={class:"col text-body1"},Oo={class:"col text-body1"},Ho={class:"col text-body1"},Bo={class:"q-pr-md"},Mo={key:0,class:"q-pr-md"},Qo={key:0,class:"q-mt-md text-center"},Fo={class:"layout-padding q-pa-none q-pb-md"},zo={class:"u-container"},Ro={class:"col-12 col-md-4"},Go={class:"row items-center"},jo={class:"col-12 col-md-4"},Jo={class:"row items-center"},Wo={class:"row justify-between",style:{width:"100%"}},Yo={class:"row justify-between",style:{width:"100%"}},Xo={class:"row q-ma-md"},Zo={key:0,class:"row q-ma-md"},Ko={class:"certificado-error-messages"},$o={class:"col-6 col-sm-9 text-subtitle text-tertiary"},ea={class:"col-6 col-sm-9 text-subtitle text-tertiary"},oa={class:"col-6 col-sm-9 text-subtitle text-tertiary"},aa={class:"col-12 text-subtitle text-tertiary text-weight-bold"};function ta(l,e,s,u,a,c){var y,O;const E=R("avatar"),q=R("row"),w=R("campo"),N=R("SeletorContato"),P=R("card"),L=R("g-col"),n=R("g-label"),x=R("g-row"),z=R("badge");return _(),A("div",Lo,[f("div",Ao,[(_(!0),A($,null,re(a.empresas,t=>(_(),Y(M,{class:"extratoItem bg-white q-mb-md q-pa-md",key:t.id},{default:i(()=>[o(ie,null,{default:i(()=>[o(E,{imagem:t.contato.imagem,rotulo:t.apelido,tamanho:"40",class:"float-left"},null,8,["imagem","rotulo"]),o(se,null,{default:i(()=>[f("div",null,S(t.nome),1),o(q,{class:"q-col-gutter-md"},{default:i(()=>[f("div",To,S(t.apelido),1),f("div",Oo,S(t.numeroDocumentoNacional),1),f("div",Ho,[f("span",Bo,[e[44]||(e[44]=V("Ativa: ")),f("b",null,S(t.ativo?"Sim":"N\xE3o"),1)]),t.sigla?(_(),A("span",Mo,[e[45]||(e[45]=V("Sigla: ")),f("b",null,S(t.sigla),1)])):X("",!0)])]),_:2},1024)]),_:2},1024),o(k,{onClick:d=>c.abrirModalEmpresa(t),icon:"edit",size:"md",color:"primary",round:"",flat:"",dense:"",class:"q-ma-xs"},null,8,["onClick"]),o(k,{onClick:d=>c.empresaUsuarios_click(t),icon:"manage_accounts",size:"md",color:"primary",round:"",flat:"",dense:"",class:"q-ma-xs"},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128)),[1,2].includes((O=(y=a.dbUsuario)==null?void 0:y.logado)==null?void 0:O.grupoInterno)?(_(),A("div",Qo,[o(k,{onClick:c.abrirPromptContatoEmpresa,icon:"add",size:"sm",label:"Empresa",color:"positive",outline:""},null,8,["onClick"])])):X("",!0)]),o(ee,{modelValue:a.modalEmpresa,"onUpdate:modelValue":e[26]||(e[26]=t=>a.modalEmpresa=t),maximized:""},{default:i(()=>[o(de,{class:"bg-light",container:""},{default:i(()=>[f("form",{onSubmit:e[25]||(e[25]=Ue((...t)=>c.gravarEmpresa&&c.gravarEmpresa(...t),["prevent"]))},[o(me,null,{default:i(()=>[o(ie,null,{default:i(()=>[B(o(k,{flat:"",round:"",dense:"",icon:"arrow_back"},null,512),[[J]]),o(se,null,{default:i(()=>[V(S(a.empresa.nome),1)]),_:1}),o(k,{class:"q-ml-sm no-shadow",color:"white","text-color":"primary",label:"Salvar",type:"submit",unelevated:""})]),_:1})]),_:1}),o(pe,null,{default:i(()=>[f("div",Fo,[f("div",zo,[o(M,{class:"q-pa-md q-pa-md q-mt-md bg-white no-shadow"},{default:i(()=>[o(q,{class:"q-col-gutter-md items-center"},{default:i(()=>[!!a.dbUsuario.logado.administrador&&[1,2].includes(a.dbUsuario.logado.grupoInterno)?(_(),Y(w,{key:0,modelValue:a.empresa.ativo,"onUpdate:modelValue":e[0]||(e[0]=t=>a.empresa.ativo=t),class:"col-12 col-md-4",maxlength:"1",rotulo:"Ativo",tipo:"logico"},null,8,["modelValue"])):X("",!0),f("div",Ro,[f("div",Go,[B(o(Me,{modelValue:a.empresa.corPrincipal,"onUpdate:modelValue":e[1]||(e[1]=t=>a.empresa.corPrincipal=t),ref:"corPrincipal","format-model":"hex",modal:"",clearable:"","ok-label":"Ok","cancel-label":"Cancelar"},null,8,["modelValue"]),[[he,!1]]),o(k,{class:"col-auto",style:Pe({color:a.empresa.corPrincipal}),flat:"",icon:"mdi-circle",size:"xl",onClick:e[2]||(e[2]=t=>l.$refs.corPrincipal.show())},null,8,["style"]),e[46]||(e[46]=f("div",{class:"col no-wrap"},"Cor principal",-1))])]),f("div",jo,[f("div",Jo,[B(o(Me,{modelValue:a.empresa.corSecundaria,"onUpdate:modelValue":e[3]||(e[3]=t=>a.empresa.corSecundaria=t),ref:"corSecundaria","format-model":"hex",modal:"",clearable:"","ok-label":"Ok","cancel-label":"Cancelar"},null,8,["modelValue"]),[[he,!1]]),o(k,{class:"col-auto",style:Pe({color:a.empresa.corSecundaria}),flat:"",icon:"mdi-circle",size:"xl",onClick:e[4]||(e[4]=t=>l.$refs.corSecundaria.show())},null,8,["style"]),e[47]||(e[47]=f("div",{class:"col no-wrap"},"Cor secundaria",-1))])])]),_:1}),o(q,{class:"q-col-gutter-md"},{default:i(()=>[o(w,{modelValue:a.empresa.sigla,"onUpdate:modelValue":e[5]||(e[5]=t=>a.empresa.sigla=t),class:"col-12 col-md-4",maxlength:"5",rotulo:"Sigla"},null,8,["modelValue"]),o(N,{modelValue:a.empresa.idPai,"onUpdate:modelValue":e[6]||(e[6]=t=>a.empresa.idPai=t),class:"col-12 col-md-8",filtro:{ativo:!0,empresas:!0},rotulo:"Grupo",onSelecionar:e[7]||(e[7]=t=>a.empresa.codigoPai=t.codigoContato)},null,8,["modelValue"])]),_:1})]),_:1}),o(M,{class:"q-pa-md q-pa-md q-mt-md bg-white no-shadow"},{default:i(()=>[o(q,{class:"q-col-gutter-md"},{default:i(()=>[e[48]||(e[48]=f("div",{class:"col-12 text-subtitle text-tertiary text-weight-bold"},"Token de atualiza\xE7\xE3o de al\xEDquotas para calculo do valor aproximado dos tributos",-1)),o(w,{modelValue:a.empresa.tokenIBPT,"onUpdate:modelValue":e[8]||(e[8]=t=>a.empresa.tokenIBPT=t),class:"col-12",maxlength:"64",rotulo:"Token IBPT (ibpt.com.br)"},null,8,["modelValue"]),o(k,{label:"Site para obter o token",color:"primary",flat:"",icon:"vpn_key",onClick:c.abrirSiteIbpt},null,8,["onClick"])]),_:1})]),_:1}),o(M,{class:"q-pa-md q-pa-md q-mt-md bg-white no-shadow"},{default:i(()=>[o(q,{class:"q-col-gutter-md"},{default:i(()=>[e[49]||(e[49]=f("div",{class:"col-12 text-subtitle text-tertiary text-weight-bold"},"Dados para gera\xE7\xE3o do QRCode da NFC-e",-1)),o(w,{modelValue:a.empresa.tokenCSCProducao,"onUpdate:modelValue":e[9]||(e[9]=t=>a.empresa.tokenCSCProducao=t),class:"col-12 col-md-4",maxlength:"6",rotulo:"Token CSC Produ\xE7\xE3o"},null,8,["modelValue"]),o(w,{modelValue:a.empresa.hashCSCProducao,"onUpdate:modelValue":e[10]||(e[10]=t=>a.empresa.hashCSCProducao=t),class:"col-12 col-md-8",maxlength:"50",rotulo:"Hash CSC Produ\xE7\xE3o"},null,8,["modelValue"]),o(w,{modelValue:a.empresa.tokenCSCHomologacao,"onUpdate:modelValue":e[11]||(e[11]=t=>a.empresa.tokenCSCHomologacao=t),class:"col-12 col-md-4",maxlength:"6",rotulo:"Token CSC Homologa\xE7\xE3o"},null,8,["modelValue"]),o(w,{modelValue:a.empresa.hashCSCHomologacao,"onUpdate:modelValue":e[12]||(e[12]=t=>a.empresa.hashCSCHomologacao=t),class:"col-12 col-md-8",maxlength:"50",rotulo:"Hash CSC Homologa\xE7\xE3o"},null,8,["modelValue"])]),_:1})]),_:1}),o(M,{class:"q-pa-md q-pa-md q-mt-md bg-white no-shadow"},{default:i(()=>[o(q,{class:"q-col-gutter-md"},{default:i(()=>[e[51]||(e[51]=f("div",{class:"col-12 text-subtitle text-tertiary text-weight-bold"}," Dados padr\xF5es para serem utilizados na cria\xE7\xE3o de uma NFS-e ",-1)),o(ne,{class:"col-12 col-md-3",modelValue:a.empresa.nfseOptanteSimples,"onUpdate:modelValue":e[13]||(e[13]=t=>a.empresa.nfseOptanteSimples=t),label:"Optante Simples Nacional",options:[{label:"Sim",value:"1"},{label:"N\xE3o",value:"2"}],"emit-value":"","map-options":"",dense:""},null,8,["modelValue"]),o(ne,{class:"col-12 col-md-3",modelValue:a.empresa.nfseIncentivadorCultural,"onUpdate:modelValue":e[14]||(e[14]=t=>a.empresa.nfseIncentivadorCultural=t),label:"Incentivador Cultural",options:a.simENaoOpcoes,"emit-value":"","map-options":"",dense:""},null,8,["modelValue","options"]),o(ne,{class:"col-12 col-md-3",modelValue:a.empresa.nfseNaturezaOperacao,"onUpdate:modelValue":e[15]||(e[15]=t=>a.empresa.nfseNaturezaOperacao=t),label:"Natureza da Opera\xE7\xE3o",options:a.naturezaOperacaoOpcoes,"emit-value":"","map-options":"",dense:""},null,8,["modelValue","options"]),o(ne,{class:"col-12 col-md-3",modelValue:a.empresa.nfseRegimeTributario,"onUpdate:modelValue":e[16]||(e[16]=t=>a.empresa.nfseRegimeTributario=t),label:"Regime Especial Tributa\xE7\xE3o",options:a.regimeTributarioOpcoes,"emit-value":"","map-options":"",dense:""},null,8,["modelValue","options"]),o(w,{class:"col-12 col-md-3",modelValue:a.empresa.nfseDescricaoServico,"onUpdate:modelValue":e[17]||(e[17]=t=>a.empresa.nfseDescricaoServico=t),rotulo:"Descri\xE7\xE3o do Servi\xE7o"},null,8,["modelValue"]),o(ne,{class:"col-12 col-md-3",modelValue:a.empresa.nfseCodigoServico,"onUpdate:modelValue":e[18]||(e[18]=t=>a.empresa.nfseCodigoServico=t),options:a.itensListaDeServico,label:"C\xF3digo de Item da Lista e Servi\xE7o","option-label":"descricao","option-value":"codigo","map-options":"","emit-value":"",dense:""},{"no-option":i(()=>[o(ge,null,{default:i(()=>[o(G,null,{default:i(()=>[o(fe,null,{default:i(()=>e[50]||(e[50]=[V("Nenhuma op\xE7\xE3o. Por favor, cadastre um item")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","options"]),o(w,{class:"col-12 col-md-3",rotulo:"Aliquota",value:"2",suffix:"%",decimals:"2",tipo:"decimal",modelValue:a.empresa.nfseAliquotaIss,"onUpdate:modelValue":e[19]||(e[19]=t=>a.empresa.nfseAliquotaIss=t)},null,8,["modelValue"]),o(w,{modelValue:a.empresa.nRps,"onUpdate:modelValue":e[20]||(e[20]=t=>a.empresa.nRps=t),class:"col-4 col-md-4",maxlength:"6",rotulo:"Numero RPS"},null,8,["modelValue"]),o(w,{modelValue:a.empresa.serieRps,"onUpdate:modelValue":e[21]||(e[21]=t=>a.empresa.serieRps=t),class:"col-4 col-md-8",maxlength:"6",rotulo:"S\xE9rie RPS"},null,8,["modelValue"])]),_:1})]),_:1}),o(M,{class:"q-pa-md q-pa-md q-mt-md bg-white no-shadow"},{default:i(()=>[o(Le,{rows:a.historicoIss,columns:a.colunasTabelaHistoricoIss,"row-key":"name"},{top:i(()=>[f("div",Wo,[e[52]||(e[52]=f("div",{class:"text-subtitle text-tertiary text-weight-bold"}," Hist\xF3rico ISS ",-1)),o(k,{label:"Novo",icon:"add",color:"primary",onClick:e[22]||(e[22]=t=>(a.itemHistoricoIss={...a.itemHistoricoIssModelo},a.itemHistoricoIssModal=!0))})])]),body:i(t=>[o(Ae,{props:t},{default:i(()=>[o(Q,{key:"data",props:t},{default:i(()=>[V(S(t.row.data),1)]),_:2},1032,["props"]),o(Q,{key:"aliquota",props:t},{default:i(()=>[V(S(t.row.aliquota)+" % ",1)]),_:2},1032,["props"]),o(Q,{key:"acao",props:t},{default:i(()=>[o(k,{icon:"delete",color:"red",flat:"",onClick:d=>c.removerHistoricoIss(t.rowIndex)},null,8,["onClick"])]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"])]),_:1}),o(M,{class:"q-pa-md q-pa-md q-mt-md bg-white no-shadow"},{default:i(()=>[o(Le,{rows:a.itensListaDeServico,columns:a.colunasTabelaItensListaServico,"row-key":"name"},{top:i(()=>[f("div",Yo,[e[53]||(e[53]=f("div",{class:"text-subtitle text-tertiary text-weight-bold"}," Itens da Lista de Servi\xE7o ",-1)),o(k,{label:"Novo",icon:"add",color:"primary",onClick:e[23]||(e[23]=t=>(a.itemListaDeServico={...a.itemListaDeServicoModelo},a.itemListaDeServicoModal=!0))})])]),body:i(t=>[o(Ae,{props:t},{default:i(()=>[o(Q,{key:"codigo",props:t},{default:i(()=>[V(S(t.row.codigo),1)]),_:2},1032,["props"]),o(Q,{key:"codigoCNAE",props:t},{default:i(()=>[V(S(t.row.codigoCNAE),1)]),_:2},1032,["props"]),o(Q,{key:"codigoNBS",props:t},{default:i(()=>[V(S(t.row.codigoNBS),1)]),_:2},1032,["props"]),o(Q,{key:"codigoTributacao",props:t},{default:i(()=>[V(S(t.row.codigoTributacao),1)]),_:2},1032,["props"]),o(Q,{key:"descricao",props:t},{default:i(()=>[V(S(t.row.descricao),1)]),_:2},1032,["props"]),o(Q,{key:"iss",props:t},{default:i(()=>[V(S(t.row.iss)+" % ",1)]),_:2},1032,["props"]),o(Q,{key:"acao",props:t},{default:i(()=>[o(k,{icon:"edit",color:"primary",flat:"",onClick:d=>c.editarItemListaDeServico(t.rowIndex)},null,8,["onClick"]),o(k,{icon:"delete",color:"red",flat:"",onClick:d=>c.removerItemListaDeServico(t.rowIndex)},null,8,["onClick"])]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"])]),_:1}),o(M,{class:"q-pa-md q-pa-md q-mt-md bg-white no-shadow"},{default:i(()=>[o(q,{class:"q-col-gutter-md"},{default:i(()=>[e[54]||(e[54]=f("div",{class:"col-12 text-subtitle text-tertiary text-weight-bold"},"Certificado digital",-1)),o(k,{label:"Upload certificado",color:"primary",flat:"",icon:"vpn_key",onClick:e[24]||(e[24]=t=>{a.modalCertificado=!0,a.certificado.error={},a.certificado.senha=""})})]),_:1})]),_:1})])])]),_:1})],32)]),_:1})]),_:1},8,["modelValue"]),o(ee,{modelValue:a.modalCertificado,"onUpdate:modelValue":e[29]||(e[29]=t=>a.modalCertificado=t)},{default:i(()=>[o(de,{container:"",class:"bg-light",style:{height:"40vh",width:"50vw","max-width":"100vw"}},{default:i(()=>[f("form",{onSubmit:e[28]||(e[28]=Ue(t=>l.tryLoading(c.enviarCertificado),["prevent"]))},[o(me,null,{default:i(()=>[o(ie,null,{default:i(()=>[B(o(k,{flat:"",round:"",dense:"",icon:"arrow_back"},null,512),[[J]]),o(se,null,{default:i(()=>e[55]||(e[55]=[V("Upload certificado digital")])),_:1}),o(k,{color:"white","text-color":"primary",label:"Enviar",type:"submit",unelevated:""})]),_:1})]),_:1}),o(pe,{class:"u-container"},{default:i(()=>[o(Te,null,{default:i(()=>{var t,d,m;return[f("div",Xo,[o(No,{class:"col-12","hide-upload-btn":"","auto-upload":"",factory:c.adicionarCertificado,filter:b=>b.filter(j=>j.type==="application/x-pkcs12")},null,8,["factory","filter"]),o(w,{modelValue:a.certificado.senha,"onUpdate:modelValue":e[27]||(e[27]=b=>a.certificado.senha=b),class:"col-12 q-mt-lg",rotulo:"Senha",type:"password",autofocus:""},null,8,["modelValue"])]),Object.keys((m=(d=(t=a.certificado.error)==null?void 0:t.data)==null?void 0:d.fields)!=null?m:{}).length?(_(),A("div",Zo,[f("ul",Ko,[(_(!0),A($,null,re(Object.keys(a.certificado.error.data.fields),b=>(_(),A("li",{key:b},[f("span",null,S(b),1),f("span",null,S(a.certificado.error.data.fields[b]),1)]))),128))])])):X("",!0)]}),_:1})]),_:1})],32)]),_:1})]),_:1},8,["modelValue"]),o(ee,{modelValue:a.resultado.visivel,"onUpdate:modelValue":e[30]||(e[30]=t=>a.resultado.visivel=t),"content-css":{width:"100vw",maxWidth:"768px"}},{default:i(()=>[o(de,{container:"",class:"bg-light"},{default:i(()=>[o(me,null,{default:i(()=>[o(ie,null,{default:i(()=>[B(o(k,{flat:"",round:"",dense:"",icon:"arrow_back"},null,512),[[J]]),o(se,null,{default:i(()=>[V(S(a.resultado.titulo),1)]),_:1}),B(o(k,{color:"white","text-color":"primary",label:a.resultado.percentagem>=99.9?"Fechar":"Parar",unelevated:""},null,8,["label"]),[[J]])]),_:1})]),_:1}),o(pe,{class:"u-container"},{default:i(()=>[o(Te,null,{default:i(()=>[o(P,null,{default:i(()=>[o(q,null,{default:i(()=>[e[57]||(e[57]=f("div",{class:"col-6 col-sm-3 text-subtitle text-tertiary text-weight-bold"},"Total de NCMs:",-1)),f("div",$o,S(a.resultado.total),1),e[58]||(e[58]=f("div",{class:"col-6 col-sm-3 text-subtitle text-tertiary text-weight-bold"},"Sucesso:",-1)),f("div",ea,S(a.resultado.sucesso),1),e[59]||(e[59]=f("div",{class:"col-6 col-sm-3 text-subtitle text-tertiary text-weight-bold"},"Erro(s):",-1)),f("div",oa,S(a.resultado.erro),1),a.resultado.listaNCMErros.length>0?(_(),A($,{key:0},[e[56]||(e[56]=f("div",{class:"col-12 text-subtitle text-tertiary text-weight-bold"},"Os NCMs abaixo n\xE3o foram validados no servidor do IBPT:",-1)),(_(!0),A($,null,re(a.resultado.listaNCMErros,(t,d)=>(_(),A("div",{key:d,class:"col-12 text-subtitle text-tertiary"},"'"+S(t)+"'",1))),128))],64)):X("",!0),o(qo,{class:"col-12 q-my-md",percentage:a.resultado.percentagem,color:"primary"},null,8,["percentage"]),f("div",aa,S(a.resultado.final),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(ee,{modelValue:a.itemHistoricoIssModal,"onUpdate:modelValue":e[33]||(e[33]=t=>a.itemHistoricoIssModal=t)},{default:i(()=>[o(M,{style:{"min-width":"350px"}},{default:i(()=>[o(F,null,{default:i(()=>e[60]||(e[60]=[f("div",{class:"text-h6"},"Adicionar Hist\xF3rico ISS",-1)])),_:1}),o(F,{class:"q-pt-none"},{default:i(()=>[o(Z,{dense:"",modelValue:a.itemHistoricoIss.data,"onUpdate:modelValue":e[31]||(e[31]=t=>a.itemHistoricoIss.data=t),label:"Data",mask:"##/##/####"},null,8,["modelValue"])]),_:1}),o(F,{class:"q-pt-none"},{default:i(()=>[o(w,{rotulo:"Aliquota",value:"2",suffix:"%",decimals:"2",tipo:"decimal",modelValue:a.itemHistoricoIss.aliquota,"onUpdate:modelValue":e[32]||(e[32]=t=>a.itemHistoricoIss.aliquota=t)},null,8,["modelValue"])]),_:1}),o(Oe,{align:"right",class:"text-primary"},{default:i(()=>[B(o(k,{flat:"",label:"Cancel"},null,512),[[J]]),o(k,{flat:"",label:"Adicionar Hist\xF3rico",onClick:c.adicionarHistorico},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(ee,{modelValue:a.itemListaDeServicoModal,"onUpdate:modelValue":e[40]||(e[40]=t=>a.itemListaDeServicoModal=t)},{default:i(()=>[o(M,{style:{"min-width":"350px"}},{default:i(()=>[o(F,null,{default:i(()=>e[61]||(e[61]=[f("div",{class:"text-h6"},"Adicionar Item na Lista de Servi\xE7o",-1)])),_:1}),o(F,{class:"q-pt-none"},{default:i(()=>[o(Z,{dense:"",modelValue:a.itemListaDeServico.codigo,"onUpdate:modelValue":e[34]||(e[34]=t=>a.itemListaDeServico.codigo=t),label:"C\xF3digo"},null,8,["modelValue"])]),_:1}),o(F,{class:"q-pt-none"},{default:i(()=>[o(Z,{dense:"",modelValue:a.itemListaDeServico.codigoCNAE,"onUpdate:modelValue":e[35]||(e[35]=t=>a.itemListaDeServico.codigoCNAE=t),label:"C\xF3digo CNAE"},null,8,["modelValue"])]),_:1}),o(F,{class:"q-pt-none"},{default:i(()=>[o(Z,{dense:"",modelValue:a.itemListaDeServico.codigoNBS,"onUpdate:modelValue":e[36]||(e[36]=t=>a.itemListaDeServico.codigoNBS=t),label:"C\xF3digo NBS"},null,8,["modelValue"])]),_:1}),o(F,{class:"q-pt-none"},{default:i(()=>[o(Z,{dense:"",modelValue:a.itemListaDeServico.codigoTributacao,"onUpdate:modelValue":e[37]||(e[37]=t=>a.itemListaDeServico.codigoTributacao=t),label:"C\xF3digo de Tributa\xE7\xE3o"},null,8,["modelValue"])]),_:1}),o(F,{class:"q-pt-none"},{default:i(()=>[o(Z,{dense:"",modelValue:a.itemListaDeServico.descricao,"onUpdate:modelValue":e[38]||(e[38]=t=>a.itemListaDeServico.descricao=t),label:"Descri\xE7\xE3o"},null,8,["modelValue"])]),_:1}),o(F,{class:"q-pt-none"},{default:i(()=>[o(Z,{dense:"",modelValue:a.itemListaDeServico.iss,"onUpdate:modelValue":e[39]||(e[39]=t=>a.itemListaDeServico.iss=t),label:"Aliquota",value:"2",suffix:"%",decimals:"2",tipo:"decimal"},null,8,["modelValue"])]),_:1}),o(Oe,{align:"right",class:"text-primary"},{default:i(()=>[B(o(k,{flat:"",label:"Cancel"},null,512),[[J]]),a.itemListaDeServico.id===void 0?(_(),Y(k,{key:0,flat:"",label:"Adicionar Item",onClick:c.adicionarItemListaDeServico},null,8,["onClick"])):(_(),Y(k,{key:1,flat:"",label:"Editar Item",onClick:c.adicionarItemListaDeServico},null,8,["onClick"]))]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(ee,{modelValue:a.empresaUsuarios.mostrar,"onUpdate:modelValue":e[43]||(e[43]=t=>a.empresaUsuarios.mostrar=t),maximized:""},{default:i(()=>[o(de,{container:"",class:"bg-light"},{default:i(()=>[o(me,{class:"bg-light text-tertiary"},{default:i(()=>[o(ie,{class:"bg-primary text-white q-pa-sm"},{default:i(()=>[B(o(k,{dense:"",flat:"",icon:"arrow_back",round:""},null,512),[[J]]),o(se,null,{default:i(()=>e[62]||(e[62]=[V("Permiss\xE3o de usu\xE1rios")])),_:1}),o(_o),B(o(k,{onClick:c.empresaUsuarios_gravar_click,label:"Salvar","text-color":"primary",color:"white",unelevated:""},null,8,["onClick"]),[[J]])]),_:1}),o(x,{gutter:"sm",items:"center"},{default:i(()=>[o(L,{col:"xs-shrink"},{default:i(()=>[o(E,{imagem:a.empresaUsuarios.empresa.contato.imagem,rotulo:a.empresaUsuarios.empresa.apelido,tamanho:"40",style:{display:"flex","align-self":"center"}},null,8,["imagem","rotulo"])]),_:1}),o(L,{col:"xs"},{default:i(()=>[o(n,{text:"body1 medium"},{default:i(()=>[V(S(a.empresaUsuarios.empresa.apelido),1)]),_:1}),o(n,{text:"caption"},{default:i(()=>[V(S(a.empresaUsuarios.empresa.numeroDocumentoNacional),1)]),_:1})]),_:1}),o(L,{col:"xs-shrink"},{default:i(()=>[o(Ce,{modelValue:a.empresaUsuarios.empresa.ativo,"onUpdate:modelValue":e[41]||(e[41]=t=>a.empresaUsuarios.empresa.ativo=t),onClick:e[42]||(e[42]=t=>c.empresaUsuarios_ativar_todos_click("empresa",a.empresaUsuarios.empresa))},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),o(pe,null,{default:i(()=>[(_(!0),A($,null,re(a.empresaUsuarios.grupo,(t,d)=>(_(),Y(Do,{key:d,bordered:"",class:"bg-white q-ma-xs q-mb-md rounded-borders"},{default:i(()=>[o(ge,{clickable:"","manual-focus":"",class:"q-py-sm q-px-xs itemHover"},{default:i(()=>[o(G,{class:"col-xs no-margin",onClick:()=>{t.aberto=!t.aberto}},{default:i(()=>[o(fe,{lines:"1",class:"text-subtitle1 text-weight-bold ellipsis-2-lines"},{default:i(()=>[o(Qe,{name:t.aberto?"expand_less":"expand_more",size:"md",class:"q-px-xs"},null,8,["name"]),V(" "+S(t.descricao),1)]),_:2},1024)]),_:2},1032,["onClick"]),o(G,{class:"col-xs-shrink no-margin"},{default:i(()=>[o(Ce,{modelValue:t.ativo,"onUpdate:modelValue":m=>t.ativo=m,onClick:m=>c.empresaUsuarios_ativar_todos_click("grupo",t)},null,8,["modelValue","onUpdate:modelValue","onClick"])]),_:2},1024)]),_:2},1024),o(He),(_(!0),A($,null,re(a.empresaUsuarios.usuario.filter(m=>m.codigoGrupo===t.codigoGrupo),(m,b)=>B((_(),A("div",{key:b,class:"itemHover"},[o(ge,{clickable:"","manual-focus":"",class:"q-py-sm q-px-xs"},{default:i(()=>[o(G,{class:"col-xs no-margin"},{default:i(()=>[o(ge,{class:"q-pa-none"},{default:i(()=>[o(G,{class:"col-auto items-center"},{default:i(()=>[o(E,{imagem:m.imagem,rotulo:m.nome,tamanho:"40",style:{display:"flex","align-self":"center"}},null,8,["imagem","rotulo"])]),_:2},1024),o(G,{class:"col"},{default:i(()=>[o(fe,{lines:"2",class:"text-tertiary text-weight-bold ellipsis-2-lines"},{default:i(()=>[V(S(m.nome),1)]),_:2},1024),o(fe,{caption:"",lines:"2",class:"text-tertiary ellipsis"},{default:i(()=>[V(S(m.apelido),1)]),_:2},1024),o(G,{class:"hideondesktop q-mt-sm"},{default:i(()=>[f("div",null,[m.numeroDocumentoNacional?(_(),Y(z,{key:0,cor:"tertiary",escuro:"",class:"q-mr-xs"},{default:i(()=>[V(S(m.numeroDocumentoNacional),1)]),_:2},1024)):X("",!0)])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),o(G,{class:"hideonmobile maxw180 q-pl-sm no-margin"},{default:i(()=>[m.numeroDocumentoNacional?(_(),Y(Eo,{key:0,color:"tertiary","multi-line":"",class:"col-auto q-mx-auto q-py-xs"},{default:i(()=>[V(S(m.numeroDocumentoNacional),1)]),_:2},1024)):X("",!0)]),_:2},1024),o(G,{class:"col-xs-shrink no-margin"},{default:i(()=>[o(Ce,{modelValue:m.ativo,"onUpdate:modelValue":j=>m.ativo=j,onClick:j=>c.empresaUsuarios_ativar_todos_click("usuario",m)},null,8,["modelValue","onUpdate:modelValue","onClick"])]),_:2},1024)]),_:2},1024),o(He)])),[[he,t.aberto]])),128))]),_:2},1024))),128))]),_:1})]),_:1})]),_:1},8,["modelValue"])])}var na=xo(Po,[["render",ta],["__scopeId","data-v-33e44af6"]]);export{na as default};
