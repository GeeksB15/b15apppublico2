import{_ as st,a3 as kt,r as ge,o as H,d as J,w as s,f as t,M as $e,G as He,h as Pe,i as Me,k as N,t as te,m as Ve,e as re,H as ve,Q as ce,N as Ee,I as Ze,J as Ge,p as we,a_ as Ct,a$ as nt,b4 as St,b5 as dt,W as je,b6 as pt,d4 as ht,d5 as Ue,K as Xe,aU as Qe,D as Re,bh as bt,ar as Ne,au as Et,b3 as ze,v as it,be as Le,P as Te,S as he,T as Y,j as me,U as de,B as Dt,F as De,x as qe,C as Ie,l as ut,aO as gt,E as rt,bq as ct,e0 as Vt,L as xt,c as at,bG as ot,e1 as Pt,as as zt,at as Ft,d6 as Nt,aN as vt,A as Tt,O as At}from"./index.27953b8f.js";import{L as qt}from"./Lista.5fc6c12c.js";import{S as Ot}from"./SeletorCfop.5302d4d9.js";import{C as Bt}from"./Campo.cb77a3e9.js";import"./xlsx.2a58a3df.js";const Ut={components:{SeletorNcm:kt,SeletorCfop:Ot,Campo:Bt},data(){return{abaSelecionada:"tab1",historicoItem:[],tabelaHistoricoItem:{colunas:[{name:"fornecedor",label:"Fornecedor",align:"left"},{name:"dataCompra",label:"Data Compra",align:"right"},{name:"quantidade",label:"Quantidade",align:"right"},{name:"valorCusto",label:"Valor de Custo",align:"right"},{name:"valorTotal",label:"Valor Total (Custo)",align:"right"}],paginacao:{page:1,rowsPerPage:5}},estoqueItem:[],tabelaEstoqueItem:{colunas:[{name:"empresa",label:"Empresa",align:"left"},{name:"tipoEstoque",label:"Tipo estoque",align:"right"},{name:"lote",label:"Lote",align:"right"},{name:"quantidade",label:"Quantidade",align:"right"}],paginacao:{page:1,rowsPerPage:5}},compra:{},cfop:null,cstIcms:"",cstIpi:"",contaEstoque:[],impostoCstIpi:[],impostoIcmsModalidade:[],impostoCstIcms:[],impostoCstIcmsSt:[],documentoItem:{},imposto:{},item:{},visivel:!1,contasOpcoes:[],exibirIcms:!1,exibirIcmsSt:!1,exibirIpi:!1,somenteLeituraIcms:!1,somenteLeituraIcmsSt:!1,exibirHistorico:!1,exibirEstoque:!1,exibeCfop:!1}},emits:["salvar"],methods:{async mostrar(i,e,m){var a,c,g,_;this.compra=m,this.documentoItem=$utils.clonarV2(i),this.item=$utils.clonarV2(e),await this.consultarHistoricoItem(this.item),await this.consultarEstoqueItem(this.item);const I=await $db.hibrido.lista({table:"impostoParametro",where:{impParamTipoCod:1}}),o=await $db.hibrido.lista({table:"impostoParametro",where:{impParamTipoCod:21}});this.impostoCstIcms=I.concat(o).map(b=>({rotulo:b.numero.trim()+" - "+b.descr,valor:Number(b.numero)})).sort((b,p)=>Number(b.valor)-Number(p.valor)),this.impostoIcmsModalidade=(await $db.hibrido.lista({table:"impostoParametro",where:{impParamTipoCod:3}})).map(b=>({rotulo:b.numero.trim()+" - "+b.descr,valor:Number(b.numero)})).sort((b,p)=>Number(b.valor)-Number(p.valor)),this.impostoCstIcmsSt=(await $db.hibrido.lista({table:"impostoParametro",where:{impParamTipoCod:4}})).map(b=>({rotulo:b.numero.trim()+" - "+b.descr,valor:Number(b.numero)})).sort((b,p)=>Number(b.valor)-Number(p.valor)),this.impostoCstIpi=(await $db.hibrido.lista({table:"impostoParametro",where:{impParamTipoCod:5}})).map(b=>({rotulo:b.numero.trim()+" - "+b.descr,valor:Number(b.numero)})).sort((b,p)=>Number(b.valor)-Number(p.valor)),this.contaEstoque=(await $db.hibrido.lista({table:"financeiroPlanoConta"})).map(b=>{var p,u,y;return{rotulo:(y=(u=(p=b==null?void 0:b.descricao)!=null?p:" - "+(b==null?void 0:b.classificacao))!=null?u:" - "+(b==null?void 0:b.caminho))!=null?y:"",valor:b.id}}).sort((b,p)=>Number(b.valor)-Number(p.valor));let l;(a=this.documentoItem)!=null&&a.idCfop&&(l=await $erp().cfop.where({id:this.documentoItem.idCfop}).first()),l===void 0&&console.log("CFOP inv\xE1lido");const n=this.documentoItem.total/(this.documentoItem.quantidade||1)||0;this.documentoItem.cfop=(c=l==null?void 0:l.cfop.toString())!=null?c:"",this.documentoItem.codigoCfop=(g=l==null?void 0:l.codigoCfop)!=null?g:null,this.documentoItem.idCfop=(_=l==null?void 0:l.id)!=null?_:null,this.documentoItem.valorBaseIcms=this.documentoItem.valorBaseIcms||n,this.documentoItem.valorBaseIpi=this.documentoItem.valorBaseIpi||n,this.documentoItem.valorBaseIcmsSt=this.documentoItem.valorBaseIcmsSt||n,this.calcularImpostos(),this.exibeCfop=!0,this.visivel=!0},async salvar(){try{if(this.exibirIcms||(this.documentoItem.modalidadeBaseCalculo=null,this.documentoItem.codigoCst=null,this.documentoItem.percentualIcms=0,this.documentoItem.valorIcms=0),this.exibirIcmsSt||(this.documentoItem.modalidadeBaseCalculoST=null,this.documentoItem.percentualIcmsSt=0,this.documentoItem.valorIcmsSt=0),this.exibirIpi||(this.documentoItem.codigoCstIpi=null,this.documentoItem.percentualIpi=0,this.documentoItem.valorIpi=0),Object.keys(this.documentoItem.cfop).length>0){const i=await $db.hibrido.lista({table:"cfop",where:{cfop:Number(this.documentoItem.cfop)}});this.documentoItem.codigoCfop=i[0].codigoCfop,this.documentoItem.idCfop=i[0].id}this.documentoItem.cfop&&delete this.documentoItem.cfop,this.$emit("salvar",this.documentoItem),this.exibirIcms=!1,this.exibirIcmsSt=!1,this.exibirIpi=!1,this.visivel=!1}catch(i){$q.notifyError("Ocorreu um erro ao salvar o produto: ",i.message)}finally{$q.notifyPositive("Produto salvo com sucesso.")}},calcularImpostos(i){var b,p,u,y,h,w,r,v,S,D;let e=(b=this.documentoItem.valorBaseIcms)!=null?b:0,m=(p=this.documentoItem.valorBaseIpi)!=null?p:0,I=(u=this.documentoItem.valorBaseIcmsSt)!=null?u:0,o=(y=this.documentoItem.percentualIcms)!=null?y:0,l=(h=this.documentoItem.percentualIpi)!=null?h:0,n=(w=this.documentoItem.percentualIVA)!=null?w:0,a=(r=this.documentoItem.percentualIcmsSt)!=null?r:0,c=(v=this.documentoItem.valorIcms)!=null?v:0,g=(S=this.documentoItem.valorIpi)!=null?S:0,_=(D=this.documentoItem.valorIcmsSt)!=null?D:0;["valorBaseIcms","percentualIcms"].includes(i)&&(c=e*o/100),i==="valorIcms"&&(o=c/e*100),["valorBaseIpi","percentualIpi"].includes(i)&&(g=m*l/100),i==="valorIpi"&&(l=g/m*100),i==="valorBaseIcmsSt"&&(n=0,I>0&&e>0&&I>=e&&(n=(I-e)/e*100),_=I*a/100-c),i==="percentualIVA"&&(I=e*(1+n/100),_=I*a/100-c),i==="percentualIcmsSt"&&(_=I*a/100-c),i==="valorIcmsSt"&&(a=_/I*100),this.documentoItem.valorBaseIcmsSt=parseFloat(I.toFixed(2)),this.documentoItem.percentualIcms=parseFloat(o.toFixed(2)),this.documentoItem.percentualIcmsSt=parseFloat(a.toFixed(2)),this.documentoItem.percentualIpi=parseFloat(l.toFixed(2)),this.documentoItem.percentualIVA=parseFloat(n.toFixed(2)),this.documentoItem.valorIcms=parseFloat(c.toFixed(2)),this.documentoItem.valorIcmsSt=parseFloat(_.toFixed(2)),this.documentoItem.valorIpi=parseFloat(g.toFixed(2)),(this.documentoItem.modalidadeBaseCalculo||this.documentoItem.codigoCst||this.documentoItem.percentualIcms>0||this.documentoItem.valorIcms>0)&&(this.exibirIcms=!0),(this.documentoItem.modalidadeBaseCalculoST||this.documentoItem.percentualIcmsSt>0||this.documentoItem.valorIcmsSt>0)&&(this.exibirIcmsSt=!0),(this.documentoItem.codigoCstIpi||this.documentoItem.percentualIpi>0||this.documentoItem.valorIpi>0)&&(this.exibirIpi=!0)},async consultarCFOP(){var m,I;const i=this.documentoItem.cfop,e=await $erp().cfop.where({cfop:Number(i)}).first();e===void 0&&console.log("CFOP inv\xE1lido"),this.documentoItem.idCfop=(m=e==null?void 0:e.id)!=null?m:null,this.documentoItem.codigoCfop=(I=e==null?void 0:e.CodigoCFOP)!=null?I:null},async consultarHistoricoItem(i){const e={};(i==null?void 0:i.atual)&&Object.keys(i.atual).length>0&&(i=i.atual);const I=(await $db.hibrido.lista({table:"documentoItem",where:{idItem:i.id}})).filter(o=>(o.operacao==="Compra"||o.operacao==="Compra de Mercadoria")&&o.status==="Finalizado"&&o.operacaoFator===1&&o.quantidade>0);for(const o of I){const l=await $db.hibrido.le({table:"documento",id:o.idDocumento}),n=await $db.hibrido.le({table:"contato",id:l.idContato});e[o.idItem]||(e[o.idItem]={fornecedores:[]}),e[o.idItem].fornecedores.push({fornecedor:n.apelido||"",dataCompra:l.dataCompra||"",quantidade:o.quantidade||"",valorCusto:o.valorItem||"",valorTotal:o.valorItem*o.quantidade||""})}Object.keys(e).length>0?(this.historicoItem=e,this.historicoItem[i.id].fornecedores.sort((o,l)=>{const n=new Date(o.dataCompra||"1900-01-01");return new Date(l.dataCompra||"1900-01-01")-n})):this.historicoItem[i.id]={fornecedores:[]},this.exibirHistorico=!0},async consultarEstoqueItem(i){const e={};(i==null?void 0:i.atual)&&Object.keys(i.atual).length>0&&(i=i.atual);const m=await $db.hibrido.lista({table:"estoqueSaldoProdutoEmpresa",where:{idItem:i.id},whereFilter:{tipoEstoque:"Dispon\xEDvel"}});for(const I of m){const o=await $db.hibrido.le({table:"contato",id:I.idEmpresa});e[I.idItem]||(e[I.idItem]={estoques:[]}),e[I.idItem].estoques.push({empresa:o.apelido||"",tipoEstoque:I.tipoEstoque||"",lote:I.lote||"-",quantidade:I.saldo||""})}Object.keys(e).length>0?(this.estoqueItem=e,this.estoqueItem[i.id].estoques.sort((I,o)=>{const l=Number(I.quantidade||0);return Number(o.quantidade||0)-l})):this.estoqueItem[i.id]={estoques:[]},this.exibirEstoque=!0},async fechar(){this.documentoItem.cfop&&delete this.documentoItem.cfop,this.exibirIcms=!1,this.exibirIcmsSt=!1,this.exibirIpi=!1}}},Mt=["src"],Rt={key:0},Lt={key:0};function jt(i,e,m,I,o,l){const n=ge("badge"),a=ge("g-col"),c=ge("g-row"),g=ge("campo"),_=ge("SeletorNcm"),b=ge("SeletorCfop"),p=ge("g-label");return H(),J(Re,{modelValue:o.visivel,"onUpdate:modelValue":e[36]||(e[36]=u=>o.visivel=u),persistent:""},{default:s(()=>[t($e,{container:"",view:"hHh Lpr fFf",class:"bg-white",style:{"max-width":"980px"}},{default:s(()=>[t(He,{class:"bg-primary"},{default:s(()=>[t(Pe,{class:"bg-primary text-white"},{default:s(()=>[t(Me,null,{default:s(()=>[N(te(o.documentoItem.descricaoItem),1)]),_:1}),o.item.referencia?(H(),J(n,{key:0,cor:"tertiary",class:"q-mr-sm"},{default:s(()=>[N(te(o.item.referencia)+" ",1),t(Ve,null,{default:s(()=>e[37]||(e[37]=[N(" Refer\xEAncia ")])),_:1})]),_:1})):re("",!0),o.item.codigoItem?(H(),J(n,{key:1,cor:"positive",class:"q-mr-sm"},{default:s(()=>[N(" #"+te(o.item.codigoItem.toString().padStart(4,"0"))+" ",1),t(Ve,null,{default:s(()=>e[38]||(e[38]=[N(" C\xF3digo Item ")])),_:1})]),_:1})):re("",!0),ve(t(ce,{onClick:l.fechar,dense:"",flat:"",icon:"close",round:""},null,8,["onClick"]),[[Ee]])]),_:1})]),_:1}),t(Ze,null,{default:s(()=>[t(Ge,null,{default:s(()=>[t(c,{gutter:"md"},{default:s(()=>[t(a,null,{default:s(()=>[t(c,{class:"col-12 text-center"},{default:s(()=>[t(a,null,{default:s(()=>{var u,y,h,w,r,v;return[((u=o.item)==null?void 0:u.imagem)||((h=(y=o.item)==null?void 0:y.atual)==null?void 0:h.imagem)?(H(),we("img",{key:0,src:((w=o.item)==null?void 0:w.imagem)||((v=(r=o.item)==null?void 0:r.atual)==null?void 0:v.imagem),alt:"",style:{"max-width":"33%"}},null,8,Mt)):re("",!0)]}),_:1})]),_:1}),t(Ct,{modelValue:o.abaSelecionada,"onUpdate:modelValue":e[0]||(e[0]=u=>o.abaSelecionada=u),align:"justify",dense:"","indicator-color":"light-blue-4",class:"text-primary q-px-sm"},{default:s(()=>[t(nt,{default:"",name:"tab1",icon:"info",label:"Detalhes",class:"cinza"}),t(nt,{name:"tab2",icon:"history",label:"Compras",class:"cinza"}),t(nt,{name:"tab3",icon:"compare_arrows",label:"Estoque",class:"cinza"})]),_:1},8,["modelValue"]),t(St,{modelValue:o.abaSelecionada,"onUpdate:modelValue":e[35]||(e[35]=u=>o.abaSelecionada=u),animated:"",class:"text-tertiary"},{default:s(()=>[t(dt,{name:"tab1",class:"q-px-sm"},{default:s(()=>[t(c,null,{default:s(()=>[t(a,null,{default:s(()=>[t(g,{modelValue:o.documentoItem.observacao,"onUpdate:modelValue":e[1]||(e[1]=u=>o.documentoItem.observacao=u),tipo:"textoArea",rotulo:"Observa\xE7\xE3o",dense:"",rows:"4"},null,8,["modelValue"])]),_:1})]),_:1}),t(c,{mg:"lg-t"},{default:s(()=>[t(a,{col:"12"},{default:s(()=>[t(g,{modelValue:o.documentoItem.referenciaFornecedor,"onUpdate:modelValue":e[2]||(e[2]=u=>o.documentoItem.referenciaFornecedor=u),rotulo:"Refer\xEAncia Fornecedor"},null,8,["modelValue"])]),_:1})]),_:1}),t(c,{mg:"lg-t"},{default:s(()=>[t(a,{col:"12"},{default:s(()=>[t(_,{modelValue:o.documentoItem.ncm,"onUpdate:modelValue":e[3]||(e[3]=u=>o.documentoItem.ncm=u),class:"col-12 col-md-6",outlined:""},null,8,["modelValue"])]),_:1})]),_:1}),t(c,{mg:"lg-t"},{default:s(()=>[t(a,{col:"12"},{default:s(()=>[t(b,{modelValue:o.documentoItem.cfop,"onUpdate:modelValue":e[4]||(e[4]=u=>o.documentoItem.cfop=u),class:"col-12 col-md-6",outlined:""},null,8,["modelValue"])]),_:1})]),_:1}),t(c,{mg:"lg-t"},{default:s(()=>[t(a,null,{default:s(()=>[t(p,{text:"sub1 medium"},{default:s(()=>e[39]||(e[39]=[N("Estoque")])),_:1})]),_:1})]),_:1}),t(c,{items:"center"},{default:s(()=>[t(a,{col:"12"},{default:s(()=>[t(g,{modelValue:o.documentoItem.idPlanoContaEstoque,"onUpdate:modelValue":e[5]||(e[5]=u=>o.documentoItem.idPlanoContaEstoque=u),opcoes:o.contaEstoque,tipo:"seletor",ajuda:"Plano de Conta de Estoque para Entrada de Mercadoria",dense:"",outlined:"",rotulo:"Conta Estoque"},null,8,["modelValue","opcoes"])]),_:1})]),_:1}),t(c,{mg:"lg-t"},{default:s(()=>[t(a,null,{default:s(()=>[t(p,{text:"sub1 medium"},{default:s(()=>e[40]||(e[40]=[N("Impostos")])),_:1})]),_:1})]),_:1}),t(c,null,{default:s(()=>[t(je,{label:"ICMS",modelValue:o.exibirIcms,"onUpdate:modelValue":e[6]||(e[6]=u=>o.exibirIcms=u)},null,8,["modelValue"])]),_:1}),o.exibirIcms?(H(),J(c,{key:0,items:"center"},{default:s(()=>[t(a,{col:"12 sm6"},{default:s(()=>[t(g,{modelValue:o.documentoItem.modalidadeBaseCalculo,"onUpdate:modelValue":e[7]||(e[7]=u=>o.documentoItem.modalidadeBaseCalculo=u),opcoes:o.impostoIcmsModalidade,"somente-leitura":o.somenteLeituraIcms,tipo:"seletor",outlined:"",rotulo:"ICMS (Modalidade)"},null,8,["modelValue","opcoes","somente-leitura"])]),_:1}),t(a,{col:"12 sm6"},{default:s(()=>[t(g,{modelValue:o.documentoItem.codigoCst,"onUpdate:modelValue":e[8]||(e[8]=u=>o.documentoItem.codigoCst=u),opcoes:o.impostoCstIcms,"somente-leitura":o.somenteLeituraIcms,tipo:"seletor",outlined:"",rotulo:"CST ICMS"},null,8,["modelValue","opcoes","somente-leitura"])]),_:1}),t(a,{col:"12 sm4"},{default:s(()=>[t(g,{modelValue:o.documentoItem.valorBaseIcms,"onUpdate:modelValue":e[9]||(e[9]=u=>o.documentoItem.valorBaseIcms=u),onBlur:e[10]||(e[10]=u=>l.calcularImpostos("valorBaseIcms")),"somente-leitura":o.somenteLeituraIcms,tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"Base ICMS"},null,8,["modelValue","somente-leitura"])]),_:1}),t(a,{col:"12 sm4"},{default:s(()=>[t(g,{modelValue:o.documentoItem.percentualIcms,"onUpdate:modelValue":e[11]||(e[11]=u=>o.documentoItem.percentualIcms=u),onBlur:e[12]||(e[12]=u=>l.calcularImpostos("percentualIcms")),"somente-leitura":o.somenteLeituraIcms,tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"ICMS %"},null,8,["modelValue","somente-leitura"])]),_:1}),t(a,{col:"12 sm4"},{default:s(()=>[t(g,{modelValue:o.documentoItem.valorIcms,"onUpdate:modelValue":e[13]||(e[13]=u=>o.documentoItem.valorIcms=u),onBlur:e[14]||(e[14]=u=>l.calcularImpostos("valorIcms")),"somente-leitura":o.somenteLeituraIcms,tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"Valor ICMS"},null,8,["modelValue","somente-leitura"])]),_:1})]),_:1})):re("",!0),t(c,null,{default:s(()=>[t(je,{label:"ICMS ST",modelValue:o.exibirIcmsSt,"onUpdate:modelValue":e[15]||(e[15]=u=>o.exibirIcmsSt=u)},null,8,["modelValue"])]),_:1}),o.exibirIcmsSt?(H(),J(c,{key:1,items:"center"},{default:s(()=>[t(a,{col:"12 sm6"},{default:s(()=>[t(g,{modelValue:o.documentoItem.modalidadeBaseCalculoST,"onUpdate:modelValue":e[16]||(e[16]=u=>o.documentoItem.modalidadeBaseCalculoST=u),opcoes:o.impostoCstIcmsSt,"somente-leitura":o.somenteLeituraIcmsSt,tipo:"seletor",outlined:"",rotulo:"ICMS ST (Modalidade)"},null,8,["modelValue","opcoes","somente-leitura"])]),_:1}),t(a,{col:"12 sm6"},{default:s(()=>[t(g,{modelValue:o.documentoItem.percentualIVA,"onUpdate:modelValue":e[17]||(e[17]=u=>o.documentoItem.percentualIVA=u),onBlur:e[18]||(e[18]=u=>l.calcularImpostos("percentualIVA")),tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"IVA (%)"},null,8,["modelValue"])]),_:1}),t(a,{col:"12 sm4"},{default:s(()=>[t(g,{modelValue:o.documentoItem.valorBaseIcmsSt,"onUpdate:modelValue":e[19]||(e[19]=u=>o.documentoItem.valorBaseIcmsSt=u),onBlur:e[20]||(e[20]=u=>l.calcularImpostos("valorBaseIcmsSt")),"somente-leitura":o.somenteLeituraIcmsSt,tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"Base ICMS ST"},null,8,["modelValue","somente-leitura"])]),_:1}),t(a,{col:"12 sm4"},{default:s(()=>[t(g,{modelValue:o.documentoItem.percentualIcmsSt,"onUpdate:modelValue":e[21]||(e[21]=u=>o.documentoItem.percentualIcmsSt=u),onBlur:e[22]||(e[22]=u=>l.calcularImpostos("percentualIcmsSt")),"somente-leitura":o.somenteLeituraIcmsSt,tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"ICMS ST (%)"},null,8,["modelValue","somente-leitura"])]),_:1}),t(a,{col:"12 sm4"},{default:s(()=>[t(g,{modelValue:o.documentoItem.valorIcmsSt,"onUpdate:modelValue":e[23]||(e[23]=u=>o.documentoItem.valorIcmsSt=u),onBlur:e[24]||(e[24]=u=>l.calcularImpostos("valorIcmsSt")),"somente-leitura":o.somenteLeituraIcmsSt,tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"Valor ICMS ST"},null,8,["modelValue","somente-leitura"])]),_:1})]),_:1})):re("",!0),t(c,null,{default:s(()=>[t(je,{label:"IPI",modelValue:o.exibirIpi,"onUpdate:modelValue":e[25]||(e[25]=u=>o.exibirIpi=u)},null,8,["modelValue"])]),_:1}),o.exibirIpi?(H(),J(c,{key:2,items:"center"},{default:s(()=>[t(a,{col:"12"},{default:s(()=>[t(g,{modelValue:o.documentoItem.codigoCstIpi,"onUpdate:modelValue":e[26]||(e[26]=u=>o.documentoItem.codigoCstIpi=u),opcoes:o.impostoCstIpi,tipo:"seletor",dense:"",outlined:"",rotulo:"CST IPI"},null,8,["modelValue","opcoes"])]),_:1}),t(a,{col:"12 sm4"},{default:s(()=>[t(g,{modelValue:o.documentoItem.valorBaseIpi,"onUpdate:modelValue":e[27]||(e[27]=u=>o.documentoItem.valorBaseIpi=u),onBlur:e[28]||(e[28]=u=>l.calcularImpostos("valorBaseIpi")),tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"Base IPI"},null,8,["modelValue"])]),_:1}),t(a,{col:"12 sm4"},{default:s(()=>[t(g,{modelValue:o.documentoItem.percentualIpi,"onUpdate:modelValue":e[29]||(e[29]=u=>o.documentoItem.percentualIpi=u),onBlur:e[30]||(e[30]=u=>l.calcularImpostos("percentualIpi")),tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"IPI %"},null,8,["modelValue"])]),_:1}),t(a,{col:"12 sm4"},{default:s(()=>[t(g,{modelValue:o.documentoItem.valorIpi,"onUpdate:modelValue":e[31]||(e[31]=u=>o.documentoItem.valorIpi=u),onBlur:e[32]||(e[32]=u=>l.calcularImpostos("valorIpi")),tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"Valor IPI"},null,8,["modelValue"])]),_:1})]),_:1})):re("",!0)]),_:1}),t(dt,{name:"tab2",class:"q-px-sm"},{default:s(()=>[o.exibirHistorico?(H(),J(pt,{key:0,rows:o.historicoItem[o.documentoItem.idItem].fornecedores,columns:o.tabelaHistoricoItem.colunas,pagination:o.tabelaHistoricoItem.paginacao,"onUpdate:pagination":e[33]||(e[33]=u=>o.tabelaHistoricoItem.paginacao=u),"row-key":"index",class:"no-shadow text-left"},{body:s(u=>[t(ht,{props:u},{default:s(()=>[t(Ue,{key:"fornecedor",props:u},{default:s(()=>[N(te(u.row.fornecedor),1)]),_:2},1032,["props"]),t(Ue,{key:"dataCompra",props:u},{default:s(()=>[u.row.dataCompra!==""?(H(),we("span",Rt,te(i.$filters.data(u.row.dataCompra)),1)):re("",!0)]),_:2},1032,["props"]),t(Ue,{key:"quantidade",props:u},{default:s(()=>[N(te(u.row.quantidade),1)]),_:2},1032,["props"]),t(Ue,{key:"valorCusto",props:u},{default:s(()=>[N(te(i.$filters.numero(u.row.valorCusto,2)),1)]),_:2},1032,["props"]),t(Ue,{key:"valorTotal",props:u},{default:s(()=>[N(te(i.$filters.numero(u.row.valorTotal,2)),1)]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination"])):re("",!0)]),_:1}),t(dt,{name:"tab3",class:"q-px-sm"},{default:s(()=>[o.exibirEstoque?(H(),J(pt,{key:0,rows:o.estoqueItem[o.documentoItem.idItem].estoques,columns:o.tabelaEstoqueItem.colunas,pagination:o.tabelaEstoqueItem.paginacao,"onUpdate:pagination":e[34]||(e[34]=u=>o.tabelaEstoqueItem.paginacao=u),"row-key":"index",class:"no-shadow text-left"},{body:s(u=>[t(ht,{props:u},{default:s(()=>[t(Ue,{key:"empresa",props:u},{default:s(()=>[N(te(u.row.empresa),1)]),_:2},1032,["props"]),t(Ue,{key:"tipoEstoque",props:u},{default:s(()=>[N(te(u.row.tipoEstoque),1)]),_:2},1032,["props"]),t(Ue,{key:"lote",props:u},{default:s(()=>[u.row.lote!==""?(H(),we("span",Lt,te(u.row.lote),1)):re("",!0)]),_:2},1032,["props"]),t(Ue,{key:"quantidade",props:u},{default:s(()=>[N(te(u.row.quantidade),1)]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination"])):re("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),t(Xe,{class:"bg-light q-pa-sm",bordered:""},{default:s(()=>[t(Pe,null,{default:s(()=>[t(Qe),ve(t(ce,{onClick:l.fechar,label:"Cancelar",size:"md",flat:"","no-ripple":"",color:"tertiary",class:"q-mr-sm"},null,8,["onClick"]),[[Ee]]),t(ce,{onClick:l.salvar,label:"Salvar",color:"primary","no-ripple":"",unelevated:""},null,8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}var $t=st(Ut,[["render",jt]]);const Ht={components:{ModalEditarProdutoCompras:$t,PromptItemV2:bt},data(){const i={ehOrcamento:!0,adicionar:{modal:{value:!1,name:""}},dataPrevistaEntrega:"",horaPrevistaEntrega:"",contatos:{},produtos:[],formasDePagamento:[],visivel:!1,somenteLeitura:!1,condicaoPagamentoRules:[async()=>{const e=this.compra.condicaoPagamento;return/^[\d/]*$/.test(e)}],formaPagamentoRules:[async()=>{const e=this.compra.formaDePagamento;return/^[^\d\s][a-zA-Z\s]*[^\d\s]$/.test(e)}],comprasMigrar:[],erroDesconto:!1,erroFrete:!1,erroSeguro:!1,erroOutrasDespesas:!1,exibeInfNota:!1,documentoNovo:!1,valorTotalPagamento:0,sku:0,operacao:"",alterarPrevisaoEntrega:!1};return this.limpaCampos(i),i},emits:["atualizar","dialogImprimirEtiquetas"],computed:{skus(){return this.compraItens.length>0?`${Number(this.compraItens.length)}`:"0"}},methods:{editarProduto(i){const e=this.produtos[i.idItem],m=this.compra;this.$refs.ModalEditarProdutoCompras.mostrar(i,e,m)},removerItem(i){this.compraItens=this.compraItens.filter(e=>e.id!==i.id),this.calcularTotais()},async migrarParaOutraCompra(i,e){await $tryLoading(async()=>{const m=(e==null?void 0:e.id)||$utils.uuid(),I=e?{...e}:{...this.compra,id:m,codigoDocumento:void 0,numero:void 0,notaNumero:void 0,notaSerie:void 0,naturezaOperacao:void 0,dataCompra:void 0,chaveAcesso:void 0,totalDesconto:void 0,totalPercentualDesconto:void 0,valorFrete:void 0,valorSeguro:void 0,valorOutrasDespesas:void 0,dataHoraEmissao:$utils.dataAtual(),dataHoraFinalizado:void 0,dataHoraPrevisto:void 0,status:"Digita\xE7\xE3o"},o={...i,id:$utils.uuid(),codigoDocumentoItem:void 0,idDocumento:m,codigoDocumento:void 0,dataHoraEmissao:$utils.dataAtual(),dataHoraFinalizado:void 0,status:"Digita\xE7\xE3o"};this.calcularTotais("",I,[o]),await $db.hibrido.grava("documento",{atual:I,original:e}),await $db.hibrido.grava("documentoItem",{atual:o}),this.removerItem(i),this.salvar(),$q.notifyPositive("Item migrado com sucesso!")},{mensagem:"Migrando..."})},fecharEdicaoProduto(i){const e=this.compraItens.findIndex(m=>m.id===i.id);this.compraItens[e]=$utils.clonar(i),this.calcularTotaisItem(e)},async atualizar(){var o,l,n;this.compraOriginal=await $db.hibrido.le({table:"documento",id:this.compra.id}),this.compra=$utils.clonarV2(this.compraOriginal),$utils.verificarErro(!this.compra.id,"Compra n\xE3o encontrada"),this.compraItensOriginal=(await $db.hibrido.lista({table:"documentoItem",where:{idDocumento:this.compra.id}})).sort((a,c)=>new Date(a.dataHoraEmissao||0)-new Date(c.dataHoraEmissao||0));const i=this.compraItensOriginal.map(a=>a.idItem),e=(o=await $db.hibrido.lista({table:"item",columns:["id","descricaoConcatenada"],whereIn:{id:i}}))!=null?o:{};for(const a of this.compraItensOriginal)a.descricaoConcatenada=(e==null?void 0:e.find(c=>c.id===a.idItem).descricaoConcatenada)||"";this.compraItens=$utils.clonarV2(this.compraItensOriginal),this.compraCondicoesDePagamentoOriginal=(await $db.hibrido.lista({table:"documentoCondicaoPagamento",where:{idDocumento:this.compra.id}})).sort((a,c)=>new Date(a.dataVencimento||0)-new Date(c.dataVencimento||0)),this.compraCondicoesDePagamento=$utils.clonarV2(this.compraCondicoesDePagamentoOriginal),this.compraTitulosOriginal=await $db.hibrido.lista({table:"financeiroTitulo",where:{documentoId:this.compra.id}}),this.compraTitulos=$utils.clonarV2(this.compraTitulosOriginal),this.compraMovimentacoesOriginal=await $db.hibrido.lista({table:"financeiroMovimentacao",where:{documentoId:this.compra.id}}),this.compraMovimentacoes=$utils.clonarV2(this.compraMovimentacoesOriginal),this.compraDocumentoXmlOriginal=await $db.hibrido.lista({table:"documentoXML",where:{idDocumento:this.compra.id}}),this.compraDocumentoXml=$utils.clonarV2(this.compraDocumentoXmlOriginal),this.compra.totalComImposto=!0,this.compra.calcularTributacao=(l=this.compra.calcularTributacao)!=null?l:!0,this.compra.naoGerarFinanceiro=(n=this.compra.naoGerarFinanceiro)!=null?n:!1;const m=[this.compra.idEmpresa,this.compra.idContato,this.compra.idContatoComprador,this.compra.idContatoVendedor,this.compra.idContatoTransportadora].filter(Boolean);this.carregarImagensContatos(m);const I=this.compraItens.map(({idItem:a})=>a).filter(Boolean);if(this.carregarImagensItens(I),this.valorTotalPagamento===0)for(const a of this.compraCondicoesDePagamento)this.valorTotalPagamento=this.valorTotalPagamento+a.valor;this.compra.dataHoraPrevisto&&(this.dataPrevistaEntrega=this.compra.dataHoraPrevisto.slice(0,10),this.horaPrevistaEntrega=this.compra.dataHoraPrevisto.slice(11,16)),this.carregarComprasMigrar(this.compra),this.calcularTotais(),this.exibeInfNota=!0},async carregarContatos(i){const e=await $db.hibrido.lista({table:"contato",columns:["id","apelido","imagem"],whereIn:{id:i}});for(const m of e)this.contatos[m.id]=m},async carregarImagensContatos(i){if(!!i.length){await $utils.dormir(200);try{await this.carregarContatos(i)}catch(e){console.error("Erro ao carregar imagens de contatos - ",e)}}},async carregarComprasMigrar(i){try{this.comprasMigrar=(await $db.hibrido.lista({table:"documento",where:{tipo:"Compra",idContato:i.idContato},whereFilter:{idEmpresa:i.idEmpresa,status:"Digita\xE7\xE3o"}})).filter(({id:e})=>e!==i.id)}catch(e){console.error("Erro ao carregar compras para migra\xE7\xE3o - ",e)}},async carregarItens(i){const e=await $db.hibrido.lista({table:"item",columns:["id","descricao","imagem","valorCustoReposicao","marca","referencia","codigoItem"],whereIn:{id:i}});for(const m of e)this.produtos[m.id]=m},async carregarImagensItens(i){if(!!i.length){await $utils.dormir(200);try{await this.carregarItens(i)}catch(e){console.error("Erro ao ler imagens de itens - ",e)}}},async salvar_click(){await $tryLoading(async()=>{if(this.compra.idContato||(this.compra.idContato=$db.usuario.logado.id),this.dataPrevistaEntrega){const i=`${this.dataPrevistaEntrega} ${this.horaPrevistaEntrega||"00:00:00"}`;this.compra.dataHoraPrevisto=Ne.formatDate(i)}this.calcularTotais(),await this.salvar(),this.$emit("atualizar",{aba:"Digita\xE7\xE3o"}),this.ocultarModal(),$q.notifyPositive(this.compra.operacao==="Nota de Entrada"?"A Nota de Entrada foi salva com sucesso.":"O Pedido de Compra foi salvo com sucesso.")},{mensagem:"Salvando..."})},async excluir_click(){!await $q.dialogSimNao({title:"Excluir compra",message:`Deseja excluir ${this.compra.operacao==="Pedido de Compra"?`o ${this.compra.operacao}?`:`a ${this.compra.operacao}?`}`})||await $tryLoading(async()=>{this.visivel=!1,this.operacao=this.compra.operacao,this.compra={},this.compraCondicoesDePagamento=[],this.compraItens=[],this.compraMovimentacoes=[],this.compraTitulos=[],this.compraDocumentoXml=[],await this.salvar(),await this.fechar(),$q.notifyPositive(this.compra.operacao==="Nota de Entrada"?"A Nota de Entrada foi excluida com sucesso.":"O Pedido de Compra foi excluido com sucesso.")},{mensagem:"Excluindo..."})},async criar(){await $tryLoading(async()=>{const i=(await $db.contato.ler({filtros:{ativo:!0,empresas:!0}})).data;if(!(i.length>0)){this.$q.notify({message:"N\xE3o h\xE1 empresa configurada",timeout:0,type:"negative",closeBtn:!0});return}let e=i[0];if(i.length>1){const o={ativo:!0,empresas:!0};if(e=await $g.promptContato.show({filtro:o,placeholder:"Selecione a empresa"}),!e){this.ocultarModal();return}}const m=(await $db.hibrido.lista({table:"empresa",where:{idContato:e.id}}))[0];if(!m){this.ocultarModal(),this.$q.notifyError("Erro ao selecionar empresa");return}if(this.contatos[e.id]||await this.carregarContatos([e.id]),this.limpaCampos(this),this.compra={id:$utils.uuid(),tipo:"Compra",operacao:"Pedido de Compra",status:"Digita\xE7\xE3o",descricaoEmpresa:m.nome,numeroDocumentoEmpresa:m.numeroDocumentoNacional,descricaoContato:"",idContatoComprador:null,dataHoraEmissao:$utils.dataAtual(),tipoFrete:"CIF",tipoTransporte:null,idEmpresa:m.idContato,idContato:null,totalDesconto:0,totalPercentualDesconto:0,calcularTributacao:!0,totalComImposto:!0,naoGerarFinanceiro:!1,freteSeparado:!1,dataHoraPrevisto:null,valorBaseIcms:0,valorIcms:0,valorBaseIcmsSt:0,valorIcmsSt:0,valorOutrasDespesas:0},!await this.abrirModalFornecedor()){this.ocultarModal();return}this.documentoNovo=!0,this.exibeInfNota=!0,this.visivel=!0})},async validaCampos(){try{if($utils.verificarErro(!this.compra.descricaoContato,"N\xE3o \xE9 permitido finalizar a compra sem informar o fornecedor!"),$utils.verificarErro(!this.compraItens.length,"N\xE3o \xE9 permitido finalizar compra sem itens!"),!this.compra.naoGerarFinanceiro){const i=$utils.arredondar(this.compraCondicoesDePagamento.reduce((e,m)=>e+m.valor,0));$utils.verificarErro(!this.compra.formaDePagamento,"N\xE3o \xE9 permitido finalizar a compra sem informar a forma de pagamento!"),$utils.verificarErro(this.compraCondicoesDePagamento.length>0&&this.compra.totalDocumento!==i,"N\xE3o \xE9 permitido finalizar a compra se o valor total difere da soma das parcelas!"),$utils.verificarErro(this.compraCondicoesDePagamento.length===0,'Verifique se a op\xE7\xE3o "N\xE3o gerar financeiro" est\xE1 marcada, ou adicione as parcelas para finalizar a compra!')}return this.compra.operacao==="Nota de Entrada"&&($utils.verificarErro(!this.compra.notaNumero,"N\xE3o \xE9 permitido finalizar a compra sem informar o n\xFAmero da Nota de Entrada!"),$utils.verificarErro(!this.compra.notaSerie,"N\xE3o \xE9 permitido finalizar a compra sem informara s\xE9rie da Nota de Entrada!"),$utils.verificarErro(!this.compra.naturezaOperacao,"N\xE3o \xE9 permitido finalizar a compra sem informar natureza de opera\xE7\xE3o da Nota de Entrada!"),$utils.verificarErro(!this.compra.dataCompra,"N\xE3o \xE9 permitido finalizar a compra sem informar a data de compra da Nota de Entrada!"),$utils.verificarErro(!this.compra.chaveAcesso,"N\xE3o \xE9 permitido finalizar a compra sem informar a chave de acesso da Nota de Entrada!")),!0}catch(i){return $q.notifyError("Ocorreu um erro na valida\xE7\xE3o de campos",i),!1}},async finalizar_click(){if(!await this.validaCampos())return;let i=!this.compra.naoGerarFinanceiro;await $tryLoading(async()=>{this.compra.status="Finalizado",this.compra.dataHoraFinalizado=$utils.dataAtual(),this.compra.provisaoCompra=i?1:void 0,await this.finalizarItens(),i?await this.gerarFinanceiro():(this.compraTitulos=[],this.compraMovimentacoes=[]),await this.salvar(),this.$emit("atualizar",{aba:"Finalizado"}),this.ocultarModal(),$q.notifyPositive(this.compra.operacao==="Nota de Entrada"?"A Nota de Entrada foi finalizada com sucesso!":"O Pedido de Compra foi finalizada com sucesso!"),i&&$q.notifyPositive("Provisionamento gerado com sucesso!")},{mensagem:"Finalizando Compra..."})},finalizarItens(){var l,n;let i=1,e=0,m=0,I=!1;const o=this.compra;if(o.subTotalProduto>0&&(o.tipoFrete==="FOB"&&o.freteSeparado===0&&(e=(o.valorFrete||0)+(o.valorSeguro||0)),i=((o.subTotalProduto||0)+(o.valorOutrasDespesas||0)-(o.totalDesconto||0)+(e||0))/(o.subTotalProduto||1)),m=this.compraItens.reduce((a,c)=>a+c.valorIcmsSt,m),m!==o.valorIcmsSt&&(I=!0),o.operacao==="Nota de Entrada")for(const a of this.compraItens)I&&(a.valorIcmsSt=o.valorIcmsSt*((a==null?void 0:a.total)||0)/(o.subTotalProduto>0?o.subTotalProduto:1)),a.valorFreteRateado=o.valorFrete*(((a==null?void 0:a.total)||0)/(o.subTotalProduto||1)),a.valorSeguroRateado=o.valorSeguro*(((a==null?void 0:a.total)||0)/(o.subTotalProduto||1)),a.valorOutrasDespesasRateado=(o.valorOutrasDespesas||0)*(((a==null?void 0:a.total)||0)/(o.subTotalProduto||1)),a.descontoTotalRateado=(o.totalDesconto||0)*(((a==null?void 0:a.total)||0)/(o.subTotalProduto||1)),(a==null?void 0:a.valorIcmsSt)-(a==null?void 0:a.valorIcms)>0&&((a==null?void 0:a.valorIcmsSt)||0)-((a==null?void 0:a.valorIcms)||0),a.valorRealTotal=((a==null?void 0:a.total)||0)*i+((a==null?void 0:a.valorIpi)||0)+((a==null?void 0:a.valorIcms)||0),a.valorRealTotalImpostos=((a==null?void 0:a.total)||0)+a.valorFreteRateado+a.valorSeguroRateado+a.valorOutrasDespesasRateado-a.descontoTotalRateado+((a==null?void 0:a.valorIpi)||0)+((a==null?void 0:a.valorIcmsSt)||0),a.valorReal=a.valorRealTotalImpostos/((a==null?void 0:a.quantidade)||1),a.valorCustoReposicao=((l=this.produtos[a.idItem])==null?void 0:l.valorCustoReposicao)||0;if(o.operacao==="Pedido de Compra")for(const a of this.compraItens){I&&(a.valorIcmsSt=$utils.arredondar(o.valorIcmsSt*(a.total||0)/(o.subTotalProduto>0?o.subTotalProduto:1))),a.valorFreteRateado=$utils.arredondar((o.valorFrete||0)*(a.total||0)/(o.subTotalProduto||1),4),a.valorSeguroRateado=$utils.arredondar((o.valorSeguro||0)*(a.total||0)/(o.subTotalProduto||1),4),a.valorOutrasDespesasRateado=$utils.arredondar((o.valorOutrasDespesas||0)*(a.total||0)/(o.subTotalProduto||1),4),a.descontoTotalRateado=$utils.arredondar((o.totalDesconto||0)*(a.total||0)/(o.subTotalProduto||1),4);let c=0;a.valorIcmsSt-a.valorIcms>0&&(c=$utils.arredondar((a.valorIcmsSt||0)-(a.valorIcms||0),2)),a.valorRealTotal=$utils.arredondar((a.total||0)*i+(a.valorIpi||0)+(c>0?c:0),2),a.valorRealTotalImpostos=$utils.arredondar((a.total||0)+a.valorFreteRateado+a.valorSeguroRateado+a.valorOutrasDespesasRateado-a.descontoTotalRateado+(a.valorIpi||0)+(a.valorIcmsSt||0),4),a.valorReal=$utils.arredondar(a.valorRealTotalImpostos/(a.quantidade||1),4),a.valorCustoReposicao=$utils.arredondar(((n=this.produtos[a.idItem])==null?void 0:n.valorCustoReposicao)||0,2)}},async transformarEmNotaDeEntrada_click(){this.compra.operacao==="Pedido de Compra"&&await $tryLoading(async()=>{var m;const i=this.compraItens.map(({idItem:I})=>I).filter(Boolean),e=await $db.hibrido.lista({table:"itemFornecedor",whereIn:{idItem:i},whereFilter:{idContato:this.compra.idContato}});for(const I of this.compraItens)if(!e.some(({idItem:o})=>o===I.idItem)){const o={id:$utils.uuid(),idItem:I.idItem,idContato:this.compra.idContato,referencia:"",descricao:I.descricaoItem};await $db.hibrido.grava("itemFornecedor",{atual:o,original:{}})}for(const I of this.compraTitulos)I.formaDePagamento=(m=this.compra.formaDePagamento)!=null?m:"";this.compra.operacao="Nota de Entrada",this.compra.dataHoraFinalizado="",this.compra.status="Digita\xE7\xE3o",await this.salvar(),$q.notifyPositive("Nota de Entrada gerada com sucesso!")},{mensagem:"Processando..."})},async mostrar({id:i}){this.visivel=!0;const e=$utils.logarIni("ComprasFicha");await $tryLoading(async()=>{this.compra.id=i,await this.atualizar()}),$utils.logarFim(e,1)},fechar(){this.compra.status==="Finalizado"?this.$emit("atualizar",{aba:"Finalizado"}):this.$emit("atualizar",{aba:"Digita\xE7\xE3o"}),this.ocultarModal(),this.produtos=[],this.limpaCampos(this),this.formasDePagamento=[],this.documentoNovo=!1,this.exibeInfNota=!1,this.valorTotalPagamento=0},ocultarModal(){this.visivel=!1},async abrirModalEmpresa(){const i={ativo:!0,empresas:!0},e=await $g.promptContato.show({filtro:i,placeholder:"Selecione"});if(!e)return;let m=(await $db.hibrido.lista({table:"empresa",where:{idContato:e.id}}))[0];if(!m){this.ocultarModal(),this.$q.notifyError("Erro ao selecionar empresa");return}this.contatos[e.id]||await this.carregarContatos([e.id]),this.compra.descricaoEmpresa=m.nome,this.compra.idEmpresa=m.idContato,this.compra.numeroDocumentoEmpresa=m.numeroDocumentoNacional,this.compra.InscricaoMunicipalEmpresa=m.InscricaoMunicipalEmpresa},async abrirModalComprador(){const i=await this.selecionarContato({placeholder:"Selecione o comprador",filtro:{ativo:!0,compradores:!0}});i.id&&(this.compra.idContatoComprador=i.id),this.contatos[i.id]||await this.carregarContatos([i.id])},async abrirModalFornecedor(){const i={ativo:!0},e=await $g.promptContato.show({filtro:i,placeholder:"Selecione o fornecedor"});if(!e)return e;const m=await $db.contatoTelefone.le({idContato:e.id}),I=await $db.contatoEndereco.le({idContato:e.id}),o=m.find(a=>a.tipoTelefone==="Principal"||a.tipoTelefone==="WhatsApp")||m[0]||null,l=I.find(a=>a.grupo==="Principal")||I[0]||null;let n;return l&&Object.keys(l).length>0&&(n=`${l.logradouro}, ${l.numero} ${l.complemento} - ${l.bairro} - ${l.municipio}/${l.uf}`),e.id&&(this.compra.idContato=e.id,this.compra.descricaoContato=e.nome,this.compra.numeroDocumentoContato=e.numeroDocumentoNacional,this.compra.emailContato=(e==null?void 0:e.email)||null,this.compra.regimeContato=(e==null?void 0:e.regime)||null,this.compra.telefoneContato=(o==null?void 0:o.telefone)||null,this.compra.descricaoContatoEndereco=n||null),this.contatos[e.id]||await this.carregarContatos([e.id]),e},async abrirModalVendedor(){const i=(await $db.contato.leFilhos(this.compra.idContato)).map(m=>m.id),e=await this.selecionarContato({placeholder:"Selecione o vendedor",filtro:{ativo:!0,usuarios:i}});e.id&&(this.compra.idContatoVendedor=e.id),this.contatos[e.id]||await this.carregarContatos([e.id])},async abrirModalTransportador(){const i=await this.selecionarContato({placeholder:"Selecione o transportadora",filtro:{ativo:!0,transportadoras:!0}});i.id&&(this.compra.idContatoTransportadora=i.id),this.contatos[i.id]||await this.carregarContatos([i.id])},async selecionarContato(i){const{placeholder:e,filtro:m}={placeholder:"Selecione o contato",filtro:{ativo:!0},...i},I=await $g.promptContato.show({filtro:m,placeholder:e});if(!I)throw new Error("Contato n\xE3o selecionado");return I},async adicionarItem(){let i={},e=[];for(const m of e)i[m.idItem]={item:await $db.hibrido.le({table:"item",id:m.idItem}),quantidade:m.quantidade};this.adicionar.modal.value=!0,this.adicionar.modal.name="Item"},trocarItens(i){const e=Object.keys(i)[0],m=i[e].item;this.produtos[e]=m},async selecionarItens(i){var e,m;for(const I in i){let o=await $db.hibrido.lista({table:"estoqueSaldoProdutoEmpresa",whereFilter:{idEmpresa:this.compra.idEmpresa,tipoEstoque:"Dispon\xEDvel",idItem:I}});o=o[0];const l=await $db.configuracoes.porNome("vendas.checaestoque",this.compra.idEmpresa);Number((e=l.find(u=>u.id))==null?void 0:e.valor);const n=i[I].item||{},a=((m=(await $db.hibrido.lista({table:"itemFornecedor",whereFilter:{idItem:n.id}}))[0])==null?void 0:m.referencia)||null,c=i[I].quantidade||0,g=(n==null?void 0:n.valorCustoReposicao)||(o==null?void 0:o.valorCustoMedio)||0;let _=this.compraItens.find(u=>u.idItem===I);const b=(await $erp().cfop.where({cfop:5102}).toArray())[0],p=await $db.financeiroPlanoConta.lePorConfig("financeiro.planocontas.comprageral");if(_)_.quantidade=$utils.arredondar(c,4),_.quantidadeRealizado=$utils.arredondar(c,4),_.subTotal=$utils.arredondar(g,2),_.total=$utils.arredondar(c*g,2);else{const u={dataHoraEmissao:$utils.dataAtual(),dataHoraFinalizado:"",descricaoItem:n.descricao,id:$utils.uuid(),idDocumento:this.compra.id,idItem:n.id,referencia:n.referencia,referenciaFornecedor:a,ncm:n.ncm||null,operacao:"Compra de Mercadoria",operacaoFator:1,idCfop:b==null?void 0:b.id,idPlanoContaEstoque:p==null?void 0:p.id,quantidade:$utils.arredondar(c,4),quantidadeRealizado:$utils.arredondar(c,4),status:"Digita\xE7\xE3o",tipoItem:n.tipo,subTotal:$utils.arredondar(g,2),total:$utils.arredondar(c*g,2),unidade:n.unidade,valorCustoMedio:(o==null?void 0:o.valorCustoMedio)||0,valorItem:g,valorOriginal:g,observacao:""};this.compraItens.push(u),await this.carregarItens([n.id])}this.compra.subTotal=0,this.compra.subTotalProduto=0;for(let u in this.compraItens)this.compra.subTotal+=this.compraItens[u].total,this.compra.subTotalProduto+=this.compraItens[u].total;this.compra.subTotal=$utils.arredondar(this.compra.subTotal,2),this.compra.totalDocumento=this.compra.subTotal}},calcularTotaisItem(i,e){const m=$utils.clonar(this.compraItens[i]);m.valorOriginal;const I=m.quantidade||0;let o=m.valorItem||0,l=m.descontoPercentualItem||0,n=m.descontoItem||0,a=m.subTotal||0,c=m.total||0;e==="descontoPercentualItem"&&((l<0||l>100)&&(l=0),n=o*l/100,a=o-n),e==="descontoItem"&&((n<0||n>o)&&(n=0),l=n/o*100,a=o-n),e==="valorItem"&&(n>o&&(n=0,l=0),l=n/o*100,a=o-n),e==="subTotal"&&((a<0||a>o)&&(a=o),n=o-a,l=n/o*100),c=I*a,m.valorItem=o,m.descontoItem=n,m.descontoPercentualItem=l,m.subTotal=a,m.total=c,this.compraItens[i]=m,this.calcularTotais("totalDesconto")},calcularTotais(i,e,m){const I=e||$utils.clonar(this.compra),o=m||this.compraItens;let l=0,n=0,a=0,c=I.totalDesconto||0,g=I.totalPercentualDesconto||0,_=I.valorFrete||0,b=I.valorSeguro||0,p=I.valorOutrasDespesas||0,u=0,y=0,h=0,w=0,r=0;this.erroFrete=!1,this.erroSeguro=!1,this.erroOutrasDespesas=!1;for(const v of o)l+=v.total,u+=v.valorBaseIcms||0,y+=v.valorIcms||0,h+=v.valorBaseIcmsSt||0,w+=v.valorIcmsSt||0,r+=v.valorIpi||0;i==="totalPercentualDesconto"&&(this.erroDesconto=!1,(g<0||g>100)&&(this.erroDesconto=!0),c=l*g/100),i==="totalDesconto"&&(this.erroDesconto=!1,(c<0||c>l)&&(this.erroDesconto=!0),g=c/l*100),_<0&&(this.erroFrete=!0),_=I.tipoFrete==="FOB"?_:0,b<0&&(this.erroSeguro=!0),b=I.tipoFrete==="FOB"?b:0,p<0&&(this.erroOutrasDespesas=!0),I.calcularTributacao||(u=0,y=0,h=0,w=0),I.totalComImposto||(r=0),n=l-c+_+b+p,a=n+r+w,I.valorBaseIcms=$utils.arredondar(u,2),I.valorIcms=$utils.arredondar(y),I.valorBaseIcmsSt=$utils.arredondar(h),I.valorIcmsSt=$utils.arredondar(w),I.valorIpi=$utils.arredondar(r),I.totalDesconto=$utils.arredondar(c),I.totalPercentualDesconto=$utils.arredondar(g),I.subTotalProduto=$utils.arredondar(l),I.totalProduto=$utils.arredondar(l)-$utils.arredondar(c),I.subTotal=$utils.arredondar(n),I.totalDocumento=$utils.arredondar(a),e||(this.compra=I)},limpaCampos(i){i.compra={},i.compraOriginal={},i.compraItens=[],i.compraItensOriginal=[],i.compraCondicoesDePagamento=[],i.compraCondicoesDePagamentoOriginal=[],i.compraTitulos=[],i.compraTitulosOriginal=[],i.compraMovimentacoes=[],i.compraMovimentacoesOriginal=[],i.compraDocumentoXml=[],i.compraDocumentoXmlOriginal=[],i.dataPrevistaEntrega="",i.horaPrevistaEntrega=""},async salvar(){this.compra.totalComImposto&&delete this.compra.totalComImposto;for(const e of this.compraItens)e.dataHoraFinalizado=this.compra.dataHoraFinalizado,e.status=this.compra.status;const i=[];this.compra.id?await $db.hibrido.preGrava(i,"documento",{atual:this.compra,original:this.compraOriginal}):this.compraOriginal.id&&await $db.hibrido.preRemove(i,"documento",this.compraOriginal),await $db.hibrido.preGravaLista(i,"documentoItem",{atual:this.compraItens,original:this.compraItensOriginal}),await $db.hibrido.preGravaLista(i,"documentoCondicaoPagamento",{atual:this.compraCondicoesDePagamento,original:this.compraCondicoesDePagamentoOriginal}),await $db.hibrido.preGravaLista(i,"financeiroTitulo",{atual:this.compraTitulos,original:this.compraTitulosOriginal}),await $db.hibrido.preGravaLista(i,"financeiroMovimentacao",{atual:this.compraMovimentacoes,original:this.compraMovimentacoesOriginal}),await $db.hibrido.preGravaLista(i,"documentoXML",{atual:this.compraDocumentoXml,original:this.compraDocumentoXmlOriginal}),await $db.hibrido.enviaLote(i),this.compra.totalComImposto=!0,this.calculaKardex()},async calculaKardex(){const i=$utils.logarIni("calculaKardex"),e=this.compraItens.map(({idItem:m})=>m).filter(Boolean);try{e.length&&await $utils.geeksApi({calculaKardex:{funcao:"9913E9FD-24A5-4C0A-9F1E-AACCDC7EAB9D",idsItem:e}})}catch(m){console.error(`Erro ao calcular Kardex
`,m)}$utils.logarFim(i,e.length)},async reabrir_click(){var e;const i=(e=this.compraTitulos)!=null&&e.length?this.compra.operacao==="Nota de Entrada"?"<strong>A movimenta\xE7\xE3o financeira ser\xE1 retornada ao status de provisionada!</strong>":"<strong>O Financeiro ser\xE1 apagado!</strong>":"";!await $q.dialogSimNao({title:"Reabertura",message:`Deseja reabrir o documento?<br/>${i}`,html:!0})||await $tryLoading(async()=>{await this.retornarParaDigitacao(),await this.salvar(),await this.atualizar(),$q.notifyPositive("Documento reaberto para digita\xE7\xE3o!")},{mensagem:"Reabrindo..."})},async retornarParaDigitacao(){$utils.verificarErro(this.compra.status!=="Finalizado","N\xE3o \xE9 poss\xEDvel realizar esta opera\xE7\xE3o em documento n\xE3o finalizado.");const i=this.compraTitulos.filter(({dataPagamento:e})=>e);$utils.verificarErro(i.length,"N\xE3o \xE9 poss\xEDvel excluir o Financeiro. Parcelas provisionadas j\xE1 pagas!"),this.compra.dataHoraFinalizado="",this.compra.status="Digita\xE7\xE3o",this.compra.operacao==="Pedido de Compra"&&(this.compraTitulos=[],this.compraMovimentacoes=[]),this.compra.operacao==="Nota de Entrada"&&this.compraTitulos.forEach(e=>{e.formaDePagamento=`Provis\xE3o Pedido - ${e.formaDePagamento}`})},async removerPagamento_click(i){try{this.compraCondicoesDePagamento=this.compraCondicoesDePagamento.filter(e=>e.id!==i.id),this.compraCondicoesDePagamento.sort((e,m)=>{let I=new Date(e.dataVencimento),o=new Date(m.dataVencimento);return I-o}),await this.atualizaValorTotalPagamento({condicao:i,acao:"remover"})}catch(e){console.log(e.message)}},async gerarCondicoesDePagamento_click(){var i;try{let e=this.compra.id,m=this.compra.condicaoPagamento,I=(i=this.compra.notaNumero)!=null?i:null;this.compra.naoGerarFinanceiro||await this.gerarParcelamento(e,m,I),this.compra.naoGerarFinanceiro&&(this.compraCondicoesDePagamento=[])}catch(e){console.log(e.message)}},async gerarParcelamento(i,e,m){this.compraCondicoesDePagamento=[];const I=$utils.clonar(this.compra),o=`${this.dataPrevistaEntrega} ${this.horaPrevistaEntrega||"00:00:00"}`,l=Ne.formatDate(o)||I.dataHoraPrevisto,n=I.dataCompra||l||$utils.dataAtual(),a=e.split("/"),c=a.length,g=(I==null?void 0:I.freteSeparado)||0;let _=$utils.arredondar(I==null?void 0:I.totalDocumento,2);const b=((I==null?void 0:I.valorFrete)||0)+((I==null?void 0:I.valorSeguro)||0);if(g&&(I==null?void 0:I.tipoFrete)==="FOB"&&b>0){let y;l?y=new Date(l):(y=new Date(n),y.setDate(y.getDate()+Number(a[0]||0)));let h={id:$utils.uuid(),idDocumento:I==null?void 0:I.id,dataVencimento:Ne.formatDate(y),valor:b,observacao:"Valor Frete + Seguro",freteSeparado:!0};this.compraCondicoesDePagamento.push(h),_-=b}let p=0,u=_/c;for(let y in a){let h=new Date(n);h.setDate(h.getDate()+Number(a[y]||0));let w={id:$utils.uuid(),idDocumento:I==null?void 0:I.id,dataVencimento:Ne.formatDate(h),valor:u,observacao:""};this.compraCondicoesDePagamento.push(w),p+=u||0}_!==p&&(this.compraCondicoesDePagamento[0].valor+=(_||0)-(p||0)),this.valorTotalPagamento=g&&(I==null?void 0:I.tipoFrete)==="FOB"?_+b:_},async gerarFinanceiro(){var n,a;const i=await $db.financeiroPlanoConta.lePorConfig("financeiro.planocontas.comprageral"),e=[];for(const c of this.compraItens){if(c.idPlanoContaEstoque===i.id)continue;const g=(c.total||0)-(c.descontoTotalRateado||0),_=e.findIndex(({idPlanoContaEstoque:b})=>b===c.idPlanoContaEstoque);_!==-1?e[_].valor+=g:e.push({idPlanoContaEstoque:c.idPlanoContaEstoque,idPlanoContaDestino:"",valor:g,porcentagem:0})}for(const c of e)c.valor=$utils.arredondar(c.valor),c.porcentagem=$utils.arredondar(c.valor/this.compra.totalDocumento,4);const m=await $db.financeiroPlanoConta.lePorConfig("financeiro.planocontas.freteaquisicao"),I=this.compraTitulos.filter(({dataPagamento:c})=>c);$utils.verificarErro(I.length,"N\xE3o \xE9 poss\xEDvel regerar o Financeiro. Parcelas provisionadas j\xE1 pagas!");const o=Ne.formatDate(new Date().setHours(0,0,0,0));this.compraTitulos=[];for(const c in this.compraCondicoesDePagamento){const g=this.compraCondicoesDePagamento[c],_=[g.observacao,this.compra.codigoDocumento?`Pedido de Compra: ${this.compra.codigoDocumento}`:"",this.compra.notaNumero?`Nota nro: ${this.compra.notaNumero}`:""].filter(Boolean).join(" | "),b={id:$utils.uuid(),dataEmissao:o,dataCompetencia:o,dataVencimento:Ne.formatDate(new Date(g.dataVencimento).setHours(0,0,0,0)),dataVencimentoOriginal:Ne.formatDate(new Date(g.dataVencimento).setHours(0,0,0,0)),valor:$utils.arredondar(g.valor,2),tipoJuros:"dia",valorMulta:0,percentualJuros:0,documentoTipo:this.compra.operacao,parcela:`${Number(c)+1}/${this.compraCondicoesDePagamento.length}`,descricao:this.compra.operacao,observacao:_,formaDePagamento:this.compra.operacao==="Pedido de Compra"?`Provis\xE3o Pedido - ${(n=this.compra.formaDePagamento)!=null?n:""}`:(a=this.compra.formaDePagamento)!=null?a:"",receberPagar:0,valorOriginal:$utils.arredondar(g.valor,2),documentoVinculado:1,valorTotal:$utils.arredondar(g.valor,2),valorARealizar:$utils.arredondar(g.valor,2),valorDesconto:0,percentualDesconto:0,idEmpresa:this.compra.idEmpresa,idContato:(g==null?void 0:g.freteSeparado)&&!!this.compra.idContatoTransportadora?this.compra.idContatoTransportadora:this.compra.idContato,idFinanceiroPlanoConta:g.observacao==="Valor Frete + Seguro"?m.id:i==null?void 0:i.id,documentoId:this.compra.id,idFinanceiroMovimentacaoAgrupamentoAutomatico:$utils.uuid(),cobrancaAtivo:1};this.compraTitulos.push(b)}const l=$utils.uuid();this.compraMovimentacoes=[];for(const c of e){const g={id:$utils.uuid(),idFinanceiroMovimentacaoN:l,idEmpresa:this.compra.idEmpresa,idFinanceiroPlanoConta:i.id,dataEmissao:o,valorCredito:this.compra.totalDocumento*c.porcentagem,valorDebito:0,descricao:i.descricao.trim(),observacao:"",automatico:0,liquidando:0,dataCompetencia:o,dataVencimento:o,dataMovimento:o,documentoTipo:this.compra.operacao,documentoId:this.compra.id};this.compraMovimentacoes.push(g);const _=await $db.financeiroPlanoConta.leCache({id:c.idPlanoContaEstoque}),b={id:$utils.uuid(),idFinanceiroMovimentacaoN:l,idEmpresa:this.compra.idEmpresa,idFinanceiroPlanoConta:c.idPlanoContaEstoque,dataEmissao:o,valorCredito:0,valorDebito:this.compra.totalDocumento*c.porcentagem,descricao:_.descricao.trim(),observacao:"",automatico:0,liquidando:0,dataCompetencia:o,dataVencimento:o,dataMovimento:o,documentoTipo:this.compra.operacao,documentoId:this.compra.id};this.compraMovimentacoes.push(b)}},async atualizaValorTotalPagamento({condicao:i,acao:e}){!i||e==="remover"&&(this.valorTotalPagamento=this.valorTotalPagamento-i.valor)},async ajustarPrevisaoEntrega(i){i==="alterar"&&(this.alterarPrevisaoEntrega=!0),i==="salvar"&&(await $tryLoading(async()=>{const e=`${this.dataPrevistaEntrega} ${this.horaPrevistaEntrega||"00:00:00"}`;$utils.verificarErro(!this.dataPrevistaEntrega&&this.horaPrevistaEntrega,"\xC9 necess\xE1rio preencher uma data em conjunto com a hora."),Ne.formatDate(e)!==Ne.formatDate(this.compra.dataHoraPrevisto)?(this.compra.dataHoraPrevisto=Ne.formatDate(e)||"",await this.salvar(),await this.atualizar(),$q.notifyPositive("A previs\xE3o foi salva com sucesso")):$q.notifyPositive("N\xE3o h\xE1 dados alterados.")}),this.alterarPrevisaoEntrega=!1)},dialogImprimirEtiquetas(i,e){this.$emit("dialogImprimirEtiquetas",{acao:i,item:e})}}},Zt={class:"row items-center"},Gt={class:"col-auto"},Wt={class:"col-auto"},Xt={class:"col-auto"};function Qt(i,e,m,I,o,l){const n=ge("g-label"),a=ge("g-col"),c=ge("Badge"),g=ge("BadgeCopiarUid"),_=ge("g-row"),b=ge("avatar"),p=ge("campo"),u=ge("SeletorItem"),y=ge("ModalEditarProdutoCompras"),h=ge("PromptItemV2"),w=Et("mask");return H(),we(De,null,[t(Re,{modelValue:i.visivel,"onUpdate:modelValue":e[33]||(e[33]=r=>i.visivel=r),persistent:"",maximized:"",onKeyup:ct(l.fechar,["esc"])},{default:s(()=>[t($e,{view:"hHh lpR lFr",container:"",class:"bg-light"},{default:s(()=>[t(He,null,{default:s(()=>[t(Pe,null,{default:s(()=>[t(ce,{onClick:l.fechar,icon:"arrow_back",flat:"",round:"",dense:""},null,8,["onClick"]),t(Me,null,{default:s(()=>[N(te(i.compra.operacao),1)]),_:1}),ve(t(ce,{onClick:l.salvar_click,label:"Salvar",color:"white","text-color":"primary",unelevated:"",class:"q-ml-sm"},null,8,["onClick"]),[[ze,i.compra.status==="Digita\xE7\xE3o"]])]),_:1})]),_:1}),t(Ze,{class:"u-container"},{default:s(()=>[t(Ge,null,{default:s(()=>[t(_,{gutter:"md",mg:"md",bg:"bg-white"},{default:s(()=>[t(a,{col:"12 sm12 md6"},{default:s(()=>[t(_,{items:"center",justify:"end",class:"hideondesktop"},{default:s(()=>[t(a,{col:"xs-shrink",order:"1 sm0"},{default:s(()=>[ve(t(n,{text:"caption",icon:"mdi-calendar-today sm tertiary left",tip:`Emitido \xE1s ${i.$filters.hora(i.compra.dataHoraEmissao)}`},{default:s(()=>[N(te(i.$filters.data(i.compra.dataHoraEmissao)),1)]),_:1},8,["tip"]),[[ze,i.compra.dataHoraEmissao]])]),_:1}),t(a,{col:"xs-shrink",order:"1 sm0"},{default:s(()=>[ve(t(n,{text:"caption",icon:"mdi-calendar-today sm tertiary left",tip:`Finalizado \xE1s ${i.$filters.hora(i.compra.dataHoraFinalizado)}`},{default:s(()=>[N(te(i.$filters.data(i.compra.dataHoraFinalizado)),1)]),_:1},8,["tip"]),[[ze,i.compra.dataHoraFinalizado]])]),_:1}),t(a,{col:"xs12 sm-shrink",order:"0 sm1",text:"right"},{default:s(()=>[t(c,{cor:i.compra.status!=="Digita\xE7\xE3o"?"tertiary":"light",escuro:i.compra.status!=="Digita\xE7\xE3o",class:"q-ml-sm"},{default:s(()=>[N(te(i.compra.status),1)]),_:1},8,["cor","escuro"]),t(g,{id:i.compra.id,numero:i.compra.numero,cor:"positive",class:"q-ml-sm"},null,8,["id","numero"])]),_:1})]),_:1}),t(_,null,{default:s(()=>[t(a,{col:"12 sm6"},{default:s(()=>[t(_,null,{default:s(()=>[t(a,{col:"xs-shrink"},{default:s(()=>{var r,v;return[t(b,{imagem:(r=i.contatos[i.compra.idContato])==null?void 0:r.imagem,rotulo:(v=i.contatos[i.compra.idContato])==null?void 0:v.apelido,tamanho:"50"},null,8,["imagem","rotulo"])]}),_:1}),t(a,{col:"xs"},{default:s(()=>{var r;return[t(p,{modelValue:(r=i.contatos[i.compra.idContato])==null?void 0:r.apelido,"somente-leitura":"",after:[{icon:"edit",handler(){l.abrirModalFornecedor()}}],disable:i.compra.status!=="Digita\xE7\xE3o",rotulo:"Fornecedor",dense:"",borderless:"",class:"q-mb-sm"},null,8,["modelValue","after","disable"])]}),_:1})]),_:1})]),_:1}),t(a,{col:"12 sm6"},{default:s(()=>{var r;return[t(p,{modelValue:(r=i.contatos[i.compra.idContatoVendedor])==null?void 0:r.apelido,"somente-leitura":"",disable:i.compra.status!=="Digita\xE7\xE3o",after:[{icon:"edit",handler(){l.abrirModalVendedor()}}],rotulo:"Vendedor",dense:"",borderless:"",class:"q-mb-sm"},null,8,["modelValue","disable","after"])]}),_:1}),t(a,{col:"12 sm6"},{default:s(()=>{var r;return[t(p,{modelValue:(r=i.contatos[i.compra.idEmpresa])==null?void 0:r.apelido,"somente-leitura":"",after:[{icon:"edit",handler(){l.abrirModalEmpresa()}}],disable:i.compra.status!=="Digita\xE7\xE3o",rotulo:"Empresa",dense:"",borderless:"",class:"q-mb-sm"},null,8,["modelValue","after","disable"])]}),_:1}),t(a,{col:"12 sm6"},{default:s(()=>{var r;return[t(p,{modelValue:(r=i.contatos[i.compra.idContatoComprador])==null?void 0:r.apelido,"somente-leitura":"",disable:i.compra.status!=="Digita\xE7\xE3o",after:[{icon:"edit",handler(){l.abrirModalComprador()}}],rotulo:"Comprador",dense:"",borderless:"",class:"q-mb-sm"},null,8,["modelValue","disable","after"])]}),_:1}),t(a,{col:"12 sm6"},{default:s(()=>{var r;return[t(p,{modelValue:(r=i.contatos[i.compra.idContatoTransportadora])==null?void 0:r.apelido,"somente-leitura":"",disable:i.compra.status!=="Digita\xE7\xE3o",after:[{icon:"edit",handler(){l.abrirModalTransportador()}}],rotulo:"Transportadora",dense:"",borderless:"",class:"q-mb-sm"},null,8,["modelValue","disable","after"])]}),_:1}),t(a,{col:"12 sm6"},{default:s(()=>[t(_,null,{default:s(()=>[t(a,{col:"7"},{default:s(()=>[t(it,{modelValue:i.dataPrevistaEntrega,"onUpdate:modelValue":e[0]||(e[0]=r=>i.dataPrevistaEntrega=r),disable:!this.alterarPrevisaoEntrega&&this.compra.status!=="Digita\xE7\xE3o",type:"date",label:"Data Prevista de Entrega",clearable:"",dense:"","stack-label":"",borderless:"",class:"q-mb-sm"},null,8,["modelValue","disable"])]),_:1}),t(a,{col:"5"},{default:s(()=>[t(it,{modelValue:i.horaPrevistaEntrega,"onUpdate:modelValue":e[1]||(e[1]=r=>i.horaPrevistaEntrega=r),disable:!this.alterarPrevisaoEntrega&&this.compra.status!=="Digita\xE7\xE3o",type:"time",label:"Hora Prevista de Entrega",clearable:"",dense:"","stack-label":"",borderless:"",class:"q-mb-sm"},null,8,["modelValue","disable"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(a,{col:"12 sm12 md6"},{default:s(()=>[t(_,{justify:"end",items:"center",text:"right",class:"hideonmobile"},{default:s(()=>[t(a,{col:"12"},{default:s(()=>[t(_,{justify:"end",items:"center"},{default:s(()=>[t(c,{cor:i.compra.status!=="Digita\xE7\xE3o"?"tertiary":"light",escuro:i.compra.status!=="Digita\xE7\xE3o"},{default:s(()=>[N(te(i.compra.status),1)]),_:1},8,["cor","escuro"]),t(g,{id:i.compra.id,numero:i.compra.numero,cor:"positive",class:"q-ml-sm"},null,8,["id","numero"]),t(ce,{color:"tertiary",flat:"",icon:"more_vert",round:""},{default:s(()=>[t(Le,null,{default:s(()=>[ve((H(),J(Te,{link:"",separator:""},{default:s(()=>[i.alterarPrevisaoEntrega?(H(),J(he,{key:1,clickable:"",onClick:e[3]||(e[3]=r=>l.ajustarPrevisaoEntrega("salvar"))},{default:s(()=>[t(Y,{avatar:""},{default:s(()=>[t(me,{name:"local_shipping"})]),_:1}),t(Y,null,{default:s(()=>[t(de,null,{default:s(()=>e[36]||(e[36]=[N("Salvar Previs\xE3o de Entrega")])),_:1})]),_:1})]),_:1})):(H(),J(he,{key:0,disable:i.compra.status==="Digita\xE7\xE3o",clickable:"",onClick:e[2]||(e[2]=r=>l.ajustarPrevisaoEntrega("alterar"))},{default:s(()=>[t(Y,{avatar:""},{default:s(()=>[t(me,{name:"local_shipping"})]),_:1}),t(Y,null,{default:s(()=>[t(de,null,{default:s(()=>e[35]||(e[35]=[N("Alterar Previs\xE3o de Entrega")])),_:1})]),_:1})]),_:1},8,["disable"])),t(he,{onClick:e[4]||(e[4]=r=>l.dialogImprimirEtiquetas("adicionar",i.compra)),clickable:""},{default:s(()=>[t(Y,{avatar:""},{default:s(()=>[t(me,{name:"print"})]),_:1}),t(Y,null,{default:s(()=>[t(de,null,{default:s(()=>e[37]||(e[37]=[N(" Adicionar Etiquetas ")])),_:1})]),_:1})]),_:1}),t(he,{onClick:e[5]||(e[5]=r=>l.dialogImprimirEtiquetas("impressao",i.compra)),clickable:""},{default:s(()=>[t(Y,{avatar:""},{default:s(()=>[t(me,{name:"print"})]),_:1}),t(Y,null,{default:s(()=>[t(de,null,{default:s(()=>e[38]||(e[38]=[N(" Imprimir Etiquetas ")])),_:1})]),_:1})]),_:1})]),_:1})),[[Ee]])]),_:1})]),_:1})]),_:1})]),_:1}),t(a,{col:"shrink"},{default:s(()=>[ve(t(n,{text:"caption",icon:"mdi-calendar-today sm tertiary left",tip:`Emitido \xE1s ${i.$filters.hora(i.compra.dataHoraEmissao)}`},{default:s(()=>[N(te(i.$filters.data(i.compra.dataHoraEmissao)),1)]),_:1},8,["tip"]),[[ze,i.compra.dataHoraEmissao]])]),_:1}),t(a,{col:"shrink"},{default:s(()=>[ve(t(n,{text:"caption",icon:"mdi-calendar sm tertiary left",tip:`Finalizado \xE1s ${i.$filters.hora(i.compra.dataHoraFinalizado)}`},{default:s(()=>[N(te(i.$filters.data(i.compra.dataHoraFinalizado)),1)]),_:1},8,["tip"]),[[ze,i.compra.dataHoraFinalizado]])]),_:1})]),_:1}),t(_,null,{default:s(()=>[t(a,null,{default:s(()=>[t(p,{modelValue:i.compra.observacao,"onUpdate:modelValue":e[6]||(e[6]=r=>i.compra.observacao=r),"somente-leitura":i.compra.status!=="Digita\xE7\xE3o",tipo:"textoArea",rotulo:"Observa\xE7\xE3o",rows:"4"},null,8,["modelValue","somente-leitura"])]),_:1})]),_:1})]),_:1})]),_:1}),t(_,{gutter:"md",mg:"md",bg:"bg-white"},{default:s(()=>[i.exibeInfNota?(H(),J(Dt,{key:0,"default-opened":i.compra.notaNumero>0||i.documentoNovo,"header-class":"q-px-sm",class:"notaEntrada g-col col-12"},{header:s(()=>[t(Y,null,{default:s(()=>[t(n,{text:"sub1 medium",icon:"mdi-file-replace sm tertiary left"},{default:s(()=>e[39]||(e[39]=[N("Nota de Entrada")])),_:1})]),_:1})]),default:s(()=>[t(a,{col:"12"},{default:s(()=>[t(_,null,{default:s(()=>[t(a,{col:"12 sm6 md3"},{default:s(()=>[ve(t(p,{modelValue:i.compra.notaNumero,"onUpdate:modelValue":e[7]||(e[7]=r=>i.compra.notaNumero=r),"somente-leitura":i.compra.status!=="Digita\xE7\xE3o",rotulo:"Numero",dense:""},null,8,["modelValue","somente-leitura"]),[[w,"##########"]])]),_:1}),t(a,{col:"12 sm6 md3"},{default:s(()=>[t(p,{modelValue:i.compra.notaSerie,"onUpdate:modelValue":e[8]||(e[8]=r=>i.compra.notaSerie=r),"somente-leitura":i.compra.status!=="Digita\xE7\xE3o",rotulo:"Serie",dense:""},null,8,["modelValue","somente-leitura"])]),_:1}),t(a,{col:"12 sm6 md3"},{default:s(()=>[t(p,{modelValue:i.compra.naturezaOperacao,"onUpdate:modelValue":e[9]||(e[9]=r=>i.compra.naturezaOperacao=r),"somente-leitura":i.compra.status!=="Digita\xE7\xE3o",rotulo:"Natureza da Opera\xE7\xE3o",dense:""},null,8,["modelValue","somente-leitura"])]),_:1}),t(a,{col:"12 sm6 md3"},{default:s(()=>[t(p,{modelValue:i.compra.dataCompra,"onUpdate:modelValue":e[10]||(e[10]=r=>i.compra.dataCompra=r),"somente-leitura":i.compra.status!=="Digita\xE7\xE3o",rotulo:"Data compra",tipo:"data",dense:""},null,8,["modelValue","somente-leitura"])]),_:1}),t(a,{col:"12"},{default:s(()=>[t(p,{modelValue:i.compra.chaveAcesso,"onUpdate:modelValue":e[11]||(e[11]=r=>i.compra.chaveAcesso=r),"somente-leitura":i.compra.status!=="Digita\xE7\xE3o",rotulo:"Chave",dense:""},null,8,["modelValue","somente-leitura"])]),_:1})]),_:1})]),_:1})]),_:1},8,["default-opened"])):re("",!0)]),_:1}),t(_,{gutter:"md",mg:"md",bg:"bg-white"},{default:s(()=>[t(a,{col:"12"},{default:s(()=>[t(n,{text:"sub1 medium",icon:"shopping_cart sm tertiary left"},{default:s(()=>[e[40]||(e[40]=N("Carrinho ")),t(ce,{onClick:e[12]||(e[12]=r=>l.adicionarItem()),disable:i.compra.status!=="Digita\xE7\xE3o",icon:"add",label:"Produto",size:"md",color:"primary",flat:"",dense:"",class:"float-right q-px-sm"},null,8,["disable"])]),_:1})]),_:1}),(H(!0),we(De,null,qe(i.compraItens,(r,v)=>(H(),J(a,{col:"12",key:v},{default:s(()=>[t(Te,{class:"full-width"},{default:s(()=>[t(he,{class:"q-px-none"},{default:s(()=>{var S;return[t(Y,{avatar:"",class:"col-auto"},{default:s(()=>{var D;return[t(b,{imagem:(D=i.produtos[r.idItem])==null?void 0:D.imagem,rotulo:r.descricaoItem,tamanho:"50"},null,8,["imagem","rotulo"])]}),_:2},1024),t(Y,{class:"q-px-none"},{default:s(()=>[t(u,{modelValue:r.idItem,"onUpdate:modelValue":D=>r.idItem=D,rotulo:"Produto",onSelecionarItens:l.trocarItens,"somente-leitura":i.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onUpdate:modelValue","onSelecionarItens","somente-leitura"]),t(de,{caption:""},{default:s(()=>{var D,V;return[N(te((V=(D=i.produtos[r.idItem])==null?void 0:D.marca)!=null?V:""),1)]}),_:2},1024)]),_:2},1024),ve(t(Y,{avatar:""},{default:s(()=>[t(c,{denso:""},{default:s(()=>{var D,V;return[N(te((V=(D=i.produtos[r.idItem])==null?void 0:D.referencia)!=null?V:""),1)]}),_:2},1024)]),_:2},1536),[[ze,(S=i.produtos[r.idItem])==null?void 0:S.referencia]]),t(Y,{avatar:""},{default:s(()=>[Ie("div",Zt,[Ie("div",Gt,[t(ce,{color:"primary",dense:"",flat:"",icon:"edit",round:"",onClick:D=>l.editarProduto(r),disable:i.compra.status!=="Digita\xE7\xE3o"},null,8,["onClick","disable"])]),Ie("div",Wt,[t(ce,{color:"tertiary",dense:"",flat:"",icon:"delete",round:"",onClick:D=>l.removerItem(r),disable:i.compra.status!=="Digita\xE7\xE3o"},{default:s(()=>[t(Ve,{anchor:"bottom middle",self:"center middle"},{default:s(()=>e[41]||(e[41]=[N("Remover Item")])),_:1})]),_:2},1032,["onClick","disable"])]),Ie("div",Xt,[t(ce,{color:"tertiary",dense:"",flat:"",icon:"more_vert",round:"",disable:i.compra.status!=="Digita\xE7\xE3o"},{default:s(()=>[t(Le,null,{default:s(()=>[ve((H(),J(Te,{link:"",separator:""},{default:s(()=>[i.compra.status==="Digita\xE7\xE3o"?(H(),we(De,{key:0},[(H(!0),we(De,null,qe(i.comprasMigrar,D=>(H(),J(he,{key:D.id,clickable:"",onClick:V=>l.migrarParaOutraCompra(r,D)},{default:s(()=>[t(Y,{avatar:""},{default:s(()=>[t(me,{name:"mdi-folder-move"})]),_:1}),t(Y,null,{default:s(()=>[N(te("Migrar para Compra #"+(D.numero||D.id.slice(-6))),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),t(he,{clickable:"",onClick:D=>l.migrarParaOutraCompra(r)},{default:s(()=>[t(Y,{avatar:""},{default:s(()=>[t(me,{name:"mdi-folder-move"})]),_:1}),t(Y,null,{default:s(()=>e[42]||(e[42]=[N("Migrar para nova Compra")])),_:1})]),_:2},1032,["onClick"])],64)):re("",!0)]),_:2},1024)),[[Ee]])]),_:2},1024)]),_:2},1032,["disable"])])])]),_:2},1024)]}),_:2},1024)]),_:2},1024),t(_,null,{default:s(()=>[t(a,{col:"4 md"},{default:s(()=>[t(p,{dense:"",align:"left",tipo:"decimal",decimals:"4",zerosDireita:"2",outlined:"",rotulo:"Valor do produto",modelValue:r.valorItem,"onUpdate:modelValue":S=>r.valorItem=S,"somente-leitura":i.compra.status!=="Digita\xE7\xE3o",onBlur:S=>l.calcularTotaisItem(v,"valorItem")},null,8,["modelValue","onUpdate:modelValue","somente-leitura","onBlur"])]),_:2},1024),t(a,{col:"4 md"},{default:s(()=>[t(_,{items:"center"},{default:s(()=>[t(a,{col:"shrink"},{default:s(()=>[t(me,{name:"mdi-minus",color:"primary"})]),_:1}),t(a,{col:"xs"},{default:s(()=>[t(p,{dense:"",opcoes:{maximumValue:100},tipo:"decimal",decimals:"2",rotulo:"Desconto percentual",modelValue:r.descontoPercentualItem,"onUpdate:modelValue":S=>r.descontoPercentualItem=S,outlined:"",suffix:"%","somente-leitura":i.compra.status!=="Digita\xE7\xE3o",onBlur:S=>l.calcularTotaisItem(v,"descontoPercentualItem")},null,8,["modelValue","onUpdate:modelValue","somente-leitura","onBlur"])]),_:2},1024)]),_:2},1024)]),_:2},1024),t(a,{col:"4 md"},{default:s(()=>[t(p,{dense:"",tipo:"decimal",modelValue:r.descontoItem,"onUpdate:modelValue":S=>r.descontoItem=S,decimals:"4",zerosDireita:"2",outlined:"",rotulo:"Desconto em reais",prefix:"R$",onBlur:S=>l.calcularTotaisItem(v,"descontoItem"),"somente-leitura":i.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onUpdate:modelValue","onBlur","somente-leitura"])]),_:2},1024),t(a,{col:"6 md"},{default:s(()=>[t(_,{items:"center"},{default:s(()=>[t(a,{col:"shrink",class:"hideonmobile"},{default:s(()=>[t(me,{name:"mdi-equal",color:"primary"})]),_:1}),t(a,{col:"xs"},{default:s(()=>[t(p,{dense:"",outlined:"",opcoes:{maximumValue:10,minimumValue:0},rotulo:"Subtotal",tipo:"decimal",decimals:"4",zerosDireita:"2",modelValue:r.subTotal,"onUpdate:modelValue":S=>r.subTotal=S,onBlur:S=>l.calcularTotaisItem(v,"subTotal"),"somente-leitura":i.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onUpdate:modelValue","onBlur","somente-leitura"])]),_:2},1024)]),_:2},1024)]),_:2},1024),t(a,{col:"6 md"},{default:s(()=>[t(_,{items:"center"},{default:s(()=>[t(a,{col:"shrink"},{default:s(()=>[t(me,{name:"mdi-close",color:"primary"})]),_:1}),t(a,{col:"xs"},{default:s(()=>[t(p,{dense:"",max:"100",min:"0",outlined:"",modelValue:r.quantidade,"onUpdate:modelValue":S=>r.quantidade=S,decimals:"4",zerosDireita:"0",tipo:"quantidade",onBlur:S=>l.calcularTotaisItem(v),disable:i.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onUpdate:modelValue","onBlur","disable"]),t(Ve,{anchor:"bottom middle",self:"center middle"},{default:s(()=>e[43]||(e[43]=[N("Quantidade")])),_:1})]),_:2},1024)]),_:2},1024)]),_:2},1024),t(a,{col:"12 md"},{default:s(()=>[t(_,{items:"center"},{default:s(()=>[t(a,{col:"shrink",class:"hideonmobile"},{default:s(()=>[t(me,{name:"mdi-equal",color:"primary"})]),_:1}),t(a,{col:"xs"},{default:s(()=>[t(p,{dense:"",tipo:"decimal",decimals:"2",rotulo:"Total","somente-leitura":"",modelValue:r.total,"onUpdate:modelValue":S=>r.total=S,outlined:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),t(a,{col:"12"},{default:s(()=>[t(_,{gutter:"md",mg:"md-y",justify:"end",items:"center",bg:"bg-light","rounded-borders":"","min-height":"49px"},{default:s(()=>[t(a,{col:"3 sm2 md-shrink",text:"bold"},{default:s(()=>e[44]||(e[44]=[N(" Calcular ")])),_:1}),t(a,{col:"9 sm10 md"},{default:s(()=>[t(je,{modelValue:i.compra.calcularTributacao,"onUpdate:modelValue":[e[13]||(e[13]=r=>i.compra.calcularTributacao=r),l.calcularTotais],"checked-icon":"check",color:"green","unchecked-icon":"clear",disable:i.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onUpdate:modelValue","disable"])]),_:1}),t(a,{col:"6 md-shrink"},{default:s(()=>e[45]||(e[45]=[N(" Base ICMS ")])),_:1}),t(a,{col:"6 md",text:"right"},{default:s(()=>[t(p,{dense:"",outlined:"",decimals:"2",zerosDireita:"2",tipo:"decimal",modelValue:i.compra.valorBaseIcms,"onUpdate:modelValue":e[14]||(e[14]=r=>i.compra.valorBaseIcms=r),"somente-leitura":!!i.compra.calcularTributacao||i.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","somente-leitura"])]),_:1}),t(a,{col:"6 md-shrink"},{default:s(()=>e[46]||(e[46]=[N(" Valor ICMS ")])),_:1}),t(a,{col:"6 md",text:"right"},{default:s(()=>[t(p,{dense:"",outlined:"",modelValue:i.compra.valorIcms,"onUpdate:modelValue":e[15]||(e[15]=r=>i.compra.valorIcms=r),decimals:"2",zerosDireita:"2",tipo:"decimal","somente-leitura":!!i.compra.calcularTributacao||i.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","somente-leitura"])]),_:1}),t(a,{col:"6 md-shrink"},{default:s(()=>e[47]||(e[47]=[N(" Base ICMS ST ")])),_:1}),t(a,{col:"6 md",text:"right"},{default:s(()=>[t(p,{dense:"",outlined:"",modelValue:i.compra.valorBaseIcmsSt,"onUpdate:modelValue":e[16]||(e[16]=r=>i.compra.valorBaseIcmsSt=r),decimals:"2",zerosDireita:"2",tipo:"decimal","somente-leitura":!!i.compra.calcularTributacao||i.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","somente-leitura"])]),_:1}),t(a,{col:"6 md-shrink"},{default:s(()=>e[48]||(e[48]=[N(" ICMS ST ")])),_:1}),t(a,{col:"6 md",text:"right"},{default:s(()=>[t(p,{dense:"",outlined:"",modelValue:i.compra.valorIcmsSt,"onUpdate:modelValue":e[17]||(e[17]=r=>i.compra.valorIcmsSt=r),decimals:"2",zerosDireita:"2",tipo:"decimal","somente-leitura":!!i.compra.calcularTributacao||i.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","somente-leitura"])]),_:1})]),_:1}),t(_,{mg:"lg-t",justify:"end"},{default:s(()=>[t(a,{col:"xs12 sm8 md4"},{default:s(()=>[t(_,{items:"center"},{default:s(()=>[t(a,{col:"3",text:"bold"},{default:s(()=>e[49]||(e[49]=[N(" Subtotal ")])),_:1}),t(a,{col:"xs",text:"right bold"},{default:s(()=>[N(te(i.$filters.numero(i.compra.subTotalProduto,2)),1)]),_:1})]),_:1}),t(ut,{class:"q-mb-md q-mt-xs"}),t(_,{items:"center"},{default:s(()=>[t(a,{col:"xs3"},{default:s(()=>e[50]||(e[50]=[N(" Desconto ")])),_:1}),t(a,{col:"xs"},{default:s(()=>[t(p,{tipo:"decimal",decimals:"2",modelValue:i.compra.totalPercentualDesconto,"onUpdate:modelValue":e[18]||(e[18]=r=>i.compra.totalPercentualDesconto=r),onBlur:e[19]||(e[19]=r=>l.calcularTotais("totalPercentualDesconto")),suffix:"%",error:i.erroDesconto,"somente-leitura":i.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","error","somente-leitura"])]),_:1}),t(a,{col:"xs"},{default:s(()=>[t(p,{tipo:"decimal",decimals:"2",modelValue:i.compra.totalDesconto,"onUpdate:modelValue":e[20]||(e[20]=r=>i.compra.totalDesconto=r),onBlur:e[21]||(e[21]=r=>l.calcularTotais("totalDesconto")),error:i.erroDesconto,"somente-leitura":i.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","error","somente-leitura"])]),_:1})]),_:1}),t(_,{items:"center"},{default:s(()=>[t(a,{col:"xs3"},{default:s(()=>e[51]||(e[51]=[N(" Frete ")])),_:1}),t(a,{col:"xs"},{default:s(()=>[t(gt,{class:"q-mr-md",label:"CIF",val:"CIF",modelValue:i.compra.tipoFrete,"onUpdate:modelValue":[e[22]||(e[22]=r=>i.compra.tipoFrete=r),l.calcularTotais],dense:"",disable:i.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onUpdate:modelValue","disable"]),t(gt,{label:"FOB",val:"FOB",modelValue:i.compra.tipoFrete,"onUpdate:modelValue":[e[23]||(e[23]=r=>i.compra.tipoFrete=r),l.calcularTotais],dense:"",disable:i.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onUpdate:modelValue","disable"])]),_:1}),t(a,{col:"xs"},{default:s(()=>[t(p,{tipo:"decimal",decimals:"2",modelValue:i.compra.valorFrete,"onUpdate:modelValue":e[24]||(e[24]=r=>i.compra.valorFrete=r),onBlur:l.calcularTotais,error:i.erroFrete,"somente-leitura":i.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onBlur","error","somente-leitura"])]),_:1})]),_:1}),t(_,{items:"center"},{default:s(()=>[t(a,{col:"xs3"},{default:s(()=>e[52]||(e[52]=[N(" Seguro ")])),_:1}),t(a,{col:"xs"},{default:s(()=>[t(p,{tipo:"decimal",decimals:"2",modelValue:i.compra.valorSeguro,"onUpdate:modelValue":e[25]||(e[25]=r=>i.compra.valorSeguro=r),onBlur:l.calcularTotais,error:i.erroSeguro,"somente-leitura":i.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onBlur","error","somente-leitura"])]),_:1})]),_:1}),t(_,{items:"center"},{default:s(()=>[t(a,{col:"xs5"},{default:s(()=>e[53]||(e[53]=[N(" Outras despesas ")])),_:1}),t(a,{col:"xs"},{default:s(()=>[t(p,{tipo:"decimal",decimals:"2",modelValue:i.compra.valorOutrasDespesas,"onUpdate:modelValue":e[26]||(e[26]=r=>i.compra.valorOutrasDespesas=r),onBlur:l.calcularTotais,error:i.erroOutrasDespesas,"somente-leitura":i.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onBlur","error","somente-leitura"])]),_:1})]),_:1}),t(ut,{class:"q-mt-md q-mb-xs"}),t(_,{items:"center"},{default:s(()=>[t(a,{col:"xs4",text:"bold"},{default:s(()=>e[54]||(e[54]=[N(" Total ")])),_:1}),t(a,{col:"xs",text:"right bold"},{default:s(()=>[N(te(i.$filters.numero(i.compra.totalProduto,2)),1)]),_:1})]),_:1}),i.compra.totalComImposto?(H(),J(_,{key:0,items:"center"},{default:s(()=>[t(a,{col:"xs4",text:"bold"},{default:s(()=>e[55]||(e[55]=[N(" Total IPI ")])),_:1}),t(a,{col:"xs",text:"right bold"},{default:s(()=>[N(te(i.$filters.numero(i.compra.valorIpi,2)),1)]),_:1})]),_:1})):re("",!0),t(_,{items:"center"},{default:s(()=>[t(a,{col:"xs5",text:"bold"},{default:s(()=>e[56]||(e[56]=[N(" Total c/ Impostos ")])),_:1}),t(a,{col:"xs-shrink"},{default:s(()=>[t(je,{disable:i.compra.status!=="Digita\xE7\xE3o",modelValue:i.compra.totalComImposto,"onUpdate:modelValue":[e[27]||(e[27]=r=>i.compra.totalComImposto=r),l.calcularTotais],"checked-icon":"check",color:"green","unchecked-icon":"clear"},null,8,["disable","modelValue","onUpdate:modelValue"])]),_:1}),t(a,{col:"xs",text:"right bold"},{default:s(()=>[N(te(i.$filters.numero(i.compra.totalDocumento,2)),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(_,{gutter:"md",mg:"md",bg:"bg-white"},{default:s(()=>[t(a,{col:"12"},{default:s(()=>[t(n,{text:"sub1 medium",icon:"credit_card sm tertiary left"},{default:s(()=>e[57]||(e[57]=[N("Faturar")])),_:1})]),_:1}),t(a,{col:"12"},{default:s(()=>[t(p,{modelValue:i.compra.observacaoFaturamento,"onUpdate:modelValue":e[28]||(e[28]=r=>i.compra.observacaoFaturamento=r),tipo:"textoArea",rotulo:"Observa\xE7\xE3o faturamento",rows:"5"},null,8,["modelValue"])]),_:1}),t(a,{col:"12"},{default:s(()=>[t(rt,{ref:"formAdicionarPagamento"},{default:s(()=>[t(_,{mg:"md-y",items:"center"},{default:s(()=>[t(a,{col:"12 sm6 md"},{default:s(()=>[t(p,{modelValue:i.compra.formaDePagamento,"onUpdate:modelValue":e[29]||(e[29]=r=>i.compra.formaDePagamento=r),rules:i.formaPagamentoRules,ajuda:"Exemplo: Boleto","somente-leitura":i.compra.status!=="Digita\xE7\xE3o",rotulo:"Forma de pagamento"},null,8,["modelValue","rules","somente-leitura"])]),_:1}),t(a,{col:"12 sm6 md"},{default:s(()=>[t(p,{modelValue:i.compra.condicaoPagamento,"onUpdate:modelValue":e[30]||(e[30]=r=>i.compra.condicaoPagamento=r),rules:i.condicaoPagamentoRules,ajuda:"Exemplo: 28/56/64","somente-leitura":i.compra.status!=="Digita\xE7\xE3o",rotulo:"Cond. Pag",tipo:"numero"},null,8,["modelValue","rules","somente-leitura"])]),_:1}),t(a,{col:"12 sm4 md",text:"bold",class:"q-my-sm"},{default:s(()=>[e[58]||(e[58]=N(" Frete Separado ")),t(je,{modelValue:i.compra.freteSeparado,"onUpdate:modelValue":[e[31]||(e[31]=r=>i.compra.freteSeparado=r),l.calcularTotais],disable:i.compra.status!=="Digita\xE7\xE3o",dense:"",class:"q-ml-sm"},null,8,["modelValue","onUpdate:modelValue","disable"])]),_:1}),t(a,{col:"12 sm4 md",text:"bold",class:"q-my-sm"},{default:s(()=>[e[59]||(e[59]=N(" N\xE3o gerar financeiro ")),t(je,{modelValue:i.compra.naoGerarFinanceiro,"onUpdate:modelValue":[e[32]||(e[32]=r=>i.compra.naoGerarFinanceiro=r),l.calcularTotais],disable:i.compra.status!=="Digita\xE7\xE3o",dense:"",class:"q-ml-sm"},null,8,["modelValue","onUpdate:modelValue","disable"])]),_:1}),t(a,{col:"12 sm4 md",text:"center"},{default:s(()=>[t(ce,{onClick:l.gerarCondicoesDePagamento_click,disable:i.compra.status!=="Digita\xE7\xE3o",color:"positive",icon:"add",label:"Forma de pagamento",outline:"",size:"sm"},null,8,["onClick","disable"])]),_:1})]),_:1})]),_:1},512)]),_:1}),t(a,{col:"12"},{default:s(()=>[ve(t(n,{text:"sub1 medium"},{default:s(()=>e[60]||(e[60]=[N("Condi\xE7\xF5es de pagamento")])),_:1},512),[[ze,i.compraCondicoesDePagamento.length>0]]),(H(!0),we(De,null,qe(i.compraCondicoesDePagamento,r=>(H(),J(Te,{highlight:"",class:"q-pa-none",key:r.id},{default:s(()=>[t(_,{gutter:"md",mg:"sm-y",items:"center",bordered:"","rounded-borders":""},{default:s(()=>[t(a,{col:"xs6 md-shrink"},{default:s(()=>[t(p,{modelValue:r.dataVencimento,"onUpdate:modelValue":v=>r.dataVencimento=v,"somente-leitura":i.compra.status!=="Digita\xE7\xE3o",rotulo:"Data vencimento",tipo:"data",dense:""},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024),t(a,{col:"xs6 md2"},{default:s(()=>[t(p,{modelValue:r.valor,"onUpdate:modelValue":v=>r.valor=v,"somente-leitura":i.compra.status!=="Digita\xE7\xE3o",align:"left",rotulo:"Valor",decimals:"2",zerosDireita:"2",tipo:"decimal"},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024),t(a,{col:"xs-grow"},{default:s(()=>[t(p,{modelValue:r.observacao,"onUpdate:modelValue":v=>r.observacao=v,"somente-leitura":i.compra.status!=="Digita\xE7\xE3o"||r.observacao==="Valor Frete + Seguro",rotulo:"Observa\xE7\xE3o"},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024),t(a,{col:"xs-shrink",text:"right"},{default:s(()=>[t(ce,{onClick:v=>l.removerPagamento_click(r),icon:"delete",round:"",dense:"",flat:"",color:"tertiary",disable:i.compra.status!=="Digita\xE7\xE3o"},null,8,["onClick","disable"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),i.valorTotalPagamento>0?(H(),J(_,{key:0,mg:"sm-t"},{default:s(()=>[t(a,{col:"xs-shrink",text:"bold"},{default:s(()=>[N(" Valor total: "+te(i.$filters.numero(i.valorTotalPagamento,2)),1)]),_:1})]),_:1})):re("",!0)]),_:1})]),_:1}),i.$db.usuario.desenvolvedor()?(H(),J(_,{key:0,gutter:"md",mg:"md",bg:"bg-yellow"},{default:s(()=>[t(a,{col:"12"},{default:s(()=>[t(n,{text:"sub1 medium",icon:"credit_card sm tertiary left"},{default:s(()=>e[61]||(e[61]=[N("Contabilidade (apenas desenvolvedor)")])),_:1})]),_:1}),t(a,{col:"12"},{default:s(()=>[i.compraTitulos.length?(H(),J(n,{key:0,text:"sub1 medium"},{default:s(()=>e[62]||(e[62]=[N("Titulos")])),_:1})):re("",!0),t(Te,{highlight:"",class:"q-pa-none"},{default:s(()=>[(H(!0),we(De,null,qe(i.compraTitulos,r=>(H(),J(_,{key:r.id,items:"center"},{default:s(()=>[t(a,{col:"sm2"},{default:s(()=>[t(p,{modelValue:r.dataVencimento,"somente-leitura":"",rotulo:"Data vencimento",tipo:"data",dense:""},null,8,["modelValue"])]),_:2},1024),t(a,{col:"sm2"},{default:s(()=>[t(p,{modelValue:r.dataPagamento||"A pagar","somente-leitura":"",rotulo:"Data pagamento",tipo:r.dataPagamento?"data":"texto",dense:""},null,8,["modelValue","tipo"])]),_:2},1024),t(a,{col:"sm2"},{default:s(()=>[t(p,{modelValue:r.valor,"somente-leitura":"",align:"left",rotulo:"Valor",decimals:"2",tipo:"decimal"},null,8,["modelValue"])]),_:2},1024),t(a,{col:"sm2"},{default:s(()=>[t(p,{modelValue:r.parcela,"somente-leitura":"",align:"left",rotulo:"Parcela"},null,8,["modelValue"])]),_:2},1024),t(a,{col:"sm2"},{default:s(()=>[t(p,{modelValue:r.formaDePagamento,"somente-leitura":"",rotulo:"Forma de pagamento"},null,8,["modelValue"])]),_:2},1024),t(a,{col:"sm2"},{default:s(()=>[t(p,{modelValue:r.observacao,"somente-leitura":"",rotulo:"Observa\xE7\xE3o"},null,8,["modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),t(a,{col:"12"},{default:s(()=>[i.compraMovimentacoes.length?(H(),J(n,{key:0,text:"sub1 medium"},{default:s(()=>e[63]||(e[63]=[N("Movimenta\xE7\xF4es")])),_:1})):re("",!0),t(Te,{highlight:"",class:"q-pa-none"},{default:s(()=>[(H(!0),we(De,null,qe(i.compraMovimentacoes,r=>(H(),J(_,{key:r.id,gutter:"sm",mg:"sm-y",items:"center"},{default:s(()=>[t(a,{col:"xs-grow"},{default:s(()=>[t(p,{modelValue:r.descricao,"somente-leitura":"",rotulo:"Descri\xE7\xE3o"},null,8,["modelValue"])]),_:2},1024),r.valorCredito?(H(),J(a,{key:0,col:"xs6 md2"},{default:s(()=>[t(p,{modelValue:r.valorCredito,"somente-leitura":"",align:"left",rotulo:"Valor Credito",decimals:"2",tipo:"decimal"},null,8,["modelValue"])]),_:2},1024)):re("",!0),r.valorDebito?(H(),J(a,{key:1,col:"xs6 md2"},{default:s(()=>[t(p,{modelValue:r.valorDebito,"somente-leitura":"",align:"left",rotulo:"Valor Debito",decimals:"2",tipo:"decimal"},null,8,["modelValue"])]),_:2},1024)):re("",!0),t(a,{col:"xs6 md-shrink"},{default:s(()=>[t(p,{modelValue:r.dataCompetencia,"somente-leitura":"",rotulo:"Data competencia",tipo:"data",dense:""},null,8,["modelValue"])]),_:2},1024),t(a,{col:"xs-grow"},{default:s(()=>[t(p,{modelValue:r.observacao,"somente-leitura":"",rotulo:"Observa\xE7\xE3o"},null,8,["modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})):re("",!0)]),_:1})]),_:1}),t(Xe,{class:"bg-light border-top"},{default:s(()=>[t(Pe,{class:"bg-light text-tertiary q-px-md u-container"},{default:s(()=>[t(Me,{class:"text-subtitle2"},{default:s(()=>[N(" Valor Total: "+te(i.$filters.numero(i.compra.totalDocumento,2))+" ",1),e[64]||(e[64]=Ie("span",{class:"q-px-xs"},"|",-1)),N(" SKU: "+te(l.skus),1)]),_:1}),t(Qe),ve(t(ce,{onClick:l.excluir_click,type:"submit",class:"q-ml-sm",color:"white","text-color":"negative",flat:"",label:"Excluir"},null,8,["onClick"]),[[ze,i.compra.status==="Digita\xE7\xE3o"]]),ve(t(ce,{onClick:l.finalizar_click,type:"submit",class:"q-ml-sm",color:"primary",unelevated:"",label:"Finalizar"},null,8,["onClick"]),[[ze,i.compra.status==="Digita\xE7\xE3o"]]),ve(t(ce,{onClick:l.reabrir_click,color:"tertiary",flat:"",label:"Reabrir",type:"submit",class:"q-ml-sm"},null,8,["onClick"]),[[ze,i.compra.status==="Finalizado"]]),ve(t(ce,{unelevated:"",onClick:l.transformarEmNotaDeEntrada_click,class:"q-ml-sm",color:"primary",label:"Transformar em Nota de Entrada",type:"submit"},null,8,["onClick"]),[[ze,i.compra.status==="Finalizado"&&i.compra.operacao==="Pedido de Compra"]])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onKeyup"]),t(y,{ref:"ModalEditarProdutoCompras",onSalvar:l.fecharEdicaoProduto},null,8,["onSalvar"]),t(h,{modelValue:i.adicionar.modal.value,"onUpdate:modelValue":e[34]||(e[34]=r=>i.adicionar.modal.value=r),filtro:{ativo:!0,idEmpresa:i.compra.idEmpresa},ref:"promptItem",habilitarQuantidade:!0,exibirValorVenda:!1,calculaItemCusto:!0,onSelecionarItens:l.selecionarItens},null,8,["modelValue","filtro","onSelecionarItens"])],64)}var Kt=st(Ht,[["render",Qt]]);const Yt={components:{PromptItemV2:bt},data(){return{mostrarItemModal:!1,idxItem:0,compra:{},compraItens:[],compraItensNaoVinculados:[],visivel:!1,edicaoGeral:{marca:"",grupo:"",subGrupo:"",percentualMarkup:0},modalMarkup:{visivel:!1,idItem:"",custo:0,venda:0,markup:0,lucro:0,origem:{}},tela:{width:0,height:0}}},emits:["atualizar","concluirImportacao"],computed:{produtosNaoVinculados(){return this.compraItens.reduce((i,e)=>i+(e.vinculado?0:1),0)},quantProdutos(){return this.compraItens.reduce((i,e)=>i+1,0)}},methods:{async mostrar(i){for(const e of i.documentosItem)this.recalcularItem_blur(e);this.compra=i,this.compraItens=i.documentosItem,this.compraItensNaoVinculados=this.compraItens.filter(({vinculado:e})=>!e),this.visivel=!0},async fechar(){this.visivel=!1},async selecionarItens(i){await $tryLoading(async()=>{var n,a,c;const e=(n=Object.values(i)[0])==null?void 0:n.item;$utils.verificarErro(!(e!=null&&e.id),"Produto inv\xE1lido"),this.compraItensNaoVinculados[this.idxItem].item=e;const{documentoItem:m,item:I,nfeProd:o}=this.compraItensNaoVinculados[this.idxItem];m.idItem=I.id,m.descricaoItem=I.descricao;const l={id:$utils.uuid(),idItem:m.idItem,idContato:this.compra.documento.idContato,referencia:o.cProd,descricao:o.xProd};(c=(a=this.compra)==null?void 0:a.fornecedor)!=null&&c.contato&&$db.compra.gravaFornecedor({atual:this.compra.fornecedor}),await $db.hibrido.grava("itemFornecedor",{atual:l}),this.compraItensNaoVinculados[this.idxItem].vinculado=!0,this.compraItensNaoVinculados=this.compraItens.filter(({vinculado:g})=>!g),$q.notifyPositive(`Produto vinculado com sucesso: ${I.descricao}`)},{mensagem:"Vinculando produto..."}),this.mostrarItemModal=!1},aplicar_click(){for(const i of this.compraItens)i.vinculado||(this.edicaoGeral.marca&&(i.item.marca=this.edicaoGeral.marca),this.edicaoGeral.grupo&&(i.item.grupo=this.edicaoGeral.grupo),this.edicaoGeral.subGrupo&&(i.item.subGrupo=this.edicaoGeral.subGrupo),this.edicaoGeral.percentualMarkup&&(i.item.percentualMarkup=this.edicaoGeral.percentualMarkup,this.recalcularItem_blur(i)))},async recalcularItem_blur(i){const{item:m,documentoItem:I,itemAnterior:o=$utils.clonarV2(i.item)}=i,{valorFreteRateado:l=0,valorSeguroRateado:n=0,valorOutrasDespesasRateado:a=0}=I;i.valoresEdicao||(i.valoresEdicao={valorOutrasDespesas:l+n+a,percentualIpi:I.percentualIpi||0,percentualIcmsSt:I.percentualIcmsSt||0,percentualDifal:0});const{valorOutrasDespesas:c,percentualIpi:g,percentualIcmsSt:_,percentualDifal:b}=i.valoresEdicao,{valorCusto:p=0,percentualMarkup:u=0,valorVenda:y=0}=m,h=p+c,w=h*g/100,r=h*_/100,v=h*b/100;m.valorCustoReposicao=$utils.arredondar(h+w+r+v,2),y!==o.valorVenda?m.percentualMarkup=$utils.arredondar(100*(y-m.valorCustoReposicao)/y,2):m.valorVenda=$utils.arredondar(m.valorCustoReposicao/(1-u/100),2),m.valorVenda===0&&(m.percentualMarkup=(m.valorVenda-m.valorCustoReposicao)/(m.valorVenda+1e-9)*100),i.itemAnterior=$utils.clonarV2(m)},async adicionarItem_click(i){i.buttonLoading=!0,await this.$nextTick(),await $tryLoading(async()=>{var o,l;const e=await $db.hibrido.lista({table:"item",where:{referencia:i.item.referencia}});$utils.verificarErro(e.length,"Referencia j\xE1 utilizada por outro produto"),i.documentoItem.descricaoItem=i.item.descricao,i.item.descricaoConcatenada=i.item.descricao;const m=i.nfeProd,I={id:$utils.uuid(),idItem:i.item.id,idContato:this.compra.documento.idContato,referencia:m.cProd,descricao:m.xProd};await $db.hibrido.grava("item",{atual:i.item}),await $db.item.carregarMemoria(i.item.id),(l=(o=this.compra)==null?void 0:o.fornecedor)!=null&&l.contato&&$db.compra.gravaFornecedor({atual:this.compra.fornecedor}),await $db.hibrido.grava("itemFornecedor",{atual:I}),i.vinculado=!0,$q.notifyPositive(`Item criado com sucesso: ${i.item.descricao}`)},{mensagem:"Cadastrando produto..."}),i.buttonLoading=!1},async salvar_click(){this.compraItens.some(({vinculado:i})=>!i)?$q.notifyError("Verifique todos os itens n\xE3o vinculados!"):(this.mostrarItemModal=!1,this.visivel=!1,this.$emit("concluirImportacao",this.compra))},async incluirTodos_click(){for(const i of this.compraItens)i.vinculado||await this.adicionarItem_click(i)},edicaoGeralMarkup(){this.edicaoGeral.percentualMarkup=this.edicaoGeral.percentualMarkup>99.99?99.99:this.edicaoGeral.percentualMarkup},rules(i,e){if(i==="lucro"){e.item.valorVenda=e.item.valorCustoReposicao/(1-e.item.percentualMarkup/100),this.$nextTick(()=>{e.item.percentualMarkup>99.99&&(e.item.percentualMarkup=99.99,this.rules("lucro",e))});return}if(i==="venda"){e.item.valorVenda<0&&this.$nextTick(()=>{e.item.valorVenda=e.item.valorCustoReposicao,this.rules("venda",e)}),e.item.valorVenda===0?e.item.percentualMarkup=(e.item.valorVenda-e.item.valorCustoReposicao)/(e.item.valorVenda+1e-9)*100:e.item.percentualMarkup=(e.item.valorVenda-e.item.valorCustoReposicao)/e.item.valorVenda*100,this.$nextTick(()=>{e.item.percentualMarkup>99.99&&(e.item.percentualMarkup=99.99,this.rules("lucro",e))});return}},abrirModalMarkup(i){this.modalMarkup={visivel:!0,idItem:i.item.id,custo:i.item.valorCustoReposicao,venda:i.item.valorVenda,markup:i.item.valorVenda&&i.item.valorCustoReposicao?(i.item.valorVenda/i.item.valorCustoReposicao-1)*100:0,lucro:i.item.valorVenda===0?(i.item.valorVenda-i.item.valorCustoReposicao)/(i.item.valorVenda+1e-9)*100:(i.item.valorVenda-i.item.valorCustoReposicao)/i.item.valorVenda*100,origem:{custo:i.item.valorCustoReposicao,venda:i.item.valorVenda,lucro:i.item.percentualMarkup}}},fecharModalMarkup(i=!1){i?(this.compraItensNaoVinculados.filter(e=>e.item.id===this.modalMarkup.idItem)[0].item.valorCustoReposicao=this.modalMarkup.custo,this.compraItensNaoVinculados.filter(e=>e.item.id===this.modalMarkup.idItem)[0].item.valorVenda=this.modalMarkup.venda,this.compraItensNaoVinculados.filter(e=>e.item.id===this.modalMarkup.idItem)[0].item.percentualMarkup=this.modalMarkup.lucro):(this.compraItensNaoVinculados.filter(e=>e.item.id===this.modalMarkup.idItem)[0].item.valorCustoReposicao=this.modalMarkup.origem.custo,this.compraItensNaoVinculados.filter(e=>e.item.id===this.modalMarkup.idItem)[0].item.valorVenda=this.modalMarkup.origem.venda,this.compraItensNaoVinculados.filter(e=>e.item.id===this.modalMarkup.idItem)[0].item.percentualMarkup=this.modalMarkup.origem.lucro),this.modalMarkup={visivel:!1,idItem:"",custo:0,venda:0,markup:0,lucro:0,origem:{}}},calcularModalMarkup(i){const e=this.modalMarkup,m=1e-9;if(i==="custo"){e.custo<0&&this.$nextTick(()=>{e.custo=0,e.markup=0,e.lucro=0,e.venda=0}),e.markup=(e.venda/e.custo-1)*100,e.venda===0?e.lucro=(e.venda-e.custo)/(e.venda+m)*100:e.lucro=(e.venda-e.custo)/e.venda*100,this.$nextTick(()=>{e.lucro>99.99&&(e.lucro=99.99,this.calcularModalMarkup("lucro"))});return}if(i==="markup"){e.markup<-100&&this.$nextTick(()=>{e.markup=-100,this.calcularModalMarkup("markup")}),e.venda=e.custo+e.markup/100*e.custo,e.venda===0?e.lucro=(e.venda-e.custo)/(e.venda+m)*100:e.lucro=(e.venda-e.custo)/e.venda*100,this.$nextTick(()=>{e.lucro>99.99&&(e.lucro=99.99,this.calcularModalMarkup("lucro"))});return}if(i==="lucro"){e.venda=e.custo/(1-e.lucro/100),e.markup=(e.venda/e.custo-1)*100,this.$nextTick(()=>{e.lucro>99.99&&(e.lucro=99.99,this.calcularModalMarkup("lucro"))});return}if(i==="venda"){e.venda<0&&this.$nextTick(()=>{e.venda=e.custo,this.calcularModalMarkup("venda")}),e.markup=(e.venda/e.custo-1)*100,e.venda===0?e.lucro=(e.venda-e.custo)/(e.venda+m)*100:e.lucro=(e.venda-e.custo)/e.venda*100,this.$nextTick(()=>{e.lucro>99.99&&(e.lucro=99.99,this.calcularModalMarkup("lucro"))});return}},resize(){const i=document.getElementById("ItemFicha");i&&(this.tela={width:i.offsetWidth,height:i.offsetHeight})}}},Jt={id:"ImportarXML"},ea={class:"q-my-md q-mx-sm rounded-borders shadow"},ta={class:"q-my-md q-mx-sm rounded-borders shadow"},aa={class:"text-weight-bold"},oa={class:"text-weight-bold"};function ra(i,e,m,I,o,l){const n=ge("ajuda"),a=ge("g-label"),c=ge("campo"),g=ge("g-col"),_=ge("g-row"),b=ge("PromptItemV2");return H(),we("div",Jt,[t(Re,{modelValue:o.visivel,"onUpdate:modelValue":e[4]||(e[4]=p=>o.visivel=p),persistent:"",maximized:"",onKeyup:ct(l.fechar,["esc"])},{default:s(()=>[t($e,{container:"",view:"hHh LpR fFf",class:"bg-light"},{default:s(()=>[t(He,null,{default:s(()=>[t(Pe,null,{default:s(()=>[t(ce,{icon:"arrow_back",flat:"",round:"",dense:"",onClick:l.fechar},null,8,["onClick"]),t(Me,null,{default:s(()=>e[18]||(e[18]=[N("Importar XML x Cadastro")])),_:1}),t(n)]),_:1})]),_:1}),t(Ze,null,{default:s(()=>[t(Ge,{class:"u-container"},{default:s(()=>[Ie("div",ea,[t(_,{gutter:"md",bg:"bg-white"},{default:s(()=>[t(g,{col:"12"},{default:s(()=>[t(a,{icon:"mdi-set-none sm tertiary left",text:"body1 medium",class:"q-mb-md"},{default:s(()=>e[19]||(e[19]=[N(" Propriedades para todos os produtos ")])),_:1}),t(_,null,{default:s(()=>[t(g,{col:"12 md"},{default:s(()=>[t(c,{modelValue:o.edicaoGeral.marca,"onUpdate:modelValue":e[0]||(e[0]=p=>o.edicaoGeral.marca=p),dense:"",outlined:"",rotulo:"Marca",tipo:"texto"},null,8,["modelValue"])]),_:1}),t(g,{col:"6 md"},{default:s(()=>[t(c,{modelValue:o.edicaoGeral.grupo,"onUpdate:modelValue":e[1]||(e[1]=p=>o.edicaoGeral.grupo=p),dense:"",outlined:"",rotulo:"Grupo",tipo:"texto"},null,8,["modelValue"])]),_:1}),t(g,{col:"6 md"},{default:s(()=>[t(c,{modelValue:o.edicaoGeral.subGrupo,"onUpdate:modelValue":e[2]||(e[2]=p=>o.edicaoGeral.subGrupo=p),dense:"",outlined:"",rotulo:"SubGrupo",tipo:"texto"},null,8,["modelValue"])]),_:1})]),_:1}),t(_,{items:"center",justify:"end"},{default:s(()=>[t(g,{col:"xs-grow sm-shrink"},{default:s(()=>[t(c,{modelValue:o.edicaoGeral.percentualMarkup,"onUpdate:modelValue":e[3]||(e[3]=p=>o.edicaoGeral.percentualMarkup=p),opcoes:{maximumValue:99.99},rules:l.edicaoGeralMarkup(),"lazy-rules":"",dense:"",outlined:"",rotulo:"Margem de Lucro",suffix:"%",tipo:"decimal",decimals:"2",col:"2"},null,8,["modelValue","rules"])]),_:1}),t(g,{col:"shrink"},{default:s(()=>[t(ce,{onClick:l.aplicar_click,unelevated:"",color:"primary",icon:"play_arrow",label:"Aplicar"},null,8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1})]),t(Vt,{items:o.compraItensNaoVinculados,separator:""},{default:s(({item:p,index:u})=>[Ie("div",ta,[t(_,{gutter:"md",bg:"bg-white"},{default:s(()=>[t(g,{col:"12"},{default:s(()=>[t(_,null,{default:s(()=>[t(g,{col:"12 md"},{default:s(()=>[t(c,{modelValue:p.item.descricao,"onUpdate:modelValue":y=>p.item.descricao=y,"somente-leitura":!!p.vinculado,dense:"",outlined:"",rotulo:"Descri\xE7\xE3o Item",tipo:"texto",align:"left",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024),t(g,{col:"12 md"},{default:s(()=>[t(c,{modelValue:p.item.referencia,"onUpdate:modelValue":y=>p.item.referencia=y,"somente-leitura":!!p.vinculado,dense:"",outlined:"",rotulo:"Referencia",tipo:"texto",maxlength:"30",align:"left",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024)]),_:2},1024),t(_,null,{default:s(()=>[t(g,{col:"12 md"},{default:s(()=>[t(c,{modelValue:p.item.marca,"onUpdate:modelValue":y=>p.item.marca=y,"somente-leitura":!!p.vinculado,dense:"",outlined:"",rotulo:"Marca",tipo:"texto",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024),t(g,{col:"6 md"},{default:s(()=>[t(de,null,{default:s(()=>[t(c,{modelValue:p.item.grupo,"onUpdate:modelValue":y=>p.item.grupo=y,"somente-leitura":!!p.vinculado,dense:"",outlined:"",rotulo:"Grupo",tipo:"texto",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024)]),_:2},1024),t(g,{col:"6 md"},{default:s(()=>[t(de,null,{default:s(()=>[t(c,{modelValue:p.item.subGrupo,"onUpdate:modelValue":y=>p.item.subGrupo=y,"somente-leitura":!!p.vinculado,dense:"",outlined:"",rotulo:"SubGrupo",tipo:"texto",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024)]),_:2},1024)]),_:2},1024),t(_,null,{default:s(()=>[t(g,{col:"6 md"},{default:s(()=>[t(c,{modelValue:p.item.valorCusto,"onUpdate:modelValue":y=>p.item.valorCusto=y,dense:"",outlined:"","somente-leitura":"",rotulo:"Valor pr\xE9 custo",tipo:"decimal",decimals:"4",zerosDireita:"2",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(g,{col:"6 md"},{default:s(()=>[t(c,{modelValue:p.valoresEdicao.valorOutrasDespesas,"onUpdate:modelValue":y=>p.valoresEdicao.valorOutrasDespesas=y,onBlur:y=>l.recalcularItem_blur(p),"somente-leitura":!!p.vinculado,dense:"",outlined:"",rotulo:"Outras Despesas",tipo:"decimal",decimals:"4",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue","onBlur","somente-leitura"])]),_:2},1024),t(g,{col:"6 md"},{default:s(()=>[t(c,{modelValue:p.valoresEdicao.percentualIpi,"onUpdate:modelValue":y=>p.valoresEdicao.percentualIpi=y,onBlur:y=>l.recalcularItem_blur(p),opcoes:{maximumValue:100},"somente-leitura":!!p.vinculado,outlined:"",dense:"",rotulo:"IPI",suffix:"%",tipo:"decimal",decimals:"2",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue","onBlur","somente-leitura"])]),_:2},1024),t(g,{col:"6 md"},{default:s(()=>[t(c,{modelValue:p.valoresEdicao.percentualIcmsSt,"onUpdate:modelValue":y=>p.valoresEdicao.percentualIcmsSt=y,onBlur:y=>l.recalcularItem_blur(p),opcoes:{maximumValue:100},"somente-leitura":!!p.vinculado,dense:"",outlined:"",rotulo:"ST",suffix:"%",tipo:"decimal",decimals:"2",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue","onBlur","somente-leitura"])]),_:2},1024),t(g,{col:"6 md"},{default:s(()=>[t(c,{modelValue:p.valoresEdicao.percentualDifal,"onUpdate:modelValue":y=>p.valoresEdicao.percentualDifal=y,onBlur:y=>l.recalcularItem_blur(p),opcoes:{maximumValue:100},"somente-leitura":!!p.vinculado,dense:"",outlined:"",rotulo:"DIFAL",suffix:"%",tipo:"decimal",decimals:"2",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue","onBlur","somente-leitura"])]),_:2},1024),t(g,{col:"6 md"},{default:s(()=>[t(c,{modelValue:p.item.valorCustoReposicao,"onUpdate:modelValue":y=>p.item.valorCustoReposicao=y,dense:"",outlined:"","somente-leitura":"",rotulo:"Custo de reposi\xE7\xE3o",tipo:"decimal",decimals:"4",zerosDireita:"2",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(g,{col:"6 md"},{default:s(()=>[t(c,{modelValue:p.item.percentualMarkup,"onUpdate:modelValue":y=>p.item.percentualMarkup=y,onBlur:y=>l.recalcularItem_blur(p),opcoes:{maximumValue:99.99},"somente-leitura":!!p.vinculado,dense:"",outlined:"",rotulo:"Margem de Lucro",suffix:"%",tipo:"decimal",decimals:"2",class:"q-field--with-bottom",rules:[y=>{y>99.99&&l.abrirModalMarkup(p)}],after:[{icon:"calculate",color:"primary",round:!0,dense:!0,flat:!0,handler:()=>l.abrirModalMarkup(p)}]},null,8,["modelValue","onUpdate:modelValue","onBlur","somente-leitura","rules","after"])]),_:2},1024),t(g,{col:"6 md"},{default:s(()=>[t(c,{modelValue:p.item.valorVenda,"onUpdate:modelValue":y=>p.item.valorVenda=y,onBlur:y=>l.recalcularItem_blur(p),"somente-leitura":!!p.vinculado,dense:"",outlined:"",rotulo:"Valor de Venda",rules:l.rules("venda",p),tipo:"decimal",decimals:"4",zerosDireita:"2",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue","onBlur","somente-leitura","rules"])]),_:2},1024)]),_:2},1024),p.vinculado?(H(),J(_,{key:1,items:"center",justify:"end"},{default:s(()=>e[21]||(e[21]=[N(" Produto vinculado ")])),_:1})):(H(),J(_,{key:0,items:"center",justify:"end"},{default:s(()=>[t(g,{col:"shrink"},{default:s(()=>[t(ce,{onClick:()=>{o.mostrarItemModal=!o.mostrarItemModal,o.idxItem=u},unelevated:"",icon:"search",label:"Vincular",color:"primary",class:"q-px-sm"},null,8,["onClick"])]),_:2},1024),t(g,{col:"shrink"},{default:s(()=>[t(a,null,{default:s(()=>e[20]||(e[20]=[N("ou")])),_:1})]),_:1}),t(g,{col:"shrink"},{default:s(()=>[t(ce,{onClick:y=>l.adicionarItem_click(p),loading:p.buttonLoading,unelevated:"",icon:"add",label:"Novo",color:"primary",class:"q-px-sm"},null,8,["onClick","loading"])]),_:2},1024)]),_:2},1024))]),_:2},1024)]),_:2},1024)])]),_:1},8,["items"])]),_:1})]),_:1}),t(Xe,{class:"bg-white border-top"},{default:s(()=>[t(Pe,{class:"u-container"},{default:s(()=>[t(he,null,{default:s(()=>[t(Y,null,{default:s(()=>[t(de,{caption:"",class:"text-weight-medium"},{default:s(()=>[e[22]||(e[22]=N(" Produtos: ")),Ie("span",aa,te(l.quantProdutos),1)]),_:1}),t(de,{caption:"",class:"text-weight-medium"},{default:s(()=>[e[23]||(e[23]=N(" N\xE3o vinculados: ")),Ie("span",oa,te(l.produtosNaoVinculados),1)]),_:1})]),_:1})]),_:1}),t(Qe),l.produtosNaoVinculados?(H(),J(ce,{key:0,onClick:l.incluirTodos_click,unelevated:"",label:"Incluir Todos",color:"primary",class:"q-ml-sm"},null,8,["onClick"])):(H(),J(ce,{key:1,onClick:l.salvar_click,unelevated:"",label:"Salvar",color:"primary",class:"q-ml-sm"},null,8,["onClick"]))]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onKeyup"]),t(b,{modelValue:o.mostrarItemModal,"onUpdate:modelValue":e[5]||(e[5]=p=>o.mostrarItemModal=p),onSelecionarItens:l.selecionarItens,filtro:{ativo:!0,idEmpresa:o.compra.idEmpresa},exibirValorVenda:!1,habilitarQuantidade:!1,ref:"promptItem"},null,8,["modelValue","onSelecionarItens","filtro"]),t(Re,{modelValue:o.modalMarkup.visivel,"onUpdate:modelValue":e[16]||(e[16]=p=>o.modalMarkup.visivel=p),onKeyup:e[17]||(e[17]=ct(p=>l.fecharModalMarkup(),["esc"])),persistent:""},{default:s(()=>[t($e,{container:"",view:"hHh LpR fFf",class:"bg-white rounded-borders",style:xt(o.tela.width<=550?"height:100%;max-height:540px;":"max-width:550px;height:100%;max-height:500px;")},{default:s(()=>[t(He,null,{default:s(()=>[t(Pe,null,{default:s(()=>[t(me,{name:"calculate",size:"sm",flat:""}),t(Me,null,{default:s(()=>e[24]||(e[24]=[N("Markup X Margem de Lucro")])),_:1})]),_:1})]),_:1}),t(Ze,null,{default:s(()=>[t(Ge,null,{default:s(()=>[t(_,{gutter:"md",class:"q-mb-lg"},{default:s(()=>[t(g,{col:"12"},{default:s(()=>[t(a,{bordered:"","rounded-borders":"",text:"caption",class:"q-pa-sm"},{default:s(()=>e[25]||(e[25]=[Ie("strong",null,"N\xE3o \xE9 para ter margem\xA0de\xA0lucro superior a 99.99%",-1),N(", o c\xE1lculo do lucro \xE9 sempre sobre o valor da venda, a explica\xE7\xE3o vem da an\xE1lise que o lucro da "),Ie("strong",null,"EMPRESA",-1),N(" sempre \xE9 c\xE1lculado com base no "),Ie("strong",null,"LUCRO",-1),N(" x "),Ie("strong",null,"FATURAMENTO",-1),N(". ")])),_:1})]),_:1})]),_:1}),t(_,{gutter:"md-x",justify:"center"},{default:s(()=>[t(g,{col:"6 sm5"},{default:s(()=>[t(c,{modelValue:o.modalMarkup.custo,"onUpdate:modelValue":[e[6]||(e[6]=p=>o.modalMarkup.custo=p),e[7]||(e[7]=p=>l.calcularModalMarkup("custo"))],somenteLeitura:"",dense:"",filled:"","lazy-rules":"",tipo:"decimal",rotulo:"Custo de reposi\xE7\xE3o",decimals:"2",zerosDireita:"2","hide-bottom-space":"",class:"q-mb-lg",debounce:500},null,8,["modelValue"])]),_:1})]),_:1}),t(_,{gutter:"md-x",justify:"center"},{default:s(()=>[t(g,{col:"6 sm5"},{default:s(()=>[t(c,{modelValue:o.modalMarkup.markup,"onUpdate:modelValue":[e[8]||(e[8]=p=>o.modalMarkup.markup=p),e[9]||(e[9]=p=>l.calcularModalMarkup("markup"))],filled:"",dense:"","lazy-rules":"",rotulo:"Percentual Markup",somenteLeitura:!(o.modalMarkup.custo>0),tipo:"decimal",decimals:"2",zerosDireita:"2",suffix:"%","hide-bottom-space":"",debounce:500},null,8,["modelValue","somenteLeitura"]),t(a,{class:"q-pa-xs",style:{"font-size":"11px","line-height":"1.1"}},{default:s(()=>e[26]||(e[26]=[N(" \xC9 um \xEDndice aplicado sobre o pre\xE7o de custo para determinar o pre\xE7o de venda. ")])),_:1})]),_:1}),t(g,{col:"6 sm5"},{default:s(()=>[t(c,{modelValue:o.modalMarkup.lucro,"onUpdate:modelValue":[e[10]||(e[10]=p=>o.modalMarkup.lucro=p),e[11]||(e[11]=p=>l.calcularModalMarkup("lucro"))],filled:"",dense:"","lazy-rules":"",tipo:"decimal",rotulo:"Margem de Lucro",somenteLeitura:!(o.modalMarkup.custo>0),suffix:"%",decimals:"2",zerosDireita:"2","hide-bottom-space":"",debounce:500},null,8,["modelValue","somenteLeitura"]),t(a,{class:"q-pa-xs",style:{"font-size":"11px","line-height":"1.1"}},{default:s(()=>e[27]||(e[27]=[N(" \xC9 o percentual do pre\xE7o de venda correspondente ao lucro da opera\xE7\xE3o. ")])),_:1})]),_:1})]),_:1}),t(_,{gutter:"md-x",justify:"center"},{default:s(()=>[t(g,{col:"6 sm5"},{default:s(()=>[t(c,{modelValue:o.modalMarkup.venda,"onUpdate:modelValue":[e[12]||(e[12]=p=>o.modalMarkup.venda=p),e[13]||(e[13]=p=>l.calcularModalMarkup("venda"))],somenteLeitura:!(o.modalMarkup.custo>0),debounce:500,filled:"",dense:"","lazy-rules":"","hide-bottom-space":"",rotulo:"Valor de Venda",tipo:"decimal",decimals:"2",zerosDireita:"2",class:"q-mt-md"},null,8,["modelValue","somenteLeitura"])]),_:1})]),_:1})]),_:1})]),_:1}),t(Xe,{class:"bg-light"},{default:s(()=>[t(Pe,null,{default:s(()=>[t(Qe),t(ce,{onClick:e[14]||(e[14]=p=>l.fecharModalMarkup()),flat:"",label:"Cancelar",color:"tertiary"}),t(ce,{onClick:e[15]||(e[15]=p=>l.fecharModalMarkup(!0)),unelevated:"",label:"Aplicar",color:"primary",class:"q-ml-sm"})]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["modelValue"])])}var ia=st(Yt,[["render",ra]]),_t={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(i,e){(function(m){i.exports=m()})(function(){return function m(I,o,l){function n(g,_){if(!o[g]){if(!I[g]){var b=typeof ot=="function"&&ot;if(!_&&b)return b(g,!0);if(a)return a(g,!0);var p=new Error("Cannot find module '"+g+"'");throw p.code="MODULE_NOT_FOUND",p}var u=o[g]={exports:{}};I[g][0].call(u.exports,function(y){var h=I[g][1][y];return n(h||y)},u,u.exports,m,I,o,l)}return o[g].exports}for(var a=typeof ot=="function"&&ot,c=0;c<l.length;c++)n(l[c]);return n}({1:[function(m,I,o){var l=m("./utils"),n=m("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";o.encode=function(c){for(var g,_,b,p,u,y,h,w=[],r=0,v=c.length,S=v,D=l.getTypeOf(c)!=="string";r<c.length;)S=v-r,b=D?(g=c[r++],_=r<v?c[r++]:0,r<v?c[r++]:0):(g=c.charCodeAt(r++),_=r<v?c.charCodeAt(r++):0,r<v?c.charCodeAt(r++):0),p=g>>2,u=(3&g)<<4|_>>4,y=1<S?(15&_)<<2|b>>6:64,h=2<S?63&b:64,w.push(a.charAt(p)+a.charAt(u)+a.charAt(y)+a.charAt(h));return w.join("")},o.decode=function(c){var g,_,b,p,u,y,h=0,w=0,r="data:";if(c.substr(0,r.length)===r)throw new Error("Invalid base64 input, it looks like a data url.");var v,S=3*(c=c.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(c.charAt(c.length-1)===a.charAt(64)&&S--,c.charAt(c.length-2)===a.charAt(64)&&S--,S%1!=0)throw new Error("Invalid base64 input, bad content length.");for(v=n.uint8array?new Uint8Array(0|S):new Array(0|S);h<c.length;)g=a.indexOf(c.charAt(h++))<<2|(p=a.indexOf(c.charAt(h++)))>>4,_=(15&p)<<4|(u=a.indexOf(c.charAt(h++)))>>2,b=(3&u)<<6|(y=a.indexOf(c.charAt(h++))),v[w++]=g,u!==64&&(v[w++]=_),y!==64&&(v[w++]=b);return v}},{"./support":30,"./utils":32}],2:[function(m,I,o){var l=m("./external"),n=m("./stream/DataWorker"),a=m("./stream/Crc32Probe"),c=m("./stream/DataLengthProbe");function g(_,b,p,u,y){this.compressedSize=_,this.uncompressedSize=b,this.crc32=p,this.compression=u,this.compressedContent=y}g.prototype={getContentWorker:function(){var _=new n(l.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new c("data_length")),b=this;return _.on("end",function(){if(this.streamInfo.data_length!==b.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),_},getCompressedWorker:function(){return new n(l.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},g.createWorkerFrom=function(_,b,p){return _.pipe(new a).pipe(new c("uncompressedSize")).pipe(b.compressWorker(p)).pipe(new c("compressedSize")).withStreamInfo("compression",b)},I.exports=g},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(m,I,o){var l=m("./stream/GenericWorker");o.STORE={magic:"\0\0",compressWorker:function(){return new l("STORE compression")},uncompressWorker:function(){return new l("STORE decompression")}},o.DEFLATE=m("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(m,I,o){var l=m("./utils"),n=function(){for(var a,c=[],g=0;g<256;g++){a=g;for(var _=0;_<8;_++)a=1&a?3988292384^a>>>1:a>>>1;c[g]=a}return c}();I.exports=function(a,c){return a!==void 0&&a.length?l.getTypeOf(a)!=="string"?function(g,_,b,p){var u=n,y=p+b;g^=-1;for(var h=p;h<y;h++)g=g>>>8^u[255&(g^_[h])];return-1^g}(0|c,a,a.length,0):function(g,_,b,p){var u=n,y=p+b;g^=-1;for(var h=p;h<y;h++)g=g>>>8^u[255&(g^_.charCodeAt(h))];return-1^g}(0|c,a,a.length,0):0}},{"./utils":32}],5:[function(m,I,o){o.base64=!1,o.binary=!1,o.dir=!1,o.createFolders=!0,o.date=null,o.compression=null,o.compressionOptions=null,o.comment=null,o.unixPermissions=null,o.dosPermissions=null},{}],6:[function(m,I,o){var l=null;l=typeof Promise!="undefined"?Promise:m("lie"),I.exports={Promise:l}},{lie:37}],7:[function(m,I,o){var l=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Uint32Array!="undefined",n=m("pako"),a=m("./utils"),c=m("./stream/GenericWorker"),g=l?"uint8array":"array";function _(b,p){c.call(this,"FlateWorker/"+b),this._pako=null,this._pakoAction=b,this._pakoOptions=p,this.meta={}}o.magic="\b\0",a.inherits(_,c),_.prototype.processChunk=function(b){this.meta=b.meta,this._pako===null&&this._createPako(),this._pako.push(a.transformTo(g,b.data),!1)},_.prototype.flush=function(){c.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},_.prototype.cleanUp=function(){c.prototype.cleanUp.call(this),this._pako=null},_.prototype._createPako=function(){this._pako=new n[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var b=this;this._pako.onData=function(p){b.push({data:p,meta:b.meta})}},o.compressWorker=function(b){return new _("Deflate",b)},o.uncompressWorker=function(){return new _("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(m,I,o){function l(u,y){var h,w="";for(h=0;h<y;h++)w+=String.fromCharCode(255&u),u>>>=8;return w}function n(u,y,h,w,r,v){var S,D,V=u.file,B=u.compression,q=v!==g.utf8encode,j=a.transformTo("string",v(V.name)),A=a.transformTo("string",g.utf8encode(V.name)),G=V.comment,oe=a.transformTo("string",v(G)),E=a.transformTo("string",g.utf8encode(G)),O=A.length!==V.name.length,f=E.length!==G.length,M="",ne="",Z="",ue=V.dir,R=V.date,se={crc32:0,compressedSize:0,uncompressedSize:0};y&&!h||(se.crc32=u.crc32,se.compressedSize=u.compressedSize,se.uncompressedSize=u.uncompressedSize);var z=0;y&&(z|=8),q||!O&&!f||(z|=2048);var F=0,ee=0;ue&&(F|=16),r==="UNIX"?(ee=798,F|=function(K,be){var ke=K;return K||(ke=be?16893:33204),(65535&ke)<<16}(V.unixPermissions,ue)):(ee=20,F|=function(K){return 63&(K||0)}(V.dosPermissions)),S=R.getUTCHours(),S<<=6,S|=R.getUTCMinutes(),S<<=5,S|=R.getUTCSeconds()/2,D=R.getUTCFullYear()-1980,D<<=4,D|=R.getUTCMonth()+1,D<<=5,D|=R.getUTCDate(),O&&(ne=l(1,1)+l(_(j),4)+A,M+="up"+l(ne.length,2)+ne),f&&(Z=l(1,1)+l(_(oe),4)+E,M+="uc"+l(Z.length,2)+Z);var W="";return W+=`
\0`,W+=l(z,2),W+=B.magic,W+=l(S,2),W+=l(D,2),W+=l(se.crc32,4),W+=l(se.compressedSize,4),W+=l(se.uncompressedSize,4),W+=l(j.length,2),W+=l(M.length,2),{fileRecord:b.LOCAL_FILE_HEADER+W+j+M,dirRecord:b.CENTRAL_FILE_HEADER+l(ee,2)+W+l(oe.length,2)+"\0\0\0\0"+l(F,4)+l(w,4)+j+M+oe}}var a=m("../utils"),c=m("../stream/GenericWorker"),g=m("../utf8"),_=m("../crc32"),b=m("../signature");function p(u,y,h,w){c.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=y,this.zipPlatform=h,this.encodeFileName=w,this.streamFiles=u,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}a.inherits(p,c),p.prototype.push=function(u){var y=u.meta.percent||0,h=this.entriesCount,w=this._sources.length;this.accumulate?this.contentBuffer.push(u):(this.bytesWritten+=u.data.length,c.prototype.push.call(this,{data:u.data,meta:{currentFile:this.currentFile,percent:h?(y+100*(h-w-1))/h:100}}))},p.prototype.openedSource=function(u){this.currentSourceOffset=this.bytesWritten,this.currentFile=u.file.name;var y=this.streamFiles&&!u.file.dir;if(y){var h=n(u,y,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:h.fileRecord,meta:{percent:0}})}else this.accumulate=!0},p.prototype.closedSource=function(u){this.accumulate=!1;var y=this.streamFiles&&!u.file.dir,h=n(u,y,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(h.dirRecord),y)this.push({data:function(w){return b.DATA_DESCRIPTOR+l(w.crc32,4)+l(w.compressedSize,4)+l(w.uncompressedSize,4)}(u),meta:{percent:100}});else for(this.push({data:h.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},p.prototype.flush=function(){for(var u=this.bytesWritten,y=0;y<this.dirRecords.length;y++)this.push({data:this.dirRecords[y],meta:{percent:100}});var h=this.bytesWritten-u,w=function(r,v,S,D,V){var B=a.transformTo("string",V(D));return b.CENTRAL_DIRECTORY_END+"\0\0\0\0"+l(r,2)+l(r,2)+l(v,4)+l(S,4)+l(B.length,2)+B}(this.dirRecords.length,h,u,this.zipComment,this.encodeFileName);this.push({data:w,meta:{percent:100}})},p.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},p.prototype.registerPrevious=function(u){this._sources.push(u);var y=this;return u.on("data",function(h){y.processChunk(h)}),u.on("end",function(){y.closedSource(y.previous.streamInfo),y._sources.length?y.prepareNextSource():y.end()}),u.on("error",function(h){y.error(h)}),this},p.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},p.prototype.error=function(u){var y=this._sources;if(!c.prototype.error.call(this,u))return!1;for(var h=0;h<y.length;h++)try{y[h].error(u)}catch{}return!0},p.prototype.lock=function(){c.prototype.lock.call(this);for(var u=this._sources,y=0;y<u.length;y++)u[y].lock()},I.exports=p},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(m,I,o){var l=m("../compressions"),n=m("./ZipFileWorker");o.generateWorker=function(a,c,g){var _=new n(c.streamFiles,g,c.platform,c.encodeFileName),b=0;try{a.forEach(function(p,u){b++;var y=function(v,S){var D=v||S,V=l[D];if(!V)throw new Error(D+" is not a valid compression method !");return V}(u.options.compression,c.compression),h=u.options.compressionOptions||c.compressionOptions||{},w=u.dir,r=u.date;u._compressWorker(y,h).withStreamInfo("file",{name:p,dir:w,date:r,comment:u.comment||"",unixPermissions:u.unixPermissions,dosPermissions:u.dosPermissions}).pipe(_)}),_.entriesCount=b}catch(p){_.error(p)}return _}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(m,I,o){function l(){if(!(this instanceof l))return new l;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var n=new l;for(var a in this)typeof this[a]!="function"&&(n[a]=this[a]);return n}}(l.prototype=m("./object")).loadAsync=m("./load"),l.support=m("./support"),l.defaults=m("./defaults"),l.version="3.10.1",l.loadAsync=function(n,a){return new l().loadAsync(n,a)},l.external=m("./external"),I.exports=l},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(m,I,o){var l=m("./utils"),n=m("./external"),a=m("./utf8"),c=m("./zipEntries"),g=m("./stream/Crc32Probe"),_=m("./nodejsUtils");function b(p){return new n.Promise(function(u,y){var h=p.decompressed.getContentWorker().pipe(new g);h.on("error",function(w){y(w)}).on("end",function(){h.streamInfo.crc32!==p.decompressed.crc32?y(new Error("Corrupted zip : CRC32 mismatch")):u()}).resume()})}I.exports=function(p,u){var y=this;return u=l.extend(u||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),_.isNode&&_.isStream(p)?n.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):l.prepareContent("the loaded zip file",p,!0,u.optimizedBinaryString,u.base64).then(function(h){var w=new c(u);return w.load(h),w}).then(function(h){var w=[n.Promise.resolve(h)],r=h.files;if(u.checkCRC32)for(var v=0;v<r.length;v++)w.push(b(r[v]));return n.Promise.all(w)}).then(function(h){for(var w=h.shift(),r=w.files,v=0;v<r.length;v++){var S=r[v],D=S.fileNameStr,V=l.resolve(S.fileNameStr);y.file(V,S.decompressed,{binary:!0,optimizedBinaryString:!0,date:S.date,dir:S.dir,comment:S.fileCommentStr.length?S.fileCommentStr:null,unixPermissions:S.unixPermissions,dosPermissions:S.dosPermissions,createFolders:u.createFolders}),S.dir||(y.file(V).unsafeOriginalName=D)}return w.zipComment.length&&(y.comment=w.zipComment),y})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(m,I,o){var l=m("../utils"),n=m("../stream/GenericWorker");function a(c,g){n.call(this,"Nodejs stream input adapter for "+c),this._upstreamEnded=!1,this._bindStream(g)}l.inherits(a,n),a.prototype._bindStream=function(c){var g=this;(this._stream=c).pause(),c.on("data",function(_){g.push({data:_,meta:{percent:0}})}).on("error",function(_){g.isPaused?this.generatedError=_:g.error(_)}).on("end",function(){g.isPaused?g._upstreamEnded=!0:g.end()})},a.prototype.pause=function(){return!!n.prototype.pause.call(this)&&(this._stream.pause(),!0)},a.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},I.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(m,I,o){var l=m("readable-stream").Readable;function n(a,c,g){l.call(this,c),this._helper=a;var _=this;a.on("data",function(b,p){_.push(b)||_._helper.pause(),g&&g(p)}).on("error",function(b){_.emit("error",b)}).on("end",function(){_.push(null)})}m("../utils").inherits(n,l),n.prototype._read=function(){this._helper.resume()},I.exports=n},{"../utils":32,"readable-stream":16}],14:[function(m,I,o){I.exports={isNode:typeof Buffer!="undefined",newBufferFrom:function(l,n){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(l,n);if(typeof l=="number")throw new Error('The "data" argument must not be a number');return new Buffer(l,n)},allocBuffer:function(l){if(Buffer.alloc)return Buffer.alloc(l);var n=new Buffer(l);return n.fill(0),n},isBuffer:function(l){return Buffer.isBuffer(l)},isStream:function(l){return l&&typeof l.on=="function"&&typeof l.pause=="function"&&typeof l.resume=="function"}}},{}],15:[function(m,I,o){function l(V,B,q){var j,A=a.getTypeOf(B),G=a.extend(q||{},_);G.date=G.date||new Date,G.compression!==null&&(G.compression=G.compression.toUpperCase()),typeof G.unixPermissions=="string"&&(G.unixPermissions=parseInt(G.unixPermissions,8)),G.unixPermissions&&16384&G.unixPermissions&&(G.dir=!0),G.dosPermissions&&16&G.dosPermissions&&(G.dir=!0),G.dir&&(V=r(V)),G.createFolders&&(j=w(V))&&v.call(this,j,!0);var oe=A==="string"&&G.binary===!1&&G.base64===!1;q&&q.binary!==void 0||(G.binary=!oe),(B instanceof b&&B.uncompressedSize===0||G.dir||!B||B.length===0)&&(G.base64=!1,G.binary=!0,B="",G.compression="STORE",A="string");var E=null;E=B instanceof b||B instanceof c?B:y.isNode&&y.isStream(B)?new h(V,B):a.prepareContent(V,B,G.binary,G.optimizedBinaryString,G.base64);var O=new p(V,E,G);this.files[V]=O}var n=m("./utf8"),a=m("./utils"),c=m("./stream/GenericWorker"),g=m("./stream/StreamHelper"),_=m("./defaults"),b=m("./compressedObject"),p=m("./zipObject"),u=m("./generate"),y=m("./nodejsUtils"),h=m("./nodejs/NodejsStreamInputAdapter"),w=function(V){V.slice(-1)==="/"&&(V=V.substring(0,V.length-1));var B=V.lastIndexOf("/");return 0<B?V.substring(0,B):""},r=function(V){return V.slice(-1)!=="/"&&(V+="/"),V},v=function(V,B){return B=B!==void 0?B:_.createFolders,V=r(V),this.files[V]||l.call(this,V,null,{dir:!0,createFolders:B}),this.files[V]};function S(V){return Object.prototype.toString.call(V)==="[object RegExp]"}var D={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(V){var B,q,j;for(B in this.files)j=this.files[B],(q=B.slice(this.root.length,B.length))&&B.slice(0,this.root.length)===this.root&&V(q,j)},filter:function(V){var B=[];return this.forEach(function(q,j){V(q,j)&&B.push(j)}),B},file:function(V,B,q){if(arguments.length!==1)return V=this.root+V,l.call(this,V,B,q),this;if(S(V)){var j=V;return this.filter(function(G,oe){return!oe.dir&&j.test(G)})}var A=this.files[this.root+V];return A&&!A.dir?A:null},folder:function(V){if(!V)return this;if(S(V))return this.filter(function(A,G){return G.dir&&V.test(A)});var B=this.root+V,q=v.call(this,B),j=this.clone();return j.root=q.name,j},remove:function(V){V=this.root+V;var B=this.files[V];if(B||(V.slice(-1)!=="/"&&(V+="/"),B=this.files[V]),B&&!B.dir)delete this.files[V];else for(var q=this.filter(function(A,G){return G.name.slice(0,V.length)===V}),j=0;j<q.length;j++)delete this.files[q[j].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(V){var B,q={};try{if((q=a.extend(V||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:n.utf8encode})).type=q.type.toLowerCase(),q.compression=q.compression.toUpperCase(),q.type==="binarystring"&&(q.type="string"),!q.type)throw new Error("No output type specified.");a.checkSupport(q.type),q.platform!=="darwin"&&q.platform!=="freebsd"&&q.platform!=="linux"&&q.platform!=="sunos"||(q.platform="UNIX"),q.platform==="win32"&&(q.platform="DOS");var j=q.comment||this.comment||"";B=u.generateWorker(this,q,j)}catch(A){(B=new c("error")).error(A)}return new g(B,q.type||"string",q.mimeType)},generateAsync:function(V,B){return this.generateInternalStream(V).accumulate(B)},generateNodeStream:function(V,B){return(V=V||{}).type||(V.type="nodebuffer"),this.generateInternalStream(V).toNodejsStream(B)}};I.exports=D},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(m,I,o){I.exports=m("stream")},{stream:void 0}],17:[function(m,I,o){var l=m("./DataReader");function n(a){l.call(this,a);for(var c=0;c<this.data.length;c++)a[c]=255&a[c]}m("../utils").inherits(n,l),n.prototype.byteAt=function(a){return this.data[this.zero+a]},n.prototype.lastIndexOfSignature=function(a){for(var c=a.charCodeAt(0),g=a.charCodeAt(1),_=a.charCodeAt(2),b=a.charCodeAt(3),p=this.length-4;0<=p;--p)if(this.data[p]===c&&this.data[p+1]===g&&this.data[p+2]===_&&this.data[p+3]===b)return p-this.zero;return-1},n.prototype.readAndCheckSignature=function(a){var c=a.charCodeAt(0),g=a.charCodeAt(1),_=a.charCodeAt(2),b=a.charCodeAt(3),p=this.readData(4);return c===p[0]&&g===p[1]&&_===p[2]&&b===p[3]},n.prototype.readData=function(a){if(this.checkOffset(a),a===0)return[];var c=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,c},I.exports=n},{"../utils":32,"./DataReader":18}],18:[function(m,I,o){var l=m("../utils");function n(a){this.data=a,this.length=a.length,this.index=0,this.zero=0}n.prototype={checkOffset:function(a){this.checkIndex(this.index+a)},checkIndex:function(a){if(this.length<this.zero+a||a<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+a+"). Corrupted zip ?")},setIndex:function(a){this.checkIndex(a),this.index=a},skip:function(a){this.setIndex(this.index+a)},byteAt:function(){},readInt:function(a){var c,g=0;for(this.checkOffset(a),c=this.index+a-1;c>=this.index;c--)g=(g<<8)+this.byteAt(c);return this.index+=a,g},readString:function(a){return l.transformTo("string",this.readData(a))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var a=this.readInt(4);return new Date(Date.UTC(1980+(a>>25&127),(a>>21&15)-1,a>>16&31,a>>11&31,a>>5&63,(31&a)<<1))}},I.exports=n},{"../utils":32}],19:[function(m,I,o){var l=m("./Uint8ArrayReader");function n(a){l.call(this,a)}m("../utils").inherits(n,l),n.prototype.readData=function(a){this.checkOffset(a);var c=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,c},I.exports=n},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(m,I,o){var l=m("./DataReader");function n(a){l.call(this,a)}m("../utils").inherits(n,l),n.prototype.byteAt=function(a){return this.data.charCodeAt(this.zero+a)},n.prototype.lastIndexOfSignature=function(a){return this.data.lastIndexOf(a)-this.zero},n.prototype.readAndCheckSignature=function(a){return a===this.readData(4)},n.prototype.readData=function(a){this.checkOffset(a);var c=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,c},I.exports=n},{"../utils":32,"./DataReader":18}],21:[function(m,I,o){var l=m("./ArrayReader");function n(a){l.call(this,a)}m("../utils").inherits(n,l),n.prototype.readData=function(a){if(this.checkOffset(a),a===0)return new Uint8Array(0);var c=this.data.subarray(this.zero+this.index,this.zero+this.index+a);return this.index+=a,c},I.exports=n},{"../utils":32,"./ArrayReader":17}],22:[function(m,I,o){var l=m("../utils"),n=m("../support"),a=m("./ArrayReader"),c=m("./StringReader"),g=m("./NodeBufferReader"),_=m("./Uint8ArrayReader");I.exports=function(b){var p=l.getTypeOf(b);return l.checkSupport(p),p!=="string"||n.uint8array?p==="nodebuffer"?new g(b):n.uint8array?new _(l.transformTo("uint8array",b)):new a(l.transformTo("array",b)):new c(b)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(m,I,o){o.LOCAL_FILE_HEADER="PK",o.CENTRAL_FILE_HEADER="PK",o.CENTRAL_DIRECTORY_END="PK",o.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",o.ZIP64_CENTRAL_DIRECTORY_END="PK",o.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(m,I,o){var l=m("./GenericWorker"),n=m("../utils");function a(c){l.call(this,"ConvertWorker to "+c),this.destType=c}n.inherits(a,l),a.prototype.processChunk=function(c){this.push({data:n.transformTo(this.destType,c.data),meta:c.meta})},I.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(m,I,o){var l=m("./GenericWorker"),n=m("../crc32");function a(){l.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}m("../utils").inherits(a,l),a.prototype.processChunk=function(c){this.streamInfo.crc32=n(c.data,this.streamInfo.crc32||0),this.push(c)},I.exports=a},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(m,I,o){var l=m("../utils"),n=m("./GenericWorker");function a(c){n.call(this,"DataLengthProbe for "+c),this.propName=c,this.withStreamInfo(c,0)}l.inherits(a,n),a.prototype.processChunk=function(c){if(c){var g=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=g+c.data.length}n.prototype.processChunk.call(this,c)},I.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(m,I,o){var l=m("../utils"),n=m("./GenericWorker");function a(c){n.call(this,"DataWorker");var g=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,c.then(function(_){g.dataIsReady=!0,g.data=_,g.max=_&&_.length||0,g.type=l.getTypeOf(_),g.isPaused||g._tickAndRepeat()},function(_){g.error(_)})}l.inherits(a,n),a.prototype.cleanUp=function(){n.prototype.cleanUp.call(this),this.data=null},a.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,l.delay(this._tickAndRepeat,[],this)),!0)},a.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(l.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},a.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var c=null,g=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":c=this.data.substring(this.index,g);break;case"uint8array":c=this.data.subarray(this.index,g);break;case"array":case"nodebuffer":c=this.data.slice(this.index,g)}return this.index=g,this.push({data:c,meta:{percent:this.max?this.index/this.max*100:0}})},I.exports=a},{"../utils":32,"./GenericWorker":28}],28:[function(m,I,o){function l(n){this.name=n||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}l.prototype={push:function(n){this.emit("data",n)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(n){this.emit("error",n)}return!0},error:function(n){return!this.isFinished&&(this.isPaused?this.generatedError=n:(this.isFinished=!0,this.emit("error",n),this.previous&&this.previous.error(n),this.cleanUp()),!0)},on:function(n,a){return this._listeners[n].push(a),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(n,a){if(this._listeners[n])for(var c=0;c<this._listeners[n].length;c++)this._listeners[n][c].call(this,a)},pipe:function(n){return n.registerPrevious(this)},registerPrevious:function(n){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=n.streamInfo,this.mergeStreamInfo(),this.previous=n;var a=this;return n.on("data",function(c){a.processChunk(c)}),n.on("end",function(){a.end()}),n.on("error",function(c){a.error(c)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var n=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),n=!0),this.previous&&this.previous.resume(),!n},flush:function(){},processChunk:function(n){this.push(n)},withStreamInfo:function(n,a){return this.extraStreamInfo[n]=a,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var n in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,n)&&(this.streamInfo[n]=this.extraStreamInfo[n])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var n="Worker "+this.name;return this.previous?this.previous+" -> "+n:n}},I.exports=l},{}],29:[function(m,I,o){var l=m("../utils"),n=m("./ConvertWorker"),a=m("./GenericWorker"),c=m("../base64"),g=m("../support"),_=m("../external"),b=null;if(g.nodestream)try{b=m("../nodejs/NodejsStreamOutputAdapter")}catch{}function p(y,h){return new _.Promise(function(w,r){var v=[],S=y._internalType,D=y._outputType,V=y._mimeType;y.on("data",function(B,q){v.push(B),h&&h(q)}).on("error",function(B){v=[],r(B)}).on("end",function(){try{var B=function(q,j,A){switch(q){case"blob":return l.newBlob(l.transformTo("arraybuffer",j),A);case"base64":return c.encode(j);default:return l.transformTo(q,j)}}(D,function(q,j){var A,G=0,oe=null,E=0;for(A=0;A<j.length;A++)E+=j[A].length;switch(q){case"string":return j.join("");case"array":return Array.prototype.concat.apply([],j);case"uint8array":for(oe=new Uint8Array(E),A=0;A<j.length;A++)oe.set(j[A],G),G+=j[A].length;return oe;case"nodebuffer":return Buffer.concat(j);default:throw new Error("concat : unsupported type '"+q+"'")}}(S,v),V);w(B)}catch(q){r(q)}v=[]}).resume()})}function u(y,h,w){var r=h;switch(h){case"blob":case"arraybuffer":r="uint8array";break;case"base64":r="string"}try{this._internalType=r,this._outputType=h,this._mimeType=w,l.checkSupport(r),this._worker=y.pipe(new n(r)),y.lock()}catch(v){this._worker=new a("error"),this._worker.error(v)}}u.prototype={accumulate:function(y){return p(this,y)},on:function(y,h){var w=this;return y==="data"?this._worker.on(y,function(r){h.call(w,r.data,r.meta)}):this._worker.on(y,function(){l.delay(h,arguments,w)}),this},resume:function(){return l.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(y){if(l.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new b(this,{objectMode:this._outputType!=="nodebuffer"},y)}},I.exports=u},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(m,I,o){if(o.base64=!0,o.array=!0,o.string=!0,o.arraybuffer=typeof ArrayBuffer!="undefined"&&typeof Uint8Array!="undefined",o.nodebuffer=typeof Buffer!="undefined",o.uint8array=typeof Uint8Array!="undefined",typeof ArrayBuffer=="undefined")o.blob=!1;else{var l=new ArrayBuffer(0);try{o.blob=new Blob([l],{type:"application/zip"}).size===0}catch{try{var n=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);n.append(l),o.blob=n.getBlob("application/zip").size===0}catch{o.blob=!1}}}try{o.nodestream=!!m("readable-stream").Readable}catch{o.nodestream=!1}},{"readable-stream":16}],31:[function(m,I,o){for(var l=m("./utils"),n=m("./support"),a=m("./nodejsUtils"),c=m("./stream/GenericWorker"),g=new Array(256),_=0;_<256;_++)g[_]=252<=_?6:248<=_?5:240<=_?4:224<=_?3:192<=_?2:1;g[254]=g[254]=1;function b(){c.call(this,"utf-8 decode"),this.leftOver=null}function p(){c.call(this,"utf-8 encode")}o.utf8encode=function(u){return n.nodebuffer?a.newBufferFrom(u,"utf-8"):function(y){var h,w,r,v,S,D=y.length,V=0;for(v=0;v<D;v++)(64512&(w=y.charCodeAt(v)))==55296&&v+1<D&&(64512&(r=y.charCodeAt(v+1)))==56320&&(w=65536+(w-55296<<10)+(r-56320),v++),V+=w<128?1:w<2048?2:w<65536?3:4;for(h=n.uint8array?new Uint8Array(V):new Array(V),v=S=0;S<V;v++)(64512&(w=y.charCodeAt(v)))==55296&&v+1<D&&(64512&(r=y.charCodeAt(v+1)))==56320&&(w=65536+(w-55296<<10)+(r-56320),v++),w<128?h[S++]=w:(w<2048?h[S++]=192|w>>>6:(w<65536?h[S++]=224|w>>>12:(h[S++]=240|w>>>18,h[S++]=128|w>>>12&63),h[S++]=128|w>>>6&63),h[S++]=128|63&w);return h}(u)},o.utf8decode=function(u){return n.nodebuffer?l.transformTo("nodebuffer",u).toString("utf-8"):function(y){var h,w,r,v,S=y.length,D=new Array(2*S);for(h=w=0;h<S;)if((r=y[h++])<128)D[w++]=r;else if(4<(v=g[r]))D[w++]=65533,h+=v-1;else{for(r&=v===2?31:v===3?15:7;1<v&&h<S;)r=r<<6|63&y[h++],v--;1<v?D[w++]=65533:r<65536?D[w++]=r:(r-=65536,D[w++]=55296|r>>10&1023,D[w++]=56320|1023&r)}return D.length!==w&&(D.subarray?D=D.subarray(0,w):D.length=w),l.applyFromCharCode(D)}(u=l.transformTo(n.uint8array?"uint8array":"array",u))},l.inherits(b,c),b.prototype.processChunk=function(u){var y=l.transformTo(n.uint8array?"uint8array":"array",u.data);if(this.leftOver&&this.leftOver.length){if(n.uint8array){var h=y;(y=new Uint8Array(h.length+this.leftOver.length)).set(this.leftOver,0),y.set(h,this.leftOver.length)}else y=this.leftOver.concat(y);this.leftOver=null}var w=function(v,S){var D;for((S=S||v.length)>v.length&&(S=v.length),D=S-1;0<=D&&(192&v[D])==128;)D--;return D<0||D===0?S:D+g[v[D]]>S?D:S}(y),r=y;w!==y.length&&(n.uint8array?(r=y.subarray(0,w),this.leftOver=y.subarray(w,y.length)):(r=y.slice(0,w),this.leftOver=y.slice(w,y.length))),this.push({data:o.utf8decode(r),meta:u.meta})},b.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:o.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},o.Utf8DecodeWorker=b,l.inherits(p,c),p.prototype.processChunk=function(u){this.push({data:o.utf8encode(u.data),meta:u.meta})},o.Utf8EncodeWorker=p},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(m,I,o){var l=m("./support"),n=m("./base64"),a=m("./nodejsUtils"),c=m("./external");function g(h){return h}function _(h,w){for(var r=0;r<h.length;++r)w[r]=255&h.charCodeAt(r);return w}m("setimmediate"),o.newBlob=function(h,w){o.checkSupport("blob");try{return new Blob([h],{type:w})}catch{try{var r=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return r.append(h),r.getBlob(w)}catch{throw new Error("Bug : can't construct the Blob.")}}};var b={stringifyByChunk:function(h,w,r){var v=[],S=0,D=h.length;if(D<=r)return String.fromCharCode.apply(null,h);for(;S<D;)w==="array"||w==="nodebuffer"?v.push(String.fromCharCode.apply(null,h.slice(S,Math.min(S+r,D)))):v.push(String.fromCharCode.apply(null,h.subarray(S,Math.min(S+r,D)))),S+=r;return v.join("")},stringifyByChar:function(h){for(var w="",r=0;r<h.length;r++)w+=String.fromCharCode(h[r]);return w},applyCanBeUsed:{uint8array:function(){try{return l.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return l.nodebuffer&&String.fromCharCode.apply(null,a.allocBuffer(1)).length===1}catch{return!1}}()}};function p(h){var w=65536,r=o.getTypeOf(h),v=!0;if(r==="uint8array"?v=b.applyCanBeUsed.uint8array:r==="nodebuffer"&&(v=b.applyCanBeUsed.nodebuffer),v)for(;1<w;)try{return b.stringifyByChunk(h,r,w)}catch{w=Math.floor(w/2)}return b.stringifyByChar(h)}function u(h,w){for(var r=0;r<h.length;r++)w[r]=h[r];return w}o.applyFromCharCode=p;var y={};y.string={string:g,array:function(h){return _(h,new Array(h.length))},arraybuffer:function(h){return y.string.uint8array(h).buffer},uint8array:function(h){return _(h,new Uint8Array(h.length))},nodebuffer:function(h){return _(h,a.allocBuffer(h.length))}},y.array={string:p,array:g,arraybuffer:function(h){return new Uint8Array(h).buffer},uint8array:function(h){return new Uint8Array(h)},nodebuffer:function(h){return a.newBufferFrom(h)}},y.arraybuffer={string:function(h){return p(new Uint8Array(h))},array:function(h){return u(new Uint8Array(h),new Array(h.byteLength))},arraybuffer:g,uint8array:function(h){return new Uint8Array(h)},nodebuffer:function(h){return a.newBufferFrom(new Uint8Array(h))}},y.uint8array={string:p,array:function(h){return u(h,new Array(h.length))},arraybuffer:function(h){return h.buffer},uint8array:g,nodebuffer:function(h){return a.newBufferFrom(h)}},y.nodebuffer={string:p,array:function(h){return u(h,new Array(h.length))},arraybuffer:function(h){return y.nodebuffer.uint8array(h).buffer},uint8array:function(h){return u(h,new Uint8Array(h.length))},nodebuffer:g},o.transformTo=function(h,w){if(w=w||"",!h)return w;o.checkSupport(h);var r=o.getTypeOf(w);return y[r][h](w)},o.resolve=function(h){for(var w=h.split("/"),r=[],v=0;v<w.length;v++){var S=w[v];S==="."||S===""&&v!==0&&v!==w.length-1||(S===".."?r.pop():r.push(S))}return r.join("/")},o.getTypeOf=function(h){return typeof h=="string"?"string":Object.prototype.toString.call(h)==="[object Array]"?"array":l.nodebuffer&&a.isBuffer(h)?"nodebuffer":l.uint8array&&h instanceof Uint8Array?"uint8array":l.arraybuffer&&h instanceof ArrayBuffer?"arraybuffer":void 0},o.checkSupport=function(h){if(!l[h.toLowerCase()])throw new Error(h+" is not supported by this platform")},o.MAX_VALUE_16BITS=65535,o.MAX_VALUE_32BITS=-1,o.pretty=function(h){var w,r,v="";for(r=0;r<(h||"").length;r++)v+="\\x"+((w=h.charCodeAt(r))<16?"0":"")+w.toString(16).toUpperCase();return v},o.delay=function(h,w,r){setImmediate(function(){h.apply(r||null,w||[])})},o.inherits=function(h,w){function r(){}r.prototype=w.prototype,h.prototype=new r},o.extend=function(){var h,w,r={};for(h=0;h<arguments.length;h++)for(w in arguments[h])Object.prototype.hasOwnProperty.call(arguments[h],w)&&r[w]===void 0&&(r[w]=arguments[h][w]);return r},o.prepareContent=function(h,w,r,v,S){return c.Promise.resolve(w).then(function(D){return l.blob&&(D instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(D))!==-1)&&typeof FileReader!="undefined"?new c.Promise(function(V,B){var q=new FileReader;q.onload=function(j){V(j.target.result)},q.onerror=function(j){B(j.target.error)},q.readAsArrayBuffer(D)}):D}).then(function(D){var V=o.getTypeOf(D);return V?(V==="arraybuffer"?D=o.transformTo("uint8array",D):V==="string"&&(S?D=n.decode(D):r&&v!==!0&&(D=function(B){return _(B,l.uint8array?new Uint8Array(B.length):new Array(B.length))}(D))),D):c.Promise.reject(new Error("Can't read the data of '"+h+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(m,I,o){var l=m("./reader/readerFor"),n=m("./utils"),a=m("./signature"),c=m("./zipEntry"),g=m("./support");function _(b){this.files=[],this.loadOptions=b}_.prototype={checkSignature:function(b){if(!this.reader.readAndCheckSignature(b)){this.reader.index-=4;var p=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+n.pretty(p)+", expected "+n.pretty(b)+")")}},isSignature:function(b,p){var u=this.reader.index;this.reader.setIndex(b);var y=this.reader.readString(4)===p;return this.reader.setIndex(u),y},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var b=this.reader.readData(this.zipCommentLength),p=g.uint8array?"uint8array":"array",u=n.transformTo(p,b);this.zipComment=this.loadOptions.decodeFileName(u)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var b,p,u,y=this.zip64EndOfCentralSize-44;0<y;)b=this.reader.readInt(2),p=this.reader.readInt(4),u=this.reader.readData(p),this.zip64ExtensibleData[b]={id:b,length:p,value:u}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var b,p;for(b=0;b<this.files.length;b++)p=this.files[b],this.reader.setIndex(p.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),p.readLocalPart(this.reader),p.handleUTF8(),p.processAttributes()},readCentralDir:function(){var b;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)(b=new c({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(b);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var b=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(b<0)throw this.isSignature(0,a.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(b);var p=b;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===n.MAX_VALUE_16BITS||this.diskWithCentralDirStart===n.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===n.MAX_VALUE_16BITS||this.centralDirRecords===n.MAX_VALUE_16BITS||this.centralDirSize===n.MAX_VALUE_32BITS||this.centralDirOffset===n.MAX_VALUE_32BITS){if(this.zip64=!0,(b=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(b),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var u=this.centralDirOffset+this.centralDirSize;this.zip64&&(u+=20,u+=12+this.zip64EndOfCentralSize);var y=p-u;if(0<y)this.isSignature(p,a.CENTRAL_FILE_HEADER)||(this.reader.zero=y);else if(y<0)throw new Error("Corrupted zip: missing "+Math.abs(y)+" bytes.")},prepareReader:function(b){this.reader=l(b)},load:function(b){this.prepareReader(b),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},I.exports=_},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(m,I,o){var l=m("./reader/readerFor"),n=m("./utils"),a=m("./compressedObject"),c=m("./crc32"),g=m("./utf8"),_=m("./compressions"),b=m("./support");function p(u,y){this.options=u,this.loadOptions=y}p.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(u){var y,h;if(u.skip(22),this.fileNameLength=u.readInt(2),h=u.readInt(2),this.fileName=u.readData(this.fileNameLength),u.skip(h),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((y=function(w){for(var r in _)if(Object.prototype.hasOwnProperty.call(_,r)&&_[r].magic===w)return _[r];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+n.pretty(this.compressionMethod)+" unknown (inner file : "+n.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,y,u.readData(this.compressedSize))},readCentralPart:function(u){this.versionMadeBy=u.readInt(2),u.skip(2),this.bitFlag=u.readInt(2),this.compressionMethod=u.readString(2),this.date=u.readDate(),this.crc32=u.readInt(4),this.compressedSize=u.readInt(4),this.uncompressedSize=u.readInt(4);var y=u.readInt(2);if(this.extraFieldsLength=u.readInt(2),this.fileCommentLength=u.readInt(2),this.diskNumberStart=u.readInt(2),this.internalFileAttributes=u.readInt(2),this.externalFileAttributes=u.readInt(4),this.localHeaderOffset=u.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");u.skip(y),this.readExtraFields(u),this.parseZIP64ExtraField(u),this.fileComment=u.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var u=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),u==0&&(this.dosPermissions=63&this.externalFileAttributes),u==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var u=l(this.extraFields[1].value);this.uncompressedSize===n.MAX_VALUE_32BITS&&(this.uncompressedSize=u.readInt(8)),this.compressedSize===n.MAX_VALUE_32BITS&&(this.compressedSize=u.readInt(8)),this.localHeaderOffset===n.MAX_VALUE_32BITS&&(this.localHeaderOffset=u.readInt(8)),this.diskNumberStart===n.MAX_VALUE_32BITS&&(this.diskNumberStart=u.readInt(4))}},readExtraFields:function(u){var y,h,w,r=u.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});u.index+4<r;)y=u.readInt(2),h=u.readInt(2),w=u.readData(h),this.extraFields[y]={id:y,length:h,value:w};u.setIndex(r)},handleUTF8:function(){var u=b.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=g.utf8decode(this.fileName),this.fileCommentStr=g.utf8decode(this.fileComment);else{var y=this.findExtraFieldUnicodePath();if(y!==null)this.fileNameStr=y;else{var h=n.transformTo(u,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(h)}var w=this.findExtraFieldUnicodeComment();if(w!==null)this.fileCommentStr=w;else{var r=n.transformTo(u,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(r)}}},findExtraFieldUnicodePath:function(){var u=this.extraFields[28789];if(u){var y=l(u.value);return y.readInt(1)!==1||c(this.fileName)!==y.readInt(4)?null:g.utf8decode(y.readData(u.length-5))}return null},findExtraFieldUnicodeComment:function(){var u=this.extraFields[25461];if(u){var y=l(u.value);return y.readInt(1)!==1||c(this.fileComment)!==y.readInt(4)?null:g.utf8decode(y.readData(u.length-5))}return null}},I.exports=p},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(m,I,o){function l(y,h,w){this.name=y,this.dir=w.dir,this.date=w.date,this.comment=w.comment,this.unixPermissions=w.unixPermissions,this.dosPermissions=w.dosPermissions,this._data=h,this._dataBinary=w.binary,this.options={compression:w.compression,compressionOptions:w.compressionOptions}}var n=m("./stream/StreamHelper"),a=m("./stream/DataWorker"),c=m("./utf8"),g=m("./compressedObject"),_=m("./stream/GenericWorker");l.prototype={internalStream:function(y){var h=null,w="string";try{if(!y)throw new Error("No output type specified.");var r=(w=y.toLowerCase())==="string"||w==="text";w!=="binarystring"&&w!=="text"||(w="string"),h=this._decompressWorker();var v=!this._dataBinary;v&&!r&&(h=h.pipe(new c.Utf8EncodeWorker)),!v&&r&&(h=h.pipe(new c.Utf8DecodeWorker))}catch(S){(h=new _("error")).error(S)}return new n(h,w,"")},async:function(y,h){return this.internalStream(y).accumulate(h)},nodeStream:function(y,h){return this.internalStream(y||"nodebuffer").toNodejsStream(h)},_compressWorker:function(y,h){if(this._data instanceof g&&this._data.compression.magic===y.magic)return this._data.getCompressedWorker();var w=this._decompressWorker();return this._dataBinary||(w=w.pipe(new c.Utf8EncodeWorker)),g.createWorkerFrom(w,y,h)},_decompressWorker:function(){return this._data instanceof g?this._data.getContentWorker():this._data instanceof _?this._data:new a(this._data)}};for(var b=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],p=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},u=0;u<b.length;u++)l.prototype[b[u]]=p;I.exports=l},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(m,I,o){(function(l){var n,a,c=l.MutationObserver||l.WebKitMutationObserver;if(c){var g=0,_=new c(y),b=l.document.createTextNode("");_.observe(b,{characterData:!0}),n=function(){b.data=g=++g%2}}else if(l.setImmediate||l.MessageChannel===void 0)n="document"in l&&"onreadystatechange"in l.document.createElement("script")?function(){var h=l.document.createElement("script");h.onreadystatechange=function(){y(),h.onreadystatechange=null,h.parentNode.removeChild(h),h=null},l.document.documentElement.appendChild(h)}:function(){setTimeout(y,0)};else{var p=new l.MessageChannel;p.port1.onmessage=y,n=function(){p.port2.postMessage(0)}}var u=[];function y(){var h,w;a=!0;for(var r=u.length;r;){for(w=u,u=[],h=-1;++h<r;)w[h]();r=u.length}a=!1}I.exports=function(h){u.push(h)!==1||a||n()}}).call(this,typeof at!="undefined"?at:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],37:[function(m,I,o){var l=m("immediate");function n(){}var a={},c=["REJECTED"],g=["FULFILLED"],_=["PENDING"];function b(r){if(typeof r!="function")throw new TypeError("resolver must be a function");this.state=_,this.queue=[],this.outcome=void 0,r!==n&&h(this,r)}function p(r,v,S){this.promise=r,typeof v=="function"&&(this.onFulfilled=v,this.callFulfilled=this.otherCallFulfilled),typeof S=="function"&&(this.onRejected=S,this.callRejected=this.otherCallRejected)}function u(r,v,S){l(function(){var D;try{D=v(S)}catch(V){return a.reject(r,V)}D===r?a.reject(r,new TypeError("Cannot resolve promise with itself")):a.resolve(r,D)})}function y(r){var v=r&&r.then;if(r&&(typeof r=="object"||typeof r=="function")&&typeof v=="function")return function(){v.apply(r,arguments)}}function h(r,v){var S=!1;function D(q){S||(S=!0,a.reject(r,q))}function V(q){S||(S=!0,a.resolve(r,q))}var B=w(function(){v(V,D)});B.status==="error"&&D(B.value)}function w(r,v){var S={};try{S.value=r(v),S.status="success"}catch(D){S.status="error",S.value=D}return S}(I.exports=b).prototype.finally=function(r){if(typeof r!="function")return this;var v=this.constructor;return this.then(function(S){return v.resolve(r()).then(function(){return S})},function(S){return v.resolve(r()).then(function(){throw S})})},b.prototype.catch=function(r){return this.then(null,r)},b.prototype.then=function(r,v){if(typeof r!="function"&&this.state===g||typeof v!="function"&&this.state===c)return this;var S=new this.constructor(n);return this.state!==_?u(S,this.state===g?r:v,this.outcome):this.queue.push(new p(S,r,v)),S},p.prototype.callFulfilled=function(r){a.resolve(this.promise,r)},p.prototype.otherCallFulfilled=function(r){u(this.promise,this.onFulfilled,r)},p.prototype.callRejected=function(r){a.reject(this.promise,r)},p.prototype.otherCallRejected=function(r){u(this.promise,this.onRejected,r)},a.resolve=function(r,v){var S=w(y,v);if(S.status==="error")return a.reject(r,S.value);var D=S.value;if(D)h(r,D);else{r.state=g,r.outcome=v;for(var V=-1,B=r.queue.length;++V<B;)r.queue[V].callFulfilled(v)}return r},a.reject=function(r,v){r.state=c,r.outcome=v;for(var S=-1,D=r.queue.length;++S<D;)r.queue[S].callRejected(v);return r},b.resolve=function(r){return r instanceof this?r:a.resolve(new this(n),r)},b.reject=function(r){var v=new this(n);return a.reject(v,r)},b.all=function(r){var v=this;if(Object.prototype.toString.call(r)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=r.length,D=!1;if(!S)return this.resolve([]);for(var V=new Array(S),B=0,q=-1,j=new this(n);++q<S;)A(r[q],q);return j;function A(G,oe){v.resolve(G).then(function(E){V[oe]=E,++B!==S||D||(D=!0,a.resolve(j,V))},function(E){D||(D=!0,a.reject(j,E))})}},b.race=function(r){var v=this;if(Object.prototype.toString.call(r)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=r.length,D=!1;if(!S)return this.resolve([]);for(var V=-1,B=new this(n);++V<S;)q=r[V],v.resolve(q).then(function(j){D||(D=!0,a.resolve(B,j))},function(j){D||(D=!0,a.reject(B,j))});var q;return B}},{immediate:36}],38:[function(m,I,o){var l={};(0,m("./lib/utils/common").assign)(l,m("./lib/deflate"),m("./lib/inflate"),m("./lib/zlib/constants")),I.exports=l},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(m,I,o){var l=m("./zlib/deflate"),n=m("./utils/common"),a=m("./utils/strings"),c=m("./zlib/messages"),g=m("./zlib/zstream"),_=Object.prototype.toString,b=0,p=-1,u=0,y=8;function h(r){if(!(this instanceof h))return new h(r);this.options=n.assign({level:p,method:y,chunkSize:16384,windowBits:15,memLevel:8,strategy:u,to:""},r||{});var v=this.options;v.raw&&0<v.windowBits?v.windowBits=-v.windowBits:v.gzip&&0<v.windowBits&&v.windowBits<16&&(v.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new g,this.strm.avail_out=0;var S=l.deflateInit2(this.strm,v.level,v.method,v.windowBits,v.memLevel,v.strategy);if(S!==b)throw new Error(c[S]);if(v.header&&l.deflateSetHeader(this.strm,v.header),v.dictionary){var D;if(D=typeof v.dictionary=="string"?a.string2buf(v.dictionary):_.call(v.dictionary)==="[object ArrayBuffer]"?new Uint8Array(v.dictionary):v.dictionary,(S=l.deflateSetDictionary(this.strm,D))!==b)throw new Error(c[S]);this._dict_set=!0}}function w(r,v){var S=new h(v);if(S.push(r,!0),S.err)throw S.msg||c[S.err];return S.result}h.prototype.push=function(r,v){var S,D,V=this.strm,B=this.options.chunkSize;if(this.ended)return!1;D=v===~~v?v:v===!0?4:0,typeof r=="string"?V.input=a.string2buf(r):_.call(r)==="[object ArrayBuffer]"?V.input=new Uint8Array(r):V.input=r,V.next_in=0,V.avail_in=V.input.length;do{if(V.avail_out===0&&(V.output=new n.Buf8(B),V.next_out=0,V.avail_out=B),(S=l.deflate(V,D))!==1&&S!==b)return this.onEnd(S),!(this.ended=!0);V.avail_out!==0&&(V.avail_in!==0||D!==4&&D!==2)||(this.options.to==="string"?this.onData(a.buf2binstring(n.shrinkBuf(V.output,V.next_out))):this.onData(n.shrinkBuf(V.output,V.next_out)))}while((0<V.avail_in||V.avail_out===0)&&S!==1);return D===4?(S=l.deflateEnd(this.strm),this.onEnd(S),this.ended=!0,S===b):D!==2||(this.onEnd(b),!(V.avail_out=0))},h.prototype.onData=function(r){this.chunks.push(r)},h.prototype.onEnd=function(r){r===b&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=r,this.msg=this.strm.msg},o.Deflate=h,o.deflate=w,o.deflateRaw=function(r,v){return(v=v||{}).raw=!0,w(r,v)},o.gzip=function(r,v){return(v=v||{}).gzip=!0,w(r,v)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(m,I,o){var l=m("./zlib/inflate"),n=m("./utils/common"),a=m("./utils/strings"),c=m("./zlib/constants"),g=m("./zlib/messages"),_=m("./zlib/zstream"),b=m("./zlib/gzheader"),p=Object.prototype.toString;function u(h){if(!(this instanceof u))return new u(h);this.options=n.assign({chunkSize:16384,windowBits:0,to:""},h||{});var w=this.options;w.raw&&0<=w.windowBits&&w.windowBits<16&&(w.windowBits=-w.windowBits,w.windowBits===0&&(w.windowBits=-15)),!(0<=w.windowBits&&w.windowBits<16)||h&&h.windowBits||(w.windowBits+=32),15<w.windowBits&&w.windowBits<48&&(15&w.windowBits)==0&&(w.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new _,this.strm.avail_out=0;var r=l.inflateInit2(this.strm,w.windowBits);if(r!==c.Z_OK)throw new Error(g[r]);this.header=new b,l.inflateGetHeader(this.strm,this.header)}function y(h,w){var r=new u(w);if(r.push(h,!0),r.err)throw r.msg||g[r.err];return r.result}u.prototype.push=function(h,w){var r,v,S,D,V,B,q=this.strm,j=this.options.chunkSize,A=this.options.dictionary,G=!1;if(this.ended)return!1;v=w===~~w?w:w===!0?c.Z_FINISH:c.Z_NO_FLUSH,typeof h=="string"?q.input=a.binstring2buf(h):p.call(h)==="[object ArrayBuffer]"?q.input=new Uint8Array(h):q.input=h,q.next_in=0,q.avail_in=q.input.length;do{if(q.avail_out===0&&(q.output=new n.Buf8(j),q.next_out=0,q.avail_out=j),(r=l.inflate(q,c.Z_NO_FLUSH))===c.Z_NEED_DICT&&A&&(B=typeof A=="string"?a.string2buf(A):p.call(A)==="[object ArrayBuffer]"?new Uint8Array(A):A,r=l.inflateSetDictionary(this.strm,B)),r===c.Z_BUF_ERROR&&G===!0&&(r=c.Z_OK,G=!1),r!==c.Z_STREAM_END&&r!==c.Z_OK)return this.onEnd(r),!(this.ended=!0);q.next_out&&(q.avail_out!==0&&r!==c.Z_STREAM_END&&(q.avail_in!==0||v!==c.Z_FINISH&&v!==c.Z_SYNC_FLUSH)||(this.options.to==="string"?(S=a.utf8border(q.output,q.next_out),D=q.next_out-S,V=a.buf2string(q.output,S),q.next_out=D,q.avail_out=j-D,D&&n.arraySet(q.output,q.output,S,D,0),this.onData(V)):this.onData(n.shrinkBuf(q.output,q.next_out)))),q.avail_in===0&&q.avail_out===0&&(G=!0)}while((0<q.avail_in||q.avail_out===0)&&r!==c.Z_STREAM_END);return r===c.Z_STREAM_END&&(v=c.Z_FINISH),v===c.Z_FINISH?(r=l.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===c.Z_OK):v!==c.Z_SYNC_FLUSH||(this.onEnd(c.Z_OK),!(q.avail_out=0))},u.prototype.onData=function(h){this.chunks.push(h)},u.prototype.onEnd=function(h){h===c.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=h,this.msg=this.strm.msg},o.Inflate=u,o.inflate=y,o.inflateRaw=function(h,w){return(w=w||{}).raw=!0,y(h,w)},o.ungzip=y},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(m,I,o){var l=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Int32Array!="undefined";o.assign=function(c){for(var g=Array.prototype.slice.call(arguments,1);g.length;){var _=g.shift();if(_){if(typeof _!="object")throw new TypeError(_+"must be non-object");for(var b in _)_.hasOwnProperty(b)&&(c[b]=_[b])}}return c},o.shrinkBuf=function(c,g){return c.length===g?c:c.subarray?c.subarray(0,g):(c.length=g,c)};var n={arraySet:function(c,g,_,b,p){if(g.subarray&&c.subarray)c.set(g.subarray(_,_+b),p);else for(var u=0;u<b;u++)c[p+u]=g[_+u]},flattenChunks:function(c){var g,_,b,p,u,y;for(g=b=0,_=c.length;g<_;g++)b+=c[g].length;for(y=new Uint8Array(b),g=p=0,_=c.length;g<_;g++)u=c[g],y.set(u,p),p+=u.length;return y}},a={arraySet:function(c,g,_,b,p){for(var u=0;u<b;u++)c[p+u]=g[_+u]},flattenChunks:function(c){return[].concat.apply([],c)}};o.setTyped=function(c){c?(o.Buf8=Uint8Array,o.Buf16=Uint16Array,o.Buf32=Int32Array,o.assign(o,n)):(o.Buf8=Array,o.Buf16=Array,o.Buf32=Array,o.assign(o,a))},o.setTyped(l)},{}],42:[function(m,I,o){var l=m("./common"),n=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch{n=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{a=!1}for(var c=new l.Buf8(256),g=0;g<256;g++)c[g]=252<=g?6:248<=g?5:240<=g?4:224<=g?3:192<=g?2:1;function _(b,p){if(p<65537&&(b.subarray&&a||!b.subarray&&n))return String.fromCharCode.apply(null,l.shrinkBuf(b,p));for(var u="",y=0;y<p;y++)u+=String.fromCharCode(b[y]);return u}c[254]=c[254]=1,o.string2buf=function(b){var p,u,y,h,w,r=b.length,v=0;for(h=0;h<r;h++)(64512&(u=b.charCodeAt(h)))==55296&&h+1<r&&(64512&(y=b.charCodeAt(h+1)))==56320&&(u=65536+(u-55296<<10)+(y-56320),h++),v+=u<128?1:u<2048?2:u<65536?3:4;for(p=new l.Buf8(v),h=w=0;w<v;h++)(64512&(u=b.charCodeAt(h)))==55296&&h+1<r&&(64512&(y=b.charCodeAt(h+1)))==56320&&(u=65536+(u-55296<<10)+(y-56320),h++),u<128?p[w++]=u:(u<2048?p[w++]=192|u>>>6:(u<65536?p[w++]=224|u>>>12:(p[w++]=240|u>>>18,p[w++]=128|u>>>12&63),p[w++]=128|u>>>6&63),p[w++]=128|63&u);return p},o.buf2binstring=function(b){return _(b,b.length)},o.binstring2buf=function(b){for(var p=new l.Buf8(b.length),u=0,y=p.length;u<y;u++)p[u]=b.charCodeAt(u);return p},o.buf2string=function(b,p){var u,y,h,w,r=p||b.length,v=new Array(2*r);for(u=y=0;u<r;)if((h=b[u++])<128)v[y++]=h;else if(4<(w=c[h]))v[y++]=65533,u+=w-1;else{for(h&=w===2?31:w===3?15:7;1<w&&u<r;)h=h<<6|63&b[u++],w--;1<w?v[y++]=65533:h<65536?v[y++]=h:(h-=65536,v[y++]=55296|h>>10&1023,v[y++]=56320|1023&h)}return _(v,y)},o.utf8border=function(b,p){var u;for((p=p||b.length)>b.length&&(p=b.length),u=p-1;0<=u&&(192&b[u])==128;)u--;return u<0||u===0?p:u+c[b[u]]>p?u:p}},{"./common":41}],43:[function(m,I,o){I.exports=function(l,n,a,c){for(var g=65535&l|0,_=l>>>16&65535|0,b=0;a!==0;){for(a-=b=2e3<a?2e3:a;_=_+(g=g+n[c++]|0)|0,--b;);g%=65521,_%=65521}return g|_<<16|0}},{}],44:[function(m,I,o){I.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(m,I,o){var l=function(){for(var n,a=[],c=0;c<256;c++){n=c;for(var g=0;g<8;g++)n=1&n?3988292384^n>>>1:n>>>1;a[c]=n}return a}();I.exports=function(n,a,c,g){var _=l,b=g+c;n^=-1;for(var p=g;p<b;p++)n=n>>>8^_[255&(n^a[p])];return-1^n}},{}],46:[function(m,I,o){var l,n=m("../utils/common"),a=m("./trees"),c=m("./adler32"),g=m("./crc32"),_=m("./messages"),b=0,p=4,u=0,y=-2,h=-1,w=4,r=2,v=8,S=9,D=286,V=30,B=19,q=2*D+1,j=15,A=3,G=258,oe=G+A+1,E=42,O=113,f=1,M=2,ne=3,Z=4;function ue(d,U){return d.msg=_[U],U}function R(d){return(d<<1)-(4<d?9:0)}function se(d){for(var U=d.length;0<=--U;)d[U]=0}function z(d){var U=d.state,T=U.pending;T>d.avail_out&&(T=d.avail_out),T!==0&&(n.arraySet(d.output,U.pending_buf,U.pending_out,T,d.next_out),d.next_out+=T,U.pending_out+=T,d.total_out+=T,d.avail_out-=T,U.pending-=T,U.pending===0&&(U.pending_out=0))}function F(d,U){a._tr_flush_block(d,0<=d.block_start?d.block_start:-1,d.strstart-d.block_start,U),d.block_start=d.strstart,z(d.strm)}function ee(d,U){d.pending_buf[d.pending++]=U}function W(d,U){d.pending_buf[d.pending++]=U>>>8&255,d.pending_buf[d.pending++]=255&U}function K(d,U){var T,C,k=d.max_chain_length,x=d.strstart,L=d.prev_length,$=d.nice_match,P=d.strstart>d.w_size-oe?d.strstart-(d.w_size-oe):0,X=d.window,ae=d.w_mask,Q=d.prev,ie=d.strstart+G,ye=X[x+L-1],pe=X[x+L];d.prev_length>=d.good_match&&(k>>=2),$>d.lookahead&&($=d.lookahead);do if(X[(T=U)+L]===pe&&X[T+L-1]===ye&&X[T]===X[x]&&X[++T]===X[x+1]){x+=2,T++;do;while(X[++x]===X[++T]&&X[++x]===X[++T]&&X[++x]===X[++T]&&X[++x]===X[++T]&&X[++x]===X[++T]&&X[++x]===X[++T]&&X[++x]===X[++T]&&X[++x]===X[++T]&&x<ie);if(C=G-(ie-x),x=ie-G,L<C){if(d.match_start=U,$<=(L=C))break;ye=X[x+L-1],pe=X[x+L]}}while((U=Q[U&ae])>P&&--k!=0);return L<=d.lookahead?L:d.lookahead}function be(d){var U,T,C,k,x,L,$,P,X,ae,Q=d.w_size;do{if(k=d.window_size-d.lookahead-d.strstart,d.strstart>=Q+(Q-oe)){for(n.arraySet(d.window,d.window,Q,Q,0),d.match_start-=Q,d.strstart-=Q,d.block_start-=Q,U=T=d.hash_size;C=d.head[--U],d.head[U]=Q<=C?C-Q:0,--T;);for(U=T=Q;C=d.prev[--U],d.prev[U]=Q<=C?C-Q:0,--T;);k+=Q}if(d.strm.avail_in===0)break;if(L=d.strm,$=d.window,P=d.strstart+d.lookahead,X=k,ae=void 0,ae=L.avail_in,X<ae&&(ae=X),T=ae===0?0:(L.avail_in-=ae,n.arraySet($,L.input,L.next_in,ae,P),L.state.wrap===1?L.adler=c(L.adler,$,ae,P):L.state.wrap===2&&(L.adler=g(L.adler,$,ae,P)),L.next_in+=ae,L.total_in+=ae,ae),d.lookahead+=T,d.lookahead+d.insert>=A)for(x=d.strstart-d.insert,d.ins_h=d.window[x],d.ins_h=(d.ins_h<<d.hash_shift^d.window[x+1])&d.hash_mask;d.insert&&(d.ins_h=(d.ins_h<<d.hash_shift^d.window[x+A-1])&d.hash_mask,d.prev[x&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=x,x++,d.insert--,!(d.lookahead+d.insert<A)););}while(d.lookahead<oe&&d.strm.avail_in!==0)}function ke(d,U){for(var T,C;;){if(d.lookahead<oe){if(be(d),d.lookahead<oe&&U===b)return f;if(d.lookahead===0)break}if(T=0,d.lookahead>=A&&(d.ins_h=(d.ins_h<<d.hash_shift^d.window[d.strstart+A-1])&d.hash_mask,T=d.prev[d.strstart&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=d.strstart),T!==0&&d.strstart-T<=d.w_size-oe&&(d.match_length=K(d,T)),d.match_length>=A)if(C=a._tr_tally(d,d.strstart-d.match_start,d.match_length-A),d.lookahead-=d.match_length,d.match_length<=d.max_lazy_match&&d.lookahead>=A){for(d.match_length--;d.strstart++,d.ins_h=(d.ins_h<<d.hash_shift^d.window[d.strstart+A-1])&d.hash_mask,T=d.prev[d.strstart&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=d.strstart,--d.match_length!=0;);d.strstart++}else d.strstart+=d.match_length,d.match_length=0,d.ins_h=d.window[d.strstart],d.ins_h=(d.ins_h<<d.hash_shift^d.window[d.strstart+1])&d.hash_mask;else C=a._tr_tally(d,0,d.window[d.strstart]),d.lookahead--,d.strstart++;if(C&&(F(d,!1),d.strm.avail_out===0))return f}return d.insert=d.strstart<A-1?d.strstart:A-1,U===p?(F(d,!0),d.strm.avail_out===0?ne:Z):d.last_lit&&(F(d,!1),d.strm.avail_out===0)?f:M}function le(d,U){for(var T,C,k;;){if(d.lookahead<oe){if(be(d),d.lookahead<oe&&U===b)return f;if(d.lookahead===0)break}if(T=0,d.lookahead>=A&&(d.ins_h=(d.ins_h<<d.hash_shift^d.window[d.strstart+A-1])&d.hash_mask,T=d.prev[d.strstart&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=d.strstart),d.prev_length=d.match_length,d.prev_match=d.match_start,d.match_length=A-1,T!==0&&d.prev_length<d.max_lazy_match&&d.strstart-T<=d.w_size-oe&&(d.match_length=K(d,T),d.match_length<=5&&(d.strategy===1||d.match_length===A&&4096<d.strstart-d.match_start)&&(d.match_length=A-1)),d.prev_length>=A&&d.match_length<=d.prev_length){for(k=d.strstart+d.lookahead-A,C=a._tr_tally(d,d.strstart-1-d.prev_match,d.prev_length-A),d.lookahead-=d.prev_length-1,d.prev_length-=2;++d.strstart<=k&&(d.ins_h=(d.ins_h<<d.hash_shift^d.window[d.strstart+A-1])&d.hash_mask,T=d.prev[d.strstart&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=d.strstart),--d.prev_length!=0;);if(d.match_available=0,d.match_length=A-1,d.strstart++,C&&(F(d,!1),d.strm.avail_out===0))return f}else if(d.match_available){if((C=a._tr_tally(d,0,d.window[d.strstart-1]))&&F(d,!1),d.strstart++,d.lookahead--,d.strm.avail_out===0)return f}else d.match_available=1,d.strstart++,d.lookahead--}return d.match_available&&(C=a._tr_tally(d,0,d.window[d.strstart-1]),d.match_available=0),d.insert=d.strstart<A-1?d.strstart:A-1,U===p?(F(d,!0),d.strm.avail_out===0?ne:Z):d.last_lit&&(F(d,!1),d.strm.avail_out===0)?f:M}function fe(d,U,T,C,k){this.good_length=d,this.max_lazy=U,this.nice_length=T,this.max_chain=C,this.func=k}function Ce(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=v,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new n.Buf16(2*q),this.dyn_dtree=new n.Buf16(2*(2*V+1)),this.bl_tree=new n.Buf16(2*(2*B+1)),se(this.dyn_ltree),se(this.dyn_dtree),se(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new n.Buf16(j+1),this.heap=new n.Buf16(2*D+1),se(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new n.Buf16(2*D+1),se(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function _e(d){var U;return d&&d.state?(d.total_in=d.total_out=0,d.data_type=r,(U=d.state).pending=0,U.pending_out=0,U.wrap<0&&(U.wrap=-U.wrap),U.status=U.wrap?E:O,d.adler=U.wrap===2?0:1,U.last_flush=b,a._tr_init(U),u):ue(d,y)}function xe(d){var U=_e(d);return U===u&&function(T){T.window_size=2*T.w_size,se(T.head),T.max_lazy_match=l[T.level].max_lazy,T.good_match=l[T.level].good_length,T.nice_match=l[T.level].nice_length,T.max_chain_length=l[T.level].max_chain,T.strstart=0,T.block_start=0,T.lookahead=0,T.insert=0,T.match_length=T.prev_length=A-1,T.match_available=0,T.ins_h=0}(d.state),U}function Ae(d,U,T,C,k,x){if(!d)return y;var L=1;if(U===h&&(U=6),C<0?(L=0,C=-C):15<C&&(L=2,C-=16),k<1||S<k||T!==v||C<8||15<C||U<0||9<U||x<0||w<x)return ue(d,y);C===8&&(C=9);var $=new Ce;return(d.state=$).strm=d,$.wrap=L,$.gzhead=null,$.w_bits=C,$.w_size=1<<$.w_bits,$.w_mask=$.w_size-1,$.hash_bits=k+7,$.hash_size=1<<$.hash_bits,$.hash_mask=$.hash_size-1,$.hash_shift=~~(($.hash_bits+A-1)/A),$.window=new n.Buf8(2*$.w_size),$.head=new n.Buf16($.hash_size),$.prev=new n.Buf16($.w_size),$.lit_bufsize=1<<k+6,$.pending_buf_size=4*$.lit_bufsize,$.pending_buf=new n.Buf8($.pending_buf_size),$.d_buf=1*$.lit_bufsize,$.l_buf=3*$.lit_bufsize,$.level=U,$.strategy=x,$.method=T,xe(d)}l=[new fe(0,0,0,0,function(d,U){var T=65535;for(T>d.pending_buf_size-5&&(T=d.pending_buf_size-5);;){if(d.lookahead<=1){if(be(d),d.lookahead===0&&U===b)return f;if(d.lookahead===0)break}d.strstart+=d.lookahead,d.lookahead=0;var C=d.block_start+T;if((d.strstart===0||d.strstart>=C)&&(d.lookahead=d.strstart-C,d.strstart=C,F(d,!1),d.strm.avail_out===0)||d.strstart-d.block_start>=d.w_size-oe&&(F(d,!1),d.strm.avail_out===0))return f}return d.insert=0,U===p?(F(d,!0),d.strm.avail_out===0?ne:Z):(d.strstart>d.block_start&&(F(d,!1),d.strm.avail_out),f)}),new fe(4,4,8,4,ke),new fe(4,5,16,8,ke),new fe(4,6,32,32,ke),new fe(4,4,16,16,le),new fe(8,16,32,32,le),new fe(8,16,128,128,le),new fe(8,32,128,256,le),new fe(32,128,258,1024,le),new fe(32,258,258,4096,le)],o.deflateInit=function(d,U){return Ae(d,U,v,15,8,0)},o.deflateInit2=Ae,o.deflateReset=xe,o.deflateResetKeep=_e,o.deflateSetHeader=function(d,U){return d&&d.state?d.state.wrap!==2?y:(d.state.gzhead=U,u):y},o.deflate=function(d,U){var T,C,k,x;if(!d||!d.state||5<U||U<0)return d?ue(d,y):y;if(C=d.state,!d.output||!d.input&&d.avail_in!==0||C.status===666&&U!==p)return ue(d,d.avail_out===0?-5:y);if(C.strm=d,T=C.last_flush,C.last_flush=U,C.status===E)if(C.wrap===2)d.adler=0,ee(C,31),ee(C,139),ee(C,8),C.gzhead?(ee(C,(C.gzhead.text?1:0)+(C.gzhead.hcrc?2:0)+(C.gzhead.extra?4:0)+(C.gzhead.name?8:0)+(C.gzhead.comment?16:0)),ee(C,255&C.gzhead.time),ee(C,C.gzhead.time>>8&255),ee(C,C.gzhead.time>>16&255),ee(C,C.gzhead.time>>24&255),ee(C,C.level===9?2:2<=C.strategy||C.level<2?4:0),ee(C,255&C.gzhead.os),C.gzhead.extra&&C.gzhead.extra.length&&(ee(C,255&C.gzhead.extra.length),ee(C,C.gzhead.extra.length>>8&255)),C.gzhead.hcrc&&(d.adler=g(d.adler,C.pending_buf,C.pending,0)),C.gzindex=0,C.status=69):(ee(C,0),ee(C,0),ee(C,0),ee(C,0),ee(C,0),ee(C,C.level===9?2:2<=C.strategy||C.level<2?4:0),ee(C,3),C.status=O);else{var L=v+(C.w_bits-8<<4)<<8;L|=(2<=C.strategy||C.level<2?0:C.level<6?1:C.level===6?2:3)<<6,C.strstart!==0&&(L|=32),L+=31-L%31,C.status=O,W(C,L),C.strstart!==0&&(W(C,d.adler>>>16),W(C,65535&d.adler)),d.adler=1}if(C.status===69)if(C.gzhead.extra){for(k=C.pending;C.gzindex<(65535&C.gzhead.extra.length)&&(C.pending!==C.pending_buf_size||(C.gzhead.hcrc&&C.pending>k&&(d.adler=g(d.adler,C.pending_buf,C.pending-k,k)),z(d),k=C.pending,C.pending!==C.pending_buf_size));)ee(C,255&C.gzhead.extra[C.gzindex]),C.gzindex++;C.gzhead.hcrc&&C.pending>k&&(d.adler=g(d.adler,C.pending_buf,C.pending-k,k)),C.gzindex===C.gzhead.extra.length&&(C.gzindex=0,C.status=73)}else C.status=73;if(C.status===73)if(C.gzhead.name){k=C.pending;do{if(C.pending===C.pending_buf_size&&(C.gzhead.hcrc&&C.pending>k&&(d.adler=g(d.adler,C.pending_buf,C.pending-k,k)),z(d),k=C.pending,C.pending===C.pending_buf_size)){x=1;break}x=C.gzindex<C.gzhead.name.length?255&C.gzhead.name.charCodeAt(C.gzindex++):0,ee(C,x)}while(x!==0);C.gzhead.hcrc&&C.pending>k&&(d.adler=g(d.adler,C.pending_buf,C.pending-k,k)),x===0&&(C.gzindex=0,C.status=91)}else C.status=91;if(C.status===91)if(C.gzhead.comment){k=C.pending;do{if(C.pending===C.pending_buf_size&&(C.gzhead.hcrc&&C.pending>k&&(d.adler=g(d.adler,C.pending_buf,C.pending-k,k)),z(d),k=C.pending,C.pending===C.pending_buf_size)){x=1;break}x=C.gzindex<C.gzhead.comment.length?255&C.gzhead.comment.charCodeAt(C.gzindex++):0,ee(C,x)}while(x!==0);C.gzhead.hcrc&&C.pending>k&&(d.adler=g(d.adler,C.pending_buf,C.pending-k,k)),x===0&&(C.status=103)}else C.status=103;if(C.status===103&&(C.gzhead.hcrc?(C.pending+2>C.pending_buf_size&&z(d),C.pending+2<=C.pending_buf_size&&(ee(C,255&d.adler),ee(C,d.adler>>8&255),d.adler=0,C.status=O)):C.status=O),C.pending!==0){if(z(d),d.avail_out===0)return C.last_flush=-1,u}else if(d.avail_in===0&&R(U)<=R(T)&&U!==p)return ue(d,-5);if(C.status===666&&d.avail_in!==0)return ue(d,-5);if(d.avail_in!==0||C.lookahead!==0||U!==b&&C.status!==666){var $=C.strategy===2?function(P,X){for(var ae;;){if(P.lookahead===0&&(be(P),P.lookahead===0)){if(X===b)return f;break}if(P.match_length=0,ae=a._tr_tally(P,0,P.window[P.strstart]),P.lookahead--,P.strstart++,ae&&(F(P,!1),P.strm.avail_out===0))return f}return P.insert=0,X===p?(F(P,!0),P.strm.avail_out===0?ne:Z):P.last_lit&&(F(P,!1),P.strm.avail_out===0)?f:M}(C,U):C.strategy===3?function(P,X){for(var ae,Q,ie,ye,pe=P.window;;){if(P.lookahead<=G){if(be(P),P.lookahead<=G&&X===b)return f;if(P.lookahead===0)break}if(P.match_length=0,P.lookahead>=A&&0<P.strstart&&(Q=pe[ie=P.strstart-1])===pe[++ie]&&Q===pe[++ie]&&Q===pe[++ie]){ye=P.strstart+G;do;while(Q===pe[++ie]&&Q===pe[++ie]&&Q===pe[++ie]&&Q===pe[++ie]&&Q===pe[++ie]&&Q===pe[++ie]&&Q===pe[++ie]&&Q===pe[++ie]&&ie<ye);P.match_length=G-(ye-ie),P.match_length>P.lookahead&&(P.match_length=P.lookahead)}if(P.match_length>=A?(ae=a._tr_tally(P,1,P.match_length-A),P.lookahead-=P.match_length,P.strstart+=P.match_length,P.match_length=0):(ae=a._tr_tally(P,0,P.window[P.strstart]),P.lookahead--,P.strstart++),ae&&(F(P,!1),P.strm.avail_out===0))return f}return P.insert=0,X===p?(F(P,!0),P.strm.avail_out===0?ne:Z):P.last_lit&&(F(P,!1),P.strm.avail_out===0)?f:M}(C,U):l[C.level].func(C,U);if($!==ne&&$!==Z||(C.status=666),$===f||$===ne)return d.avail_out===0&&(C.last_flush=-1),u;if($===M&&(U===1?a._tr_align(C):U!==5&&(a._tr_stored_block(C,0,0,!1),U===3&&(se(C.head),C.lookahead===0&&(C.strstart=0,C.block_start=0,C.insert=0))),z(d),d.avail_out===0))return C.last_flush=-1,u}return U!==p?u:C.wrap<=0?1:(C.wrap===2?(ee(C,255&d.adler),ee(C,d.adler>>8&255),ee(C,d.adler>>16&255),ee(C,d.adler>>24&255),ee(C,255&d.total_in),ee(C,d.total_in>>8&255),ee(C,d.total_in>>16&255),ee(C,d.total_in>>24&255)):(W(C,d.adler>>>16),W(C,65535&d.adler)),z(d),0<C.wrap&&(C.wrap=-C.wrap),C.pending!==0?u:1)},o.deflateEnd=function(d){var U;return d&&d.state?(U=d.state.status)!==E&&U!==69&&U!==73&&U!==91&&U!==103&&U!==O&&U!==666?ue(d,y):(d.state=null,U===O?ue(d,-3):u):y},o.deflateSetDictionary=function(d,U){var T,C,k,x,L,$,P,X,ae=U.length;if(!d||!d.state||(x=(T=d.state).wrap)===2||x===1&&T.status!==E||T.lookahead)return y;for(x===1&&(d.adler=c(d.adler,U,ae,0)),T.wrap=0,ae>=T.w_size&&(x===0&&(se(T.head),T.strstart=0,T.block_start=0,T.insert=0),X=new n.Buf8(T.w_size),n.arraySet(X,U,ae-T.w_size,T.w_size,0),U=X,ae=T.w_size),L=d.avail_in,$=d.next_in,P=d.input,d.avail_in=ae,d.next_in=0,d.input=U,be(T);T.lookahead>=A;){for(C=T.strstart,k=T.lookahead-(A-1);T.ins_h=(T.ins_h<<T.hash_shift^T.window[C+A-1])&T.hash_mask,T.prev[C&T.w_mask]=T.head[T.ins_h],T.head[T.ins_h]=C,C++,--k;);T.strstart=C,T.lookahead=A-1,be(T)}return T.strstart+=T.lookahead,T.block_start=T.strstart,T.insert=T.lookahead,T.lookahead=0,T.match_length=T.prev_length=A-1,T.match_available=0,d.next_in=$,d.input=P,d.avail_in=L,T.wrap=x,u},o.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(m,I,o){I.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(m,I,o){I.exports=function(l,n){var a,c,g,_,b,p,u,y,h,w,r,v,S,D,V,B,q,j,A,G,oe,E,O,f,M;a=l.state,c=l.next_in,f=l.input,g=c+(l.avail_in-5),_=l.next_out,M=l.output,b=_-(n-l.avail_out),p=_+(l.avail_out-257),u=a.dmax,y=a.wsize,h=a.whave,w=a.wnext,r=a.window,v=a.hold,S=a.bits,D=a.lencode,V=a.distcode,B=(1<<a.lenbits)-1,q=(1<<a.distbits)-1;e:do{S<15&&(v+=f[c++]<<S,S+=8,v+=f[c++]<<S,S+=8),j=D[v&B];t:for(;;){if(v>>>=A=j>>>24,S-=A,(A=j>>>16&255)===0)M[_++]=65535&j;else{if(!(16&A)){if((64&A)==0){j=D[(65535&j)+(v&(1<<A)-1)];continue t}if(32&A){a.mode=12;break e}l.msg="invalid literal/length code",a.mode=30;break e}G=65535&j,(A&=15)&&(S<A&&(v+=f[c++]<<S,S+=8),G+=v&(1<<A)-1,v>>>=A,S-=A),S<15&&(v+=f[c++]<<S,S+=8,v+=f[c++]<<S,S+=8),j=V[v&q];a:for(;;){if(v>>>=A=j>>>24,S-=A,!(16&(A=j>>>16&255))){if((64&A)==0){j=V[(65535&j)+(v&(1<<A)-1)];continue a}l.msg="invalid distance code",a.mode=30;break e}if(oe=65535&j,S<(A&=15)&&(v+=f[c++]<<S,(S+=8)<A&&(v+=f[c++]<<S,S+=8)),u<(oe+=v&(1<<A)-1)){l.msg="invalid distance too far back",a.mode=30;break e}if(v>>>=A,S-=A,(A=_-b)<oe){if(h<(A=oe-A)&&a.sane){l.msg="invalid distance too far back",a.mode=30;break e}if(O=r,(E=0)===w){if(E+=y-A,A<G){for(G-=A;M[_++]=r[E++],--A;);E=_-oe,O=M}}else if(w<A){if(E+=y+w-A,(A-=w)<G){for(G-=A;M[_++]=r[E++],--A;);if(E=0,w<G){for(G-=A=w;M[_++]=r[E++],--A;);E=_-oe,O=M}}}else if(E+=w-A,A<G){for(G-=A;M[_++]=r[E++],--A;);E=_-oe,O=M}for(;2<G;)M[_++]=O[E++],M[_++]=O[E++],M[_++]=O[E++],G-=3;G&&(M[_++]=O[E++],1<G&&(M[_++]=O[E++]))}else{for(E=_-oe;M[_++]=M[E++],M[_++]=M[E++],M[_++]=M[E++],2<(G-=3););G&&(M[_++]=M[E++],1<G&&(M[_++]=M[E++]))}break}}break}}while(c<g&&_<p);c-=G=S>>3,v&=(1<<(S-=G<<3))-1,l.next_in=c,l.next_out=_,l.avail_in=c<g?g-c+5:5-(c-g),l.avail_out=_<p?p-_+257:257-(_-p),a.hold=v,a.bits=S}},{}],49:[function(m,I,o){var l=m("../utils/common"),n=m("./adler32"),a=m("./crc32"),c=m("./inffast"),g=m("./inftrees"),_=1,b=2,p=0,u=-2,y=1,h=852,w=592;function r(E){return(E>>>24&255)+(E>>>8&65280)+((65280&E)<<8)+((255&E)<<24)}function v(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new l.Buf16(320),this.work=new l.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function S(E){var O;return E&&E.state?(O=E.state,E.total_in=E.total_out=O.total=0,E.msg="",O.wrap&&(E.adler=1&O.wrap),O.mode=y,O.last=0,O.havedict=0,O.dmax=32768,O.head=null,O.hold=0,O.bits=0,O.lencode=O.lendyn=new l.Buf32(h),O.distcode=O.distdyn=new l.Buf32(w),O.sane=1,O.back=-1,p):u}function D(E){var O;return E&&E.state?((O=E.state).wsize=0,O.whave=0,O.wnext=0,S(E)):u}function V(E,O){var f,M;return E&&E.state?(M=E.state,O<0?(f=0,O=-O):(f=1+(O>>4),O<48&&(O&=15)),O&&(O<8||15<O)?u:(M.window!==null&&M.wbits!==O&&(M.window=null),M.wrap=f,M.wbits=O,D(E))):u}function B(E,O){var f,M;return E?(M=new v,(E.state=M).window=null,(f=V(E,O))!==p&&(E.state=null),f):u}var q,j,A=!0;function G(E){if(A){var O;for(q=new l.Buf32(512),j=new l.Buf32(32),O=0;O<144;)E.lens[O++]=8;for(;O<256;)E.lens[O++]=9;for(;O<280;)E.lens[O++]=7;for(;O<288;)E.lens[O++]=8;for(g(_,E.lens,0,288,q,0,E.work,{bits:9}),O=0;O<32;)E.lens[O++]=5;g(b,E.lens,0,32,j,0,E.work,{bits:5}),A=!1}E.lencode=q,E.lenbits=9,E.distcode=j,E.distbits=5}function oe(E,O,f,M){var ne,Z=E.state;return Z.window===null&&(Z.wsize=1<<Z.wbits,Z.wnext=0,Z.whave=0,Z.window=new l.Buf8(Z.wsize)),M>=Z.wsize?(l.arraySet(Z.window,O,f-Z.wsize,Z.wsize,0),Z.wnext=0,Z.whave=Z.wsize):(M<(ne=Z.wsize-Z.wnext)&&(ne=M),l.arraySet(Z.window,O,f-M,ne,Z.wnext),(M-=ne)?(l.arraySet(Z.window,O,f-M,M,0),Z.wnext=M,Z.whave=Z.wsize):(Z.wnext+=ne,Z.wnext===Z.wsize&&(Z.wnext=0),Z.whave<Z.wsize&&(Z.whave+=ne))),0}o.inflateReset=D,o.inflateReset2=V,o.inflateResetKeep=S,o.inflateInit=function(E){return B(E,15)},o.inflateInit2=B,o.inflate=function(E,O){var f,M,ne,Z,ue,R,se,z,F,ee,W,K,be,ke,le,fe,Ce,_e,xe,Ae,d,U,T,C,k=0,x=new l.Buf8(4),L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!E||!E.state||!E.output||!E.input&&E.avail_in!==0)return u;(f=E.state).mode===12&&(f.mode=13),ue=E.next_out,ne=E.output,se=E.avail_out,Z=E.next_in,M=E.input,R=E.avail_in,z=f.hold,F=f.bits,ee=R,W=se,U=p;e:for(;;)switch(f.mode){case y:if(f.wrap===0){f.mode=13;break}for(;F<16;){if(R===0)break e;R--,z+=M[Z++]<<F,F+=8}if(2&f.wrap&&z===35615){x[f.check=0]=255&z,x[1]=z>>>8&255,f.check=a(f.check,x,2,0),F=z=0,f.mode=2;break}if(f.flags=0,f.head&&(f.head.done=!1),!(1&f.wrap)||(((255&z)<<8)+(z>>8))%31){E.msg="incorrect header check",f.mode=30;break}if((15&z)!=8){E.msg="unknown compression method",f.mode=30;break}if(F-=4,d=8+(15&(z>>>=4)),f.wbits===0)f.wbits=d;else if(d>f.wbits){E.msg="invalid window size",f.mode=30;break}f.dmax=1<<d,E.adler=f.check=1,f.mode=512&z?10:12,F=z=0;break;case 2:for(;F<16;){if(R===0)break e;R--,z+=M[Z++]<<F,F+=8}if(f.flags=z,(255&f.flags)!=8){E.msg="unknown compression method",f.mode=30;break}if(57344&f.flags){E.msg="unknown header flags set",f.mode=30;break}f.head&&(f.head.text=z>>8&1),512&f.flags&&(x[0]=255&z,x[1]=z>>>8&255,f.check=a(f.check,x,2,0)),F=z=0,f.mode=3;case 3:for(;F<32;){if(R===0)break e;R--,z+=M[Z++]<<F,F+=8}f.head&&(f.head.time=z),512&f.flags&&(x[0]=255&z,x[1]=z>>>8&255,x[2]=z>>>16&255,x[3]=z>>>24&255,f.check=a(f.check,x,4,0)),F=z=0,f.mode=4;case 4:for(;F<16;){if(R===0)break e;R--,z+=M[Z++]<<F,F+=8}f.head&&(f.head.xflags=255&z,f.head.os=z>>8),512&f.flags&&(x[0]=255&z,x[1]=z>>>8&255,f.check=a(f.check,x,2,0)),F=z=0,f.mode=5;case 5:if(1024&f.flags){for(;F<16;){if(R===0)break e;R--,z+=M[Z++]<<F,F+=8}f.length=z,f.head&&(f.head.extra_len=z),512&f.flags&&(x[0]=255&z,x[1]=z>>>8&255,f.check=a(f.check,x,2,0)),F=z=0}else f.head&&(f.head.extra=null);f.mode=6;case 6:if(1024&f.flags&&(R<(K=f.length)&&(K=R),K&&(f.head&&(d=f.head.extra_len-f.length,f.head.extra||(f.head.extra=new Array(f.head.extra_len)),l.arraySet(f.head.extra,M,Z,K,d)),512&f.flags&&(f.check=a(f.check,M,K,Z)),R-=K,Z+=K,f.length-=K),f.length))break e;f.length=0,f.mode=7;case 7:if(2048&f.flags){if(R===0)break e;for(K=0;d=M[Z+K++],f.head&&d&&f.length<65536&&(f.head.name+=String.fromCharCode(d)),d&&K<R;);if(512&f.flags&&(f.check=a(f.check,M,K,Z)),R-=K,Z+=K,d)break e}else f.head&&(f.head.name=null);f.length=0,f.mode=8;case 8:if(4096&f.flags){if(R===0)break e;for(K=0;d=M[Z+K++],f.head&&d&&f.length<65536&&(f.head.comment+=String.fromCharCode(d)),d&&K<R;);if(512&f.flags&&(f.check=a(f.check,M,K,Z)),R-=K,Z+=K,d)break e}else f.head&&(f.head.comment=null);f.mode=9;case 9:if(512&f.flags){for(;F<16;){if(R===0)break e;R--,z+=M[Z++]<<F,F+=8}if(z!==(65535&f.check)){E.msg="header crc mismatch",f.mode=30;break}F=z=0}f.head&&(f.head.hcrc=f.flags>>9&1,f.head.done=!0),E.adler=f.check=0,f.mode=12;break;case 10:for(;F<32;){if(R===0)break e;R--,z+=M[Z++]<<F,F+=8}E.adler=f.check=r(z),F=z=0,f.mode=11;case 11:if(f.havedict===0)return E.next_out=ue,E.avail_out=se,E.next_in=Z,E.avail_in=R,f.hold=z,f.bits=F,2;E.adler=f.check=1,f.mode=12;case 12:if(O===5||O===6)break e;case 13:if(f.last){z>>>=7&F,F-=7&F,f.mode=27;break}for(;F<3;){if(R===0)break e;R--,z+=M[Z++]<<F,F+=8}switch(f.last=1&z,F-=1,3&(z>>>=1)){case 0:f.mode=14;break;case 1:if(G(f),f.mode=20,O!==6)break;z>>>=2,F-=2;break e;case 2:f.mode=17;break;case 3:E.msg="invalid block type",f.mode=30}z>>>=2,F-=2;break;case 14:for(z>>>=7&F,F-=7&F;F<32;){if(R===0)break e;R--,z+=M[Z++]<<F,F+=8}if((65535&z)!=(z>>>16^65535)){E.msg="invalid stored block lengths",f.mode=30;break}if(f.length=65535&z,F=z=0,f.mode=15,O===6)break e;case 15:f.mode=16;case 16:if(K=f.length){if(R<K&&(K=R),se<K&&(K=se),K===0)break e;l.arraySet(ne,M,Z,K,ue),R-=K,Z+=K,se-=K,ue+=K,f.length-=K;break}f.mode=12;break;case 17:for(;F<14;){if(R===0)break e;R--,z+=M[Z++]<<F,F+=8}if(f.nlen=257+(31&z),z>>>=5,F-=5,f.ndist=1+(31&z),z>>>=5,F-=5,f.ncode=4+(15&z),z>>>=4,F-=4,286<f.nlen||30<f.ndist){E.msg="too many length or distance symbols",f.mode=30;break}f.have=0,f.mode=18;case 18:for(;f.have<f.ncode;){for(;F<3;){if(R===0)break e;R--,z+=M[Z++]<<F,F+=8}f.lens[L[f.have++]]=7&z,z>>>=3,F-=3}for(;f.have<19;)f.lens[L[f.have++]]=0;if(f.lencode=f.lendyn,f.lenbits=7,T={bits:f.lenbits},U=g(0,f.lens,0,19,f.lencode,0,f.work,T),f.lenbits=T.bits,U){E.msg="invalid code lengths set",f.mode=30;break}f.have=0,f.mode=19;case 19:for(;f.have<f.nlen+f.ndist;){for(;fe=(k=f.lencode[z&(1<<f.lenbits)-1])>>>16&255,Ce=65535&k,!((le=k>>>24)<=F);){if(R===0)break e;R--,z+=M[Z++]<<F,F+=8}if(Ce<16)z>>>=le,F-=le,f.lens[f.have++]=Ce;else{if(Ce===16){for(C=le+2;F<C;){if(R===0)break e;R--,z+=M[Z++]<<F,F+=8}if(z>>>=le,F-=le,f.have===0){E.msg="invalid bit length repeat",f.mode=30;break}d=f.lens[f.have-1],K=3+(3&z),z>>>=2,F-=2}else if(Ce===17){for(C=le+3;F<C;){if(R===0)break e;R--,z+=M[Z++]<<F,F+=8}F-=le,d=0,K=3+(7&(z>>>=le)),z>>>=3,F-=3}else{for(C=le+7;F<C;){if(R===0)break e;R--,z+=M[Z++]<<F,F+=8}F-=le,d=0,K=11+(127&(z>>>=le)),z>>>=7,F-=7}if(f.have+K>f.nlen+f.ndist){E.msg="invalid bit length repeat",f.mode=30;break}for(;K--;)f.lens[f.have++]=d}}if(f.mode===30)break;if(f.lens[256]===0){E.msg="invalid code -- missing end-of-block",f.mode=30;break}if(f.lenbits=9,T={bits:f.lenbits},U=g(_,f.lens,0,f.nlen,f.lencode,0,f.work,T),f.lenbits=T.bits,U){E.msg="invalid literal/lengths set",f.mode=30;break}if(f.distbits=6,f.distcode=f.distdyn,T={bits:f.distbits},U=g(b,f.lens,f.nlen,f.ndist,f.distcode,0,f.work,T),f.distbits=T.bits,U){E.msg="invalid distances set",f.mode=30;break}if(f.mode=20,O===6)break e;case 20:f.mode=21;case 21:if(6<=R&&258<=se){E.next_out=ue,E.avail_out=se,E.next_in=Z,E.avail_in=R,f.hold=z,f.bits=F,c(E,W),ue=E.next_out,ne=E.output,se=E.avail_out,Z=E.next_in,M=E.input,R=E.avail_in,z=f.hold,F=f.bits,f.mode===12&&(f.back=-1);break}for(f.back=0;fe=(k=f.lencode[z&(1<<f.lenbits)-1])>>>16&255,Ce=65535&k,!((le=k>>>24)<=F);){if(R===0)break e;R--,z+=M[Z++]<<F,F+=8}if(fe&&(240&fe)==0){for(_e=le,xe=fe,Ae=Ce;fe=(k=f.lencode[Ae+((z&(1<<_e+xe)-1)>>_e)])>>>16&255,Ce=65535&k,!(_e+(le=k>>>24)<=F);){if(R===0)break e;R--,z+=M[Z++]<<F,F+=8}z>>>=_e,F-=_e,f.back+=_e}if(z>>>=le,F-=le,f.back+=le,f.length=Ce,fe===0){f.mode=26;break}if(32&fe){f.back=-1,f.mode=12;break}if(64&fe){E.msg="invalid literal/length code",f.mode=30;break}f.extra=15&fe,f.mode=22;case 22:if(f.extra){for(C=f.extra;F<C;){if(R===0)break e;R--,z+=M[Z++]<<F,F+=8}f.length+=z&(1<<f.extra)-1,z>>>=f.extra,F-=f.extra,f.back+=f.extra}f.was=f.length,f.mode=23;case 23:for(;fe=(k=f.distcode[z&(1<<f.distbits)-1])>>>16&255,Ce=65535&k,!((le=k>>>24)<=F);){if(R===0)break e;R--,z+=M[Z++]<<F,F+=8}if((240&fe)==0){for(_e=le,xe=fe,Ae=Ce;fe=(k=f.distcode[Ae+((z&(1<<_e+xe)-1)>>_e)])>>>16&255,Ce=65535&k,!(_e+(le=k>>>24)<=F);){if(R===0)break e;R--,z+=M[Z++]<<F,F+=8}z>>>=_e,F-=_e,f.back+=_e}if(z>>>=le,F-=le,f.back+=le,64&fe){E.msg="invalid distance code",f.mode=30;break}f.offset=Ce,f.extra=15&fe,f.mode=24;case 24:if(f.extra){for(C=f.extra;F<C;){if(R===0)break e;R--,z+=M[Z++]<<F,F+=8}f.offset+=z&(1<<f.extra)-1,z>>>=f.extra,F-=f.extra,f.back+=f.extra}if(f.offset>f.dmax){E.msg="invalid distance too far back",f.mode=30;break}f.mode=25;case 25:if(se===0)break e;if(K=W-se,f.offset>K){if((K=f.offset-K)>f.whave&&f.sane){E.msg="invalid distance too far back",f.mode=30;break}be=K>f.wnext?(K-=f.wnext,f.wsize-K):f.wnext-K,K>f.length&&(K=f.length),ke=f.window}else ke=ne,be=ue-f.offset,K=f.length;for(se<K&&(K=se),se-=K,f.length-=K;ne[ue++]=ke[be++],--K;);f.length===0&&(f.mode=21);break;case 26:if(se===0)break e;ne[ue++]=f.length,se--,f.mode=21;break;case 27:if(f.wrap){for(;F<32;){if(R===0)break e;R--,z|=M[Z++]<<F,F+=8}if(W-=se,E.total_out+=W,f.total+=W,W&&(E.adler=f.check=f.flags?a(f.check,ne,W,ue-W):n(f.check,ne,W,ue-W)),W=se,(f.flags?z:r(z))!==f.check){E.msg="incorrect data check",f.mode=30;break}F=z=0}f.mode=28;case 28:if(f.wrap&&f.flags){for(;F<32;){if(R===0)break e;R--,z+=M[Z++]<<F,F+=8}if(z!==(4294967295&f.total)){E.msg="incorrect length check",f.mode=30;break}F=z=0}f.mode=29;case 29:U=1;break e;case 30:U=-3;break e;case 31:return-4;case 32:default:return u}return E.next_out=ue,E.avail_out=se,E.next_in=Z,E.avail_in=R,f.hold=z,f.bits=F,(f.wsize||W!==E.avail_out&&f.mode<30&&(f.mode<27||O!==4))&&oe(E,E.output,E.next_out,W-E.avail_out)?(f.mode=31,-4):(ee-=E.avail_in,W-=E.avail_out,E.total_in+=ee,E.total_out+=W,f.total+=W,f.wrap&&W&&(E.adler=f.check=f.flags?a(f.check,ne,W,E.next_out-W):n(f.check,ne,W,E.next_out-W)),E.data_type=f.bits+(f.last?64:0)+(f.mode===12?128:0)+(f.mode===20||f.mode===15?256:0),(ee==0&&W===0||O===4)&&U===p&&(U=-5),U)},o.inflateEnd=function(E){if(!E||!E.state)return u;var O=E.state;return O.window&&(O.window=null),E.state=null,p},o.inflateGetHeader=function(E,O){var f;return E&&E.state?(2&(f=E.state).wrap)==0?u:((f.head=O).done=!1,p):u},o.inflateSetDictionary=function(E,O){var f,M=O.length;return E&&E.state?(f=E.state).wrap!==0&&f.mode!==11?u:f.mode===11&&n(1,O,M,0)!==f.check?-3:oe(E,O,M,M)?(f.mode=31,-4):(f.havedict=1,p):u},o.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(m,I,o){var l=m("../utils/common"),n=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],g=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];I.exports=function(_,b,p,u,y,h,w,r){var v,S,D,V,B,q,j,A,G,oe=r.bits,E=0,O=0,f=0,M=0,ne=0,Z=0,ue=0,R=0,se=0,z=0,F=null,ee=0,W=new l.Buf16(16),K=new l.Buf16(16),be=null,ke=0;for(E=0;E<=15;E++)W[E]=0;for(O=0;O<u;O++)W[b[p+O]]++;for(ne=oe,M=15;1<=M&&W[M]===0;M--);if(M<ne&&(ne=M),M===0)return y[h++]=20971520,y[h++]=20971520,r.bits=1,0;for(f=1;f<M&&W[f]===0;f++);for(ne<f&&(ne=f),E=R=1;E<=15;E++)if(R<<=1,(R-=W[E])<0)return-1;if(0<R&&(_===0||M!==1))return-1;for(K[1]=0,E=1;E<15;E++)K[E+1]=K[E]+W[E];for(O=0;O<u;O++)b[p+O]!==0&&(w[K[b[p+O]]++]=O);if(q=_===0?(F=be=w,19):_===1?(F=n,ee-=257,be=a,ke-=257,256):(F=c,be=g,-1),E=f,B=h,ue=O=z=0,D=-1,V=(se=1<<(Z=ne))-1,_===1&&852<se||_===2&&592<se)return 1;for(;;){for(j=E-ue,G=w[O]<q?(A=0,w[O]):w[O]>q?(A=be[ke+w[O]],F[ee+w[O]]):(A=96,0),v=1<<E-ue,f=S=1<<Z;y[B+(z>>ue)+(S-=v)]=j<<24|A<<16|G|0,S!==0;);for(v=1<<E-1;z&v;)v>>=1;if(v!==0?(z&=v-1,z+=v):z=0,O++,--W[E]==0){if(E===M)break;E=b[p+w[O]]}if(ne<E&&(z&V)!==D){for(ue===0&&(ue=ne),B+=f,R=1<<(Z=E-ue);Z+ue<M&&!((R-=W[Z+ue])<=0);)Z++,R<<=1;if(se+=1<<Z,_===1&&852<se||_===2&&592<se)return 1;y[D=z&V]=ne<<24|Z<<16|B-h|0}}return z!==0&&(y[B+z]=E-ue<<24|64<<16|0),r.bits=ne,0}},{"../utils/common":41}],51:[function(m,I,o){I.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(m,I,o){var l=m("../utils/common"),n=0,a=1;function c(k){for(var x=k.length;0<=--x;)k[x]=0}var g=0,_=29,b=256,p=b+1+_,u=30,y=19,h=2*p+1,w=15,r=16,v=7,S=256,D=16,V=17,B=18,q=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],j=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],A=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],G=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],oe=new Array(2*(p+2));c(oe);var E=new Array(2*u);c(E);var O=new Array(512);c(O);var f=new Array(256);c(f);var M=new Array(_);c(M);var ne,Z,ue,R=new Array(u);function se(k,x,L,$,P){this.static_tree=k,this.extra_bits=x,this.extra_base=L,this.elems=$,this.max_length=P,this.has_stree=k&&k.length}function z(k,x){this.dyn_tree=k,this.max_code=0,this.stat_desc=x}function F(k){return k<256?O[k]:O[256+(k>>>7)]}function ee(k,x){k.pending_buf[k.pending++]=255&x,k.pending_buf[k.pending++]=x>>>8&255}function W(k,x,L){k.bi_valid>r-L?(k.bi_buf|=x<<k.bi_valid&65535,ee(k,k.bi_buf),k.bi_buf=x>>r-k.bi_valid,k.bi_valid+=L-r):(k.bi_buf|=x<<k.bi_valid&65535,k.bi_valid+=L)}function K(k,x,L){W(k,L[2*x],L[2*x+1])}function be(k,x){for(var L=0;L|=1&k,k>>>=1,L<<=1,0<--x;);return L>>>1}function ke(k,x,L){var $,P,X=new Array(w+1),ae=0;for($=1;$<=w;$++)X[$]=ae=ae+L[$-1]<<1;for(P=0;P<=x;P++){var Q=k[2*P+1];Q!==0&&(k[2*P]=be(X[Q]++,Q))}}function le(k){var x;for(x=0;x<p;x++)k.dyn_ltree[2*x]=0;for(x=0;x<u;x++)k.dyn_dtree[2*x]=0;for(x=0;x<y;x++)k.bl_tree[2*x]=0;k.dyn_ltree[2*S]=1,k.opt_len=k.static_len=0,k.last_lit=k.matches=0}function fe(k){8<k.bi_valid?ee(k,k.bi_buf):0<k.bi_valid&&(k.pending_buf[k.pending++]=k.bi_buf),k.bi_buf=0,k.bi_valid=0}function Ce(k,x,L,$){var P=2*x,X=2*L;return k[P]<k[X]||k[P]===k[X]&&$[x]<=$[L]}function _e(k,x,L){for(var $=k.heap[L],P=L<<1;P<=k.heap_len&&(P<k.heap_len&&Ce(x,k.heap[P+1],k.heap[P],k.depth)&&P++,!Ce(x,$,k.heap[P],k.depth));)k.heap[L]=k.heap[P],L=P,P<<=1;k.heap[L]=$}function xe(k,x,L){var $,P,X,ae,Q=0;if(k.last_lit!==0)for(;$=k.pending_buf[k.d_buf+2*Q]<<8|k.pending_buf[k.d_buf+2*Q+1],P=k.pending_buf[k.l_buf+Q],Q++,$===0?K(k,P,x):(K(k,(X=f[P])+b+1,x),(ae=q[X])!==0&&W(k,P-=M[X],ae),K(k,X=F(--$),L),(ae=j[X])!==0&&W(k,$-=R[X],ae)),Q<k.last_lit;);K(k,S,x)}function Ae(k,x){var L,$,P,X=x.dyn_tree,ae=x.stat_desc.static_tree,Q=x.stat_desc.has_stree,ie=x.stat_desc.elems,ye=-1;for(k.heap_len=0,k.heap_max=h,L=0;L<ie;L++)X[2*L]!==0?(k.heap[++k.heap_len]=ye=L,k.depth[L]=0):X[2*L+1]=0;for(;k.heap_len<2;)X[2*(P=k.heap[++k.heap_len]=ye<2?++ye:0)]=1,k.depth[P]=0,k.opt_len--,Q&&(k.static_len-=ae[2*P+1]);for(x.max_code=ye,L=k.heap_len>>1;1<=L;L--)_e(k,X,L);for(P=ie;L=k.heap[1],k.heap[1]=k.heap[k.heap_len--],_e(k,X,1),$=k.heap[1],k.heap[--k.heap_max]=L,k.heap[--k.heap_max]=$,X[2*P]=X[2*L]+X[2*$],k.depth[P]=(k.depth[L]>=k.depth[$]?k.depth[L]:k.depth[$])+1,X[2*L+1]=X[2*$+1]=P,k.heap[1]=P++,_e(k,X,1),2<=k.heap_len;);k.heap[--k.heap_max]=k.heap[1],function(pe,Fe){var Ke,Oe,Ye,Se,et,lt,Be=Fe.dyn_tree,mt=Fe.max_code,yt=Fe.stat_desc.static_tree,wt=Fe.stat_desc.has_stree,It=Fe.stat_desc.extra_bits,ft=Fe.stat_desc.extra_base,Je=Fe.stat_desc.max_length,tt=0;for(Se=0;Se<=w;Se++)pe.bl_count[Se]=0;for(Be[2*pe.heap[pe.heap_max]+1]=0,Ke=pe.heap_max+1;Ke<h;Ke++)Je<(Se=Be[2*Be[2*(Oe=pe.heap[Ke])+1]+1]+1)&&(Se=Je,tt++),Be[2*Oe+1]=Se,mt<Oe||(pe.bl_count[Se]++,et=0,ft<=Oe&&(et=It[Oe-ft]),lt=Be[2*Oe],pe.opt_len+=lt*(Se+et),wt&&(pe.static_len+=lt*(yt[2*Oe+1]+et)));if(tt!==0){do{for(Se=Je-1;pe.bl_count[Se]===0;)Se--;pe.bl_count[Se]--,pe.bl_count[Se+1]+=2,pe.bl_count[Je]--,tt-=2}while(0<tt);for(Se=Je;Se!==0;Se--)for(Oe=pe.bl_count[Se];Oe!==0;)mt<(Ye=pe.heap[--Ke])||(Be[2*Ye+1]!==Se&&(pe.opt_len+=(Se-Be[2*Ye+1])*Be[2*Ye],Be[2*Ye+1]=Se),Oe--)}}(k,x),ke(X,ye,k.bl_count)}function d(k,x,L){var $,P,X=-1,ae=x[1],Q=0,ie=7,ye=4;for(ae===0&&(ie=138,ye=3),x[2*(L+1)+1]=65535,$=0;$<=L;$++)P=ae,ae=x[2*($+1)+1],++Q<ie&&P===ae||(Q<ye?k.bl_tree[2*P]+=Q:P!==0?(P!==X&&k.bl_tree[2*P]++,k.bl_tree[2*D]++):Q<=10?k.bl_tree[2*V]++:k.bl_tree[2*B]++,X=P,ye=(Q=0)===ae?(ie=138,3):P===ae?(ie=6,3):(ie=7,4))}function U(k,x,L){var $,P,X=-1,ae=x[1],Q=0,ie=7,ye=4;for(ae===0&&(ie=138,ye=3),$=0;$<=L;$++)if(P=ae,ae=x[2*($+1)+1],!(++Q<ie&&P===ae)){if(Q<ye)for(;K(k,P,k.bl_tree),--Q!=0;);else P!==0?(P!==X&&(K(k,P,k.bl_tree),Q--),K(k,D,k.bl_tree),W(k,Q-3,2)):Q<=10?(K(k,V,k.bl_tree),W(k,Q-3,3)):(K(k,B,k.bl_tree),W(k,Q-11,7));X=P,ye=(Q=0)===ae?(ie=138,3):P===ae?(ie=6,3):(ie=7,4)}}c(R);var T=!1;function C(k,x,L,$){W(k,(g<<1)+($?1:0),3),function(P,X,ae,Q){fe(P),Q&&(ee(P,ae),ee(P,~ae)),l.arraySet(P.pending_buf,P.window,X,ae,P.pending),P.pending+=ae}(k,x,L,!0)}o._tr_init=function(k){T||(function(){var x,L,$,P,X,ae=new Array(w+1);for(P=$=0;P<_-1;P++)for(M[P]=$,x=0;x<1<<q[P];x++)f[$++]=P;for(f[$-1]=P,P=X=0;P<16;P++)for(R[P]=X,x=0;x<1<<j[P];x++)O[X++]=P;for(X>>=7;P<u;P++)for(R[P]=X<<7,x=0;x<1<<j[P]-7;x++)O[256+X++]=P;for(L=0;L<=w;L++)ae[L]=0;for(x=0;x<=143;)oe[2*x+1]=8,x++,ae[8]++;for(;x<=255;)oe[2*x+1]=9,x++,ae[9]++;for(;x<=279;)oe[2*x+1]=7,x++,ae[7]++;for(;x<=287;)oe[2*x+1]=8,x++,ae[8]++;for(ke(oe,p+1,ae),x=0;x<u;x++)E[2*x+1]=5,E[2*x]=be(x,5);ne=new se(oe,q,b+1,p,w),Z=new se(E,j,0,u,w),ue=new se(new Array(0),A,0,y,v)}(),T=!0),k.l_desc=new z(k.dyn_ltree,ne),k.d_desc=new z(k.dyn_dtree,Z),k.bl_desc=new z(k.bl_tree,ue),k.bi_buf=0,k.bi_valid=0,le(k)},o._tr_stored_block=C,o._tr_flush_block=function(k,x,L,$){var P,X,ae=0;0<k.level?(k.strm.data_type===2&&(k.strm.data_type=function(Q){var ie,ye=4093624447;for(ie=0;ie<=31;ie++,ye>>>=1)if(1&ye&&Q.dyn_ltree[2*ie]!==0)return n;if(Q.dyn_ltree[18]!==0||Q.dyn_ltree[20]!==0||Q.dyn_ltree[26]!==0)return a;for(ie=32;ie<b;ie++)if(Q.dyn_ltree[2*ie]!==0)return a;return n}(k)),Ae(k,k.l_desc),Ae(k,k.d_desc),ae=function(Q){var ie;for(d(Q,Q.dyn_ltree,Q.l_desc.max_code),d(Q,Q.dyn_dtree,Q.d_desc.max_code),Ae(Q,Q.bl_desc),ie=y-1;3<=ie&&Q.bl_tree[2*G[ie]+1]===0;ie--);return Q.opt_len+=3*(ie+1)+5+5+4,ie}(k),P=k.opt_len+3+7>>>3,(X=k.static_len+3+7>>>3)<=P&&(P=X)):P=X=L+5,L+4<=P&&x!==-1?C(k,x,L,$):k.strategy===4||X===P?(W(k,2+($?1:0),3),xe(k,oe,E)):(W(k,4+($?1:0),3),function(Q,ie,ye,pe){var Fe;for(W(Q,ie-257,5),W(Q,ye-1,5),W(Q,pe-4,4),Fe=0;Fe<pe;Fe++)W(Q,Q.bl_tree[2*G[Fe]+1],3);U(Q,Q.dyn_ltree,ie-1),U(Q,Q.dyn_dtree,ye-1)}(k,k.l_desc.max_code+1,k.d_desc.max_code+1,ae+1),xe(k,k.dyn_ltree,k.dyn_dtree)),le(k),$&&fe(k)},o._tr_tally=function(k,x,L){return k.pending_buf[k.d_buf+2*k.last_lit]=x>>>8&255,k.pending_buf[k.d_buf+2*k.last_lit+1]=255&x,k.pending_buf[k.l_buf+k.last_lit]=255&L,k.last_lit++,x===0?k.dyn_ltree[2*L]++:(k.matches++,x--,k.dyn_ltree[2*(f[L]+b+1)]++,k.dyn_dtree[2*F(x)]++),k.last_lit===k.lit_bufsize-1},o._tr_align=function(k){W(k,2,3),K(k,S,oe),function(x){x.bi_valid===16?(ee(x,x.bi_buf),x.bi_buf=0,x.bi_valid=0):8<=x.bi_valid&&(x.pending_buf[x.pending++]=255&x.bi_buf,x.bi_buf>>=8,x.bi_valid-=8)}(k)}},{"../utils/common":41}],53:[function(m,I,o){I.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(m,I,o){(function(l){(function(n,a){if(!n.setImmediate){var c,g,_,b,p=1,u={},y=!1,h=n.document,w=Object.getPrototypeOf&&Object.getPrototypeOf(n);w=w&&w.setTimeout?w:n,c={}.toString.call(n.process)==="[object process]"?function(D){process.nextTick(function(){v(D)})}:function(){if(n.postMessage&&!n.importScripts){var D=!0,V=n.onmessage;return n.onmessage=function(){D=!1},n.postMessage("","*"),n.onmessage=V,D}}()?(b="setImmediate$"+Math.random()+"$",n.addEventListener?n.addEventListener("message",S,!1):n.attachEvent("onmessage",S),function(D){n.postMessage(b+D,"*")}):n.MessageChannel?((_=new MessageChannel).port1.onmessage=function(D){v(D.data)},function(D){_.port2.postMessage(D)}):h&&"onreadystatechange"in h.createElement("script")?(g=h.documentElement,function(D){var V=h.createElement("script");V.onreadystatechange=function(){v(D),V.onreadystatechange=null,g.removeChild(V),V=null},g.appendChild(V)}):function(D){setTimeout(v,0,D)},w.setImmediate=function(D){typeof D!="function"&&(D=new Function(""+D));for(var V=new Array(arguments.length-1),B=0;B<V.length;B++)V[B]=arguments[B+1];var q={callback:D,args:V};return u[p]=q,c(p),p++},w.clearImmediate=r}function r(D){delete u[D]}function v(D){if(y)setTimeout(v,0,D);else{var V=u[D];if(V){y=!0;try{(function(B){var q=B.callback,j=B.args;switch(j.length){case 0:q();break;case 1:q(j[0]);break;case 2:q(j[0],j[1]);break;case 3:q(j[0],j[1],j[2]);break;default:q.apply(a,j)}})(V)}finally{r(D),y=!1}}}}function S(D){D.source===n&&typeof D.data=="string"&&D.data.indexOf(b)===0&&v(+D.data.slice(b.length))}})(typeof self=="undefined"?l===void 0?this:l:self)}).call(this,typeof at!="undefined"?at:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}]},{},[10])(10)})})(_t);var sa=_t.exports;const We={paginacao:{atual:1,maximo:1,total:1,limite:25},filtros:{numero:"",numeroCompra:null,destinatario:null,periodoEmissao:{ini:"",fim:""},periodoFinalizado:{ini:"",fim:""},fornecedor:{nome:""},ordenacao:"dataHoraFinalizado",direcao:"desc",ordenacaoSefaz:"dhRecbto",direcaoSefaz:"desc"}},la={components:{Lista:qt,ComprasFicha:Kt,ComprasImportacaoXML:ia},data(){return{usuario:"",clienteSistema:"",lista:[],contatos:{},destinatarioOpcoes:[],destinatarioSelecionado:null,mostrar:{header:!0,barraTopo:!0,toolbarTitulo:!0,icone:"factory",titulo:"Compras",filtroAvancado:!0,buscar:!0,btnAjuda:!0,btnAtualizar:!0,btnNovo:!0,toolbarAcoes:!0,checkBox:!1,btnRemover:!1,btnRestaurar:!1,centralizaTabs:!1,btnDetalhes:!1,btnExportaXLS:!1,btnMenuMais:!1,toolbarAdicao:!1,bannerMsg:"",conexao:{icone:"hibrido",iconeTamanho:"xs",cor:"grey-5",rotulo:null,dica:"H\xEDbrido",denso:!0,flat:!0,escuro:!1}},resultado:{},busca:"",filtros:$utils.clonar(We.filtros),ordenacaoOpcoes:[{value:"dataHoraEmissao",label:"Data Emiss\xE3o"},{value:"dataHoraFinalizado",label:"Data Finalizado"}],ordenacaoSefaz:[{value:"dhRecbto",label:"Data Recebimento"}],direcaoOpcoes:[{value:"desc",label:"Decrescente"},{value:"asc",label:"Crescente"}],tabSelecionada:{valor:"Pedido de Compra"},tabs:[],tabSelecionada2:{valor:"Digita\xE7\xE3o"},tabs2:[{valor:"Digita\xE7\xE3o",rotulo:"Digita\xE7\xE3o"},{valor:"Finalizado",rotulo:"Finalizado"},{valor:"Todos",rotulo:"Todos"}],paginacao:$utils.clonar(We.paginacao),xmlDevolucao:!1,xmlEstrangeiro:!1,modalXMLNotaEntrada:!1,xmlNotaEntrada:{},abrirNotadeEntrada:null,modalPrevisaoEntrega:{},configImpressao:[],configImpressaoPedidoCompra:[{valor:"ped_compra",texto:"Pedido de Compra",observacao:"Modelo 1"},{valor:"pedidoCompra",texto:"Pedido de Compra",observacao:"Modelo 2"}],dialogEtiquetas:{impressao:!1,adicionar:!1,limpar:!1,item:{}},opcoesModelo:[],modeloSelecionado:"",emBranco:0,opcoesEmpresas:[],empresaSelecionada:"",tabelasPreco:[],opcoesTabelasPreco:[],tabelaPrecoSelecionada:""}},methods:{aoSelecionarDestinatario(){this.filtros.destinatario=$utils.clonar(this.destinatarioSelecionado)},async atualizar(i){var m;const e=$utils.logarIni("ComprasLista");await $tryLoading(async()=>{var _,b,p,u,y,h,w,r,v,S,D,V,B,q,j,A,G,oe,E,O,f,M,ne,Z,ue;let{buscarTabsRecentes:I,buscarDadosRecentes:o}=i!=null?i:{},l,n,a,c,g;if(I?(l=await $utils.localIDB.getItem({objectStore:"dadosRecentes",id:"ComprasLista_"+((_=this.usuario)==null?void 0:_.id)}),this.tabSelecionada.valor=(l==null?void 0:l.tabSelecionada)||"Pedido de Compra",this.setOpcoesTabs(this.tabSelecionada.valor)):this.setOpcoesTabs(this.tabSelecionada.valor),this.tabSelecionadaAnterior&&this.tabSelecionadaAnterior!==this.tabSelecionada.valor&&(this.filtros=$utils.clonarV2(We.filtros),this.paginacao=$utils.clonarV2(We.paginacao),this.busca="",o=!0),this.tabSelecionadaAnterior=this.tabSelecionada.valor,o&&(n=await $utils.localIDB.getItem({objectStore:"dadosRecentes",id:"ComprasLista_"+this.tabSelecionada.valor+((b=this.usuario)==null?void 0:b.id)}),n!=null&&n._id?(this.tabSelecionada2.valor=n==null?void 0:n.tabSelecionada2,this.destinatarioSelecionado=(p=n==null?void 0:n.filtros)==null?void 0:p.destinatario,this.busca=(n==null?void 0:n.busca)||"",this.paginacao.limite=(n==null?void 0:n.limite)||25,this.filtros={numero:((u=n==null?void 0:n.filtros)==null?void 0:u.numero)||"",numeroCompra:((y=n==null?void 0:n.filtros)==null?void 0:y.numeroCompra)||null,destinatario:((h=n==null?void 0:n.filtros)==null?void 0:h.destinatario)||null,periodoEmissao:{ini:((r=(w=n==null?void 0:n.filtros)==null?void 0:w.periodoEmissao)==null?void 0:r.ini)||"",fim:((S=(v=n==null?void 0:n.filtros)==null?void 0:v.periodoEmissao)==null?void 0:S.fim)||""},periodoFinalizado:{ini:((V=(D=n==null?void 0:n.filtros)==null?void 0:D.periodoFinalizado)==null?void 0:V.ini)||"",fim:((q=(B=n==null?void 0:n.filtros)==null?void 0:B.periodoFinalizado)==null?void 0:q.fim)||""},fornecedor:{nome:((A=(j=n==null?void 0:n.filtros)==null?void 0:j.fornecedor)==null?void 0:A.nome)||""},ordenacao:((G=n==null?void 0:n.filtros)==null?void 0:G.ordenacao)||"dataHoraFinalizado",direcao:((oe=n==null?void 0:n.filtros)==null?void 0:oe.direcao)||"desc",ordenacaoSefaz:((E=n==null?void 0:n.filtros)==null?void 0:E.ordenacaoSefaz)||"dhRecbto",direcaoSefaz:((O=n==null?void 0:n.filtros)==null?void 0:O.direcaoSefaz)||"desc"},this.compareObject(We.filtros,this.filtros,["ordenacao","direcao","ordenacaoSefaz","direcaoSefaz"])&&(this.$refs.comprasLista.filtros=!0)):this.tabSelecionada.valor!=="Nota na SEFAZ"?this.tabSelecionada2.valor="Digita\xE7\xE3o":this.tabSelecionada2.valor="N\xE3o Importada",this.tabSelecionada2Anterior=this.tabSelecionada2.valor),a=$utils.eliminarVazios(this.filtros),c=this.paginacao.limite,g=this.paginacao.atual,a.status=this.tabSelecionada2.valor,a.operacao=this.tabSelecionada.valor,delete a.termoBusca,this.busca&&(a.termoBusca=this.busca,this.buscaAnterior!==this.busca&&(this.paginacao.atual=1),this.buscaAnterior=this.busca),this.tabSelecionada2.valor==="Todos"&&delete a.status,a.operacao==="Nota na SEFAZ"){let R=await $db.hibrido.lista({table:"documentoFiscalEletronico",columns:["id","xNomeEmitente","cpfCnpjEmitente","xNomeDestinatario","cpfCnpjDestinatario","vNF","situacao","nNF"],where:{tipo:"DFe",...this.tabSelecionada2.valor!=="Todos"?{situacao:this.tabSelecionada2.valor}:{}}});if(a.numero&&(R=R.filter(ee=>parseInt(ee.nNF)===parseInt(a.numero))),(f=a.fornecedor)!=null&&f.nome&&(R=R.filter(ee=>ee.xNomeEmitente.toLowerCase().includes(a.fornecedor.nome.toLowerCase()))),(M=a.destinatario)!=null&&M.numeroDocumentoNacional&&(R=R.filter(ee=>{var W;return((W=ee.cpfCnpjDestinatario)==null?void 0:W.replace(/\D/g,""))===a.destinatario.numeroDocumentoNacional.replace(/\D/g,"")})),a.termoBusca)if(/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/.test(a.termoBusca))R=R.filter(W=>W.id===a.termoBusca);else{const W=$utils.removerAcentos(a.termoBusca.toUpperCase()).split(" ").filter(Boolean),K=W.filter(le=>le.match(/^\d+$/)),be=W.filter(le=>!le.match(/^\d+$/)),ke=[];for(const le of R){const fe=$utils.removerAcentos([le.xNomeEmitente,le.xNomeDestinatario,le.cpfCnpjEmitente,le.cpfCnpjDestinatario].join(" ").toUpperCase()),Ce=[le.nNF].map(String);let _e=!0;for(const xe of K)_e=_e&&Ce.includes(xe);for(const xe of be)_e=_e&&fe.includes(xe);_e&&ke.push(le)}R=ke}const se=await $db.hibrido.lista({table:"documentoFiscalEletronicoXml",columns:["idDocumentoFiscalEletronico","dhRecbto"],whereIn:{idDocumentoFiscalEletronico:R.map(ee=>ee.id)}}),z=[];se.forEach(ee=>{var le,fe;const W=R.find(Ce=>Ce.id===ee.idDocumentoFiscalEletronico),K=new Date(ee.dhRecbto).setHours(0,0,0,0),be=new Date((le=a.periodoEmissao)==null?void 0:le.ini).setHours(0,0,0,0),ke=new Date((fe=a.periodoEmissao)==null?void 0:fe.fim).setHours(0,0,0,0);(be||ke)&&K&&(be&&K<be||ke&&K>ke)||W&&z.push({id:W.id,descricaoContato:W.xNomeEmitente,numeroDocumentoContato:this.$filters.cpfCnpj(W.cpfCnpjEmitente)||"",descricaoEmpresa:W.xNomeDestinatario,numeroDocumentoEmpresa:this.$filters.cpfCnpj(W.cpfCnpjDestinatario)||"",dhRecbto:ee.dhRecbto,totalDocumento:W.vNF,status:W.situacao,notaNumero:W.nNF})});const F=(g-1)*c;this.paginacao.total=z.length,this.paginacao.maximo=Math.ceil(this.paginacao.total/c)||1,a.direcaoSefaz==="desc"?z.sort((ee,W)=>ee[a.ordenacaoSefaz]<W[a.ordenacaoSefaz]?1:-1):z.sort((ee,W)=>ee[a.ordenacaoSefaz]>W[a.ordenacaoSefaz]?1:-1),this.lista=z.splice(F,c)}else{const R=[a.ordenacao],se=[a.direcao];(ne=a.destinatario)!=null&&ne.value&&(a.idContatoEmpresa=a.destinatario.value);const z=await $db.compra.leListaCompleta({filtros:a,limit:c,page:g,sort:R,dir:se});this.paginacao.total=z.total,this.paginacao.maximo=z.totalPages,this.lista=z.data.compras}for(const{idContato:R}of this.lista)R&&!this.contatos[R]&&(this.contatos[R]={});this.carregarImagensContatos(this.contatos),this.configuraImpressao(a.idEmpresa),l={_id:"ComprasLista_"+((Z=this.usuario)==null?void 0:Z.id),tabSelecionada:this.tabSelecionada.valor},await $utils.localIDB.setItem({objectStore:"dadosRecentes",data:l}),n={_id:"ComprasLista_"+this.tabSelecionada.valor+((ue=this.usuario)==null?void 0:ue.id),tabSelecionada:this.tabSelecionada.valor,tabSelecionada2:this.tabSelecionada2.valor,filtros:$utils.clonar(this.filtros),busca:this.busca,limite:this.paginacao.limite},await $utils.localIDB.setItem({objectStore:"dadosRecentes",data:n})}),$utils.logarFim(e,((m=this.paginacao)==null?void 0:m.total)||1)},async carregarImagensContatos(i){const e=Object.keys(i);if(!!e.length){await $utils.dormir(200);try{const m=await $db.hibrido.lista({table:"contato",columns:["id","apelido","imagem"],whereIn:{id:e}});for(const I of m)i[I.id].imagem=I.imagem||""}catch(m){console.error("Erro ao carregar imagens de contatos - ",m)}}},adicionarXml(i){this.xmlNotaEntrada.arquivo=i[0]},async concluirImportacao(i){await $tryLoading(async()=>{await $db.compra.grava({atual:i}),$q.notifyPositive("Importa\xE7\xE3o realizada com sucesso!"),this.tabSelecionada2.valor="Digita\xE7\xE3o",this.tabSelecionada.valor="Nota de Entrada",await this.$refs.comprasFicha.mostrar({id:i.documento.id})},{mensagem:"Gravando importa\xE7\xE3o..."})},async importarXmlNotaDeEntrada(){var I,o,l,n,a,c;let i;try{$utils.verificarErro(!this.xmlNotaEntrada.arquivo,"Adicione um arquivo XML antes de enviar!"),i=await new Promise((g,_)=>{const b=new FileReader;b.readAsText(this.xmlNotaEntrada.arquivo,"UTF-8"),b.onload=()=>g(b.result),b.onerror=p=>_(p)})}catch(g){return console.error(g),$q.notifyError("Ocorreu um erro na importa\xE7\xE3o"),!1}let e;try{e=await Pt.parseStringPromise(i)}catch(g){return console.error(g),$q.notifyError("Arquivo inv\xE1lido ou corrompido"),!1}if(!((c=(a=(n=(l=(o=(I=e==null?void 0:e.nfeProc)==null?void 0:I.protNFe)==null?void 0:o[0])==null?void 0:l.infProt)==null?void 0:n[0])==null?void 0:a.nProt)==null?void 0:c[0])&&!await $q.dialogSimNao({title:"Aviso importante",message:"O XML que est\xE1 sendo importado n\xE3o foi protocolado pela Sefaz, gostaria de importar o XML sem o protocolo?",html:!0})){$q.notifyError("Opera\xE7\xE3o para importa\xE7\xE3o de XML n\xE3o realizada!",erro);return}await $tryLoading(async()=>{const g=(await $db.hibrido.lista({table:"documentoXML",whereFilter:{xmlAux:i}}))[0];$utils.verificarErro(g==null?void 0:g.id,"Esse xml j\xE1 foi importado!");const _=await $db.compra.importaXml({xmlString:i,xmlEstrangeiro:Boolean(this.xmlEstrangeiro)});_.documentosItem.find(({vinculado:b})=>!b)?this.$refs.comprasImportacaoXML.mostrar(_):await this.concluirImportacao(_)},{mensagem:"Importando..."}),delete this.xmlNotaEntrada.arquivo,this.modalXMLNotaEntrada=!1,this.xmlEstrangeiro=!1},async fecharXmlNotaDeEntrada(){delete this.xmlNotaEntrada.arquivo},async abrir(i){this.tabSelecionada.valor!=="Nota na SEFAZ"&&this.$refs.comprasFicha.mostrar({id:i})},criarClick(){this.$refs.comprasFicha.criar()},importarXmlClick(){this.modalXMLNotaEntrada=!0},async limparFiltrosClick(){this.filtros=$utils.clonarV2(We.filtros),this.destinatarioSelecionado=null,await this.atualizar()},compareObject(i,e,m=[]){const I=Object.keys(i);for(const o of I)if(!m.includes(o)){if(typeof i[o]=="object"&&i[o]!==null){if(!this.compareObject(i[o],e[o],m))continue;return!0}else if(i[o]!==e[o])return!0}return!1},setOpcoesTabs(i){i!=="Nota na SEFAZ"?this.tabs2=[{valor:"Digita\xE7\xE3o",rotulo:"Digita\xE7\xE3o"},{valor:"Finalizado",rotulo:"Finalizado"},{valor:"Todos",rotulo:"Todos"}]:this.tabs2=[{valor:"N\xE3o Importada",rotulo:"N\xE3o Importada"},{valor:"Importada",rotulo:"Importada"},{valor:"Todos",rotulo:"Todas"}],this.tabSelecionada2Anterior!==this.tabSelecionada2.valor&&(this.paginacao.atual=1),this.tabSelecionada2Anterior=this.tabSelecionada2.valor},async duplicarDocumento_click(i){!await $q.dialogSimNao({title:"Duplicar",message:"Deseja prosseguir com a opera\xE7\xE3o?"})||await $tryLoading(async()=>{const e=await $db.hibrido.le({table:"documento",id:i.id});$utils.verificarErro(!e.id,"Compra n\xE3o encontrada");const m=(await $db.hibrido.lista({table:"documentoItem",where:{idDocumento:i.id}})).sort((l,n)=>new Date(l.dataHoraEmissao||0)-new Date(n.dataHoraEmissao||0)),I=[],o=$utils.uuid();await $db.hibrido.preGrava(I,"documento",{atual:{...e,id:o,codigoDocumento:void 0,numero:void 0,notaNumero:void 0,notaSerie:void 0,naturezaOperacao:void 0,dataCompra:void 0,chaveAcesso:void 0,dataHoraEmissao:$utils.dataAtual(),dataHoraFinalizado:void 0,dataHoraPrevisto:void 0,status:"Digita\xE7\xE3o",operacao:"Pedido de Compra"}}),await $db.hibrido.preGravaLista(I,"documentoItem",{atual:m.map(l=>({...l,id:$utils.uuid(),codigoDocumentoItem:void 0,idDocumento:o,codigoDocumento:void 0,dataHoraEmissao:$utils.dataAtual(),dataHoraFinalizado:void 0,status:"Digita\xE7\xE3o"}))}),await $db.hibrido.enviaLote(I),$q.notifyPositive("Duplica\xE7\xE3o realizada com sucesso!"),this.tabSelecionada2.valor="Digita\xE7\xE3o",this.tabSelecionada.valor="Pedido de Compra",await this.$refs.comprasFicha.mostrar({id:o})},{mensagem:"Duplicando..."})},async trocarCfop_click(i){!await $q.dialogSimNao({title:"Confirma\xE7\xE3o",message:"Deseja trocar os CFOP iniciados em 5 para 1556 e 6 para 2556?"})||await $tryLoading(async()=>{var n;const e=await $db.hibrido.lista({table:"documentoItem",where:{idDocumento:i.id}}),m=$utils.clonarV2(e),I=await $db.hibrido.lista({table:"cfop",whereIn:{id:$utils.unicos(m,"idCfop")}});let o=0;for(const a of I){const c=String(a.cfop),g=c[0]==="5"?"1556":c[0]==="6"?"2556":c;if(g!==c){const _=(n=(await $db.hibrido.lista({table:"cfop",where:{cfop:g}}))[0])==null?void 0:n.id;$utils.verificarErro(!_,`CFOP ${g} n\xE3o encontrado`);for(const b of m)b.idCfop===a.id&&(b.idCfop=_,o++)}}$utils.verificarErro(!o,"N\xE3o h\xE1 CFOPs com inicial 5 ou 6 para realizar trocas");const l=[];await $db.hibrido.preGravaLista(l,"documentoItem",{atual:m,original:e}),await $db.hibrido.enviaLote(l),$q.notifyPositive(`Troca de CFOP realizada com sucesso em ${o} itens!`)},{mensagem:"Processando..."})},async alterarPrevisaoEntrega_click(i){var e,m;this.modalPrevisaoEntrega={visivel:!0,dataPrevistaEntrega:(e=i.dataHoraPrevisto)==null?void 0:e.slice(0,10),horaPrevistaEntrega:(m=i.dataHoraPrevisto)==null?void 0:m.slice(11,16),compra:i}},async alterarPrevisaoEntrega(){await $tryLoading(async()=>{const{compra:i,dataPrevistaEntrega:e,horaPrevistaEntrega:m}=this.modalPrevisaoEntrega;$utils.verificarErro(!e,"\xC9 necess\xE1rio preencher a data");const I=Ne.formatDate(`${e} ${m||"00:00:00"}`);$utils.verificarErro(!I,"Data Inv\xE1lida"),I!==Ne.formatDate(i.dataHoraPrevisto)?(await $db.hibrido.grava("documento",{atual:{id:i.id,dataHoraPrevisto:I}}),i.dataHoraPrevisto=I,$q.notifyPositive("A previs\xE3o foi salva com sucesso"),this.modalPrevisaoEntrega={}):$q.notifyPositive("N\xE3o h\xE1 dados alterados.")})},async downloadXmlDFeFiltrados(){var i,e,m,I,o;if(!!await $q.dialogSimNao({title:"Download XML's filtrados",message:"Deseja prosseguir com a opera\xE7\xE3o?"}))try{$q.loading.show();let l=[];if($db.hibrido.isOnline())l=(o=(I=(m=await $utils.geeksApi({downloadDFe:{funcao:"2D9F9B43-47D3-491E-AD49-528EC9547BDC",...this.tabSelecionada2.valor!=="Todos"?{situacao:this.tabSelecionada2.valor}:{},fornecedor:(i=this.filtros.fornecedor)==null?void 0:i.nome,numeroDocumentoNacionalDestinatario:(e=this.filtros.destinatario)==null?void 0:e.numeroDocumentoNacional,periodoRecbto:this.filtros.periodoEmissao}}))==null?void 0:m.data)==null?void 0:I.downloadDFe)!=null?o:[];else{let n=await $db.hibrido.lista({table:"documentoFiscalEletronico",columns:["id","dhEmi","cpfCnpjEmitente","cpfCnpjDestinatario","xNomeEmitente","xNomeDestinatario"],where:{tipo:"DFe",...this.tabSelecionada2.valor!=="Todos"?{situacao:this.tabSelecionada2.valor}:{}}});n=n.filter(c=>{var g,_,b;return!(((g=this.filtros.fornecedor)==null?void 0:g.nome)&&!c.xNomeEmitente.toLowerCase().includes(this.filtros.fornecedor.nome.toLowerCase())||((_=this.filtros.destinatario)==null?void 0:_.numeroDocumentoNacional)&&((b=c.cpfCnpjDestinatario)==null?void 0:b.replace(/\D/g,""))!==this.filtros.destinatario.numeroDocumentoNacional.replace(/\D/g,""))}),(await $db.hibrido.lista({table:"documentoFiscalEletronicoXml",columns:["idDocumentoFiscalEletronico","chNFe","dhRecbto","xmlProt"],whereIn:{idDocumentoFiscalEletronico:n.map(c=>c.id)}})).forEach(c=>{var u,y;const g=n.find(h=>h.id===c.idDocumentoFiscalEletronico),_=new Date(c.dhRecbto).setHours(0,0,0,0),b=new Date((u=this.filtros.periodoEmissao)==null?void 0:u.ini).setHours(0,0,0,0),p=new Date((y=this.filtros.periodoEmissao)==null?void 0:y.fim).setHours(0,0,0,0);(b||p)&&_&&(b&&_<b||p&&_>p)||g&&l.push({chNFe:c.chNFe,xml:c.xmlProt,cnpj:g.cpfCnpjDestinatario})})}if((l==null?void 0:l.length)>0){const n=Array.from(new Set(l.filter(c=>c.cnpj).map(c=>c.cnpj))),a=new sa;for(const c of n)for(const g of l.filter(_=>_.cnpj===c))a.file(`${c}/${g.chNFe}.procNFe.xml`,g.xml);a.generateAsync({type:"blob"}).then(function(c){const g=new Date,_=document.createElement("a");_.href=window.URL.createObjectURL(c),_.download=`${g.getFullYear()}-${String(g.getMonth()+1).padStart(2,"0")}-${String(g.getDate()).padStart(2,"0")}_NotasEntradaSEFAZ.zip`,_.click()})}}catch{$q.notify({message:"N\xE3o foi poss\xEDvel realizar o download",type:"negative"})}finally{$q.loading.hide()}},async downloadXmlDFe(i,e){!await $q.dialogSimNao({title:"Download XML",message:"Deseja prosseguir com a opera\xE7\xE3o?"})||await $tryLoading(async()=>{var c;const I=(e==="Nota de Entrada"?await $db.hibrido.lista({table:"documentoXML",where:{idDocumento:i}}):await $db.hibrido.lista({table:"documentoFiscalEletronicoXml",where:{idDocumentoFiscalEletronico:i}}))[0],o=(I==null?void 0:I.xmlProt)||(I==null?void 0:I.xmlData),l=(I==null?void 0:I.chNFe)||((c=/<chNFe>(\d+)<\/chNFe>/i.exec(o))==null?void 0:c[1]);$utils.verificarErro(!o,"N\xE3o foi poss\xEDvel recuperar o XML");const n=document.createElement("a"),a=new Blob([o],{type:"text/plain"});n.setAttribute("href",window.URL.createObjectURL(a)),n.setAttribute("download",`${l||i}-procNFe.xml`),n.click()})},async importarXmlDFe(i){!await $q.dialogSimNao({title:"Importar XML",message:"Deseja prosseguir com a opera\xE7\xE3o?"})||await $tryLoading(async()=>{const e=await $db.hibrido.le({table:"documentoFiscalEletronico",id:i}),m=(await $db.hibrido.lista({table:"documentoFiscalEletronicoXml",where:{idDocumentoFiscalEletronico:i}}))[0];if((e==null?void 0:e.id)&&(m==null?void 0:m.xmlProt)){const I=(await $db.hibrido.lista({table:"documento",whereFilter:{chaveAcesso:m==null?void 0:m.chNFe}}))[0];$utils.verificarErro(I==null?void 0:I.id,"Esse xml j\xE1 foi importado!");const o=await $db.compra.importaXml({xmlString:m.xmlProt});o.documentoFiscalEletronico={id:i,situacao:"Importada"},o.documentosItem.find(({vinculado:l})=>!l)?this.$refs.comprasImportacaoXML.mostrar(o):await this.concluirImportacao(o)}},{mensagem:"Importando..."})},async destinatarioOpcoesCarregar(){const i=(await $db.contato.ler({filtros:{ativo:!0,empresas:!0}})).data;this.destinatarioOpcoes=i.map(e=>({label:e.nome,value:e.id,numeroDocumentoNacional:e.numeroDocumentoNacional}))},async configuraImpressao(i){const e=await $db.configuracoes.porNome("impressao.compra",i);this.configImpressao=[...e.length?e.map(m=>({valor:m.valor,texto:m.texto,observacao:m.observacao})):[{valor:"invoice",texto:"Pedido de Compra",observacao:"Invoice"}]]},imprimirPedidoCompra(i,e){i==="pedidoCompra"&&this.abrirImpressao(`
            https://rel.storage.b15.com.br/Relatorios/OptiSoul/pedidoCompra.html
            ?CodigoDocumento=${e}
            &hfCodigoSistema=${encodeURIComponent(JSON.stringify({data:{CodigoUsuario:this.usuario.codigoUsuario,CodigoSistema:this.clienteSistema.codigoSistema,CodigoClienteSistema:this.clienteSistema.codigoClienteSistema,Sistema:this.clienteSistema.sistema,URLServidor:this.clienteSistema.urlServidor,BancoDeDados:this.clienteSistema.bancoDeDados,CodigoCliente:this.clienteSistema.codigoCliente,Cliente:this.clienteSistema.cliente,Administrador:this.clienteSistema.administrador,GrupoInterno:this.clienteSistema.grupoInterno}}))}
          `),i==="ped_compra"&&this.abrirImpressao(`
            https://rel.storage.b15.com.br/Relatorios/distribuidor/email.html
            ?CodigoDocumento=${e}
            &URLServidor=${encodeURIComponent(this.clienteSistema.urlServidor)}
            &Banco=${encodeURIComponent(this.clienteSistema.bancoDeDados)}
            &NomeReport=ped_compra
            &CodigoUsuario=${this.usuario.codigoUsuario}
            &hfCodigoSistema=${encodeURIComponent(JSON.stringify({data:{CodigoUsuario:this.usuario.codigoUsuario,CodigoSistema:this.clienteSistema.codigoSistema,CodigoClienteSistema:this.clienteSistema.codigoClienteSistema,Sistema:this.clienteSistema.sistema,Versao:this.clienteSistema.versao,URLServidor:this.clienteSistema.urlServidor,BancoDeDados:this.clienteSistema.bancoDeDados,CodigoCliente:this.clienteSistema.codigoCliente,Cliente:this.clienteSistema.cliente,Padrao:this.clienteSistema.padrao?this.clienteSistema.padrao:null,Administrador:this.clienteSistema.administrador,GrupoInterno:this.clienteSistema.grupoInterno}}))}
          `)},async configuraEtiqueta(){const i=await $db.configuracoes.le({nome:"impressao.etiqueta"}),e=await $db.configuracoes.le({prefixoNome:"impressao.optisoul.etiqueta."});this.opcoesModelo=[],i.length?i.forEach(m=>{this.opcoesModelo.push({rotulo:m.texto,valor:m.observacao&&m.observacao.trim()!==""?m.observacao:m.valor,modelo:m.valor})}):this.opcoesModelo.push({rotulo:"Etiqueta Carta (EBF-23)",valor:"etiqueta-carta-ebf23",modelo:"imprimir-etiquetas"},{rotulo:"Etiqueta Fila \xD3culos/Joias",valor:"etiqueta-fila-joias",modelo:"imprimir-etiquetas"},{rotulo:"Etiqueta Fila 3 Colunas",valor:"etiqueta-fila-3colunas",modelo:"imprimir-etiquetas"},{rotulo:"Etiqueta Pimaco (A4 96)",valor:"etiqueta-pimaco-a496",modelo:"imprimir-etiquetas"}),e.length&&e.forEach(m=>{this.opcoesModelo.push({rotulo:m.texto,valor:m.valor.replace("OptiSoul/","")})}),this.modeloSelecionado=this.opcoesModelo[0].valor},async configuraEmpresas(){const i=(await $db.contato.ler({filtros:{ativo:!0,empresas:!0}})).data;this.opcoesEmpresas=i.map(e=>({rotulo:e.apelido||e.nome,valor:e.id,codigoEmpresa:e.codigoContato})),this.empresaSelecionada=""},async configuraTabelasPreco(){this.tabelasPreco=await $db.itemTabelaPreco.le({ativo:!0,tabelaMaster:!0})||[],this.opcoesTabelasPreco=this.tabelasPreco.map(i=>({rotulo:i.descricao,valor:i.id,codigoItemTabelaPreco:i.codigoItemTabelaPreco})),this.tabelaPrecoSelecionada=""},async dialogImprimirEtiquetas({acao:i,item:e}){try{await this.configuraEtiqueta(),await this.configuraEmpresas(),await this.configuraTabelasPreco(),this.dialogEtiquetas={[i]:!0,item:e||{},limpar:!1}}catch(m){console.error("Erro ao configurar impress\xE3o de etiquetas",m)}},imprimirEtiquetas(i){var e,m,I,o,l;if(i==="etiqueta_generica_ajustavel"||i==="etiqueta-fila"||i==="etiqueta-carta"||i==="EtiquetaPimaco6Col"){const n=i==="etiqueta_generica_ajustavel"?"":"OptiSoul/";this.abrirImpressao(`
            https://rel.storage.b15.com.br/Relatorios/${n}${i}.html
            ?Banco=${encodeURIComponent(this.clienteSistema.bancoDeDados)}
            &URLServidor=${encodeURIComponent(this.clienteSistema.urlServidor)}
            &CodigoUsuario=${this.usuario.codigoUsuario}
            &EmBranco=${this.emBranco}
            &CodigoPedido=${(m=(e=this.dialogEtiquetas)==null?void 0:e.item)==null?void 0:m.codigoDocumento}
            &TabelaPreco=${this.tabelaPrecoSelecionada?encodeURIComponent(this.opcoesTabelasPreco.find(a=>a.valor===this.tabelaPrecoSelecionada).codigoItemTabelaPreco):""}
            &CodigoContatoEmpresa=${this.empresaSelecionada?encodeURIComponent(this.opcoesEmpresas.find(a=>a.valor===this.empresaSelecionada).codigoEmpresa):""}
            &cpfUsuarioLogado=${encodeURIComponent(this.usuario.cpf)}
            &hfCodigoSistema=${encodeURIComponent(JSON.stringify({data:{CodigoUsuario:this.usuario.codigoUsuario,CodigoSistema:this.clienteSistema.codigoSistema,CodigoClienteSistema:this.clienteSistema.codigoClienteSistema,Sistema:this.clienteSistema.sistema,URLServidor:this.clienteSistema.urlServidor,BancoDeDados:this.clienteSistema.bancoDeDados,CodigoCliente:this.clienteSistema.codigoCliente,Cliente:this.clienteSistema.cliente,Administrador:this.clienteSistema.administrador,GrupoInterno:this.clienteSistema.grupoInterno}}))}
          `)}else{const n=(I=this.opcoesModelo)==null?void 0:I.find(g=>g.valor===i),a=(n==null?void 0:n.modelo)||"",c=(n==null?void 0:n.valor)||"";$imprimir(a,{id:(l=(o=this.dialogEtiquetas)==null?void 0:o.item)==null?void 0:l.id,impressao:"etiquetas"},{modelo:c,idEmpresa:this.empresaSelecionada,idTabelaPreco:this.tabelaPrecoSelecionada,emBranco:this.emBranco})}},abrirImpressao(i){window.open(i.replace(/[\s\n]/g,""),"_blank").focus()},async adicionarEtiquetas(){var i;try{$q.loading.show();const e=this.dialogEtiquetas;let m=await $db.etiqueta.ler({cpfUsuarioLogado:this.usuario.numeroDocumentoNacional})||[];if(e!=null&&e.limpar){for(const n of m)await $db.etiqueta.remover(n.id);m=[]}const I=await $db.hibrido.lista({table:"documentoItem",where:{idDocumento:(i=e==null?void 0:e.item)==null?void 0:i.id}});if(!I.length){$q.notifyError("N\xE3o foi poss\xEDvel encontrar itens para carregar a impress\xE3o etiquetas");return}const o=I.map(n=>n.idItem),l=await $db.hibrido.lista({table:"item",columns:["id","codigoItem","descricaoConcatenada","valorVenda"],whereIn:{id:o}});if(!l.length){$q.notifyError("N\xE3o foi poss\xEDvel encontrar itens para carregar a impress\xE3o etiquetas");return}for(const n of l){if(m.length){const c=m.find(g=>g.idItem===n.id)||null;c&&await $db.etiqueta.remover(c==null?void 0:c.id)}const a={id:$utils.uuid(),idItem:n.id,nomeProduto:n.descricaoConcatenada,valor:n.valorVenda||0,quantidadeEtiquetas:I.find(c=>c.idItem===n.id).quantidade||0,cpfUsuarioLogado:this.usuario.numeroDocumentoNacional,dataHoraEmissao:$utils.dataAtual()};await $db.etiqueta.gravar({atual:a})}$q.loading.hide(),this.$q.dialog({title:"",message:"Ir para tela de impress\xE3o de etiquetas?",noRefocus:!0,preventClose:!0,ok:{label:"SIM",push:!0,class:"bg-primary",textColor:"white",flat:!0},cancel:{label:"N\xC3O",push:!0,color:"tertiary",flat:!0}}).onOk(()=>{this.$router.push({name:"EtiquetasLista"})}).onCancel(()=>{this.dialogEtiquetas.adicionar=!1})}catch(e){$q.loading.hide(),$q.notifyError("Erro ao adicionar etiquetas",e)}}},watch:{"tabSelecionada.valor"(){this.tabSelecionada.valor==="Nota na SEFAZ"?this.mostrar.btnMenuMais=!0:this.mostrar.btnMenuMais=!1}},async mounted(){await this.destinatarioOpcoesCarregar(),this.usuario=JSON.parse(localStorage.getItem("usuario")),this.clienteSistema=JSON.parse(localStorage.getItem("clienteSistema"));const i=[{valor:"Pedido de Compra",rotulo:"Pedido de Compra"},{valor:"Nota de Entrada",rotulo:"Nota de Entrada"}];[52,53,62].includes(Number(this.clienteSistema.codigoSistema))&&i.push({valor:"Nota na SEFAZ",rotulo:"Nota na SEFAZ"}),this.tabs=i,this.atualizar({buscarTabsRecentes:!0,buscarDadosRecentes:!0})}},na={id:"ComprasLista"},da={class:"mw80 text-center"},ua={key:0,class:"text-weight-medium"},ca={class:"row q-ma-md"},ma={key:0,class:"row q-ma-md"},fa={class:"certificado-error-messages"},pa={class:"col-12"},ha={class:"col-12"},ga={class:"q-mt-lg text-right"};function va(i,e,m,I,o,l){const n=ge("campo"),a=ge("BadgeCopiarUid"),c=ge("avatar"),g=ge("g-label"),_=ge("badge"),b=ge("g-col"),p=ge("g-row"),u=ge("Lista"),y=ge("ComprasFicha"),h=ge("ComprasImportacaoXML"),w=ge("row");return H(),we("div",na,[t(u,{ref:"comprasLista",busca:o.busca,"onUpdate:busca":e[15]||(e[15]=r=>o.busca=r),onAtualizar:l.atualizar,onLimparFiltrosClick:l.limparFiltrosClick,onCriarClick:l.criarClick,lista:o.lista,tabSelecionada:o.tabSelecionada,tabs:o.tabs,tabSelecionada2:o.tabSelecionada2,tabs2:o.tabs2,paginacao:o.paginacao,mostrar:o.mostrar},{menuExtras:s(()=>[ve((H(),J(he,{onClick:l.downloadXmlDFeFiltrados,clickable:""},{default:s(()=>[t(Y,{avatar:""},{default:s(()=>[t(me,{name:"download"})]),_:1}),t(Y,null,{default:s(()=>[t(de,null,{default:s(()=>e[31]||(e[31]=[N("Download")])),_:1}),t(de,{caption:""},{default:s(()=>e[32]||(e[32]=[N("XML's filtrados")])),_:1})]),_:1})]),_:1},8,["onClick"])),[[Ee]])]),botaoNovo:s(()=>[t(ce,{label:"Novo",icon:"add",unelevated:"",color:"primary","text-color":"white",class:"hideonmobile"},{default:s(()=>[t(Le,null,{default:s(()=>[t(Te,{link:"","no-border":"",separator:""},{default:s(()=>[ve((H(),J(he,{onClick:l.criarClick,clickable:""},{default:s(()=>[t(Y,{avatar:""},{default:s(()=>[t(me,{name:"add"})]),_:1}),t(Y,null,{default:s(()=>e[33]||(e[33]=[N("Incluir Manual")])),_:1})]),_:1},8,["onClick"])),[[Ee]]),ve((H(),J(he,{onClick:l.importarXmlClick,clickable:""},{default:s(()=>[t(Y,{avatar:""},{default:s(()=>[t(me,{name:"add"})]),_:1}),t(Y,null,{default:s(()=>e[34]||(e[34]=[N("Importar XML")])),_:1})]),_:1},8,["onClick"])),[[Ee]])]),_:1})]),_:1})]),_:1}),t(ce,{icon:"add",flat:"",round:"",color:"primary","text-color":"white",class:"hideondesktop"},{default:s(()=>[t(Le,null,{default:s(()=>[t(Te,{link:"","no-border":"",separator:""},{default:s(()=>[ve((H(),J(he,{onClick:l.criarClick,clickable:""},{default:s(()=>[t(Y,{avatar:""},{default:s(()=>[t(me,{name:"add"})]),_:1}),t(Y,null,{default:s(()=>e[35]||(e[35]=[N("Incluir Manual")])),_:1})]),_:1},8,["onClick"])),[[Ee]]),ve((H(),J(he,{onClick:l.importarXmlClick,clickable:""},{default:s(()=>[t(Y,{avatar:""},{default:s(()=>[t(me,{name:"add"})]),_:1}),t(Y,null,{default:s(()=>e[36]||(e[36]=[N("Importar XML")])),_:1})]),_:1},8,["onClick"])),[[Ee]])]),_:1})]),_:1})]),_:1})]),filtroCampos:s(()=>[t(n,{modelValue:o.filtros.numero,"onUpdate:modelValue":e[0]||(e[0]=r=>o.filtros.numero=r),dense:"",rotulo:"N\xBA Nota",class:"q-mt-md"},null,8,["modelValue"]),t(n,{modelValue:o.filtros.numeroCompra,"onUpdate:modelValue":e[1]||(e[1]=r=>o.filtros.numeroCompra=r),dense:"",rotulo:"Ordem de compra",class:"q-mt-lg"},null,8,["modelValue"]),t(zt,{modelValue:o.destinatarioSelecionado,"onUpdate:modelValue":[e[2]||(e[2]=r=>o.destinatarioSelecionado=r),l.aoSelecionarDestinatario],options:o.destinatarioOpcoes,clearable:"",dense:"",label:"Destinat\xE1rio",class:"q-mt-lg"},null,8,["modelValue","onUpdate:modelValue","options"]),t(n,{modelValue:o.filtros.fornecedor.nome,"onUpdate:modelValue":e[3]||(e[3]=r=>o.filtros.fornecedor.nome=r),dense:"",rotulo:"Fornecedor",class:"q-mt-lg"},null,8,["modelValue"]),this.tabSelecionada.valor==="Nota na SEFAZ"?(H(),we(De,{key:0},[t(n,{modelValue:o.filtros.periodoEmissao.ini,"onUpdate:modelValue":e[4]||(e[4]=r=>o.filtros.periodoEmissao.ini=r),dense:"",rotulo:"Data Emiss\xE3o",tipo:"data",class:"q-mt-xl"},null,8,["modelValue"]),t(n,{modelValue:o.filtros.periodoEmissao.fim,"onUpdate:modelValue":e[5]||(e[5]=r=>o.filtros.periodoEmissao.fim=r),dense:"",tipo:"data",rotulo:"at\xE9",class:"q-mt-sm"},null,8,["modelValue"]),t(n,{modelValue:o.filtros.ordenacaoSefaz,"onUpdate:modelValue":e[6]||(e[6]=r=>o.filtros.ordenacaoSefaz=r),options:o.ordenacaoSefaz,dense:"",rotuloFixo:"Ordenar por",tipo:"seletor",class:"q-mt-xl"},null,8,["modelValue","options"]),t(n,{modelValue:o.filtros.direcaoSefaz,"onUpdate:modelValue":e[7]||(e[7]=r=>o.filtros.direcaoSefaz=r),options:o.direcaoOpcoes,dense:"",rotuloFixo:"Dire\xE7\xE3o",tipo:"seletor",class:"q-mt-sm"},null,8,["modelValue","options"])],64)):(H(),we(De,{key:1},[t(n,{modelValue:o.filtros.periodoEmissao.ini,"onUpdate:modelValue":e[8]||(e[8]=r=>o.filtros.periodoEmissao.ini=r),dense:"",tipo:"data",rotulo:"Data Emiss\xE3o",class:"q-mt-xl"},null,8,["modelValue"]),t(n,{modelValue:o.filtros.periodoEmissao.fim,"onUpdate:modelValue":e[9]||(e[9]=r=>o.filtros.periodoEmissao.fim=r),dense:"",rotulo:"at\xE9",tipo:"data",class:"q-mt-sm"},null,8,["modelValue"]),t(n,{modelValue:o.filtros.periodoFinalizado.ini,"onUpdate:modelValue":e[10]||(e[10]=r=>o.filtros.periodoFinalizado.ini=r),dense:"",tipo:"data",rotulo:"Data Finalizado",class:"q-mt-xl"},null,8,["modelValue"]),t(n,{modelValue:o.filtros.periodoFinalizado.fim,"onUpdate:modelValue":e[11]||(e[11]=r=>o.filtros.periodoFinalizado.fim=r),dense:"",tipo:"data",rotulo:"at\xE9",class:"q-mt-sm"},null,8,["modelValue"]),t(n,{modelValue:o.filtros.ordenacao,"onUpdate:modelValue":e[12]||(e[12]=r=>o.filtros.ordenacao=r),options:o.ordenacaoOpcoes,dense:"",rotuloFixo:"Ordenar por",tipo:"seletor",class:"q-mt-xl"},null,8,["modelValue","options"]),t(n,{modelValue:o.filtros.direcao,"onUpdate:modelValue":e[13]||(e[13]=r=>o.filtros.direcao=r),options:o.direcaoOpcoes,dense:"",rotuloFixo:"Dire\xE7\xE3o",tipo:"seletor",class:"q-mt-sm"},null,8,["modelValue","options"])],64)),t(n,{modelValue:o.paginacao.limite,"onUpdate:modelValue":e[14]||(e[14]=r=>o.paginacao.limite=r),dense:"",min:"1",tipo:"quantidade",rotulo:"Quantidade por p\xE1gina",class:"q-mt-xl q-mb-lg"},null,8,["modelValue"])]),itemLista:s(()=>[t(Te,{bordered:"",class:"bg-white q-mb-xs rounded-borders",style:{"min-height":"calc(100vh - 200px)"}},{default:s(()=>[(H(!0),we(De,null,qe(o.lista,r=>(H(),we("div",{key:r.id,class:"itemHover"},[t(he,{"manual-focus":"",class:"q-py-sm q-px-xs items-center"},{default:s(()=>[t(Y,{class:"hideonmobile col-auto q-px-sm no-margin"},{default:s(()=>[Ie("div",da,[t(a,{id:r.id,numero:r.numero,cor:"positive",escuro:""},null,8,["id","numero"])])]),_:2},1024),t(Y,{class:"col-md col-lg col-xl no-margin"},{default:s(()=>[t(he,{class:"q-pa-none"},{default:s(()=>[t(Y,{onClick:v=>l.abrir(r.id),class:"col-auto items-center cursor-pointer"},{default:s(()=>[t(c,{imagem:(o.contatos[r.idContato]||{}).imagem,rotulo:r.descricaoContato,tamanho:"40"},null,8,["imagem","rotulo"])]),_:2},1032,["onClick"]),t(Y,{class:"col"},{default:s(()=>[t(de,{onClick:v=>l.abrir(r.id),lines:"2",class:"text-weight-bold cursor-pointer"},{default:s(()=>[N(te(r.descricaoContato)+" ",1),t(Ve,{anchor:"bottom middle",self:"center middle"},{default:s(()=>e[37]||(e[37]=[N("Fornecedor")])),_:1})]),_:2},1032,["onClick"]),r.descricaoEmpresa?(H(),J(de,{key:0,onClick:v=>l.abrir(r.id),caption:"",class:"cursor-pointer"},{default:s(()=>[r.descricaoEmpresa?(H(),J(g,{key:0,icon:"business 14px tertiary left"},{default:s(()=>[N(te(r.descricaoEmpresa)+" ",1),r.numeroDocumentoEmpresa?(H(),we("span",ua,"("+te(r.numeroDocumentoEmpresa)+")",1)):re("",!0)]),_:2},1024)):re("",!0)]),_:2},1032,["onClick"])):re("",!0),t(he,{class:"q-pa-none hideonmobile q-mt-xs",style:{"min-height":"unset"}},{default:s(()=>[r.notaNumero?(H(),J(_,{key:0,cor:"tertiary",class:"mw50 text-center",escuro:""},{default:s(()=>[N(te(r.notaNumero)+" ",1),t(Ve,{anchor:"bottom middle",self:"center middle"},{default:s(()=>e[38]||(e[38]=[N("N\xFAmero da Nota")])),_:1})]),_:2},1024)):(H(),J(_,{key:1,cor:"warning",class:"mw50 text-center",escuro:""},{default:s(()=>[e[40]||(e[40]=N(" S/N ")),t(Ve,{anchor:"bottom middle",self:"center middle"},{default:s(()=>e[39]||(e[39]=[N("N\xFAmero da Nota")])),_:1})]),_:1}))]),_:2},1024),t(Y,{class:"hideondesktop q-mt-sm"},{default:s(()=>[t(p,{mg:"xs-b"},{default:s(()=>[r.dataHoraEmissao?(H(),J(b,{key:0,col:"shrink"},{default:s(()=>[t(g,{icon:"mdi-calendar-today xs tertiary left",tip:`Emitido \xE0s ${i.$filters.hora(r.dataHoraEmissao)}`},{default:s(()=>[N(te(i.$filters.data(r.dataHoraEmissao)),1)]),_:2},1032,["tip"])]),_:2},1024)):re("",!0),r.dataHoraFinalizado?(H(),J(b,{key:1,col:"shrink",class:"q-ml-sm"},{default:s(()=>[t(g,{icon:"mdi-calendar xs tertiary left",tip:`Finalizado \xE1s ${i.$filters.hora(r.dataHoraFinalizado)}`},{default:s(()=>[N(te(i.$filters.data(r.dataHoraFinalizado)),1)]),_:2},1032,["tip"])]),_:2},1024)):re("",!0)]),_:2},1024),t(p,{mg:"xs-b"},{default:s(()=>[t(b,{col:"shrink"},{default:s(()=>[t(a,{id:r.id,numero:r.numero,cor:"positive",escuro:""},null,8,["id","numero"])]),_:2},1024),t(b,{col:"shrink",class:"q-ml-sm"},{default:s(()=>[r.notaNumero?(H(),J(_,{key:0,cor:"tertiary",class:"mw50",escuro:""},{default:s(()=>[N(te(r.notaNumero)+" ",1),t(Ve,{anchor:"bottom middle",self:"center middle"},{default:s(()=>e[41]||(e[41]=[N("N\xFAmero da Nota")])),_:1})]),_:2},1024)):(H(),J(_,{key:1,cor:"warning",class:"mw50",escuro:""},{default:s(()=>[e[43]||(e[43]=N(" S/N ")),t(Ve,{anchor:"bottom middle",self:"center middle"},{default:s(()=>e[42]||(e[42]=[N("N\xFAmero da Nota")])),_:1})]),_:1}))]),_:2},1024),t(b,{col:"shrink",class:"q-ml-sm"},{default:s(()=>[t(_,{rotulo:r.status,cor:r.status!=="Digita\xE7\xE3o"?"tertiary":"light",escuro:r.status!=="Digita\xE7\xE3o"},null,8,["rotulo","cor","escuro"])]),_:2},1024)]),_:2},1024),t(p,null,{default:s(()=>[t(b,{col:"shrink",text:"bold"},{default:s(()=>[N(te(i.$filters.numero(r.totalDocumento,2)),1)]),_:2},1024),ve(t(b,{col:"grow",text:"center",class:"q-ml-sm"},{default:s(()=>[N(te(r.qtdeContatos)+" Itens ",1)]),_:2},1536),[[ze,r.qtdeContatos>0]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),t(Y,{onClick:v=>l.abrir(r.id),class:"hideonmobile maxw110 q-pl-sm no-margin cursor-pointer"},{default:s(()=>[this.tabSelecionada.valor==="Nota na SEFAZ"?(H(),we(De,{key:0},[r.dhRecbto?(H(),J(de,{key:0,color:"tertiary",class:"ellipsis"},{default:s(()=>[t(me,{name:"mdi-calendar-today"}),N(" "+te(i.$filters.data(r.dhRecbto))+" ",1),t(Ve,{anchor:"bottom middle",self:"center middle"},{default:s(()=>[N(" Autorizado \xE0s "+te(i.$filters.hora(r.dhRecbto)),1)]),_:2},1024)]),_:2},1024)):re("",!0)],64)):(H(),we(De,{key:1},[r.dataHoraEmissao?(H(),J(de,{key:0,color:"tertiary",class:"ellipsis"},{default:s(()=>[t(me,{name:"mdi-calendar-today"}),N(" "+te(i.$filters.data(r.dataHoraEmissao))+" ",1),t(Ve,{anchor:"bottom middle",self:"center middle"},{default:s(()=>[N(" Emitido \xE0s "+te(i.$filters.hora(r.dataHoraEmissao)),1)]),_:2},1024)]),_:2},1024)):re("",!0),r.dataHoraFinalizado?(H(),J(de,{key:1,color:"tertiary",class:"ellipsis"},{default:s(()=>[t(me,{name:"mdi-calendar"}),N(" "+te(i.$filters.data(r.dataHoraFinalizado))+" ",1),t(Ve,{anchor:"bottom middle",self:"center middle"},{default:s(()=>[N(" Finalizado \xE1s "+te(i.$filters.hora(r.dataHoraFinalizado)),1)]),_:2},1024)]),_:2},1024)):re("",!0)],64))]),_:2},1032,["onClick"]),t(Y,{onClick:v=>l.abrir(r.id),class:"hideonmobile maxw100 q-pl-sm no-margin cursor-pointer"},{default:s(()=>[t(_,{cor:r.status!=="Digita\xE7\xE3o"?"tertiary":"light",escuro:r.status!=="Digita\xE7\xE3o",class:"col-auto q-mx-auto"},{default:s(()=>[N(te(r.status)+" ",1),t(Ve,{anchor:"bottom middle",self:"center middle"},{default:s(()=>e[44]||(e[44]=[N(" Status ")])),_:1})]),_:2},1032,["cor","escuro"])]),_:2},1032,["onClick"]),t(Y,{onClick:v=>l.abrir(r.id),class:"hideonmobile maxw120 q-pl-sm no-margin cursor-pointer"},{default:s(()=>[t(de,{class:"text-tertiary text-weight-bold text-right"},{default:s(()=>[N(te(i.$filters.numero(r.totalDocumento,2)),1)]),_:2},1024),ve(t(de,{class:"text-tertiary text-right"},{default:s(()=>[N(te(r.qtdeContatos)+" Itens ",1)]),_:2},1536),[[ze,r.qtdeContatos>0]])]),_:2},1032,["onClick"]),t(Y,{class:"hideonmobile col-auto q-pl-sm no-margin"},{default:s(()=>[t(he,{class:"q-pa-none"},{default:s(()=>[o.tabSelecionada.valor!=="Nota na SEFAZ"?(H(),J(Y,{key:0,class:"no-margin"},{default:s(()=>[t(ce,{onClick:v=>l.abrir(r.id),icon:"edit",size:"md",color:"primary",round:"",flat:"",dense:""},null,8,["onClick"])]),_:2},1024)):re("",!0),o.tabSelecionada.valor==="Nota na SEFAZ"?(H(),J(Y,{key:1,class:"no-margin",style:{width:"33.6px"}},{default:s(()=>[r.status==="N\xE3o Importada"?(H(),J(ce,{key:0,onClick:v=>l.importarXmlDFe(r.id),flat:"",round:"",dense:"",icon:"mdi-upload",size:"md",color:"tertiary",class:"buttons"},{default:s(()=>[t(Ve,{anchor:"bottom middle",self:"center middle"},{default:s(()=>e[45]||(e[45]=[N("Importar XML")])),_:1})]),_:2},1032,["onClick"])):re("",!0)]),_:2},1024)):re("",!0),["Nota na SEFAZ","Nota de Entrada"].includes(o.tabSelecionada.valor)?(H(),J(Y,{key:2,class:"no-margin",style:{width:"33.6px"}},{default:s(()=>[t(ce,{onClick:v=>l.downloadXmlDFe(r.id,o.tabSelecionada.valor),flat:"",round:"",dense:"",icon:"mdi-download",color:"tertiary",size:"md",class:"buttons"},{default:s(()=>[t(Ve,{anchor:"bottom middle",self:"center middle"},{default:s(()=>e[46]||(e[46]=[N("Download XML")])),_:1})]),_:2},1032,["onClick"])]),_:2},1024)):re("",!0),o.tabSelecionada.valor!=="Nota na SEFAZ"?(H(),J(Y,{key:3,class:"no-margin"},{default:s(()=>[t(ce,{icon:"print",size:"md",color:"tertiary",round:"",flat:"",dense:""},{default:s(()=>[t(Le,null,{default:s(()=>[ve((H(),J(Te,{link:"","no-border":"",separator:""},{default:s(()=>[(H(!0),we(De,null,qe(o.configImpressao,v=>(H(),J(he,{key:v.valor,onClick:S=>i.$imprimir(v.valor,r.id),clickable:""},{default:s(()=>[t(Y,{avatar:""},{default:s(()=>[t(me,{name:"print"})]),_:1}),t(Y,null,{default:s(()=>[t(de,null,{default:s(()=>[N(te(v.texto),1)]),_:2},1024),v.observacao?(H(),J(de,{key:0,caption:""},{default:s(()=>[N(te(v.observacao),1)]),_:2},1024)):re("",!0)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),(H(!0),we(De,null,qe(o.configImpressaoPedidoCompra,v=>(H(),J(he,{key:v.valor,onClick:S=>l.imprimirPedidoCompra(v.valor,r==null?void 0:r.codigoDocumento),clickable:""},{default:s(()=>[t(Y,{avatar:""},{default:s(()=>[t(me,{name:"print"})]),_:1}),t(Y,null,{default:s(()=>[t(de,null,{default:s(()=>[N(te(v.texto),1)]),_:2},1024),v.observacao?(H(),J(de,{key:0,caption:""},{default:s(()=>[N(te(v.observacao),1)]),_:2},1024)):re("",!0)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),t(he,{onClick:v=>l.dialogImprimirEtiquetas({acao:"adicionar",item:r}),clickable:""},{default:s(()=>[t(Y,{avatar:""},{default:s(()=>[t(me,{name:"print"})]),_:1}),t(Y,null,{default:s(()=>[t(de,null,{default:s(()=>e[47]||(e[47]=[N(" Etiquetas ")])),_:1}),t(de,{caption:""},{default:s(()=>e[48]||(e[48]=[N(" Adicionar \xE1 Fila ")])),_:1})]),_:1})]),_:2},1032,["onClick"]),t(he,{onClick:v=>l.dialogImprimirEtiquetas({acao:"impressao",item:r}),clickable:""},{default:s(()=>[t(Y,{avatar:""},{default:s(()=>[t(me,{name:"print"})]),_:1}),t(Y,null,{default:s(()=>[t(de,null,{default:s(()=>e[49]||(e[49]=[N(" Etiquetas ")])),_:1}),t(de,{caption:""},{default:s(()=>e[50]||(e[50]=[N(" Impress\xE3o Direta ")])),_:1})]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)),[[Ee]])]),_:2},1024)]),_:2},1024)]),_:2},1024)):re("",!0),o.tabSelecionada.valor!=="Nota na SEFAZ"?(H(),J(Y,{key:4,class:"no-margin"},{default:s(()=>[t(ce,{icon:"more_vert",size:"md",color:"tertiary",round:"",flat:"",dense:""},{default:s(()=>[t(Le,null,{default:s(()=>[ve((H(),J(Te,{link:"","no-border":"",separator:""},{default:s(()=>[o.tabSelecionada.valor!=="Nota na SEFAZ"?(H(),J(he,{key:0,onClick:v=>l.duplicarDocumento_click(r),clickable:""},{default:s(()=>[t(Y,{avatar:""},{default:s(()=>[t(me,{name:"content_copy"})]),_:1}),t(Y,null,{default:s(()=>[t(de,null,{default:s(()=>e[51]||(e[51]=[N(" Duplicar ")])),_:1})]),_:1})]),_:2},1032,["onClick"])):re("",!0),o.tabSelecionada.valor!=="Nota na SEFAZ"?(H(),J(he,{key:1,onClick:v=>l.alterarPrevisaoEntrega_click(r),clickable:""},{default:s(()=>[t(Y,{avatar:""},{default:s(()=>[t(me,{name:"local_shipping"})]),_:1}),t(Y,null,{default:s(()=>[t(de,null,{default:s(()=>e[52]||(e[52]=[N("Alterar Previs\xE3o de Entrega")])),_:1})]),_:1})]),_:2},1032,["onClick"])):re("",!0),o.tabSelecionada.valor!=="Nota na SEFAZ"?(H(),J(he,{key:2,onClick:v=>l.trocarCfop_click(r),clickable:""},{default:s(()=>[t(Y,{avatar:""},{default:s(()=>[t(me,{name:"sync_alt"})]),_:1}),t(Y,null,{default:s(()=>[t(de,null,{default:s(()=>e[53]||(e[53]=[N("Trocar CFOP para consumo")])),_:1})]),_:1})]),_:2},1032,["onClick"])):re("",!0),re("",!0)]),_:2},1024)),[[Ee]])]),_:2},1024)]),_:2},1024)]),_:2},1024)):re("",!0)]),_:2},1024)]),_:2},1024),t(Y,{class:"hideondesktop col-auto q-pl-sm no-margin"},{default:s(()=>[t(ce,{icon:"more_vert",size:"md",color:"tertiary",round:"",flat:"",dense:""},{default:s(()=>[t(Le,null,{default:s(()=>[ve((H(),J(Te,{link:"","no-border":"",separator:""},{default:s(()=>[re("",!0),o.tabSelecionada.valor!=="Nota na SEFAZ"?(H(),J(he,{key:1,onClick:v=>l.abrir(r.id),clickable:"",class:"itemHover"},{default:s(()=>[t(Y,{avatar:""},{default:s(()=>[t(me,{name:"edit"})]),_:1}),t(Y,null,{default:s(()=>[t(de,null,{default:s(()=>e[58]||(e[58]=[N(" Editar ")])),_:1})]),_:1})]),_:2},1032,["onClick"])):re("",!0),o.tabSelecionada.valor==="Nota na SEFAZ"&&r.status==="N\xE3o Importada"?(H(),J(he,{key:2,onClick:v=>l.importarXmlDFe(r.id),clickable:"",class:"itemHover"},{default:s(()=>[t(Y,{avatar:""},{default:s(()=>[t(me,{name:"mdi-upload"})]),_:1}),t(Y,null,{default:s(()=>[t(de,null,{default:s(()=>e[59]||(e[59]=[N(" Importar XML ")])),_:1})]),_:1})]),_:2},1032,["onClick"])):re("",!0),["Nota na SEFAZ","Nota de Entrada"].includes(o.tabSelecionada.valor)?(H(),J(he,{key:3,onClick:v=>l.downloadXmlDFe(r.id,o.tabSelecionada.valor),clickable:"",class:"itemHover"},{default:s(()=>[t(Y,{avatar:""},{default:s(()=>[t(me,{name:"mdi-download"})]),_:1}),t(Y,null,{default:s(()=>[t(de,null,{default:s(()=>e[60]||(e[60]=[N(" Download XML ")])),_:1})]),_:1})]),_:2},1032,["onClick"])):re("",!0),o.tabSelecionada.valor!=="Nota na SEFAZ"?(H(!0),we(De,{key:4},qe(o.configImpressao,v=>(H(),J(he,{key:v.valor,onClick:S=>i.$imprimir(v.valor,r.id),clickable:""},{default:s(()=>[t(Y,{avatar:""},{default:s(()=>[t(me,{name:"print"})]),_:1}),t(Y,null,{default:s(()=>[t(de,null,{default:s(()=>[N(te(v.texto),1)]),_:2},1024),v.observacao?(H(),J(de,{key:0,caption:""},{default:s(()=>[N(te(v.observacao),1)]),_:2},1024)):re("",!0)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):re("",!0),o.tabSelecionada.valor!=="Nota na SEFAZ"?(H(!0),we(De,{key:5},qe(o.configImpressaoPedidoCompra,v=>(H(),J(he,{clickable:"",key:v.valor,onClick:S=>l.imprimirPedidoCompra(v.valor,r==null?void 0:r.codigoDocumento)},{default:s(()=>[t(Y,{avatar:""},{default:s(()=>[t(me,{name:"print"})]),_:1}),t(Y,null,{default:s(()=>[t(de,null,{default:s(()=>[N(te(v.texto),1)]),_:2},1024),v.observacao?(H(),J(de,{key:0,caption:""},{default:s(()=>[N(te(v.observacao),1)]),_:2},1024)):re("",!0)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):re("",!0),o.tabSelecionada.valor!=="Nota na SEFAZ"?(H(),J(he,{key:6,clickable:"",onClick:v=>l.dialogImprimirEtiquetas({acao:"adicionar",item:r})},{default:s(()=>[t(Y,{avatar:""},{default:s(()=>[t(me,{name:"print"})]),_:1}),t(Y,null,{default:s(()=>[t(de,null,{default:s(()=>e[61]||(e[61]=[N(" Etiquetas ")])),_:1}),t(de,{caption:""},{default:s(()=>e[62]||(e[62]=[N(" Adicionar \xE1 Fila ")])),_:1})]),_:1})]),_:2},1032,["onClick"])):re("",!0),o.tabSelecionada.valor!=="Nota na SEFAZ"?(H(),J(he,{key:7,clickable:"",onClick:v=>l.dialogImprimirEtiquetas({acao:"impressao",item:r})},{default:s(()=>[t(Y,{avatar:""},{default:s(()=>[t(me,{name:"print"})]),_:1}),t(Y,null,{default:s(()=>[t(de,null,{default:s(()=>e[63]||(e[63]=[N(" Etiquetas ")])),_:1}),t(de,{caption:""},{default:s(()=>e[64]||(e[64]=[N(" Impress\xE3o Direta ")])),_:1})]),_:1})]),_:2},1032,["onClick"])):re("",!0),o.tabSelecionada.valor!=="Nota na SEFAZ"?(H(),J(he,{key:8,onClick:v=>l.duplicarDocumento_click(r),clickable:"",class:"itemHover"},{default:s(()=>[t(Y,{avatar:""},{default:s(()=>[t(me,{name:"content_copy"})]),_:1}),t(Y,null,{default:s(()=>[t(de,null,{default:s(()=>e[65]||(e[65]=[N(" Duplicar ")])),_:1})]),_:1})]),_:2},1032,["onClick"])):re("",!0),o.tabSelecionada.valor!=="Nota na SEFAZ"?(H(),J(he,{key:9,onClick:v=>l.alterarPrevisaoEntrega_click(r),clickable:""},{default:s(()=>[t(Y,{avatar:""},{default:s(()=>[t(me,{name:"local_shipping"})]),_:1}),t(Y,null,{default:s(()=>[t(de,null,{default:s(()=>e[66]||(e[66]=[N("Alterar Previs\xE3o de Entrega")])),_:1})]),_:1})]),_:2},1032,["onClick"])):re("",!0),o.tabSelecionada.valor!=="Nota na SEFAZ"?(H(),J(he,{key:10,onClick:v=>l.trocarCfop_click(r),clickable:""},{default:s(()=>[t(Y,{avatar:""},{default:s(()=>[t(me,{name:"sync_alt"})]),_:1}),t(Y,null,{default:s(()=>[t(de,null,{default:s(()=>e[67]||(e[67]=[N("Trocar CFOP para consumo")])),_:1})]),_:1})]),_:2},1032,["onClick"])):re("",!0)]),_:2},1024)),[[Ee]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),t(ut)]))),128))]),_:1})]),_:1},8,["busca","onAtualizar","onLimparFiltrosClick","onCriarClick","lista","tabSelecionada","tabs","tabSelecionada2","tabs2","paginacao","mostrar"]),t(y,{ref:"comprasFicha",onAtualizar:l.atualizar,onDialogImprimirEtiquetas:l.dialogImprimirEtiquetas},null,8,["onAtualizar","onDialogImprimirEtiquetas"]),t(h,{ref:"comprasImportacaoXML",onAtualizar:l.atualizar,onConcluirImportacao:l.concluirImportacao},null,8,["onAtualizar","onConcluirImportacao"]),t(Re,{modelValue:o.modalXMLNotaEntrada,"onUpdate:modelValue":e[19]||(e[19]=r=>o.modalXMLNotaEntrada=r),persistent:""},{default:s(()=>[t($e,{container:"",class:"bg-light",style:{height:"40vh",width:"50vw","max-width":"100vw"}},{default:s(()=>[Ie("form",{onSubmit:e[18]||(e[18]=Ft((...r)=>l.importarXmlNotaDeEntrada&&l.importarXmlNotaDeEntrada(...r),["prevent"]))},[t(He,null,{default:s(()=>[t(Pe,null,{default:s(()=>[ve(t(ce,{onClick:l.fecharXmlNotaDeEntrada,flat:"",round:"",dense:"",icon:"close"},null,8,["onClick"]),[[Ee]]),t(Me,null,{default:s(()=>e[68]||(e[68]=[N("Importar XML Nota de Entrada")])),_:1}),t(ce,{color:"white","text-color":"primary",label:"Enviar",type:"submit",unelevated:""})]),_:1})]),_:1}),t(Ze,{class:"u-container"},{default:s(()=>[t(Ge,{style:{"min-height":"300px"}},{default:s(()=>{var r,v,S;return[Ie("div",ca,[t(Nt,{class:"col-12","hide-upload-btn":"","auto-upload":"",factory:l.adicionarXml,filter:D=>D.filter(V=>V.type==="text/xml")},null,8,["factory","filter"]),t(vt,{modelValue:o.xmlDevolucao,"onUpdate:modelValue":e[16]||(e[16]=D=>o.xmlDevolucao=D),label:"Devolu\xE7\xE3o"},null,8,["modelValue"]),t(vt,{modelValue:o.xmlEstrangeiro,"onUpdate:modelValue":e[17]||(e[17]=D=>o.xmlEstrangeiro=D),label:"Importa\xE7\xE3o do exterior"},null,8,["modelValue"])]),Object.keys((S=(v=(r=o.xmlNotaEntrada.error)==null?void 0:r.data)==null?void 0:v.fields)!=null?S:{}).length?(H(),we("div",ma,[Ie("ul",fa,[(H(!0),we(De,null,qe(Object.keys(o.xmlNotaEntrada.error.data.fields),D=>(H(),we("li",{key:D},[Ie("span",null,te(D),1),Ie("span",null,te(o.xmlNotaEntrada.error.data.fields[D]),1)]))),128))])])):re("",!0)]}),_:1})]),_:1})],32)]),_:1})]),_:1},8,["modelValue"]),t(Re,{modelValue:o.modalPrevisaoEntrega.visivel,"onUpdate:modelValue":e[22]||(e[22]=r=>o.modalPrevisaoEntrega.visivel=r),"content-css":{minWidth:"50vw"}},{default:s(()=>[t(Tt,null,{default:s(()=>[t(Pe,{class:"bg-primary text-white"},{default:s(()=>[t(Me,null,{default:s(()=>e[69]||(e[69]=[N("Alterar Previs\xE3o de Entrega")])),_:1}),ve(t(ce,{dense:"",flat:"",icon:"close",round:""},null,512),[[Ee]])]),_:1}),t(At,null,{default:s(()=>[t(rt,{onSubmit:l.alterarPrevisaoEntrega},{default:s(()=>[t(w,{class:"q-col-gutter-md"},{default:s(()=>[Ie("div",pa,[t(it,{modelValue:o.modalPrevisaoEntrega.dataPrevistaEntrega,"onUpdate:modelValue":e[20]||(e[20]=r=>o.modalPrevisaoEntrega.dataPrevistaEntrega=r),type:"date",label:"Data Prevista de Entrega",clearable:"",dense:"","stack-label":"",borderless:""},null,8,["modelValue"])]),Ie("div",ha,[t(it,{modelValue:o.modalPrevisaoEntrega.horaPrevistaEntrega,"onUpdate:modelValue":e[21]||(e[21]=r=>o.modalPrevisaoEntrega.horaPrevistaEntrega=r),type:"time",label:"Hora Prevista de Entrega",clearable:"",dense:"","stack-label":"",borderless:""},null,8,["modelValue"])])]),_:1}),Ie("div",ga,[ve(t(ce,{color:"tertiary",flat:"",label:"Cancelar"},null,512),[[Ee]]),t(ce,{color:"primary",class:"q-ml-sm no-shadow",unelevated:"",label:"Alterar",type:"submit"})])]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(Re,{modelValue:o.dialogEtiquetas.impressao,"onUpdate:modelValue":e[28]||(e[28]=r=>o.dialogEtiquetas.impressao=r)},{default:s(()=>[t($e,{container:"",view:"hHh LpR fFf",class:"bg-white rounded-borders",style:{height:"100%","max-height":"425px"}},{default:s(()=>[t(rt,{onSubmit:e[27]||(e[27]=r=>l.imprimirEtiquetas(o.modeloSelecionado)),autocorrect:"off",autocapitalize:"off",autocomplete:"off",spellcheck:"false",novalidate:""},{default:s(()=>[t(He,null,{default:s(()=>[t(Pe,{class:"bg-primary text-white"},{default:s(()=>[t(Me,null,{default:s(()=>[t(me,{name:"mdi-tag-plus",size:"sm",class:"q-mr-sm"}),e[70]||(e[70]=N(" Imprimir Etiquetas "))]),_:1})]),_:1})]),_:1}),t(Ze,null,{default:s(()=>[t(Ge,{class:"q-pa-md"},{default:s(()=>[t(g,{class:"q-pb-lg"},{default:s(()=>{var r,v,S,D,V,B,q,j,A,G,oe,E,O;return[e[71]||(e[71]=N(" Imprimir os itens: ")),Ie("strong",null,te((r=o.tabSelecionada)==null?void 0:r.valor)+" "+te((S=(v=o.dialogEtiquetas)==null?void 0:v.item)!=null&&S.numero?", #"+((V=(D=o.dialogEtiquetas)==null?void 0:D.item)==null?void 0:V.numero):"")+" "+te((q=(B=o.dialogEtiquetas)==null?void 0:B.item)!=null&&q.descricaoContato?" - "+((A=(j=o.dialogEtiquetas)==null?void 0:j.item)==null?void 0:A.descricaoContato):"")+" "+te((oe=(G=o.dialogEtiquetas)==null?void 0:G.item)!=null&&oe.notaNumero?", Nota #"+((O=(E=o.dialogEtiquetas)==null?void 0:E.item)==null?void 0:O.notaNumero):""),1),e[72]||(e[72]=N(". "))]}),_:1}),t(n,{modelValue:o.modeloSelecionado,"onUpdate:modelValue":e[23]||(e[23]=r=>o.modeloSelecionado=r),opcoes:o.opcoesModelo,dense:"",filled:"",tipo:"seletor",rotulo:"Modelo",cor:"white","popup-content-class":"etiquetas-modelo-selecionado",class:"q-field--with-bottom"},null,8,["modelValue","opcoes"]),t(n,{modelValue:o.empresaSelecionada,"onUpdate:modelValue":e[24]||(e[24]=r=>o.empresaSelecionada=r),opcoes:o.opcoesEmpresas,dense:"",filled:"",clearable:"",tipo:"seletor",rotulo:"Empresa",color:"tertiary",class:"q-field--with-bottom"},null,8,["modelValue","opcoes"]),t(n,{modelValue:o.tabelaPrecoSelecionada,"onUpdate:modelValue":e[25]||(e[25]=r=>o.tabelaPrecoSelecionada=r),opcoes:o.opcoesTabelasPreco,dense:"",filled:"",clearable:"",tipo:"seletor",rotulo:"Tabela de Pre\xE7o",color:"tertiary",class:"q-field--with-bottom"},null,8,["modelValue","opcoes"]),t(n,{modelValue:o.emBranco,"onUpdate:modelValue":e[26]||(e[26]=r=>o.emBranco=r),min:0,tipo:"quantidade",dense:"",filled:"",rotulo:"Etiquetas em branco",color:"tertiary","text-color":"red"},null,8,["modelValue"])]),_:1})]),_:1}),t(Xe,{class:"bg-light"},{default:s(()=>[t(Pe,null,{default:s(()=>[t(Qe),ve(t(ce,{label:"Cancelar",color:"tertiary",flat:"",class:"q-mr-sm"},null,512),[[Ee]]),t(ce,{label:"Confirmar",color:"primary",type:"submit",unelevated:""})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(Re,{modelValue:o.dialogEtiquetas.adicionar,"onUpdate:modelValue":e[30]||(e[30]=r=>o.dialogEtiquetas.adicionar=r)},{default:s(()=>[t($e,{container:"",view:"hHh LpR fFf",class:"bg-white rounded-borders",style:{height:"100%","max-height":"250px"}},{default:s(()=>[t(rt,{onSubmit:l.adicionarEtiquetas,autocorrect:"off",autocapitalize:"off",autocomplete:"off",spellcheck:"false",novalidate:""},{default:s(()=>[t(He,null,{default:s(()=>[t(Pe,{class:"bg-primary text-white"},{default:s(()=>[t(Me,null,{default:s(()=>[t(me,{name:"mdi-tag-plus",size:"sm",class:"q-mr-sm"}),e[73]||(e[73]=N(" Adicionar os itens a lista de etiquetas "))]),_:1})]),_:1})]),_:1}),t(Ze,null,{default:s(()=>[t(Ge,{class:"q-pa-md"},{default:s(()=>[t(g,{class:"q-pb-lg"},{default:s(()=>{var r,v,S,D,V,B,q,j,A,G,oe,E,O;return[e[74]||(e[74]=N(" Adicionar os itens: ")),Ie("strong",null,te((r=o.tabSelecionada)==null?void 0:r.valor)+" "+te((S=(v=o.dialogEtiquetas)==null?void 0:v.item)!=null&&S.numero?", #"+((V=(D=o.dialogEtiquetas)==null?void 0:D.item)==null?void 0:V.numero):"")+" "+te((q=(B=o.dialogEtiquetas)==null?void 0:B.item)!=null&&q.descricaoContato?" - "+((A=(j=o.dialogEtiquetas)==null?void 0:j.item)==null?void 0:A.descricaoContato):"")+" "+te((oe=(G=o.dialogEtiquetas)==null?void 0:G.item)!=null&&oe.notaNumero?", Nota #"+((O=(E=o.dialogEtiquetas)==null?void 0:E.item)==null?void 0:O.notaNumero):""),1),e[75]||(e[75]=N(" \xE0 lista de etiquetas para impress\xE3o. "))]}),_:1}),t(n,{modelValue:o.dialogEtiquetas.limpar,"onUpdate:modelValue":e[29]||(e[29]=r=>o.dialogEtiquetas.limpar=r),tipo:"logico",rotulo:"Limpar lista de etiquetas anterior."},null,8,["modelValue"])]),_:1})]),_:1}),t(Xe,{class:"bg-light"},{default:s(()=>[t(Pe,null,{default:s(()=>[t(Qe),ve(t(ce,{label:"Cancelar",color:"tertiary",flat:"",class:"q-mr-sm"},null,512),[[Ee]]),t(ce,{label:"Confirmar",color:"primary",type:"submit",unelevated:""})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])])}var ka=st(la,[["render",va]]);export{ka as default};
