import{_ as O,bs as L,r as C,o as g,p as D,f as l,w as i,M as T,G as k,h as E,Q as R,i as I,k as f,d as b,e as h,be as z,H as A,S as M,T as U,j as Q,N as H,I as P,J as j,E as J,aL as B,t as F,v as V,as as v,C as q,K as X,bq as K,D as G}from"./index.850b07ca.js";import{o as N}from"./optionsNfse.12d4a18d.js";import{J as x}from"./JsonViewer.9d92a080.js";const W={components:{JsonViewer:x},data(){return{showModal:!1,opcoesNatureza:[],opcoesTipoRps:[],opcoesRegimeEspecialTributacao:[],opcoesStatusRps:[],opcoesSimNao:[],opcoesUF:[],opcoesInformacoesServicos:[],telefoneTipos:[],situacaoNfse:"Rascunho",nfse:{},opcoesCidadeIbge:[],JsonViewer:x}},emits:["atualizar"],methods:{onHide(){this.$router.replace({params:{id:""}})},trocouServico(n){const o=this.opcoesInformacoesServicos.find(d=>d.codigo===n);this.nfse.servico.itemListaServico=o.codigo,this.nfse.servico.codigoCnae=o.codigoCNAE,this.nfse.servico.codigoTributacaoMunicipio=o.codigoTributacao,this.nfse.servico.valores.aliquota=parseFloat(o.iss)},async abrirModalTomador(){var e,u,a,m,r;const n={ativo:!0},o=await $g.promptContato.show({filtro:n,placeholder:"Selecione"});if(!o)return;if(!o.nome){$q.notifyError("\xC9 preciso informar a Raz\xE3o Social do Intermedi\xE1rio");return}if(!(((u=(e=o.numeroDocumentoNacional)==null?void 0:e.replace(/\D/g,""))==null?void 0:u.length)===11||((m=(a=o.numeroDocumentoNacional)==null?void 0:a.replace(/\D/g,""))==null?void 0:m.length)===14)){$q.notifyError("\xC9 preciso informar o CPF/CNPJ do Intermedi\xE1rio");return}const t=await $db.contatoEndereco.leEnderecoPrincipal(o.id);if(!(t!=null&&t.id)){$q.notifyError("\xC9 preciso informar um endere\xE7o principal na ficha do contato.");return}this.nfse.tomador.razaoSocial=o.nome,this.nfse.tomador.documento=o.numeroDocumentoNacional.match(/\d+/g).join(""),this.nfse.tomador.endereco.numero=t.numero,this.nfse.tomador.endereco.rua=t.logradouro,this.nfse.tomador.endereco.bairro=t.bairro,this.nfse.tomador.endereco.cidade=t.ibgeCod,this.nfse.tomador.endereco.estado=t.uf,this.nfse.tomador.endereco.complemento=(r=t==null?void 0:t.complemento)!=null?r:"",this.nfse.tomador.endereco.cep=t.cep,this.opcoesCidadeIbge.push({valor:t.ibgeCod,rotulo:t.municipio+"-"+t.uf}),console.log(this.nfse),console.log(this.opcoesCidadeIbge)},async show(n,o,d){var c,y,w,s;let t=null,e=null,u=null,a=null;if(n&&(u=await $db.hibrido.le({table:"documentoFiscalEletronico",id:n}),a=JSON.parse(u.json),t=(await $erp().empresa.toArray()).find(p=>p.numeroDocumentoNacional.replace(/\D/g,"")===u.cpfCnpjEmitente)),t!=null&&t.idContato&&(e=(await $db.empresa.le({idContato:t.idContato}))[0]),e&&(o={nfseItensListaDeServico:JSON.parse((c=e.nfseItensListaDeServico)!=null?c:null)}),a!=null&&a.rps)this.nfse=a.rps,this.situacaoNfse=u.situacao;else{if(this.situacaoNfse="Rascunho",this.nfse=$utils.clonarV2($db.nfse.modelo),this.nfse.dataHoraCriacao=$utils.dataAtual(),d){const p=d==null?void 0:d.rps,S=(Number((y=p==null?void 0:p.identificacaoRps)==null?void 0:y.numero)||0)+1;this.nfse.identificacaoRps.numero=S.toString(),this.nfse.identificacaoRps.serie=(w=p==null?void 0:p.identificacaoRps)==null?void 0:w.serie,this.nfse.numeroLote=this.nfse.numeroLote||S.toString()}this.nfse.prestador.documento=o.documento,this.nfse.prestador.razaoSocial=o.nome,this.nfse.prestador.inscricaoMunicipal=o.inscricaoMunicipal,this.nfse.inscricaoMunicipal=o.inscricaoMunicipal,this.nfse.optanteSimplesNacional=o.nfseOptanteSimples,this.nfse.incentivadorCultural=o.nfseIncentivadorCultural,this.nfse.naturezaOperacao=o.nfseNaturezaOperacao,this.nfse.regimeEspecialTributacao=o.nfseRegimeTributario,this.nfse.servico.discriminacao=o.nfseDescricaoServico,this.nfse.servico.valores.aliquota=o.nfseAliquotaIss,this.nfse.servico.municipioPrestacaoServico=o.ibgeCod,this.opcoesCidadeIbge.push({valor:o.ibgeCod,rotulo:o.cidadeUf})}this.opcoesInformacoesServicos=o==null?void 0:o.nfseItensListaDeServico;const m=(s=$utils.clonarV2(u))!=null?s:{};let r={};delete m.rps,this.documentoFiscalEletronico=$utils.clonarV2(m),m.id&&(r=(await $db.hibrido.lista({table:"documentoFiscalEletronicoXml",where:{idDocumentoFiscalEletronico:m.id}}))[0]),this.documentoFiscalEletronico.id||(this.documentoFiscalEletronico.id=$utils.uuid()),this.documentoFiscalEletronicoOriginal=$utils.clonarV2(m),this.documentoFiscalEletronicoXmlOriginal=$utils.clonarV2(r),this.nfseOriginal=$utils.clonarV2(this.nfse),this.showModal=!0},async emitir(){var d;if(!await this.$refs.nfseForm.validate())return;let o;this.situacaoNfse==="Rascunho"&&(o="Enviando..."),this.situacaoNfse==="Protocolada"&&(o="Checando...");try{$q.loading.show({message:`${o}`,html:!0,boxClass:"bg-grey-2 text-grey-9",spinnerColor:"primary"}),this.nfse.dataEmissao=$utils.dataAtual();let t={...this.nfse,id:(d=this.documentoFiscalEletronico)==null?void 0:d.id};const{nfse:e,situacao:u}=await $db.nfse.emitir({nfse:t,aguardarRetorno:!0});this.nfse=e,this.situacaoNfse=u,u==="Enviada"&&(await this.salvar(async a=>{$q.loading.show({message:"Solicitando URL...",html:!0,boxClass:"bg-grey-2 text-grey-9",spinnerColor:"primary"}),await $db.nfse.solicitarURLImpressao(a)}),$q.notifyPositive("NFS-e emitida!")),u!=="Enviada"&&(typeof e.mensagemDeRetorno=="string"&&$q.notifyError(e.mensagemDeRetorno),typeof e.mensagemDeRetorno!="string"&&$q.notifyError("Erro de valida\xE7\xE3o"),await this.salvar())}catch(t){let e=t.message.replace("db.nfse.sincronizarLote: ","");e.length!==t.message&&$q.notifyError(e),e.length===t.message&&($q.notifyError("Falha ao emitir NFS-e"),console.error(t.message)),console.log(this.nfse)}finally{$q.loading.hide()}},async salvar(n){if(!await this.$refs.nfseForm.validate())return;const d=this.documentoFiscalEletronico.id||$utils.uuid(),t=this.documentoFiscalEletronicoOriginal.dataHoraCriacao||$utils.dataAtual(),e={id:d,tipo:"NFSe",tpAmb:"2",situacao:this.situacaoNfse,mod:"",serie:"",nNF:"",chNFe:"",vNF:0,dhEmi:L.formatarDataNFe(new Date(this.nfse.dataEmissao)),cpfCnpjEmitente:this.nfse.prestador.documento,xNomeEmitente:this.nfse.prestador.razaoSocial,cpfCnpjDestinatario:this.nfse.tomador.documento,xNomeDestinatario:this.nfse.tomador.razaoSocial,dataHoraEmissao:this.nfse.dataEmissao,dataHoraCriacao:t,protocoloRetorno:this.nfse.protocoloRetorno,xml:this.nfse.xml,pdf:this.nfse.pdf,json:JSON.stringify({rps:this.nfse})},u={id:this.documentoFiscalEletronicoXmlOriginal.id||$utils.uuid(),tipo:e.tipo,situacao:e.situacao,tpAmb:e.tpAmb,dataHoraEnvio:this.nfse.dataEmissao,cpfCnpjEmitente:this.nfse.prestador.documento,xmlEnvio:this.nfse.xml,idDocumentoFiscalEletronico:e.id};try{await $db.documentoFiscalEletronico.grava({atual:e,original:this.documentoFiscalEletronicoOriginal}),await $db.documentoFiscalEletronicoXml.grava({atual:u,original:this.documentoFiscalEletronicoXmlOriginal}),n&&await n(e.id),this.hide(),this.$emit("atualizar",{id:d})}catch(a){$q.notifyError(a.message)}},voltar(n){n.stopPropagation();let o=$utils.diferencaObjetos(this.nfseOriginal,this.nfse);if(!Object.keys(o).length){this.hide();return}$q.dialog({message:"Deseja descartar as modifica\xE7\xF5es?",title:"Descartar",cancel:{label:"Cancelar",push:!0,color:"tertiary",flat:!0},ok:{label:"Descartar",push:!0,class:"bg-negative",textColor:"white",flat:!0}}).onOk(()=>{this.hide()})},hide(){this.showModal=!1},setarValorLiquidoNfse(){const{valorServicos:n,valorPis:o,valorCofins:d,valorInss:t,valorIr:e,valorCsll:u,descontoIncondicionado:a,descontoCondicionado:m}=this.nfse.servico.valores,r=n-o-d-t-e-u-a-m;this.nfse.servico.valores.valorLiquidoNfse=r},async mostrarJsonViewer(){await this.$refs.jsonViewer.show(this)}},beforeMount(){this.opcoesNatureza=N.opcoesNatureza,this.opcoesTipoRps=N.opcoesTipoRps,this.opcoesRegimeEspecialTributacao=N.opcoesRegimeEspecialTributacao,this.opcoesStatusRps=N.opcoesStatusRps,this.opcoesSimNao=N.opcoesSimNao,this.telefoneTipos=N.telefoneTipos,this.opcoesUF=N.opcoesUF},watch:{"nfse.servico.valores.valorServicos":function(){const{valorServicos:n,descontoIncondicionado:o}=this.nfse.servico.valores;this.nfse.servico.valores.baseCalculo=n-o,this.setarValorLiquidoNfse()},"nfse.servico.valores.descontoIncondicionado":function(){const{valorServicos:n,descontoIncondicionado:o}=this.nfse.servico.valores;this.nfse.servico.valores.baseCalculo=n-o,this.setarValorLiquidoNfse()},"nfse.servico.valores.descontoCondicionado":function(){this.setarValorLiquidoNfse()},"nfse.servico.valores.valorPis":function(){this.setarValorLiquidoNfse()},"nfse.servico.valores.valorCofins":function(){this.setarValorLiquidoNfse()},"nfse.servico.valores.valorInss":function(){this.setarValorLiquidoNfse()},"nfse.servico.valores.valorIr":function(){this.setarValorLiquidoNfse()},"nfse.servico.valores.valorCsll":function(){this.setarValorLiquidoNfse()},"nfse.servico.valores.baseCalculo":async function(){const{baseCalculo:n,aliquota:o}=this.nfse.servico.valores,d=$utils.arredondar(n*(o/100),3);let t=String(this.nfse.servico.municipioPrestacaoServico)!=="3543402";if(!t){const e=await $db.configuracoes.leValorComFiltroEmpresa("nfse.motor");t=(e==null?void 0:e.toLowerCase())==="plugnotas"}t||(this.nfse.servico.valores.valorIss=$utils.arredondaAbnt5891(d)),t&&(this.nfse.servico.valores.valorIss=parseFloat(d.toFixed(2)))},"nfse.servico.valores.aliquota":async function(){const{baseCalculo:n,aliquota:o}=this.nfse.servico.valores,d=$utils.arredondar(n*(o/100),3);let t=String(this.nfse.servico.municipioPrestacaoServico)!=="3543402";if(!t){const e=await $db.configuracoes.leValorComFiltroEmpresa("nfse.motor");t=(e==null?void 0:e.toLowerCase())==="plugnotas"}t||(this.nfse.servico.valores.valorIss=$utils.arredondaAbnt5891(d)),t&&(this.nfse.servico.valores.valorIss=parseFloat(d.toFixed(2)))}}},Y={id:"NFSe"},Z={class:"q-ml-md"};function _(n,o,d,t,e,u){const a=C("g-col"),m=C("g-label"),r=C("campo"),c=C("g-row"),y=C("badge"),w=C("JsonViewer");return g(),D("div",Y,[l(G,{modelValue:e.showModal,"onUpdate:modelValue":o[48]||(o[48]=s=>e.showModal=s),onKeyup:K(u.voltar,["esc"]),onHide:u.onHide,maximized:"",persistent:""},{default:i(()=>[l(T,{container:"",view:"hHh LpR fFf",class:"bg-light"},{default:i(()=>[l(k,null,{default:i(()=>[l(E,{class:"q-px-sm"},{default:i(()=>[l(R,{onClick:u.voltar,icon:"arrow_back",dense:"",flat:"",round:""},null,8,["onClick"]),l(I,null,{default:i(()=>o[49]||(o[49]=[f("NFS-e")])),_:1}),e.situacaoNfse==="Rascunho"?(g(),b(R,{key:0,onClick:o[0]||(o[0]=s=>u.salvar()),label:"Salvar",color:"white","text-color":"primary",unelevated:"",class:"q-mr-sm"})):h("",!0),n.$db.usuario.desenvolvedor()?(g(),b(R,{key:1,icon:"more_vert",round:"",flat:""},{default:i(()=>[l(z,null,{default:i(()=>[A((g(),b(M,{onClick:o[1]||(o[1]=s=>u.mostrarJsonViewer()),clickable:""},{default:i(()=>[l(U,{avatar:""},{default:i(()=>[l(Q,{name:"mdi-file-replace",size:"sm"})]),_:1}),l(U,null,{default:i(()=>o[50]||(o[50]=[f("Ver Objeto")])),_:1})]),_:1})),[[H]])]),_:1})]),_:1})):h("",!0)]),_:1})]),_:1}),l(P,null,{default:i(()=>[l(j,{class:"u-container"},{default:i(()=>[l(J,{ref:"nfseForm",class:"q-py-lg"},{default:i(()=>[l(c,{gutter:"md"},{default:i(()=>[e.nfse.mensagemDeRetorno?(g(),b(a,{key:0,col:"12",bg:"bg-white",mg:"md-b","rounded-borders":""},{default:i(()=>[l(B,{class:"bg-red-5 text-white text-center text-weight-medium"},{default:i(()=>[f(F(e.nfse.mensagemDeRetorno),1)]),_:1})]),_:1})):h("",!0),l(a,{col:"12",bg:"bg-white",mg:"lg-b","rounded-borders":""},{default:i(()=>[l(m,{text:"body1 medium",class:"q-pa-sm"},{default:i(()=>o[51]||(o[51]=[f("Informa\xE7\xF5es da Nota Fiscal Eletr\xF4nica")])),_:1}),l(c,{gutter:"sm"},{default:i(()=>[l(a,{col:"12 md2"},{default:i(()=>[l(V,{label:"N\xFAmero do Lote",modelValue:e.nfse.numeroLote,"onUpdate:modelValue":o[2]||(o[2]=s=>e.nfse.numeroLote=s),readonly:"",dense:""},null,8,["modelValue"])]),_:1}),l(a,{col:"12 md2"},{default:i(()=>[l(V,{label:"N\xFAmero do RPS",modelValue:e.nfse.identificacaoRps.numero,"onUpdate:modelValue":[o[3]||(o[3]=s=>e.nfse.identificacaoRps.numero=s),o[4]||(o[4]=()=>{e.nfse.numeroLote=e.nfse.identificacaoRps.numero})],readonly:e.situacaoNfse!=="Rascunho",rules:[s=>!!s||"Campo Obrigat\xF3rio"],mask:"#","reverse-fill-mask":"",dense:""},null,8,["modelValue","readonly","rules"])]),_:1}),l(a,{col:"12 md1"},{default:i(()=>[l(V,{label:"Serie do RPS",modelValue:e.nfse.identificacaoRps.serie,"onUpdate:modelValue":o[5]||(o[5]=s=>e.nfse.identificacaoRps.serie=s),readonly:e.situacaoNfse!=="Rascunho",rules:[s=>!!s||"Campo Obrigat\xF3rio"],mask:"#","reverse-fill-mask":"",dense:""},null,8,["modelValue","readonly","rules"])]),_:1}),l(a,{col:"12 md1"},{default:i(()=>[l(v,{modelValue:e.nfse.identificacaoRps.tipo,"onUpdate:modelValue":o[6]||(o[6]=s=>e.nfse.identificacaoRps.tipo=s),options:e.opcoesTipoRps,label:"Tipo RPS",readonly:e.situacaoNfse!=="Rascunho",rules:[s=>!!s||"Campo Obrigat\xF3rio"],"emit-value":"","map-options":"",dense:""},null,8,["modelValue","options","readonly","rules"])]),_:1}),l(a,{col:"12 md3"},{default:i(()=>[l(r,{rotulo:"Data de emiss\xE3o NFS-e",tipo:"dataHora",modelValue:e.nfse.dataEmissao,"onUpdate:modelValue":o[7]||(o[7]=s=>e.nfse.dataEmissao=s),"somente-leitura":""},null,8,["modelValue"])]),_:1}),l(a,{col:"12 md3"},{default:i(()=>[l(r,{rotulo:"Data de cria\xE7\xE3o RPS",tipo:"dataHora",modelValue:e.nfse.dataHoraCriacao,"onUpdate:modelValue":o[8]||(o[8]=s=>e.nfse.dataHoraCriacao=s),"somente-leitura":""},null,8,["modelValue"])]),_:1})]),_:1}),l(c,{gutter:"sm"},{default:i(()=>[l(a,{col:"12 md6"},{default:i(()=>[l(v,{modelValue:e.nfse.naturezaOperacao,"onUpdate:modelValue":o[9]||(o[9]=s=>e.nfse.naturezaOperacao=s),options:e.opcoesNatureza,readonly:e.situacaoNfse!=="Rascunho",rules:[s=>!!s||"Campo Obrigat\xF3rio"],label:"Natureza da Opera\xE7\xE3o","emit-value":"","map-options":"",dense:""},null,8,["modelValue","options","readonly","rules"])]),_:1}),l(a,{col:"12 md6"},{default:i(()=>[l(v,{modelValue:e.nfse.regimeEspecialTributacao,"onUpdate:modelValue":o[10]||(o[10]=s=>e.nfse.regimeEspecialTributacao=s),options:e.opcoesRegimeEspecialTributacao,readonly:e.situacaoNfse!=="Rascunho",rules:[s=>!!s||"Campo Obrigat\xF3rio"],label:"Regime Especial Tributa\xE7\xE3o","emit-value":"","map-options":"",dense:""},null,8,["modelValue","options","readonly","rules"])]),_:1})]),_:1}),l(c,{gutter:"sm"},{default:i(()=>[l(a,{col:"12 md4"},{default:i(()=>[l(v,{modelValue:e.nfse.status,"onUpdate:modelValue":o[11]||(o[11]=s=>e.nfse.status=s),options:e.opcoesStatusRps,readonly:"","emit-value":"",rules:[s=>!!s||"Campo Obrigat\xF3rio"],label:"Status","map-options":"",dense:""},null,8,["modelValue","options","rules"])]),_:1}),l(a,{col:"12 md4"},{default:i(()=>[l(v,{modelValue:e.nfse.optanteSimplesNacional,"onUpdate:modelValue":o[12]||(o[12]=s=>e.nfse.optanteSimplesNacional=s),options:e.opcoesSimNao,"map-options":"",readonly:e.situacaoNfse!=="Rascunho",rules:[s=>!!s||"Campo Obrigat\xF3rio"],label:"Optante Simples Nacional","emit-value":"",dense:""},null,8,["modelValue","options","readonly","rules"])]),_:1}),l(a,{col:"12 md4"},{default:i(()=>[l(v,{modelValue:e.nfse.incentivadorCultural,"onUpdate:modelValue":o[13]||(o[13]=s=>e.nfse.incentivadorCultural=s),options:e.opcoesSimNao,"emit-value":"",readonly:e.situacaoNfse!=="Rascunho",rules:[s=>!!s||"Campo Obrigat\xF3rio"],label:"Incentivador Cultural","map-options":"",dense:""},null,8,["modelValue","options","readonly","rules"])]),_:1})]),_:1})]),_:1}),l(a,{col:"12",bg:"bg-white",mg:"lg-b","rounded-borders":""},{default:i(()=>[l(m,{text:"body1 medium",class:"q-pa-sm"},{default:i(()=>o[52]||(o[52]=[f("RPS Substitu\xEDdo")])),_:1}),l(c,{gutter:"sm"},{default:i(()=>[l(a,{col:"6"},{default:i(()=>[l(r,{modelValue:e.nfse.numeroRPSSubstituido,"onUpdate:modelValue":o[14]||(o[14]=s=>e.nfse.numeroRPSSubstituido=s),rotulo:"N\xFAmero do RPS","somente-leitura":e.situacaoNfse!=="Rascunho"},null,8,["modelValue","somente-leitura"])]),_:1}),l(a,{col:"6"},{default:i(()=>[l(r,{modelValue:e.nfse.protocoloRetorno,"onUpdate:modelValue":o[15]||(o[15]=s=>e.nfse.protocoloRetorno=s),rotulo:"Protocolo de retorno","somente-leitura":e.situacaoNfse!=="Rascunho"},null,8,["modelValue","somente-leitura"])]),_:1})]),_:1})]),_:1}),l(a,{col:"12",bg:"bg-white",mg:"lg-b","rounded-borders":""},{default:i(()=>[l(m,{text:"body1 medium",class:"q-pa-sm"},{default:i(()=>o[53]||(o[53]=[f("Prestador")])),_:1}),l(c,{gutter:"sm"},{default:i(()=>[l(a,{col:"12 md6"},{default:i(()=>[l(r,{modelValue:e.nfse.prestador.documento,"onUpdate:modelValue":o[16]||(o[16]=s=>e.nfse.prestador.documento=s),"somente-leitura":"",rules:[s=>!!s||"Campo Obrigat\xF3rio"],rotulo:"CNPJ"},null,8,["modelValue","rules"])]),_:1}),l(a,{col:"12 md6"},{default:i(()=>[l(r,{modelValue:e.nfse.prestador.inscricaoMunicipal,"onUpdate:modelValue":o[17]||(o[17]=s=>e.nfse.prestador.inscricaoMunicipal=s),"somente-leitura":"",rules:[s=>!!s||"Campo Obrigat\xF3rio"],rotulo:"Inscri\xE7\xE3o Municipal"},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1}),l(a,{col:"12",bg:"bg-white",mg:"lg-b","rounded-borders":""},{default:i(()=>[l(m,{text:"body1 medium",class:"q-pa-sm"},{default:i(()=>o[54]||(o[54]=[f("Tomador")])),_:1}),l(c,{gutter:"sm"},{default:i(()=>[l(a,{col:"12"},{default:i(()=>[l(r,{modelValue:e.nfse.tomador.razaoSocial,"onUpdate:modelValue":o[18]||(o[18]=s=>e.nfse.tomador.razaoSocial=s),rotulo:"Selecione o Tomador",before:[{icon:"search",handler:u.abrirModalTomador}],"somente-leitura":""},null,8,["modelValue","before"])]),_:1})]),_:1}),l(c,{gutter:"sm"},{default:i(()=>[l(a,{col:"12 md6"},{default:i(()=>[l(r,{modelValue:e.nfse.tomador.razaoSocial,"onUpdate:modelValue":o[19]||(o[19]=s=>e.nfse.tomador.razaoSocial=s),rotulo:"Nome/Raz\xE3o Social","somente-leitura":e.situacaoNfse!=="Rascunho"},null,8,["modelValue","somente-leitura"])]),_:1}),l(a,{col:"12 md6"},{default:i(()=>[l(r,{modelValue:e.nfse.tomador.documento,"onUpdate:modelValue":o[20]||(o[20]=s=>e.nfse.tomador.documento=s),"somente-leitura":"",rotulo:"CNPJ/CPF"},null,8,["modelValue"])]),_:1})]),_:1}),l(c,{gutter:"sm"},{default:i(()=>[l(a,{col:"12 md6"},{default:i(()=>[l(V,{modelValue:e.nfse.tomador.endereco.cep,"onUpdate:modelValue":o[21]||(o[21]=s=>e.nfse.tomador.endereco.cep=s),mask:"#####-###",readonly:e.situacaoNfse!=="Rascunho",dense:"",label:"CEP"},null,8,["modelValue","readonly"])]),_:1}),l(a,{col:"12 md6"},{default:i(()=>[l(r,{modelValue:e.nfse.tomador.endereco.rua,"onUpdate:modelValue":o[22]||(o[22]=s=>e.nfse.tomador.endereco.rua=s),rotulo:"Rua","somente-leitura":e.situacaoNfse!=="Rascunho"},null,8,["modelValue","somente-leitura"])]),_:1}),l(a,{col:"12 md6"},{default:i(()=>[l(r,{modelValue:e.nfse.tomador.endereco.numero,"onUpdate:modelValue":o[23]||(o[23]=s=>e.nfse.tomador.endereco.numero=s),rotulo:"Numero","somente-leitura":e.situacaoNfse!=="Rascunho"},null,8,["modelValue","somente-leitura"])]),_:1}),l(a,{col:"12 md6"},{default:i(()=>[l(r,{modelValue:e.nfse.tomador.endereco.bairro,"onUpdate:modelValue":o[24]||(o[24]=s=>e.nfse.tomador.endereco.bairro=s),rotulo:"Bairro","somente-leitura":e.situacaoNfse!=="Rascunho"},null,8,["modelValue","somente-leitura"])]),_:1}),l(a,{col:"12 md6"},{default:i(()=>[l(V,{modelValue:e.nfse.tomador.endereco.cidade,"onUpdate:modelValue":o[25]||(o[25]=s=>e.nfse.tomador.endereco.cidade=s),"reverse-fill-mask":"",dense:"",mask:"#",readonly:e.situacaoNfse!=="Rascunho",label:"Cidade (C\xF3digo Municipal)"},null,8,["modelValue","readonly"])]),_:1}),l(a,{col:"12 md6"},{default:i(()=>[l(v,{modelValue:e.nfse.tomador.endereco.estado,"onUpdate:modelValue":o[26]||(o[26]=s=>e.nfse.tomador.endereco.estado=s),options:e.opcoesUF,readonly:e.situacaoNfse!=="Rascunho",dense:"",label:"UF"},null,8,["modelValue","options","readonly"])]),_:1})]),_:1})]),_:1}),l(a,{col:"12",bg:"bg-white",mg:"lg-b","rounded-borders":""},{default:i(()=>[l(m,{text:"body1 medium",class:"q-pa-sm"},{default:i(()=>o[55]||(o[55]=[f("Constru\xE7\xE3o Civil")])),_:1}),l(c,{gutter:"sm"},{default:i(()=>[l(a,{col:"12 md6"},{default:i(()=>[l(r,{modelValue:e.nfse.codigoObra,"onUpdate:modelValue":o[27]||(o[27]=s=>e.nfse.codigoObra=s),rotulo:"C\xF3digo de Obra","somente-leitura":e.situacaoNfse!=="Rascunho"},null,8,["modelValue","somente-leitura"])]),_:1}),l(a,{col:"12 md6"},{default:i(()=>[l(r,{modelValue:e.nfse.codigoART,"onUpdate:modelValue":o[28]||(o[28]=s=>e.nfse.codigoART=s),rotulo:"C\xF3digo ART","somente-leitura":e.situacaoNfse!=="Rascunho"},null,8,["modelValue","somente-leitura"])]),_:1})]),_:1})]),_:1}),l(a,{col:"12",bg:"bg-white",mg:"lg-b","rounded-borders":""},{default:i(()=>[l(m,{text:"body1 medium",class:"q-pa-sm"},{default:i(()=>o[56]||(o[56]=[f("Discrimina\xE7\xE3o dos Servi\xE7os")])),_:1}),l(c,{gutter:"sm"},{default:i(()=>[l(a,{col:"12"},{default:i(()=>[l(r,{modelValue:e.nfse.servico.discriminacao,"onUpdate:modelValue":o[29]||(o[29]=s=>e.nfse.servico.discriminacao=s),"somente-leitura":e.situacaoNfse!=="Rascunho",rows:"2",rules:[s=>!!s||"Campo Obrigat\xF3rio"],tipo:"textoArea",rotulo:"Discrimina\xE7\xE3o dos Servi\xE7os"},null,8,["modelValue","somente-leitura","rules"])]),_:1})]),_:1})]),_:1}),l(a,{col:"12",bg:"bg-white",mg:"lg-b","rounded-borders":""},{default:i(()=>[l(m,{text:"body1 medium",class:"q-pa-sm"},{default:i(()=>o[57]||(o[57]=[f("Informa\xE7\xF5es de servi\xE7os")])),_:1}),l(c,{gutter:"sm"},{default:i(()=>[l(a,{class:"col-12 col-md-4"},{default:i(()=>[l(v,{modelValue:e.nfse.servico.itemListaServico,options:e.opcoesInformacoesServicos,label:"Servi\xE7os","option-value":s=>s.codigo,"option-label":s=>s?s.descricao:"","emit-value":"","map-options":"",dense:"",readonly:e.situacaoNfse!=="Rascunho","onUpdate:modelValue":u.trocouServico},null,8,["modelValue","options","option-value","option-label","readonly","onUpdate:modelValue"])]),_:1}),l(a,{class:"col-12 col-md-2"},{default:i(()=>[l(V,{modelValue:e.nfse.servico.itemListaServico,"onUpdate:modelValue":o[30]||(o[30]=s=>e.nfse.servico.itemListaServico=s),rules:[s=>!!s||"Campo Obrigat\xF3rio"],label:"C\xF3digo de Item da Lista de Servi\xE7o",readonly:"",dense:""},null,8,["modelValue","rules"])]),_:1}),l(a,{class:"col-12 col-md-2"},{default:i(()=>[l(V,{modelValue:e.nfse.servico.codigoCnae,"onUpdate:modelValue":o[31]||(o[31]=s=>e.nfse.servico.codigoCnae=s),label:"C\xF3digo CNAE",rules:[s=>!!s||"Campo Obrigat\xF3rio"],dense:"",readonly:""},null,8,["modelValue","rules"])]),_:1}),l(a,{class:"col-12 col-md-2"},{default:i(()=>[l(V,{modelValue:e.nfse.servico.codigoTributacaoMunicipio,"onUpdate:modelValue":o[32]||(o[32]=s=>e.nfse.servico.codigoTributacaoMunicipio=s),readonly:"",dense:"",rules:[s=>!!s||"Campo Obrigat\xF3rio"],label:"C\xF3digo de Tributa\xE7\xE3o"},null,8,["modelValue","rules"])]),_:1}),l(a,{class:"col-12 col-md-2"},{default:i(()=>[q("div",{class:"col",onClick:o[34]||(o[34]=(...s)=>n.carregarEquipamentos&&n.carregarEquipamentos(...s))},[l(r,{modelValue:e.nfse.servico.municipioPrestacaoServico,"onUpdate:modelValue":o[33]||(o[33]=s=>e.nfse.servico.municipioPrestacaoServico=s),tipo:"seletor",opcoes:e.opcoesCidadeIbge,rotulo:"C\xF3digo Munic\xEDpio IBGE"},null,8,["modelValue","opcoes"])])]),_:1})]),_:1})]),_:1}),l(a,{col:"12",bg:"bg-white","rounded-borders":""},{default:i(()=>[l(m,{text:"body1 medium",class:"q-pa-sm"},{default:i(()=>o[58]||(o[58]=[f("Valores")])),_:1}),l(c,{gutter:"sm"},{default:i(()=>[l(a,{col:"12 sm6 md3"},{default:i(()=>[l(v,{modelValue:e.nfse.servico.valores.issRetido,"onUpdate:modelValue":o[35]||(o[35]=s=>e.nfse.servico.valores.issRetido=s),options:e.opcoesSimNao,readonly:e.situacaoNfse!=="Rascunho",rules:[s=>!!s||"Campo Obrigat\xF3rio"],label:"ISS Retido","map-options":"",dense:"","emit-value":""},null,8,["modelValue","options","readonly","rules"])]),_:1}),l(a,{col:"12 sm6 md3"},{default:i(()=>[l(r,{modelValue:e.nfse.servico.valores.valorServicos,"onUpdate:modelValue":o[36]||(o[36]=s=>e.nfse.servico.valores.valorServicos=s),decimals:"4",value:"0",prefix:"R$","somente-leitura":e.situacaoNfse!=="Rascunho",rotulo:"Valor dos Servi\xE7os",tipo:"decimal"},null,8,["modelValue","somente-leitura"])]),_:1}),l(a,{col:"12 sm6 md3"},{default:i(()=>[l(r,{modelValue:e.nfse.servico.valores.valorPis,"onUpdate:modelValue":o[37]||(o[37]=s=>e.nfse.servico.valores.valorPis=s),value:"0",prefix:"R$",decimals:"2","somente-leitura":e.situacaoNfse!=="Rascunho",rotulo:"Valor PIS",tipo:"decimal"},null,8,["modelValue","somente-leitura"])]),_:1}),l(a,{col:"12 sm6 md3"},{default:i(()=>[l(r,{modelValue:e.nfse.servico.valores.valorCofins,"onUpdate:modelValue":o[38]||(o[38]=s=>e.nfse.servico.valores.valorCofins=s),value:"0",prefix:"R$",tipo:"decimal","somente-leitura":e.situacaoNfse!=="Rascunho",rotulo:"Valor COFINS",decimals:"2"},null,8,["modelValue","somente-leitura"])]),_:1}),l(a,{col:"12 sm6 md3"},{default:i(()=>[l(r,{modelValue:e.nfse.servico.valores.valorInss,"onUpdate:modelValue":o[39]||(o[39]=s=>e.nfse.servico.valores.valorInss=s),value:"0",prefix:"R$",decimals:"2","somente-leitura":e.situacaoNfse!=="Rascunho",tipo:"decimal",rotulo:"Valor INSS"},null,8,["modelValue","somente-leitura"])]),_:1}),l(a,{col:"12 sm6 md3"},{default:i(()=>[l(r,{modelValue:e.nfse.servico.valores.valorIr,"onUpdate:modelValue":o[40]||(o[40]=s=>e.nfse.servico.valores.valorIr=s),value:"0",prefix:"R$",decimals:"2","somente-leitura":e.situacaoNfse!=="Rascunho",rotulo:"Valor IR",tipo:"decimal"},null,8,["modelValue","somente-leitura"])]),_:1}),l(a,{col:"12 sm6 md3"},{default:i(()=>[l(r,{modelValue:e.nfse.servico.valores.valorCsll,"onUpdate:modelValue":o[41]||(o[41]=s=>e.nfse.servico.valores.valorCsll=s),value:"0",prefix:"R$",decimals:"2","somente-leitura":e.situacaoNfse!=="Rascunho",rotulo:"Valor CSLL",tipo:"decimal"},null,8,["modelValue","somente-leitura"])]),_:1}),l(a,{col:"12 sm6 md3"},{default:i(()=>[l(r,{modelValue:e.nfse.servico.valores.valorIss,"onUpdate:modelValue":o[42]||(o[42]=s=>e.nfse.servico.valores.valorIss=s),value:"0",prefix:"R$",decimals:"2",rotulo:"Valor ISS",tipo:"decimal","somente-leitura":""},null,8,["modelValue"])]),_:1}),l(a,{col:"12 sm6 md3"},{default:i(()=>[l(r,{modelValue:e.nfse.servico.valores.baseCalculo,"onUpdate:modelValue":o[43]||(o[43]=s=>e.nfse.servico.valores.baseCalculo=s),value:"0",prefix:"R$",decimals:"2",tipo:"decimal",rotulo:"Base Calculo","somente-leitura":""},null,8,["modelValue"])]),_:1}),l(a,{col:"12 sm6 md3"},{default:i(()=>[l(r,{modelValue:e.nfse.servico.valores.aliquota,"onUpdate:modelValue":o[44]||(o[44]=s=>e.nfse.servico.valores.aliquota=s),rotulo:"Aliquota",value:"2","somente-leitura":e.situacaoNfse!=="Rascunho",suffix:"%",decimals:"2",tipo:"decimal"},null,8,["modelValue","somente-leitura"])]),_:1}),l(a,{col:"12 sm6 md3"},{default:i(()=>[l(r,{modelValue:e.nfse.servico.valores.valorLiquidoNfse,"onUpdate:modelValue":o[45]||(o[45]=s=>e.nfse.servico.valores.valorLiquidoNfse=s),value:"0",prefix:"R$",decimals:"2",tipo:"decimal","somente-leitura":"",rotulo:"Valor Liquido Nfse"},null,8,["modelValue"])]),_:1}),l(a,{col:"12 sm6 md3"},{default:i(()=>[l(r,{modelValue:e.nfse.servico.valores.descontoCondicionado,"onUpdate:modelValue":o[46]||(o[46]=s=>e.nfse.servico.valores.descontoCondicionado=s),value:"0",tipo:"decimal",decimals:"2","somente-leitura":e.situacaoNfse!=="Rascunho",prefix:"R$",rotulo:"Desconto Condicionado"},null,8,["modelValue","somente-leitura"])]),_:1}),l(a,{col:"12 sm6 md3"},{default:i(()=>[l(r,{modelValue:e.nfse.servico.valores.descontoIncondicionado,"onUpdate:modelValue":o[47]||(o[47]=s=>e.nfse.servico.valores.descontoIncondicionado=s),rotulo:"Desconto Incondicionado","somente-leitura":e.situacaoNfse!=="Rascunho",value:"0",prefix:"R$",decimals:"2",tipo:"decimal"},null,8,["modelValue","somente-leitura"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1}),l(X,{class:"bg-white shadow-1",bordered:""},{default:i(()=>[l(E,{class:"u-container"},{default:i(()=>[l(I,{class:"text-tertiary text-weight-regular",style:{"font-size":"16px",display:"flex","align-items":"center"}},{default:i(()=>{var s,p,S;return[o[59]||(o[59]=f(" TOTAL ")),q("span",Z," R$ "+F(n.$filters.numero((S=(p=(s=e.nfse.servico)==null?void 0:s.valores)==null?void 0:p.valorServicos)!=null?S:0,2)),1),e.situacaoNfse?(g(),b(y,{key:0,rotulo:e.situacaoNfse,escuro:"",cor:"tertiary",class:"q-ml-md"},null,8,["rotulo"])):h("",!0)]}),_:1}),~["Rascunho"].indexOf(e.situacaoNfse)?(g(),b(R,{key:0,onClick:u.emitir,label:"Emitir",color:"primary",unelevated:"",class:"q-ml-sm"},null,8,["onClick"])):h("",!0),~["Protocolada"].indexOf(e.situacaoNfse)?(g(),b(R,{key:1,onClick:u.emitir,label:"Checar envio",color:"primary",unelevated:"",class:"q-ml-sm"},null,8,["onClick"])):h("",!0)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onKeyup","onHide"]),l(w,{ref:"jsonViewer"},null,512)])}var le=O(W,[["render",_]]);export{le as N};
