import{_ as re,a5 as ke,r as mt,o as Q,d as at,w as s,f as e,M as Lt,G as jt,h as Tt,i as Ut,k as R,t as J,m as St,e as lt,H as bt,Q as ct,N as Vt,I as $t,J as Ht,p as wt,b0 as Ce,b1 as se,b6 as Ee,b7 as ne,W as Mt,b8 as me,d6 as fe,d7 as Bt,K as Yt,aW as oe,D as Zt,bj as be,at as Ot,b5 as Dt,s as he,bg as Kt,P as xt,S as _t,T as tt,j as vt,U as pt,A as Se,F as Pt,u as Rt,C as ft,l as le,aQ as pe,E as de,bs as ve,d$ as De,c as ee,bI as ae,e0 as Ve,au as xe,av as Pe,d8 as ze,aP as ge}from"./index.a0bf17fb.js";import{L as Fe}from"./Lista.3bafef89.js";import{S as Te}from"./SeletorCfop.ecb89a3b.js";import{C as Ae}from"./Campo.cc2c67f0.js";import"./xlsx.01123df0.js";const Ne={components:{SeletorNcm:ke,SeletorCfop:Te,Campo:Ae},data(){return{abaSelecionada:"tab1",historicoItem:[],tabelaHistoricoItem:{colunas:[{name:"fornecedor",label:"Fornecedor",align:"left"},{name:"dataCompra",label:"Data Compra",align:"right"},{name:"quantidade",label:"Quantidade",align:"right"},{name:"valorCusto",label:"Valor de Custo",align:"right"},{name:"valorTotal",label:"Valor Total (Custo)",align:"right"}],paginacao:{page:1,rowsPerPage:5}},estoqueItem:[],tabelaEstoqueItem:{colunas:[{name:"empresa",label:"Empresa",align:"left"},{name:"tipoEstoque",label:"Tipo estoque",align:"right"},{name:"lote",label:"Lote",align:"right"},{name:"quantidade",label:"Quantidade",align:"right"}],paginacao:{page:1,rowsPerPage:5}},compra:{},cfop:null,cstIcms:"",cstIpi:"",contaEstoque:[],impostoCstIpi:[],impostoIcmsModalidade:[],impostoCstIcms:[],impostoCstIcmsSt:[],documentoItem:{},imposto:{},item:{},visivel:!1,contasOpcoes:[],exibirIcms:!1,exibirIcmsSt:!1,exibirIpi:!1,somenteLeituraIcms:!1,somenteLeituraIcmsSt:!1,exibirHistorico:!1,exibirEstoque:!1,exibeCfop:!1}},emits:["salvar"],methods:{async mostrar(o,l,h){var m,t,c,b,w,g,v,i,I,r;this.compra=h,this.documentoItem=$utils.clonarV2(o),this.item=$utils.clonarV2(l),await this.consultarHistoricoItem(this.item),await this.consultarEstoqueItem(this.item);const k=await $db.hibrido.lista({table:"impostoParametro",where:{impParamTipoCod:1}}),a=await $db.hibrido.lista({table:"impostoParametro",where:{impParamTipoCod:21}});this.impostoCstIcms=k.concat(a).map(p=>({rotulo:p.numero.trim()+" - "+p.descr,valor:Number(p.numero)})).sort((p,u)=>Number(p.valor)-Number(u.valor)),this.impostoIcmsModalidade=(await $db.hibrido.lista({table:"impostoParametro",where:{impParamTipoCod:3}})).map(p=>({rotulo:p.numero.trim()+" - "+p.descr,valor:Number(p.numero)})).sort((p,u)=>Number(p.valor)-Number(u.valor)),this.impostoCstIcmsSt=(await $db.hibrido.lista({table:"impostoParametro",where:{impParamTipoCod:4}})).map(p=>({rotulo:p.numero.trim()+" - "+p.descr,valor:Number(p.numero)})).sort((p,u)=>Number(p.valor)-Number(u.valor)),this.impostoCstIpi=(await $db.hibrido.lista({table:"impostoParametro",where:{impParamTipoCod:5}})).map(p=>({rotulo:p.numero.trim()+" - "+p.descr,valor:Number(p.numero)})).sort((p,u)=>Number(p.valor)-Number(u.valor)),this.contaEstoque=(await $db.hibrido.lista({table:"financeiroPlanoConta"})).map(p=>{var u,_,E;return{rotulo:(E=(_=(u=p==null?void 0:p.descricao)!=null?u:" - "+(p==null?void 0:p.classificacao))!=null?_:" - "+(p==null?void 0:p.caminho))!=null?E:"",valor:p.id}}).sort((p,u)=>Number(p.valor)-Number(u.valor));let n;(m=this.documentoItem)!=null&&m.idCfop&&(n=await $erp().cfop.where({id:this.documentoItem.idCfop}).first()),n===void 0&&console.log("CFOP inv\xE1lido"),this.documentoItem.cfop=(t=n==null?void 0:n.cfop.toString())!=null?t:"",this.documentoItem.codigoCfop=(c=n==null?void 0:n.codigoCfop)!=null?c:null,this.documentoItem.idCfop=(b=n.id)!=null?b:null,this.documentoItem.valorBaseIcms=(g=(w=this.documentoItem.valorBaseIcms)!=null?w:this.documentoItem.total)!=null?g:0,this.documentoItem.valorBaseIpi=(i=(v=this.documentoItem.valorBaseIpi)!=null?v:this.documentoItem.total)!=null?i:0,this.documentoItem.valorBaseIcmsSt=(r=(I=this.documentoItem.valorBaseIcmsSt)!=null?I:this.documentoItem.total)!=null?r:0,this.calcularImpostos(),this.exibeCfop=!0,this.visivel=!0},async salvar(){try{if(Object.keys(this.documentoItem.cfop).length>0){const o=await $db.hibrido.lista({table:"cfop",where:{cfop:Number(this.documentoItem.cfop)}});this.documentoItem.codigoCfop=o[0].codigoCfop,this.documentoItem.idCfop=o[0].id}this.documentoItem.cfop&&delete this.documentoItem.cfop,this.$emit("salvar",this.documentoItem),this.exibirIcms=!1,this.exibirIcmsSt=!1,this.exibirIpi=!1,this.visivel=!1}catch(o){$q.notifyError("Ocorreu um erro ao salvar o produto: ",o.message)}finally{$q.notifyPositive("Produto salvo com sucesso.")}},calcularImpostos(o){var g,v,i,I,r,p,u,_,E,D;let l=(g=this.documentoItem.valorBaseIcms)!=null?g:0,h=(v=this.documentoItem.valorBaseIpi)!=null?v:0,k=(i=this.documentoItem.valorBaseIcmsSt)!=null?i:0,a=(I=this.documentoItem.percentualIcms)!=null?I:0,n=(r=this.documentoItem.percentualIpi)!=null?r:0,m=(p=this.documentoItem.percentualIVA)!=null?p:0,t=(u=this.documentoItem.percentualIcmsSt)!=null?u:0,c=(_=this.documentoItem.valorIcms)!=null?_:0,b=(E=this.documentoItem.valorIpi)!=null?E:0,w=(D=this.documentoItem.valorIcmsSt)!=null?D:0;["valorBaseIcms","percentualIcms"].includes(o)&&(c=l*a/100),o==="valorIcms"&&(a=c/l*100),["valorBaseIpi","percentualIpi"].includes(o)&&(b=h*n/100),o==="valorIpi"&&(n=b/h*100),o==="valorBaseIcmsSt"&&(m=0,k>0&&l>0&&k>=l&&(m=(k-l)/l*100),w=k*t/100-c),o==="percentualIVA"&&(k=l*(1+m/100),w=k*t/100-c),o==="percentualIcmsSt"&&(w=k*t/100-c),o==="valorIcmsSt"&&(t=w/k*100),this.documentoItem.valorBaseIcmsSt=parseFloat(k.toFixed(2)),this.documentoItem.percentualIcms=parseFloat(a.toFixed(2)),this.documentoItem.percentualIcmsSt=parseFloat(t.toFixed(2)),this.documentoItem.percentualIpi=parseFloat(n.toFixed(2)),this.documentoItem.percentualIVA=parseFloat(m.toFixed(2)),this.documentoItem.valorIcms=parseFloat(c.toFixed(2)),this.documentoItem.valorIcmsSt=parseFloat(w.toFixed(2)),this.documentoItem.valorIpi=parseFloat(b.toFixed(2)),(this.documentoItem.modalidadeBaseCalculo||this.documentoItem.codigoCst||this.documentoItem.percentualIcms>0||this.documentoItem.valorIcms>0)&&(this.exibirIcms=!0),(this.documentoItem.modalidadeBaseCalculoST||this.documentoItem.percentualIcmsSt>0||this.documentoItem.valorIcmsSt>0)&&(this.exibirIcmsSt=!0),(this.documentoItem.codigoCstIpi||this.documentoItem.percentualIpi>0||this.documentoItem.valorIpi>0)&&(this.exibirIpi=!0)},async consultarCFOP(){var h,k;const o=this.documentoItem.cfop,l=await $erp().cfop.where({cfop:Number(o)}).first();l===void 0&&console.log("CFOP inv\xE1lido"),this.documentoItem.idCfop=(h=l==null?void 0:l.id)!=null?h:null,this.documentoItem.codigoCfop=(k=l==null?void 0:l.CodigoCFOP)!=null?k:null},async consultarHistoricoItem(o){const l={};(o==null?void 0:o.atual)&&Object.keys(o.atual).length>0&&(o=o.atual);const k=(await $db.hibrido.lista({table:"documentoItem",where:{idItem:o.id}})).filter(a=>(a.operacao==="Compra"||a.operacao==="Compra de Mercadoria")&&a.status==="Finalizado"&&a.operacaoFator===1&&a.quantidade>0);for(const a of k){const n=await $db.hibrido.le({table:"documento",id:a.idDocumento}),m=await $db.hibrido.le({table:"contato",id:n.idContato});l[a.idItem]||(l[a.idItem]={fornecedores:[]}),l[a.idItem].fornecedores.push({fornecedor:m.apelido||"",dataCompra:n.dataCompra||"",quantidade:a.quantidade||"",valorCusto:a.valorItem||"",valorTotal:a.valorItem*a.quantidade||""})}Object.keys(l).length>0?(this.historicoItem=l,this.historicoItem[o.id].fornecedores.sort((a,n)=>{const m=new Date(a.dataCompra||"1900-01-01");return new Date(n.dataCompra||"1900-01-01")-m})):this.historicoItem[o.id]={fornecedores:[]},this.exibirHistorico=!0},async consultarEstoqueItem(o){const l={};(o==null?void 0:o.atual)&&Object.keys(o.atual).length>0&&(o=o.atual);const h=await $db.hibrido.lista({table:"estoqueSaldoProdutoEmpresa",where:{idItem:o.id},whereFilter:{tipoEstoque:"Dispon\xEDvel"}});for(const k of h){const a=await $db.hibrido.le({table:"contato",id:k.idEmpresa});l[k.idItem]||(l[k.idItem]={estoques:[]}),l[k.idItem].estoques.push({empresa:a.apelido||"",tipoEstoque:k.tipoEstoque||"",lote:k.lote||"-",quantidade:k.saldo||""})}Object.keys(l).length>0?(this.estoqueItem=l,this.estoqueItem[o.id].estoques.sort((k,a)=>{const n=Number(k.quantidade||0);return Number(a.quantidade||0)-n})):this.estoqueItem[o.id]={estoques:[]},this.exibirEstoque=!0},async fechar(){this.documentoItem.cfop&&delete this.documentoItem.cfop,this.exibirIcms=!1,this.exibirIcmsSt=!1,this.exibirIpi=!1}}},qe=["src"],Be={key:0},Oe={key:0};function Ue(o,l,h,k,a,n){const m=mt("badge"),t=mt("g-col"),c=mt("g-row"),b=mt("campo"),w=mt("SeletorNcm"),g=mt("SeletorCfop"),v=mt("g-label");return Q(),at(Zt,{modelValue:a.visivel,"onUpdate:modelValue":l[36]||(l[36]=i=>a.visivel=i),persistent:""},{default:s(()=>[e(Lt,{container:"",view:"hHh Lpr fFf",class:"bg-white",style:{"max-width":"980px"}},{default:s(()=>[e(jt,{class:"bg-primary"},{default:s(()=>[e(Tt,{class:"bg-primary text-white"},{default:s(()=>[e(Ut,null,{default:s(()=>[R(J(a.documentoItem.descricaoItem),1)]),_:1}),a.item.referencia?(Q(),at(m,{key:0,cor:"tertiary",class:"q-mr-sm"},{default:s(()=>[R(J(a.item.referencia)+" ",1),e(St,null,{default:s(()=>[R(" Refer\xEAncia ")]),_:1})]),_:1})):lt("",!0),a.item.codigoItem?(Q(),at(m,{key:1,cor:"positive",class:"q-mr-sm"},{default:s(()=>[R(" #"+J(a.item.codigoItem.toString().padStart(4,"0"))+" ",1),e(St,null,{default:s(()=>[R(" C\xF3digo Item ")]),_:1})]),_:1})):lt("",!0),bt(e(ct,{onClick:n.fechar,dense:"",flat:"",icon:"close",round:""},null,8,["onClick"]),[[Vt]])]),_:1})]),_:1}),e($t,null,{default:s(()=>[e(Ht,null,{default:s(()=>[e(c,{gutter:"md"},{default:s(()=>[e(t,null,{default:s(()=>[e(c,{class:"col-12 text-center"},{default:s(()=>[e(t,null,{default:s(()=>{var i,I,r,p,u,_;return[((i=a.item)==null?void 0:i.imagem)||((r=(I=a.item)==null?void 0:I.atual)==null?void 0:r.imagem)?(Q(),wt("img",{key:0,src:((p=a.item)==null?void 0:p.imagem)||((_=(u=a.item)==null?void 0:u.atual)==null?void 0:_.imagem),alt:"",style:{"max-width":"33%"}},null,8,qe)):lt("",!0)]}),_:1})]),_:1}),e(Ce,{modelValue:a.abaSelecionada,"onUpdate:modelValue":l[0]||(l[0]=i=>a.abaSelecionada=i),align:"justify",dense:"","indicator-color":"light-blue-4",class:"text-primary q-px-sm"},{default:s(()=>[e(se,{default:"",name:"tab1",icon:"info",label:"Detalhes",class:"cinza"}),e(se,{name:"tab2",icon:"history",label:"Compras",class:"cinza"}),e(se,{name:"tab3",icon:"compare_arrows",label:"Estoque",class:"cinza"})]),_:1},8,["modelValue"]),e(Ee,{modelValue:a.abaSelecionada,"onUpdate:modelValue":l[35]||(l[35]=i=>a.abaSelecionada=i),animated:"",class:"text-tertiary"},{default:s(()=>[e(ne,{name:"tab1",class:"q-px-sm"},{default:s(()=>[e(c,null,{default:s(()=>[e(t,null,{default:s(()=>[e(b,{modelValue:a.documentoItem.observacao,"onUpdate:modelValue":l[1]||(l[1]=i=>a.documentoItem.observacao=i),tipo:"textoArea",rotulo:"Observa\xE7\xE3o",dense:"",rows:"4"},null,8,["modelValue"])]),_:1})]),_:1}),e(c,{mg:"lg-t"},{default:s(()=>[e(t,{col:"12"},{default:s(()=>[e(b,{modelValue:a.documentoItem.referenciaFornecedor,"onUpdate:modelValue":l[2]||(l[2]=i=>a.documentoItem.referenciaFornecedor=i),rotulo:"Refer\xEAncia Fornecedor"},null,8,["modelValue"])]),_:1})]),_:1}),e(c,{mg:"lg-t"},{default:s(()=>[e(t,{col:"12"},{default:s(()=>[e(w,{modelValue:a.documentoItem.ncm,"onUpdate:modelValue":l[3]||(l[3]=i=>a.documentoItem.ncm=i),class:"col-12 col-md-6",outlined:""},null,8,["modelValue"])]),_:1})]),_:1}),e(c,{mg:"lg-t"},{default:s(()=>[e(t,{col:"12"},{default:s(()=>[e(g,{modelValue:a.documentoItem.cfop,"onUpdate:modelValue":l[4]||(l[4]=i=>a.documentoItem.cfop=i),class:"col-12 col-md-6",outlined:""},null,8,["modelValue"])]),_:1})]),_:1}),e(c,{mg:"lg-t"},{default:s(()=>[e(t,null,{default:s(()=>[e(v,{text:"sub1 medium"},{default:s(()=>[R("Estoque")]),_:1})]),_:1})]),_:1}),e(c,{items:"center"},{default:s(()=>[e(t,{col:"12"},{default:s(()=>[e(b,{modelValue:a.documentoItem.idPlanoContaEstoque,"onUpdate:modelValue":l[5]||(l[5]=i=>a.documentoItem.idPlanoContaEstoque=i),opcoes:a.contaEstoque,tipo:"seletor",ajuda:"Plano de Conta de Estoque para Entrada de Mercadoria",dense:"",outlined:"",rotulo:"Conta Estoque"},null,8,["modelValue","opcoes"])]),_:1})]),_:1}),e(c,{mg:"lg-t"},{default:s(()=>[e(t,null,{default:s(()=>[e(v,{text:"sub1 medium"},{default:s(()=>[R("Impostos")]),_:1})]),_:1})]),_:1}),e(c,null,{default:s(()=>[e(Mt,{label:"ICMS",modelValue:a.exibirIcms,"onUpdate:modelValue":l[6]||(l[6]=i=>a.exibirIcms=i)},null,8,["modelValue"])]),_:1}),a.exibirIcms?(Q(),at(c,{key:0,items:"center"},{default:s(()=>[e(t,{col:"12 sm6"},{default:s(()=>[e(b,{modelValue:a.documentoItem.modalidadeBaseCalculo,"onUpdate:modelValue":l[7]||(l[7]=i=>a.documentoItem.modalidadeBaseCalculo=i),opcoes:a.impostoIcmsModalidade,"somente-leitura":a.somenteLeituraIcms,tipo:"seletor",outlined:"",rotulo:"ICMS (Modalidade)"},null,8,["modelValue","opcoes","somente-leitura"])]),_:1}),e(t,{col:"12 sm6"},{default:s(()=>[e(b,{modelValue:a.documentoItem.codigoCst,"onUpdate:modelValue":l[8]||(l[8]=i=>a.documentoItem.codigoCst=i),opcoes:a.impostoCstIcms,"somente-leitura":a.somenteLeituraIcms,tipo:"seletor",outlined:"",rotulo:"CST ICMS"},null,8,["modelValue","opcoes","somente-leitura"])]),_:1}),e(t,{col:"12 sm4"},{default:s(()=>[e(b,{modelValue:a.documentoItem.valorBaseIcms,"onUpdate:modelValue":l[9]||(l[9]=i=>a.documentoItem.valorBaseIcms=i),onBlur:l[10]||(l[10]=i=>n.calcularImpostos("valorBaseIcms")),"somente-leitura":a.somenteLeituraIcms,tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"Base ICMS"},null,8,["modelValue","somente-leitura"])]),_:1}),e(t,{col:"12 sm4"},{default:s(()=>[e(b,{modelValue:a.documentoItem.percentualIcms,"onUpdate:modelValue":l[11]||(l[11]=i=>a.documentoItem.percentualIcms=i),onBlur:l[12]||(l[12]=i=>n.calcularImpostos("percentualIcms")),"somente-leitura":a.somenteLeituraIcms,tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"ICMS %"},null,8,["modelValue","somente-leitura"])]),_:1}),e(t,{col:"12 sm4"},{default:s(()=>[e(b,{modelValue:a.documentoItem.valorIcms,"onUpdate:modelValue":l[13]||(l[13]=i=>a.documentoItem.valorIcms=i),onBlur:l[14]||(l[14]=i=>n.calcularImpostos("valorIcms")),"somente-leitura":a.somenteLeituraIcms,tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"Valor ICMS"},null,8,["modelValue","somente-leitura"])]),_:1})]),_:1})):lt("",!0),e(c,null,{default:s(()=>[e(Mt,{label:"ICMS ST",modelValue:a.exibirIcmsSt,"onUpdate:modelValue":l[15]||(l[15]=i=>a.exibirIcmsSt=i)},null,8,["modelValue"])]),_:1}),a.exibirIcmsSt?(Q(),at(c,{key:1,items:"center"},{default:s(()=>[e(t,{col:"12 sm6"},{default:s(()=>[e(b,{modelValue:a.documentoItem.modalidadeBaseCalculoST,"onUpdate:modelValue":l[16]||(l[16]=i=>a.documentoItem.modalidadeBaseCalculoST=i),opcoes:a.impostoCstIcmsSt,"somente-leitura":a.somenteLeituraIcmsSt,tipo:"seletor",outlined:"",rotulo:"ICMS ST (Modalidade)"},null,8,["modelValue","opcoes","somente-leitura"])]),_:1}),e(t,{col:"12 sm6"},{default:s(()=>[e(b,{modelValue:a.documentoItem.percentualIVA,"onUpdate:modelValue":l[17]||(l[17]=i=>a.documentoItem.percentualIVA=i),onBlur:l[18]||(l[18]=i=>n.calcularImpostos("percentualIVA")),tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"IVA (%)"},null,8,["modelValue"])]),_:1}),e(t,{col:"12 sm4"},{default:s(()=>[e(b,{modelValue:a.documentoItem.valorBaseIcmsSt,"onUpdate:modelValue":l[19]||(l[19]=i=>a.documentoItem.valorBaseIcmsSt=i),onBlur:l[20]||(l[20]=i=>n.calcularImpostos("valorBaseIcmsSt")),"somente-leitura":a.somenteLeituraIcmsSt,tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"Base ICMS ST"},null,8,["modelValue","somente-leitura"])]),_:1}),e(t,{col:"12 sm4"},{default:s(()=>[e(b,{modelValue:a.documentoItem.percentualIcmsSt,"onUpdate:modelValue":l[21]||(l[21]=i=>a.documentoItem.percentualIcmsSt=i),onBlur:l[22]||(l[22]=i=>n.calcularImpostos("percentualIcmsSt")),"somente-leitura":a.somenteLeituraIcmsSt,tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"ICMS ST (%)"},null,8,["modelValue","somente-leitura"])]),_:1}),e(t,{col:"12 sm4"},{default:s(()=>[e(b,{modelValue:a.documentoItem.valorIcmsSt,"onUpdate:modelValue":l[23]||(l[23]=i=>a.documentoItem.valorIcmsSt=i),onBlur:l[24]||(l[24]=i=>n.calcularImpostos("valorIcmsSt")),"somente-leitura":a.somenteLeituraIcmsSt,tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"Valor ICMS ST"},null,8,["modelValue","somente-leitura"])]),_:1})]),_:1})):lt("",!0),e(c,null,{default:s(()=>[e(Mt,{label:"IPI",modelValue:a.exibirIpi,"onUpdate:modelValue":l[25]||(l[25]=i=>a.exibirIpi=i)},null,8,["modelValue"])]),_:1}),a.exibirIpi?(Q(),at(c,{key:2,items:"center"},{default:s(()=>[e(t,{col:"12"},{default:s(()=>[e(b,{modelValue:a.documentoItem.codigoCstIpi,"onUpdate:modelValue":l[26]||(l[26]=i=>a.documentoItem.codigoCstIpi=i),opcoes:a.impostoCstIpi,tipo:"seletor",dense:"",outlined:"",rotulo:"CST IPI"},null,8,["modelValue","opcoes"])]),_:1}),e(t,{col:"12 sm4"},{default:s(()=>[e(b,{modelValue:a.documentoItem.valorBaseIpi,"onUpdate:modelValue":l[27]||(l[27]=i=>a.documentoItem.valorBaseIpi=i),onBlur:l[28]||(l[28]=i=>n.calcularImpostos("valorBaseIpi")),tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"Base IPI"},null,8,["modelValue"])]),_:1}),e(t,{col:"12 sm4"},{default:s(()=>[e(b,{modelValue:a.documentoItem.percentualIpi,"onUpdate:modelValue":l[29]||(l[29]=i=>a.documentoItem.percentualIpi=i),onBlur:l[30]||(l[30]=i=>n.calcularImpostos("percentualIpi")),tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"IPI %"},null,8,["modelValue"])]),_:1}),e(t,{col:"12 sm4"},{default:s(()=>[e(b,{modelValue:a.documentoItem.valorIpi,"onUpdate:modelValue":l[31]||(l[31]=i=>a.documentoItem.valorIpi=i),onBlur:l[32]||(l[32]=i=>n.calcularImpostos("valorIpi")),tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"Valor IPI"},null,8,["modelValue"])]),_:1})]),_:1})):lt("",!0)]),_:1}),e(ne,{name:"tab2",class:"q-px-sm"},{default:s(()=>[a.exibirHistorico?(Q(),at(me,{key:0,rows:a.historicoItem[a.documentoItem.idItem].fornecedores,columns:a.tabelaHistoricoItem.colunas,pagination:a.tabelaHistoricoItem.paginacao,"onUpdate:pagination":l[33]||(l[33]=i=>a.tabelaHistoricoItem.paginacao=i),"row-key":"index",class:"no-shadow text-left"},{body:s(i=>[e(fe,{props:i},{default:s(()=>[e(Bt,{key:"fornecedor",props:i},{default:s(()=>[R(J(i.row.fornecedor),1)]),_:2},1032,["props"]),e(Bt,{key:"dataCompra",props:i},{default:s(()=>[i.row.dataCompra!==""?(Q(),wt("span",Be,J(o.$filters.data(i.row.dataCompra)),1)):lt("",!0)]),_:2},1032,["props"]),e(Bt,{key:"quantidade",props:i},{default:s(()=>[R(J(i.row.quantidade),1)]),_:2},1032,["props"]),e(Bt,{key:"valorCusto",props:i},{default:s(()=>[R(J(o.$filters.numero(i.row.valorCusto,2)),1)]),_:2},1032,["props"]),e(Bt,{key:"valorTotal",props:i},{default:s(()=>[R(J(o.$filters.numero(i.row.valorTotal,2)),1)]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination"])):lt("",!0)]),_:1}),e(ne,{name:"tab3",class:"q-px-sm"},{default:s(()=>[a.exibirEstoque?(Q(),at(me,{key:0,rows:a.estoqueItem[a.documentoItem.idItem].estoques,columns:a.tabelaEstoqueItem.colunas,pagination:a.tabelaEstoqueItem.paginacao,"onUpdate:pagination":l[34]||(l[34]=i=>a.tabelaEstoqueItem.paginacao=i),"row-key":"index",class:"no-shadow text-left"},{body:s(i=>[e(fe,{props:i},{default:s(()=>[e(Bt,{key:"empresa",props:i},{default:s(()=>[R(J(i.row.empresa),1)]),_:2},1032,["props"]),e(Bt,{key:"tipoEstoque",props:i},{default:s(()=>[R(J(i.row.tipoEstoque),1)]),_:2},1032,["props"]),e(Bt,{key:"lote",props:i},{default:s(()=>[i.row.lote!==""?(Q(),wt("span",Oe,J(i.row.lote),1)):lt("",!0)]),_:2},1032,["props"]),e(Bt,{key:"quantidade",props:i},{default:s(()=>[R(J(i.row.quantidade),1)]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination"])):lt("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(Yt,{class:"bg-light q-pa-sm",bordered:""},{default:s(()=>[e(Tt,null,{default:s(()=>[e(oe),bt(e(ct,{onClick:n.fechar,label:"Cancelar",size:"md",flat:"","no-ripple":"",color:"tertiary",class:"q-mr-sm"},null,8,["onClick"]),[[Vt]]),e(ct,{onClick:n.salvar,label:"Salvar",color:"primary","no-ripple":"",unelevated:""},null,8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}var Re=re(Ne,[["render",Ue]]);const Me={components:{ModalEditarProdutoCompras:Re,PromptItemV2:be},data(){const o={ehOrcamento:!0,adicionar:{modal:{value:!1,name:""}},dataPrevistaEntrega:"",horaPrevistaEntrega:"",contatos:{},produtos:[],formasDePagamento:[],visivel:!1,somenteLeitura:!1,condicaoPagamentoRules:[async()=>{const l=this.compra.condicaoPagamento;return/^[\d/]*$/.test(l)}],formaPagamentoRules:[async()=>{const l=this.compra.formaDePagamento;return/^[^\d\s][a-zA-Z\s]*[^\d\s]$/.test(l)}],erroDesconto:!1,erroFrete:!1,erroSeguro:!1,erroOutrasDespesas:!1,exibeInfNota:!1,documentoNovo:!1,valorTotalPagamento:0,sku:0,operacao:"",alterarPrevisaoEntrega:!1};return this.limpaCampos(o),o},emits:["atualizar","dialogImprimirEtiquetas"],computed:{skus(){return this.compraItens.length>0?`${Number(this.compraItens.length)}`:"0"}},methods:{editarProduto(o){const l=this.produtos[o.idItem],h=this.compra;this.$refs.ModalEditarProdutoCompras.mostrar(o,l,h)},removerItem(o){this.compraItens=this.compraItens.filter(l=>l.id!==o.id),this.calcularTotais()},fecharEdicaoProduto(o){const l=this.compraItens.findIndex(h=>h.id===o.id);this.compraItens[l]=$utils.clonar(o),this.calcularTotaisItem(l)},async atualizar(){var h,k;this.compraOriginal=await $db.hibrido.le({table:"documento",id:this.compra.id}),this.compra=$utils.clonarV2(this.compraOriginal),$utils.verificarErro(!this.compra.id,"Compra n\xE3o encontrada"),this.compraItensOriginal=(await $db.hibrido.lista({table:"documentoItem",where:{idDocumento:this.compra.id}})).sort((a,n)=>new Date(a.dataHoraEmissao||0)-new Date(n.dataHoraEmissao||0)),this.compraItens=$utils.clonarV2(this.compraItensOriginal),this.compraCondicoesDePagamentoOriginal=(await $db.hibrido.lista({table:"documentoCondicaoPagamento",where:{idDocumento:this.compra.id}})).sort((a,n)=>new Date(a.dataVencimento||0)-new Date(n.dataVencimento||0)),this.compraCondicoesDePagamento=$utils.clonarV2(this.compraCondicoesDePagamentoOriginal),this.compraTitulosOriginal=await $db.hibrido.lista({table:"financeiroTitulo",where:{documentoId:this.compra.id}}),this.compraTitulos=$utils.clonarV2(this.compraTitulosOriginal),this.compraMovimentacoesOriginal=await $db.hibrido.lista({table:"financeiroMovimentacao",where:{documentoId:this.compra.id}}),this.compraMovimentacoes=$utils.clonarV2(this.compraMovimentacoesOriginal),this.compraDocumentoXmlOriginal=await $db.hibrido.lista({table:"documentoXML",where:{idDocumento:this.compra.id}}),this.compraDocumentoXml=$utils.clonarV2(this.compraDocumentoXmlOriginal),this.compra.totalComImposto=!0,this.compra.calcularTributacao=(h=this.compra.calcularTributacao)!=null?h:!0,this.compra.naoGerarFinanceiro=(k=this.compra.naoGerarFinanceiro)!=null?k:!1;const o=[this.compra.idEmpresa,this.compra.idContato,this.compra.idContatoComprador,this.compra.idContatoVendedor,this.compra.idContatoTransportadora].filter(Boolean);this.carregarImagensContatos(o);const l=this.compraItens.map(({idItem:a})=>a).filter(Boolean);if(this.carregarImagensItens(l),this.valorTotalPagamento===0)for(const a of this.compraCondicoesDePagamento)this.valorTotalPagamento=this.valorTotalPagamento+a.valor;this.compra.dataHoraPrevisto&&(this.dataPrevistaEntrega=this.compra.dataHoraPrevisto.slice(0,10),this.horaPrevistaEntrega=this.compra.dataHoraPrevisto.slice(11,16)),this.exibeInfNota=!0},async carregarContatos(o){const l=await $db.hibrido.lista({table:"contato",columns:["id","apelido","imagem"],whereIn:{id:o}});for(const h of l)this.contatos[h.id]=h},async carregarImagensContatos(o){if(!!o.length){await $utils.dormir(200);try{await this.carregarContatos(o)}catch(l){console.error("Erro ao carregar imagens de contatos - ",l)}}},async carregarItens(o){const l=await $db.hibrido.lista({table:"item",columns:["id","descricao","imagem","valorCustoReposicao","marca","referencia","codigoItem"],whereIn:{id:o}});for(const h of l)this.produtos[h.id]=h},async carregarImagensItens(o){if(!!o.length){await $utils.dormir(200);try{await this.carregarItens(o)}catch(l){console.error("Erro ao ler imagens de itens - ",l)}}},async salvar_click(){await $tryLoading(async()=>{if(this.compra.idContato||(this.compra.idContato=$db.usuario.logado.id),this.dataPrevistaEntrega){const o=`${this.dataPrevistaEntrega} ${this.horaPrevistaEntrega||"00:00:00"}`;this.compra.dataHoraPrevisto=Ot.formatDate(o)}await this.salvar(),this.$emit("atualizar",{aba:"Digita\xE7\xE3o"}),this.ocultarModal(),$q.notifyPositive(this.compra.operacao==="Nota de Entrada"?"A Nota de Entrada foi salva com sucesso.":"O Pedido de Compra foi salvo com sucesso.")},{mensagem:"Salvando..."})},async excluir_click(){!await $q.dialogSimNao({title:"Excluir compra",message:`Deseja excluir ${this.compra.operacao==="Pedido de Compra"?`o ${this.compra.operacao}?`:`a ${this.compra.operacao}?`}`})||await $tryLoading(async()=>{this.visivel=!1,this.operacao=this.compra.operacao,this.compra={},this.compraCondicoesDePagamento=[],this.compraItens=[],this.compraMovimentacoes=[],this.compraTitulos=[],this.compraDocumentoXml=[],await this.salvar(),await this.fechar(),$q.notifyPositive(this.compra.operacao==="Nota de Entrada"?"A Nota de Entrada foi excluida com sucesso.":"O Pedido de Compra foi excluido com sucesso.")},{mensagem:"Excluindo..."})},async criar(){await $tryLoading(async()=>{const o=(await $db.contato.ler({filtros:{ativo:!0,empresas:!0}})).data;if(!(o.length>0)){this.$q.notify({message:"N\xE3o h\xE1 empresa configurada",timeout:0,type:"negative",closeBtn:!0});return}let l=o[0];if(o.length>1){const a={ativo:!0,empresas:!0};if(l=await $g.promptContato.show({filtro:a,placeholder:"Selecione a empresa"}),!l){this.ocultarModal();return}}const h=(await $db.hibrido.lista({table:"empresa",where:{idContato:l.id}}))[0];if(!h){this.ocultarModal(),this.$q.notifyError("Erro ao selecionar empresa");return}if(this.contatos[l.id]||await this.carregarContatos([l.id]),this.limpaCampos(this),this.compra={id:$utils.uuid(),tipo:"Compra",operacao:"Pedido de Compra",status:"Digita\xE7\xE3o",descricaoEmpresa:h.nome,numeroDocumentoEmpresa:h.numeroDocumentoNacional,descricaoContato:"",idContatoComprador:null,dataHoraEmissao:$utils.dataAtual(),tipoFrete:"CIF",tipoTransporte:null,idEmpresa:h.idContato,idContato:null,totalDesconto:0,totalPercentualDesconto:0,calcularTributacao:!0,totalComImposto:!0,naoGerarFinanceiro:!1,freteSeparado:!1,dataHoraPrevisto:null,valorBaseIcms:0,valorIcms:0,valorBaseIcmsSt:0,valorIcmsSt:0,valorOutrasDespesas:0},!await this.abrirModalFornecedor()){this.ocultarModal();return}this.documentoNovo=!0,this.exibeInfNota=!0,this.visivel=!0})},async validaCampos(){try{if($utils.verificarErro(!this.compra.descricaoContato,"N\xE3o \xE9 permitido finalizar a compra sem informar o fornecedor!"),$utils.verificarErro(!this.compraItens.length,"N\xE3o \xE9 permitido finalizar compra sem itens!"),!this.compra.naoGerarFinanceiro){const o=$utils.arredondar(this.compraCondicoesDePagamento.reduce((l,h)=>l+h.valor,0));$utils.verificarErro(!this.compra.formaDePagamento,"N\xE3o \xE9 permitido finalizar a compra sem informar a forma de pagamento!"),$utils.verificarErro(this.compraCondicoesDePagamento.length>0&&this.compra.totalDocumento!==o,"N\xE3o \xE9 permitido finalizar a compra se o valor total difere da soma das parcelas!"),$utils.verificarErro(this.compraCondicoesDePagamento.length===0,'Verifique se a op\xE7\xE3o "N\xE3o gerar financeiro" est\xE1 marcada, ou adicione as parcelas para finalizar a compra!')}return this.compra.operacao==="Nota de Entrada"&&($utils.verificarErro(!this.compra.notaNumero,"N\xE3o \xE9 permitido finalizar a compra sem informar o n\xFAmero da Nota de Entrada!"),$utils.verificarErro(!this.compra.notaSerie,"N\xE3o \xE9 permitido finalizar a compra sem informara s\xE9rie da Nota de Entrada!"),$utils.verificarErro(!this.compra.naturezaOperacao,"N\xE3o \xE9 permitido finalizar a compra sem informar natureza de opera\xE7\xE3o da Nota de Entrada!"),$utils.verificarErro(!this.compra.dataCompra,"N\xE3o \xE9 permitido finalizar a compra sem informar a data de compra da Nota de Entrada!"),$utils.verificarErro(!this.compra.chaveAcesso,"N\xE3o \xE9 permitido finalizar a compra sem informar a chave de acesso da Nota de Entrada!")),!0}catch(o){return $q.notifyError("Ocorreu um erro na valida\xE7\xE3o de campos",o),!1}},async finalizar_click(){if(!await this.validaCampos())return;let o=!1;this.compra.naoGerarFinanceiro||(o=await $q.dialogSimNao({title:"Gerar Financeiro",message:"Deseja gerar as provis\xF5es financeiras?"})),await $tryLoading(async()=>{this.compra.status="Finalizado",this.compra.dataHoraFinalizado=$utils.dataAtual(),this.compra.provisaoCompra=o?1:void 0,await this.finalizarItens(),o&&await this.gerarFinanceiro(),await this.salvar(),this.$emit("atualizar",{aba:"Finalizado"}),this.ocultarModal(),$q.notifyPositive("Compra finalizada com sucesso!"),o&&$q.notifyPositive("Provisionamento gerado com sucesso!")},{mensagem:"Finalizando Compra..."})},finalizarItens(){var n,m;let o=1,l=0,h=0,k=!1;const a=this.compra;if(a.subTotalProduto>0&&(a.tipoFrete==="FOB"&&a.freteSeparado===0&&(l=(a.valorFrete||0)+(a.valorSeguro||0)),o=((a.subTotalProduto||0)+(a.valorOutrasDespesas||0)-(a.totalDesconto||0)+(l||0))/(a.subTotalProduto||1)),h=this.compraItens.reduce((t,c)=>t+c.valorIcmsSt,h),h!==a.valorIcmsSt&&(k=!0),a.operacao==="Nota de Entrada")for(const t of this.compraItens)t.dataCompra=$utils.dataAtual(),k&&(t.valorIcmsSt=a.valorIcmsSt*((t==null?void 0:t.total)||0)/(a.subTotalProduto>0?a.subTotalProduto:1)),t.valorFreteRateado=a.valorFrete*(((t==null?void 0:t.total)||0)/(a.subTotalProduto||1)),t.valorSeguroRateado=a.valorSeguro*(((t==null?void 0:t.total)||0)/(a.subTotalProduto||1)),t.valorOutrasDespesasRateado=(a.valorOutrasDespesas||0)*(((t==null?void 0:t.total)||0)/(a.subTotalProduto||1)),t.descontoTotalRateado=(a.totalDesconto||0)*(((t==null?void 0:t.total)||0)/(a.subTotalProduto||1)),(t==null?void 0:t.valorIcmsSt)-(t==null?void 0:t.valorIcms)>0&&((t==null?void 0:t.valorIcmsSt)||0)-((t==null?void 0:t.valorIcms)||0),t.valorRealTotal=((t==null?void 0:t.total)||0)*o+((t==null?void 0:t.valorIpi)||0)+((t==null?void 0:t.valorIcms)||0),t.valorRealTotalImpostos=((t==null?void 0:t.total)||0)+t.valorFreteRateado+t.valorSeguroRateado+t.valorOutrasDespesasRateado-t.descontoTotalRateado+((t==null?void 0:t.valorIpi)||0)+((t==null?void 0:t.valorIcmsSt)||0),t.valorReal=t.valorRealTotalImpostos/((t==null?void 0:t.quantidade)||1),t.valorCustoReposicao=((n=this.produtos[t.idItem])==null?void 0:n.valorCustoReposicao)||0;if(a.operacao==="Pedido de Compra")for(const t of this.compraItens){k&&(t.valorIcmsSt=$utils.arredondar(a.valorIcmsSt*(t.total||0)/(a.subTotalProduto>0?a.subTotalProduto:1))),t.valorFreteRateado=$utils.arredondar((a.valorFrete||0)*(t.total||0)/(a.subTotalProduto||1),4),t.valorSeguroRateado=$utils.arredondar((a.valorSeguro||0)*(t.total||0)/(a.subTotalProduto||1),4),t.valorOutrasDespesasRateado=$utils.arredondar((a.valorOutrasDespesas||0)*(t.total||0)/(a.subTotalProduto||1),4),t.descontoTotalRateado=$utils.arredondar((a.totalDesconto||0)*(t.total||0)/(a.subTotalProduto||1),4);let c=0;t.valorIcmsSt-t.valorIcms>0&&(c=$utils.arredondar((t.valorIcmsSt||0)-(t.valorIcms||0),2)),t.valorRealTotal=$utils.arredondar((t.total||0)*o+(t.valorIpi||0)+(c>0?c:0),2),t.valorRealTotalImpostos=$utils.arredondar((t.total||0)+t.valorFreteRateado+t.valorSeguroRateado+t.valorOutrasDespesasRateado-t.descontoTotalRateado+(t.valorIpi||0)+(t.valorIcmsSt||0),4),t.valorReal=$utils.arredondar(t.valorRealTotalImpostos/(t.quantidade||1),4),t.valorCustoReposicao=$utils.arredondar(((m=this.produtos[t.idItem])==null?void 0:m.valorCustoReposicao)||0,2)}},async transformarEmNotaDeEntrada_click(){this.compra.operacao==="Pedido de Compra"&&await $tryLoading(async()=>{var h;const o=this.compraItens.map(({idItem:k})=>k).filter(Boolean),l=await $db.hibrido.lista({table:"itemFornecedor",whereIn:{idItem:o},whereFilter:{idContato:this.compra.idContato}});for(const k of this.compraItens)if(!l.some(({idItem:a})=>a===k.idItem)){const a={id:$utils.uuid(),idItem:k.idItem,idContato:this.compra.idContato,referencia:"",descricao:k.descricaoItem};await $db.hibrido.grava("itemFornecedor",{atual:a,original:{}})}for(const k of this.compraTitulos)k.formaDePagamento=(h=this.compra.formaDePagamento)!=null?h:"";this.compra.operacao="Nota de Entrada",this.compra.dataHoraFinalizado="",this.compra.status="Digita\xE7\xE3o",await this.salvar(),this.$emit("atualizar",{aba2:"Nota de Entrada",aba:"Digita\xE7\xE3o"}),this.ocultarModal(),$q.notifyPositive("Nota de Entrada gerada com sucesso!")},{mensagem:"Processando..."})},async mostrar({id:o}){this.visivel=!0;const l=$utils.logarIni("ComprasFicha");await $tryLoading(async()=>{this.compra.id=o,await this.atualizar()}),$utils.logarFim(l,1)},fechar(){this.compra.status==="Finalizado"?this.$emit("atualizar",{aba:"Finalizado"}):this.$emit("atualizar",{aba:"Digita\xE7\xE3o"}),this.ocultarModal(),this.dataPrevistaEntrega="",this.horaPrevistaEntrega="",this.produtos=[],this.limpaCampos(this),this.formasDePagamento=[],this.documentoNovo=!1,this.exibeInfNota=!1,this.valorTotalPagamento=0},ocultarModal(){this.visivel=!1},async abrirModalEmpresa(){const o={ativo:!0,empresas:!0},l=await $g.promptContato.show({filtro:o,placeholder:"Selecione"});if(!l)return;let h=(await $db.hibrido.lista({table:"empresa",where:{idContato:l.id}}))[0];if(!h){this.ocultarModal(),this.$q.notifyError("Erro ao selecionar empresa");return}this.contatos[l.id]||await this.carregarContatos([l.id]),this.compra.descricaoEmpresa=h.nome,this.compra.idEmpresa=h.idContato,this.compra.numeroDocumentoEmpresa=h.numeroDocumentoNacional,this.compra.InscricaoMunicipalEmpresa=h.InscricaoMunicipalEmpresa},async abrirModalComprador(){const o=await this.selecionarContato({placeholder:"Selecione o comprador",filtro:{ativo:!0,compradores:!0}});o.id&&(this.compra.idContatoComprador=o.id),this.contatos[o.id]||await this.carregarContatos([o.id])},async abrirModalFornecedor(){const o={ativo:!0},l=await $g.promptContato.show({filtro:o,placeholder:"Selecione o fornecedor"});if(!l)return l;const h=await $db.contatoTelefone.le({idContato:l.id}),k=await $db.contatoEndereco.le({idContato:l.id}),a=h.find(t=>t.tipoTelefone==="Principal"||t.tipoTelefone==="WhatsApp")||h[0]||null,n=k.find(t=>t.grupo==="Principal")||k[0]||null;let m;return n&&Object.keys(n).length>0&&(m=`${n.logradouro}, ${n.numero} ${n.complemento} - ${n.bairro} - ${n.municipio}/${n.uf}`),l.id&&(this.compra.idContato=l.id,this.compra.descricaoContato=l.nome,this.compra.numeroDocumentoContato=l.numeroDocumentoNacional,this.compra.emailContato=(l==null?void 0:l.email)||null,this.compra.regimeContato=(l==null?void 0:l.regime)||null,this.compra.telefoneContato=(a==null?void 0:a.telefone)||null,this.compra.descricaoContatoEndereco=m||null),this.contatos[l.id]||await this.carregarContatos([l.id]),l},async abrirModalVendedor(){const o=(await $db.contato.leFilhos(this.compra.idContato)).map(h=>h.id),l=await this.selecionarContato({placeholder:"Selecione o vendedor",filtro:{ativo:!0,usuarios:o}});l.id&&(this.compra.idContatoVendedor=l.id),this.contatos[l.id]||await this.carregarContatos([l.id])},async abrirModalTransportador(){const o=await this.selecionarContato({placeholder:"Selecione o transportadora",filtro:{ativo:!0,transportadoras:!0}});o.id&&(this.compra.idContatoTransportadora=o.id),this.contatos[o.id]||await this.carregarContatos([o.id])},async selecionarContato(o){const{placeholder:l,filtro:h}={placeholder:"Selecione o contato",filtro:{ativo:!0},...o},k=await $g.promptContato.show({filtro:h,placeholder:l});if(!k)throw new Error("Contato n\xE3o selecionado");return k},async adicionarItem(){let o={},l=[];for(const h of l)o[h.idItem]={item:await $db.hibrido.le({table:"item",id:h.idItem}),quantidade:h.quantidade};this.adicionar.modal.value=!0,this.adicionar.modal.name="Item"},async selecionarItens(o){var l,h;for(const k in o){let a=await $db.hibrido.lista({table:"estoqueSaldoProdutoEmpresa",whereFilter:{idEmpresa:this.compra.idEmpresa,tipoEstoque:"Dispon\xEDvel",idItem:k}});a=a[0];const n=await $db.configuracoes.porNome("vendas.checaestoque",this.compra.idEmpresa);Number((l=n.find(i=>i.id))==null?void 0:l.valor);const m=o[k].item||{},t=((h=(await $db.hibrido.lista({table:"itemFornecedor",whereFilter:{idItem:m.id}}))[0])==null?void 0:h.referencia)||null,c=o[k].quantidade||0,b=(m==null?void 0:m.valorCustoReposicao)||(a==null?void 0:a.valorCustoMedio)||0;let w=this.compraItens.find(i=>i.idItem===k);const g=(await $erp().cfop.where({cfop:5102}).toArray())[0],v=await $db.financeiroPlanoConta.lePorConfig("financeiro.planocontas.comprageral");if(w)w.quantidade=$utils.arredondar(c,4),w.quantidadeRealizado=$utils.arredondar(c,4),w.subTotal=$utils.arredondar(b,2),w.total=$utils.arredondar(c*b,2);else{const i={dataHoraEmissao:$utils.dataAtual(),dataHoraFinalizado:"",descricaoItem:m.descricao,id:$utils.uuid(),idDocumento:this.compra.id,idItem:m.id,referencia:m.referencia,referenciaFornecedor:t,ncm:m.ncm||null,operacao:"Compra de Mercadoria",operacaoFator:1,idCfop:g==null?void 0:g.id,idPlanoContaEstoque:v==null?void 0:v.id,quantidade:$utils.arredondar(c,4),quantidadeRealizado:$utils.arredondar(c,4),status:"Digita\xE7\xE3o",tipoItem:m.tipo,subTotal:$utils.arredondar(b,2),total:$utils.arredondar(c*b,2),unidade:m.unidade,valorCustoMedio:(a==null?void 0:a.valorCustoMedio)||0,valorItem:b,valorOriginal:b,observacao:""};this.compraItens.push(i),await this.carregarItens([m.id])}this.compra.subTotal=0,this.compra.subTotalProduto=0;for(let i in this.compraItens)this.compra.subTotal+=this.compraItens[i].total,this.compra.subTotalProduto+=this.compraItens[i].total;this.compra.subTotal=$utils.arredondar(this.compra.subTotal,2),this.compra.totalDocumento=this.compra.subTotal}},formatXml(o,l="  "){let h="",k="";return o.split(/>\s*</).forEach(a=>{a.match(/^\/\w/)&&(k=k.substring(l.length)),h+=k+"<"+a+`>
`,a.match(/^<?\w[^>]*[^\/]$/)&&(k+=l)}),h.substring(1,h.length-3)},calcularTotaisItem(o,l){const h=$utils.clonar(this.compraItens[o]),k=h.valorOriginal||0,a=h.quantidade||0;let n=h.valorItem||0,m=h.descontoPercentualItem||0,t=h.descontoItem||0,c=h.subTotal||0,b=h.total||0;l==="descontoPercentualItem"&&((m<0||m>100)&&(m=0),t=n*m/100,c=n-t),l==="descontoItem"&&((t<0||t>n)&&(t=0),m=t/n*100,c=n-t),l==="valorItem"&&(n<k&&(n=k),t>n&&(t=0,m=0),m=t/n*100,c=n-t),l==="subTotal"&&((c<0||c>n)&&(c=n),t=n-c,m=t/n*100),b=a*c,h.valorItem=n,h.descontoItem=t,h.descontoPercentualItem=m,h.subTotal=c,h.total=b,this.compraItens[o]=h,this.calcularTotais("totalDesconto")},calcularTotais(o){const l=$utils.clonar(this.compra);let h=0,k=0,a=0,n=l.totalDesconto||0,m=l.totalPercentualDesconto||0,t=l.valorFrete||0,c=l.valorSeguro||0,b=l.valorOutrasDespesas||0,w=0,g=0,v=0,i=0,I=0;this.erroFrete=!1,this.erroSeguro=!1,this.erroOutrasDespesas=!1;for(const r of this.compraItens)h+=r.total,w+=r.valorBaseIcms||0,g+=r.valorIcms||0,v+=r.valorBaseIcmsSt||0,i+=r.valorIcmsSt||0,I+=r.valorIpi||0;o==="totalPercentualDesconto"&&(this.erroDesconto=!1,(m<0||m>100)&&(this.erroDesconto=!0),n=h*m/100),o==="totalDesconto"&&(this.erroDesconto=!1,(n<0||n>h)&&(this.erroDesconto=!0),m=n/h*100),t<0&&(this.erroFrete=!0),t=l.tipoFrete==="FOB"?t:0,c<0&&(this.erroSeguro=!0),c=l.tipoFrete==="FOB"?c:0,b<0&&(this.erroOutrasDespesas=!0),l.calcularTributacao||(w=0,g=0,v=0,i=0),l.totalComImposto||(I=0),k=h-n+t+c+b,a=k+I,l.valorBaseIcms=$utils.arredondar(w,2),l.valorIcms=$utils.arredondar(g),l.valorBaseIcmsSt=$utils.arredondar(v),l.valorIcmsSt=$utils.arredondar(i),l.valorIpi=$utils.arredondar(I),l.totalDesconto=$utils.arredondar(n),l.totalPercentualDesconto=$utils.arredondar(m),l.subTotalProduto=$utils.arredondar(h),l.totalProduto=$utils.arredondar(h)-$utils.arredondar(n),l.subTotal=$utils.arredondar(k),l.totalDocumento=$utils.arredondar(a),this.compra=l},limpaCampos(o){o.compra={},o.compraOriginal={},o.compraItens=[],o.compraItensOriginal=[],o.compraCondicoesDePagamento=[],o.compraCondicoesDePagamentoOriginal=[],o.compraTitulos=[],o.compraTitulosOriginal=[],o.compraMovimentacoes=[],o.compraMovimentacoesOriginal=[],o.compraDocumentoXml=[],o.compraDocumentoXmlOriginal=[]},async salvar(){this.compra.totalComImposto&&delete this.compra.totalComImposto;for(const o of this.compraItens)o.dataHoraFinalizado=this.compra.dataHoraFinalizado,o.status=this.compra.status;this.compra.id?await $db.hibrido.grava("documento",{atual:this.compra,original:this.compraOriginal}):this.compraOriginal.id&&await $db.hibrido.remove("documento",this.compraOriginal),await $db.hibrido.gravaLista("documentoItem",{atual:this.compraItens,original:this.compraItensOriginal}),await $db.hibrido.gravaLista("documentoCondicaoPagamento",{atual:this.compraCondicoesDePagamento,original:this.compraCondicoesDePagamentoOriginal}),await $db.hibrido.gravaLista("financeiroTitulo",{atual:this.compraTitulos,original:this.compraTitulosOriginal}),await $db.hibrido.gravaLista("financeiroMovimentacao",{atual:this.compraMovimentacoes,original:this.compraMovimentacoesOriginal}),await $db.hibrido.gravaLista("documentoXML",{atual:this.compraDocumentoXml,original:this.compraDocumentoXmlOriginal}),this.compra.totalComImposto=!0,this.calculaKardex()},async calculaKardex(){const o=$utils.logarIni("calculaKardex"),l=this.compraItens.map(({idItem:h})=>h).filter(Boolean);try{l.length&&await $utils.geeksApi({calculaKardex:{funcao:"9913E9FD-24A5-4C0A-9F1E-AACCDC7EAB9D",idsItem:l}})}catch(h){console.error(`Erro ao calcular Kardex
`,h)}$utils.logarFim(o,l.length)},async reabrir_click(){!await $q.dialogSimNao({title:"Reabertura",message:`Deseja reabrir o documento?<br/>${this.compra.naoGerarFinanceiro?"":"<strong>O Financeiro ser\xE1 apagado!</strong>"}`,html:!0})||await $tryLoading(async()=>{await this.retornarParaDigitacao(),await this.salvar(),await this.atualizar(),$q.notifyPositive("Documento reaberto para digita\xE7\xE3o!")},{mensagem:"Reabrindo..."})},async retornarParaDigitacao(){$utils.verificarErro(this.compra.status!=="Finalizado","N\xE3o \xE9 poss\xEDvel realizar esta opera\xE7\xE3o em documento n\xE3o finalizado.");const o=this.compraTitulos.filter(({dataPagamento:l})=>l);$utils.verificarErro(o.length,"N\xE3o \xE9 poss\xEDvel excluir o Financeiro. Parcelas provisionadas j\xE1 pagas!"),this.compra.dataHoraFinalizado="",this.compra.status="Digita\xE7\xE3o",this.compra.operacao==="Pedido de Compra"&&(this.compraTitulos=[],this.compraMovimentacoes=[])},async removerPagamento_click(o){try{this.compraCondicoesDePagamento=this.compraCondicoesDePagamento.filter(l=>l.id!==o.id),this.compraCondicoesDePagamento.sort((l,h)=>{let k=new Date(l.dataVencimento),a=new Date(h.dataVencimento);return k-a}),await this.atualizaValorTotalPagamento({condicao:o,acao:"remover"})}catch(l){console.log(l.message)}},async gerarCondicoesDePagamento_click(){var o;try{let l=this.compra.id,h=this.compra.condicaoPagamento,k=(o=this.compra.notaNumero)!=null?o:null;this.compra.naoGerarFinanceiro||await this.gerarParcelamento(l,h,k),this.compra.naoGerarFinanceiro&&(this.compraCondicoesDePagamento=[])}catch(l){console.log(l.message)}},async gerarParcelamento(o,l,h){var g;this.compraCondicoesDePagamento=[];const k=$utils.clonar(this.compra),a=l.split("/").length,n=!!(k!=null&&k.dataCompra)&&(k==null?void 0:k.dataCompra)!==""?k.dataCompra:!!(k!=null&&k.dataHoraPrevisto)&&(k==null?void 0:k.dataHoraPrevisto)!==""?k.dataHoraPrevisto:!!this.dataPrevistaEntrega&&this.dataPrevistaEntrega!==""?new Date(this.dataPrevistaEntrega):$utils.dataAtual(),m=(k==null?void 0:k.freteSeparado)||0;let t=$utils.arredondar(k==null?void 0:k.totalDocumento,2);const c=((k==null?void 0:k.valorFrete)||0)+((k==null?void 0:k.valorSeguro)||0);if(m&&(k==null?void 0:k.tipoFrete)==="FOB"&&c>0){let v={id:$utils.uuid(),idDocumento:k==null?void 0:k.id,dataVencimento:n,valor:c,observacao:"Valor Frete + Seguro",freteSeparado:!0};this.compraCondicoesDePagamento.push(v),t-=c}let b=0,w=t/a;for(let v in l.split("/")){let i=!!(k!=null&&k.dataCompra)&&(k==null?void 0:k.dataCompra)!==""?k.dataCompra:!!(k!=null&&k.dataHoraPrevisto)&&(k==null?void 0:k.dataHoraPrevisto)!==""?k.dataHoraPrevisto:!!this.dataPrevistaEntrega&&this.dataPrevistaEntrega!==""?new Date(this.dataPrevistaEntrega):$utils.dataAtual();typeof i=="string"&&(i=(g=new Date(i))!=null?g:$utils.dataAtual()),i.setDate(i.getDate()+parseInt(l.split("/")[v])||0);let I={id:$utils.uuid(),idDocumento:k==null?void 0:k.id,dataVencimento:Ot.formatDate(i),valor:w,observacao:""};this.compraCondicoesDePagamento.push(I),b+=w||0}t!==b&&(this.compraCondicoesDePagamento[0].valor+=(t||0)-(b||0)),this.valorTotalPagamento=m&&(k==null?void 0:k.tipoFrete)==="FOB"?t+c:t},async gerarFinanceiro(){var m,t;const o=await $db.financeiroPlanoConta.lePorConfig("financeiro.planocontas.comprageral"),l=[];for(const c of this.compraItens){if(c.idPlanoContaEstoque===o.id)continue;const b=(c.total||0)-(c.descontoTotalRateado||0),w=l.findIndex(({idPlanoContaEstoque:g})=>g===c.idPlanoContaEstoque);w!==-1?l[w].valor+=b:l.push({idPlanoContaEstoque:c.idPlanoContaEstoque,idPlanoContaDestino:"",valor:b,porcentagem:0})}for(const c of l)c.valor=$utils.arredondar(c.valor),c.porcentagem=$utils.arredondar(c.valor/this.compra.totalDocumento,4);const h=await $db.financeiroPlanoConta.lePorConfig("financeiro.planocontas.freteaquisicao"),k=this.compraTitulos.filter(({dataPagamento:c})=>c);$utils.verificarErro(k.length,"N\xE3o \xE9 poss\xEDvel regerar o Financeiro. Parcelas provisionadas j\xE1 pagas!");const a=Ot.formatDate(new Date().setHours(0,0,0,0));this.compraTitulos=[];for(const c in this.compraCondicoesDePagamento){const b=this.compraCondicoesDePagamento[c],w=[b.observacao,this.compra.codigoDocumento?`Pedido de Compra: ${this.compra.codigoDocumento}`:"",this.compra.notaNumero?`Nota nro: ${this.compra.notaNumero}`:""].filter(Boolean).join(" | "),g={id:$utils.uuid(),dataEmissao:a,dataCompetencia:a,dataVencimento:Ot.formatDate(new Date(b.dataVencimento).setHours(0,0,0,0)),dataVencimentoOriginal:Ot.formatDate(new Date(b.dataVencimento).setHours(0,0,0,0)),valor:$utils.arredondar(b.valor,2),tipoJuros:"dia",valorMulta:0,percentualJuros:0,documentoTipo:this.compra.operacao,parcela:`${Number(c)+1}/${this.compraCondicoesDePagamento.length}`,descricao:this.compra.operacao,observacao:w,formaDePagamento:this.compra.operacao!=="Pedido de Compra"?`Provis\xE3o Pedido - ${(m=this.compra.formaDePagamento)!=null?m:""}`:(t=this.compra.formaDePagamento)!=null?t:"",receberPagar:0,valorOriginal:$utils.arredondar(b.valor,2),documentoVinculado:1,valorTotal:$utils.arredondar(b.valor,2),valorARealizar:$utils.arredondar(b.valor,2),valorDesconto:0,percentualDesconto:0,idEmpresa:this.compra.idEmpresa,idContato:(b==null?void 0:b.freteSeparado)&&!!this.compra.idContatoTransportadora?this.compra.idContatoTransportadora:this.compra.idContato,idFinanceiroPlanoConta:b.observacao==="Valor Frete + Seguro"?h.id:o==null?void 0:o.id,documentoId:this.compra.id,idFinanceiroMovimentacaoAgrupamentoAutomatico:$utils.uuid(),cobrancaAtivo:1};this.compraTitulos.push(g)}const n=$utils.uuid();this.compraMovimentacoes=[];for(const c of l){const b={id:$utils.uuid(),idFinanceiroMovimentacaoN:n,idEmpresa:this.compra.idEmpresa,idFinanceiroPlanoConta:o.id,dataEmissao:a,valorCredito:this.compra.totalDocumento*c.porcentagem,valorDebito:0,descricao:o.descricao.trim(),observacao:"",automatico:0,liquidando:0,dataCompetencia:a,dataVencimento:a,dataMovimento:a,documentoTipo:this.compra.operacao,documentoId:this.compra.id};this.compraMovimentacoes.push(b);const w=await $db.financeiroPlanoConta.leCache({id:c.idPlanoContaEstoque}),g={id:$utils.uuid(),idFinanceiroMovimentacaoN:n,idEmpresa:this.compra.idEmpresa,idFinanceiroPlanoConta:c.idPlanoContaEstoque,dataEmissao:a,valorCredito:0,valorDebito:this.compra.totalDocumento*c.porcentagem,descricao:w.descricao.trim(),observacao:"",automatico:0,liquidando:0,dataCompetencia:a,dataVencimento:a,dataMovimento:a,documentoTipo:this.compra.operacao,documentoId:this.compra.id};this.compraMovimentacoes.push(g)}},async atualizaValorTotalPagamento({condicao:o,acao:l}){!o||l==="remover"&&(this.valorTotalPagamento=this.valorTotalPagamento-o.valor)},async ajustarPrevisaoEntrega(o){o==="alterar"&&(this.alterarPrevisaoEntrega=!0),o==="salvar"&&(await $tryLoading(async()=>{const l=`${this.dataPrevistaEntrega} ${this.horaPrevistaEntrega||"00:00:00"}`;$utils.verificarErro(!this.dataPrevistaEntrega&&this.horaPrevistaEntrega,"\xC9 necess\xE1rio preencher uma data em conjunto com a hora."),Ot.formatDate(l)!==Ot.formatDate(this.compra.dataHoraPrevisto)?(this.compra.dataHoraPrevisto=Ot.formatDate(l)||"",await this.salvar(),await this.atualizar(),$q.notifyPositive("A previs\xE3o foi salva com sucesso")):$q.notifyPositive("N\xE3o h\xE1 dados alterados.")}),this.alterarPrevisaoEntrega=!1)},dialogImprimirEtiquetas(o,l){this.$emit("dialogImprimirEtiquetas",{acao:o,item:l})}}},Le={class:"row items-center"},je={class:"col-auto"},$e={class:"col-auto"},He=ft("span",{class:"q-px-xs"},"|",-1);function Ze(o,l,h,k,a,n){const m=mt("g-label"),t=mt("g-col"),c=mt("Badge"),b=mt("BadgeCopiarUid"),w=mt("g-row"),g=mt("avatar"),v=mt("campo"),i=mt("ModalEditarProdutoCompras"),I=mt("PromptItemV2");return Q(),wt(Pt,null,[e(Zt,{modelValue:o.visivel,"onUpdate:modelValue":l[33]||(l[33]=r=>o.visivel=r),persistent:"",maximized:"",onKeyup:ve(n.fechar,["esc"])},{default:s(()=>[e(Lt,{view:"hHh lpR lFr",container:"",class:"bg-light"},{default:s(()=>[e(jt,null,{default:s(()=>[e(Tt,null,{default:s(()=>[e(ct,{onClick:n.fechar,icon:"arrow_back",flat:"",round:"",dense:""},null,8,["onClick"]),e(Ut,null,{default:s(()=>[R(J(o.compra.operacao),1)]),_:1}),bt(e(ct,{onClick:n.salvar_click,label:"Salvar",color:"white","text-color":"primary",unelevated:"",class:"q-ml-sm"},null,8,["onClick"]),[[Dt,o.compra.status==="Digita\xE7\xE3o"]])]),_:1})]),_:1}),e($t,{class:"u-container"},{default:s(()=>[e(Ht,null,{default:s(()=>[e(w,{gutter:"md",mg:"md",bg:"bg-white"},{default:s(()=>[e(t,{col:"12 sm12 md6"},{default:s(()=>[e(w,{items:"center",justify:"end",class:"hideondesktop"},{default:s(()=>[e(t,{col:"xs-shrink",order:"1 sm0"},{default:s(()=>[bt(e(m,{text:"caption",icon:"mdi-calendar-today sm tertiary left",tip:`Emitido \xE1s ${o.$filters.hora(o.compra.dataHoraEmissao)}`},{default:s(()=>[R(J(o.$filters.data(o.compra.dataHoraEmissao)),1)]),_:1},8,["tip"]),[[Dt,o.compra.dataHoraEmissao]])]),_:1}),e(t,{col:"xs-shrink",order:"1 sm0"},{default:s(()=>[bt(e(m,{text:"caption",icon:"mdi-calendar-today sm tertiary left",tip:`Finalizado \xE1s ${o.$filters.hora(o.compra.dataHoraFinalizado)}`},{default:s(()=>[R(J(o.$filters.data(o.compra.dataHoraFinalizado)),1)]),_:1},8,["tip"]),[[Dt,o.compra.dataHoraFinalizado]])]),_:1}),e(t,{col:"xs12 sm-shrink",order:"0 sm1",text:"right"},{default:s(()=>[e(c,{cor:o.compra.status!=="Digita\xE7\xE3o"?"tertiary":"light",escuro:o.compra.status!=="Digita\xE7\xE3o",class:"q-ml-sm"},{default:s(()=>[R(J(o.compra.status),1)]),_:1},8,["cor","escuro"]),e(b,{id:o.compra.id,numero:o.compra.numero,cor:"positive",class:"q-ml-sm"},null,8,["id","numero"])]),_:1})]),_:1}),e(w,null,{default:s(()=>[e(t,{col:"12 sm6"},{default:s(()=>[e(w,null,{default:s(()=>[e(t,{col:"xs-shrink"},{default:s(()=>{var r,p;return[e(g,{imagem:(r=o.contatos[o.compra.idContato])==null?void 0:r.imagem,rotulo:(p=o.contatos[o.compra.idContato])==null?void 0:p.apelido,tamanho:"50"},null,8,["imagem","rotulo"])]}),_:1}),e(t,{col:"xs"},{default:s(()=>{var r;return[e(v,{modelValue:(r=o.contatos[o.compra.idContato])==null?void 0:r.apelido,"somente-leitura":"",after:[{icon:"edit",handler(){n.abrirModalFornecedor()}}],disable:o.compra.status!=="Digita\xE7\xE3o",rotulo:"Fornecedor",dense:"",borderless:"",class:"q-mb-sm"},null,8,["modelValue","after","disable"])]}),_:1})]),_:1})]),_:1}),e(t,{col:"12 sm6"},{default:s(()=>{var r;return[e(v,{modelValue:(r=o.contatos[o.compra.idContatoVendedor])==null?void 0:r.apelido,"somente-leitura":"",disable:o.compra.status!=="Digita\xE7\xE3o",after:[{icon:"edit",handler(){n.abrirModalVendedor()}}],rotulo:"Vendedor",dense:"",borderless:"",class:"q-mb-sm"},null,8,["modelValue","disable","after"])]}),_:1}),e(t,{col:"12 sm6"},{default:s(()=>{var r;return[e(v,{modelValue:(r=o.contatos[o.compra.idEmpresa])==null?void 0:r.apelido,"somente-leitura":"",after:[{icon:"edit",handler(){n.abrirModalEmpresa()}}],disable:o.compra.status!=="Digita\xE7\xE3o",rotulo:"Empresa",dense:"",borderless:"",class:"q-mb-sm"},null,8,["modelValue","after","disable"])]}),_:1}),e(t,{col:"12 sm6"},{default:s(()=>{var r;return[e(v,{modelValue:(r=o.contatos[o.compra.idContatoComprador])==null?void 0:r.apelido,"somente-leitura":"",disable:o.compra.status!=="Digita\xE7\xE3o",after:[{icon:"edit",handler(){n.abrirModalComprador()}}],rotulo:"Comprador",dense:"",borderless:"",class:"q-mb-sm"},null,8,["modelValue","disable","after"])]}),_:1}),e(t,{col:"12 sm6"},{default:s(()=>{var r;return[e(v,{modelValue:(r=o.contatos[o.compra.idContatoTransportadora])==null?void 0:r.apelido,"somente-leitura":"",disable:o.compra.status!=="Digita\xE7\xE3o",after:[{icon:"edit",handler(){n.abrirModalTransportador()}}],rotulo:"Transportadora",dense:"",borderless:"",class:"q-mb-sm"},null,8,["modelValue","disable","after"])]}),_:1}),e(t,{col:"12 sm6"},{default:s(()=>[e(w,null,{default:s(()=>[e(t,{col:"7"},{default:s(()=>[e(he,{modelValue:o.dataPrevistaEntrega,"onUpdate:modelValue":l[0]||(l[0]=r=>o.dataPrevistaEntrega=r),disable:!this.alterarPrevisaoEntrega&&this.compra.status!=="Digita\xE7\xE3o",type:"date",label:"Data Prevista de Entrega",clearable:"",dense:"","stack-label":"",borderless:"",class:"q-mb-sm"},null,8,["modelValue","disable"])]),_:1}),e(t,{col:"5"},{default:s(()=>[e(he,{modelValue:o.horaPrevistaEntrega,"onUpdate:modelValue":l[1]||(l[1]=r=>o.horaPrevistaEntrega=r),disable:!this.alterarPrevisaoEntrega&&this.compra.status!=="Digita\xE7\xE3o",type:"time",label:"Hora Prevista de Entrega",clearable:"",dense:"","stack-label":"",borderless:"",class:"q-mb-sm"},null,8,["modelValue","disable"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(t,{col:"12 sm12 md6"},{default:s(()=>[e(w,{justify:"end",items:"center",text:"right",class:"hideonmobile"},{default:s(()=>[e(t,{col:"12"},{default:s(()=>[e(w,{justify:"end",items:"center"},{default:s(()=>[e(c,{cor:o.compra.status!=="Digita\xE7\xE3o"?"tertiary":"light",escuro:o.compra.status!=="Digita\xE7\xE3o"},{default:s(()=>[R(J(o.compra.status),1)]),_:1},8,["cor","escuro"]),e(b,{id:o.compra.id,numero:o.compra.numero,cor:"positive",class:"q-ml-sm"},null,8,["id","numero"]),e(ct,{color:"tertiary",flat:"",icon:"more_vert",round:""},{default:s(()=>[e(Kt,null,{default:s(()=>[bt((Q(),at(xt,{link:"",separator:""},{default:s(()=>[o.alterarPrevisaoEntrega?(Q(),at(_t,{key:1,clickable:"",onClick:l[3]||(l[3]=r=>n.ajustarPrevisaoEntrega("salvar"))},{default:s(()=>[e(tt,{avatar:""},{default:s(()=>[e(vt,{name:"local_shipping"})]),_:1}),e(tt,null,{default:s(()=>[e(pt,null,{default:s(()=>[R("Salvar Previs\xE3o de Entrega")]),_:1})]),_:1})]),_:1})):(Q(),at(_t,{key:0,disable:o.compra.status==="Digita\xE7\xE3o",clickable:"",onClick:l[2]||(l[2]=r=>n.ajustarPrevisaoEntrega("alterar"))},{default:s(()=>[e(tt,{avatar:""},{default:s(()=>[e(vt,{name:"local_shipping"})]),_:1}),e(tt,null,{default:s(()=>[e(pt,null,{default:s(()=>[R("Alterar Previs\xE3o de Entrega")]),_:1})]),_:1})]),_:1},8,["disable"])),e(_t,{onClick:l[4]||(l[4]=r=>n.dialogImprimirEtiquetas("adicionar",o.compra)),clickable:""},{default:s(()=>[e(tt,{avatar:""},{default:s(()=>[e(vt,{name:"print"})]),_:1}),e(tt,null,{default:s(()=>[e(pt,null,{default:s(()=>[R(" Adicionar Etiquetas ")]),_:1})]),_:1})]),_:1}),e(_t,{onClick:l[5]||(l[5]=r=>n.dialogImprimirEtiquetas("impressao",o.compra)),clickable:""},{default:s(()=>[e(tt,{avatar:""},{default:s(()=>[e(vt,{name:"print"})]),_:1}),e(tt,null,{default:s(()=>[e(pt,null,{default:s(()=>[R(" Imprimir Etiquetas ")]),_:1})]),_:1})]),_:1})]),_:1})),[[Vt]])]),_:1})]),_:1})]),_:1})]),_:1}),e(t,{col:"shrink"},{default:s(()=>[bt(e(m,{text:"caption",icon:"mdi-calendar-today sm tertiary left",tip:`Emitido \xE1s ${o.$filters.hora(o.compra.dataHoraEmissao)}`},{default:s(()=>[R(J(o.$filters.data(o.compra.dataHoraEmissao)),1)]),_:1},8,["tip"]),[[Dt,o.compra.dataHoraEmissao]])]),_:1}),e(t,{col:"shrink"},{default:s(()=>[bt(e(m,{text:"caption",icon:"mdi-calendar sm tertiary left",tip:`Finalizado \xE1s ${o.$filters.hora(o.compra.dataHoraFinalizado)}`},{default:s(()=>[R(J(o.$filters.data(o.compra.dataHoraFinalizado)),1)]),_:1},8,["tip"]),[[Dt,o.compra.dataHoraFinalizado]])]),_:1})]),_:1}),e(w,null,{default:s(()=>[e(t,null,{default:s(()=>[e(v,{modelValue:o.compra.observacao,"onUpdate:modelValue":l[6]||(l[6]=r=>o.compra.observacao=r),"somente-leitura":o.compra.status!=="Digita\xE7\xE3o",tipo:"textoArea",rotulo:"Observa\xE7\xE3o",rows:"4"},null,8,["modelValue","somente-leitura"])]),_:1})]),_:1})]),_:1})]),_:1}),e(w,{gutter:"md",mg:"md",bg:"bg-white"},{default:s(()=>[o.exibeInfNota?(Q(),at(Se,{key:0,"default-opened":o.compra.notaNumero>0||o.documentoNovo,"header-class":"q-px-sm",class:"notaEntrada g-col col-12"},{header:s(()=>[e(tt,null,{default:s(()=>[e(m,{text:"sub1 medium",icon:"mdi-file-replace sm tertiary left"},{default:s(()=>[R("Nota de Entrada")]),_:1})]),_:1})]),default:s(()=>[e(t,{col:"12"},{default:s(()=>[e(w,null,{default:s(()=>[e(t,{col:"12 sm6 md3"},{default:s(()=>[e(v,{modelValue:o.compra.notaNumero,"onUpdate:modelValue":l[7]||(l[7]=r=>o.compra.notaNumero=r),"somente-leitura":o.compra.status!=="Digita\xE7\xE3o",rotulo:"Numero",dense:""},null,8,["modelValue","somente-leitura"])]),_:1}),e(t,{col:"12 sm6 md3"},{default:s(()=>[e(v,{modelValue:o.compra.notaSerie,"onUpdate:modelValue":l[8]||(l[8]=r=>o.compra.notaSerie=r),"somente-leitura":o.compra.status!=="Digita\xE7\xE3o",rotulo:"Serie",dense:""},null,8,["modelValue","somente-leitura"])]),_:1}),e(t,{col:"12 sm6 md3"},{default:s(()=>[e(v,{modelValue:o.compra.naturezaOperacao,"onUpdate:modelValue":l[9]||(l[9]=r=>o.compra.naturezaOperacao=r),"somente-leitura":o.compra.status!=="Digita\xE7\xE3o",rotulo:"Natureza da Opera\xE7\xE3o",dense:""},null,8,["modelValue","somente-leitura"])]),_:1}),e(t,{col:"12 sm6 md3"},{default:s(()=>[e(v,{modelValue:o.compra.dataCompra,"onUpdate:modelValue":l[10]||(l[10]=r=>o.compra.dataCompra=r),"somente-leitura":o.compra.status!=="Digita\xE7\xE3o",rotulo:"Data compra",tipo:"data",dense:""},null,8,["modelValue","somente-leitura"])]),_:1}),e(t,{col:"12"},{default:s(()=>[e(v,{modelValue:o.compra.chaveAcesso,"onUpdate:modelValue":l[11]||(l[11]=r=>o.compra.chaveAcesso=r),"somente-leitura":o.compra.status!=="Digita\xE7\xE3o",rotulo:"Chave",dense:""},null,8,["modelValue","somente-leitura"])]),_:1})]),_:1})]),_:1})]),_:1},8,["default-opened"])):lt("",!0)]),_:1}),e(w,{gutter:"md",mg:"md",bg:"bg-white"},{default:s(()=>[e(t,{col:"12"},{default:s(()=>[e(m,{text:"sub1 medium",icon:"shopping_cart sm tertiary left"},{default:s(()=>[R("Carrinho "),e(ct,{onClick:l[12]||(l[12]=r=>n.adicionarItem()),disable:o.compra.status!=="Digita\xE7\xE3o",icon:"add",label:"Produto",size:"md",color:"primary",flat:"",dense:"",class:"float-right q-px-sm"},null,8,["disable"])]),_:1})]),_:1}),(Q(!0),wt(Pt,null,Rt(o.compraItens,(r,p)=>(Q(),at(t,{col:"12",key:p},{default:s(()=>[e(xt,{class:"full-width"},{default:s(()=>[e(_t,{class:"q-px-none"},{default:s(()=>{var u;return[e(tt,{avatar:"",class:"col-auto"},{default:s(()=>{var _;return[e(g,{imagem:(_=o.produtos[r.idItem])==null?void 0:_.imagem,rotulo:r.descricaoItem,tamanho:"50"},null,8,["imagem","rotulo"])]}),_:2},1024),e(tt,{class:"q-px-none"},{default:s(()=>[e(pt,null,{default:s(()=>[R(J(r.descricaoItem),1)]),_:2},1024),e(pt,{caption:""},{default:s(()=>{var _,E;return[R(J((E=(_=o.produtos[r.idItem])==null?void 0:_.marca)!=null?E:""),1)]}),_:2},1024)]),_:2},1024),bt(e(tt,{avatar:""},{default:s(()=>[e(c,{denso:""},{default:s(()=>{var _,E;return[R(J((E=(_=o.produtos[r.idItem])==null?void 0:_.referencia)!=null?E:""),1)]}),_:2},1024)]),_:2},1536),[[Dt,(u=o.produtos[r.idItem])==null?void 0:u.referencia]]),e(tt,{avatar:""},{default:s(()=>[ft("div",Le,[ft("div",je,[e(ct,{color:"primary",dense:"",flat:"",icon:"edit",round:"",onClick:_=>n.editarProduto(r),disable:o.compra.status!=="Digita\xE7\xE3o"},null,8,["onClick","disable"])]),ft("div",$e,[e(ct,{color:"tertiary",dense:"",flat:"",icon:"delete",round:"",onClick:_=>n.removerItem(r),disable:o.compra.status!=="Digita\xE7\xE3o"},{default:s(()=>[e(St,{anchor:"bottom middle",self:"center middle"},{default:s(()=>[R("Remover Item")]),_:1})]),_:2},1032,["onClick","disable"])])])]),_:2},1024)]}),_:2},1024)]),_:2},1024),e(w,null,{default:s(()=>[e(t,{col:"4 md"},{default:s(()=>[e(v,{dense:"",align:"left",tipo:"decimal",decimals:"4",zerosDireita:"2",outlined:"",rotulo:"Valor do produto",modelValue:r.valorItem,"onUpdate:modelValue":u=>r.valorItem=u,"somente-leitura":o.compra.status!=="Digita\xE7\xE3o",onBlur:u=>n.calcularTotaisItem(p,"valorItem")},null,8,["modelValue","onUpdate:modelValue","somente-leitura","onBlur"])]),_:2},1024),e(t,{col:"4 md"},{default:s(()=>[e(w,{items:"center"},{default:s(()=>[e(t,{col:"shrink"},{default:s(()=>[e(vt,{name:"mdi-minus",color:"primary"})]),_:1}),e(t,{col:"xs"},{default:s(()=>[e(v,{dense:"",opcoes:{maximumValue:100},tipo:"decimal",decimals:"2",rotulo:"Desconto percentual",modelValue:r.descontoPercentualItem,"onUpdate:modelValue":u=>r.descontoPercentualItem=u,outlined:"",suffix:"%","somente-leitura":o.compra.status!=="Digita\xE7\xE3o",onBlur:u=>n.calcularTotaisItem(p,"descontoPercentualItem")},null,8,["modelValue","onUpdate:modelValue","somente-leitura","onBlur"])]),_:2},1024)]),_:2},1024)]),_:2},1024),e(t,{col:"4 md"},{default:s(()=>[e(v,{dense:"",tipo:"decimal",modelValue:r.descontoItem,"onUpdate:modelValue":u=>r.descontoItem=u,decimals:"4",zerosDireita:"2",outlined:"",rotulo:"Desconto em reais",prefix:"R$",onBlur:u=>n.calcularTotaisItem(p,"descontoItem"),"somente-leitura":o.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onUpdate:modelValue","onBlur","somente-leitura"])]),_:2},1024),e(t,{col:"6 md"},{default:s(()=>[e(w,{items:"center"},{default:s(()=>[e(t,{col:"shrink",class:"hideonmobile"},{default:s(()=>[e(vt,{name:"mdi-equal",color:"primary"})]),_:1}),e(t,{col:"xs"},{default:s(()=>[e(v,{dense:"",outlined:"",opcoes:{maximumValue:10,minimumValue:0},rotulo:"Subtotal",tipo:"decimal",decimals:"4",zerosDireita:"2",modelValue:r.subTotal,"onUpdate:modelValue":u=>r.subTotal=u,onBlur:u=>n.calcularTotaisItem(p,"subTotal"),"somente-leitura":o.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onUpdate:modelValue","onBlur","somente-leitura"])]),_:2},1024)]),_:2},1024)]),_:2},1024),e(t,{col:"6 md"},{default:s(()=>[e(w,{items:"center"},{default:s(()=>[e(t,{col:"shrink"},{default:s(()=>[e(vt,{name:"mdi-close",color:"primary"})]),_:1}),e(t,{col:"xs"},{default:s(()=>[e(v,{dense:"",max:"100",min:"0",outlined:"",modelValue:r.quantidade,"onUpdate:modelValue":u=>r.quantidade=u,decimals:"4",zerosDireita:"0",tipo:"quantidade",onBlur:u=>n.calcularTotaisItem(p),disable:o.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onUpdate:modelValue","onBlur","disable"]),e(St,{anchor:"bottom middle",self:"center middle"},{default:s(()=>[R("Quantidade")]),_:1})]),_:2},1024)]),_:2},1024)]),_:2},1024),e(t,{col:"12 md"},{default:s(()=>[e(w,{items:"center"},{default:s(()=>[e(t,{col:"shrink",class:"hideonmobile"},{default:s(()=>[e(vt,{name:"mdi-equal",color:"primary"})]),_:1}),e(t,{col:"xs"},{default:s(()=>[e(v,{dense:"",tipo:"decimal",decimals:"2",rotulo:"Total","somente-leitura":"",modelValue:r.total,"onUpdate:modelValue":u=>r.total=u,outlined:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),e(t,{col:"12"},{default:s(()=>[e(w,{gutter:"md",mg:"md-y",justify:"end",items:"center",bg:"bg-light","rounded-borders":"","min-height":"49px"},{default:s(()=>[e(t,{col:"3 sm2 md-shrink",text:"bold"},{default:s(()=>[R(" Calcular ")]),_:1}),e(t,{col:"9 sm10 md"},{default:s(()=>[e(Mt,{modelValue:o.compra.calcularTributacao,"onUpdate:modelValue":[l[13]||(l[13]=r=>o.compra.calcularTributacao=r),n.calcularTotais],"checked-icon":"check",color:"green","unchecked-icon":"clear",disable:o.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onUpdate:modelValue","disable"])]),_:1}),e(t,{col:"6 md-shrink"},{default:s(()=>[R(" Base ICMS ")]),_:1}),e(t,{col:"6 md",text:"right"},{default:s(()=>[e(v,{dense:"",outlined:"",decimals:"2",zerosDireita:"2",tipo:"decimal",modelValue:o.compra.valorBaseIcms,"onUpdate:modelValue":l[14]||(l[14]=r=>o.compra.valorBaseIcms=r),"somente-leitura":!!o.compra.calcularTributacao||o.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","somente-leitura"])]),_:1}),e(t,{col:"6 md-shrink"},{default:s(()=>[R(" Valor ICMS ")]),_:1}),e(t,{col:"6 md",text:"right"},{default:s(()=>[e(v,{dense:"",outlined:"",modelValue:o.compra.valorIcms,"onUpdate:modelValue":l[15]||(l[15]=r=>o.compra.valorIcms=r),decimals:"2",zerosDireita:"2",tipo:"decimal","somente-leitura":!!o.compra.calcularTributacao||o.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","somente-leitura"])]),_:1}),e(t,{col:"6 md-shrink"},{default:s(()=>[R(" Base ICMS ST ")]),_:1}),e(t,{col:"6 md",text:"right"},{default:s(()=>[e(v,{dense:"",outlined:"",modelValue:o.compra.valorBaseIcmsSt,"onUpdate:modelValue":l[16]||(l[16]=r=>o.compra.valorBaseIcmsSt=r),decimals:"2",zerosDireita:"2",tipo:"decimal","somente-leitura":!!o.compra.calcularTributacao||o.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","somente-leitura"])]),_:1}),e(t,{col:"6 md-shrink"},{default:s(()=>[R(" ICMS ST ")]),_:1}),e(t,{col:"6 md",text:"right"},{default:s(()=>[e(v,{dense:"",outlined:"",modelValue:o.compra.valorIcmsSt,"onUpdate:modelValue":l[17]||(l[17]=r=>o.compra.valorIcmsSt=r),decimals:"2",zerosDireita:"2",tipo:"decimal","somente-leitura":!!o.compra.calcularTributacao||o.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","somente-leitura"])]),_:1})]),_:1}),e(w,{mg:"lg-t",justify:"end"},{default:s(()=>[e(t,{col:"xs12 sm8 md4"},{default:s(()=>[e(w,{items:"center"},{default:s(()=>[e(t,{col:"3",text:"bold"},{default:s(()=>[R(" Subtotal ")]),_:1}),e(t,{col:"xs",text:"right bold"},{default:s(()=>[R(J(o.$filters.numero(o.compra.subTotalProduto,2)),1)]),_:1})]),_:1}),e(le,{class:"q-mb-md q-mt-xs"}),e(w,{items:"center"},{default:s(()=>[e(t,{col:"xs3"},{default:s(()=>[R(" Desconto ")]),_:1}),e(t,{col:"xs"},{default:s(()=>[e(v,{tipo:"decimal",decimals:"2",modelValue:o.compra.totalPercentualDesconto,"onUpdate:modelValue":l[18]||(l[18]=r=>o.compra.totalPercentualDesconto=r),onBlur:l[19]||(l[19]=r=>n.calcularTotais("totalPercentualDesconto")),suffix:"%",error:o.erroDesconto,"somente-leitura":o.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","error","somente-leitura"])]),_:1}),e(t,{col:"xs"},{default:s(()=>[e(v,{tipo:"decimal",decimals:"2",modelValue:o.compra.totalDesconto,"onUpdate:modelValue":l[20]||(l[20]=r=>o.compra.totalDesconto=r),onBlur:l[21]||(l[21]=r=>n.calcularTotais("totalDesconto")),error:o.erroDesconto,"somente-leitura":o.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","error","somente-leitura"])]),_:1})]),_:1}),e(w,{items:"center"},{default:s(()=>[e(t,{col:"xs3"},{default:s(()=>[R(" Frete ")]),_:1}),e(t,{col:"xs"},{default:s(()=>[e(pe,{class:"q-mr-md",label:"CIF",val:"CIF",modelValue:o.compra.tipoFrete,"onUpdate:modelValue":[l[22]||(l[22]=r=>o.compra.tipoFrete=r),n.calcularTotais],dense:"",disable:o.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onUpdate:modelValue","disable"]),e(pe,{label:"FOB",val:"FOB",modelValue:o.compra.tipoFrete,"onUpdate:modelValue":[l[23]||(l[23]=r=>o.compra.tipoFrete=r),n.calcularTotais],dense:"",disable:o.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onUpdate:modelValue","disable"])]),_:1}),e(t,{col:"xs"},{default:s(()=>[e(v,{tipo:"decimal",decimals:"2",modelValue:o.compra.valorFrete,"onUpdate:modelValue":l[24]||(l[24]=r=>o.compra.valorFrete=r),onBlur:n.calcularTotais,error:o.erroFrete,"somente-leitura":o.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onBlur","error","somente-leitura"])]),_:1})]),_:1}),e(w,{items:"center"},{default:s(()=>[e(t,{col:"xs3"},{default:s(()=>[R(" Seguro ")]),_:1}),e(t,{col:"xs"},{default:s(()=>[e(v,{tipo:"decimal",decimals:"2",modelValue:o.compra.valorSeguro,"onUpdate:modelValue":l[25]||(l[25]=r=>o.compra.valorSeguro=r),onBlur:n.calcularTotais,error:o.erroSeguro,"somente-leitura":o.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onBlur","error","somente-leitura"])]),_:1})]),_:1}),e(w,{items:"center"},{default:s(()=>[e(t,{col:"xs5"},{default:s(()=>[R(" Outras despesas ")]),_:1}),e(t,{col:"xs"},{default:s(()=>[e(v,{tipo:"decimal",decimals:"2",modelValue:o.compra.valorOutrasDespesas,"onUpdate:modelValue":l[26]||(l[26]=r=>o.compra.valorOutrasDespesas=r),onBlur:n.calcularTotais,error:o.erroOutrasDespesas,"somente-leitura":o.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onBlur","error","somente-leitura"])]),_:1})]),_:1}),e(le,{class:"q-mt-md q-mb-xs"}),e(w,{items:"center"},{default:s(()=>[e(t,{col:"xs4",text:"bold"},{default:s(()=>[R(" Total ")]),_:1}),e(t,{col:"xs",text:"right bold"},{default:s(()=>[R(J(o.$filters.numero(o.compra.totalProduto,2)),1)]),_:1})]),_:1}),o.compra.totalComImposto?(Q(),at(w,{key:0,items:"center"},{default:s(()=>[e(t,{col:"xs4",text:"bold"},{default:s(()=>[R(" Total IPI ")]),_:1}),e(t,{col:"xs",text:"right bold"},{default:s(()=>[R(J(o.$filters.numero(o.compra.valorIpi,2)),1)]),_:1})]),_:1})):lt("",!0),e(w,{items:"center"},{default:s(()=>[e(t,{col:"xs5",text:"bold"},{default:s(()=>[R(" Total c/ Impostos ")]),_:1}),e(t,{col:"xs-shrink"},{default:s(()=>[e(Mt,{disable:o.compra.status!=="Digita\xE7\xE3o",modelValue:o.compra.totalComImposto,"onUpdate:modelValue":[l[27]||(l[27]=r=>o.compra.totalComImposto=r),n.calcularTotais],"checked-icon":"check",color:"green","unchecked-icon":"clear"},null,8,["disable","modelValue","onUpdate:modelValue"])]),_:1}),e(t,{col:"xs",text:"right bold"},{default:s(()=>[R(J(o.$filters.numero(o.compra.totalDocumento,2)),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(w,{gutter:"md",mg:"md",bg:"bg-white"},{default:s(()=>[e(t,{col:"12"},{default:s(()=>[e(m,{text:"sub1 medium",icon:"credit_card sm tertiary left"},{default:s(()=>[R("Faturar")]),_:1})]),_:1}),e(t,{col:"12"},{default:s(()=>[e(v,{modelValue:o.compra.observacaoFaturamento,"onUpdate:modelValue":l[28]||(l[28]=r=>o.compra.observacaoFaturamento=r),tipo:"textoArea",rotulo:"Observa\xE7\xE3o faturamento",rows:"5"},null,8,["modelValue"])]),_:1}),e(t,{col:"12"},{default:s(()=>[e(de,{ref:"formAdicionarPagamento"},{default:s(()=>[e(w,{mg:"md-y",items:"center"},{default:s(()=>[e(t,{col:"12 sm6 md"},{default:s(()=>[e(v,{modelValue:o.compra.formaDePagamento,"onUpdate:modelValue":l[29]||(l[29]=r=>o.compra.formaDePagamento=r),rules:o.formaPagamentoRules,ajuda:"Exemplo: Boleto","somente-leitura":o.compra.status!=="Digita\xE7\xE3o",rotulo:"Forma de pagamento"},null,8,["modelValue","rules","somente-leitura"])]),_:1}),e(t,{col:"12 sm6 md"},{default:s(()=>[e(v,{modelValue:o.compra.condicaoPagamento,"onUpdate:modelValue":l[30]||(l[30]=r=>o.compra.condicaoPagamento=r),rules:o.condicaoPagamentoRules,ajuda:"Exemplo: 28/56/64","somente-leitura":o.compra.status!=="Digita\xE7\xE3o",rotulo:"Cond. Pag",tipo:"numero"},null,8,["modelValue","rules","somente-leitura"])]),_:1}),e(t,{col:"12 sm4 md",text:"bold",class:"q-my-sm"},{default:s(()=>[R(" Frete Separado "),e(Mt,{modelValue:o.compra.freteSeparado,"onUpdate:modelValue":[l[31]||(l[31]=r=>o.compra.freteSeparado=r),n.calcularTotais],disable:o.compra.status!=="Digita\xE7\xE3o",dense:"",class:"q-ml-sm"},null,8,["modelValue","onUpdate:modelValue","disable"])]),_:1}),e(t,{col:"12 sm4 md",text:"bold",class:"q-my-sm"},{default:s(()=>[R(" N\xE3o gerar financeiro "),e(Mt,{modelValue:o.compra.naoGerarFinanceiro,"onUpdate:modelValue":[l[32]||(l[32]=r=>o.compra.naoGerarFinanceiro=r),n.calcularTotais],disable:o.compra.status!=="Digita\xE7\xE3o",dense:"",class:"q-ml-sm"},null,8,["modelValue","onUpdate:modelValue","disable"])]),_:1}),e(t,{col:"12 sm4 md",text:"center"},{default:s(()=>[e(ct,{onClick:n.gerarCondicoesDePagamento_click,disable:o.compra.status!=="Digita\xE7\xE3o",color:"positive",icon:"add",label:"Forma de pagamento",outline:"",size:"sm"},null,8,["onClick","disable"])]),_:1})]),_:1})]),_:1},512)]),_:1}),e(t,{col:"12"},{default:s(()=>[bt(e(m,{text:"sub1 medium"},{default:s(()=>[R("Condi\xE7\xF5es de pagamento")]),_:1},512),[[Dt,o.compraCondicoesDePagamento.length>0]]),(Q(!0),wt(Pt,null,Rt(o.compraCondicoesDePagamento,r=>(Q(),at(xt,{highlight:"",class:"q-pa-none",key:r.id},{default:s(()=>[e(w,{gutter:"md",mg:"sm-y",items:"center",bordered:"","rounded-borders":""},{default:s(()=>[e(t,{col:"xs6 md-shrink"},{default:s(()=>[e(v,{modelValue:r.dataVencimento,"onUpdate:modelValue":p=>r.dataVencimento=p,"somente-leitura":o.compra.status!=="Digita\xE7\xE3o",rotulo:"Data vencimento",tipo:"data",dense:""},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024),e(t,{col:"xs6 md2"},{default:s(()=>[e(v,{modelValue:r.valor,"onUpdate:modelValue":p=>r.valor=p,"somente-leitura":o.compra.status!=="Digita\xE7\xE3o",align:"left",rotulo:"Valor",decimals:"2",zerosDireita:"2",tipo:"decimal"},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024),e(t,{col:"xs-grow"},{default:s(()=>[e(v,{modelValue:r.observacao,"onUpdate:modelValue":p=>r.observacao=p,"somente-leitura":o.compra.status!=="Digita\xE7\xE3o"||r.observacao==="Valor Frete + Seguro",rotulo:"Observa\xE7\xE3o"},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024),e(t,{col:"xs-shrink",text:"right"},{default:s(()=>[e(ct,{onClick:p=>n.removerPagamento_click(r),icon:"delete",round:"",dense:"",flat:"",color:"tertiary",disable:o.compra.status!=="Digita\xE7\xE3o"},null,8,["onClick","disable"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),o.valorTotalPagamento>0?(Q(),at(w,{key:0,mg:"sm-t"},{default:s(()=>[e(t,{col:"xs-shrink",text:"bold"},{default:s(()=>[R(" Valor total: "+J(o.$filters.numero(o.valorTotalPagamento,2)),1)]),_:1})]),_:1})):lt("",!0)]),_:1})]),_:1}),o.$db.usuario.desenvolvedor()?(Q(),at(w,{key:0,gutter:"md",mg:"md",bg:"bg-yellow"},{default:s(()=>[e(t,{col:"12"},{default:s(()=>[e(m,{text:"sub1 medium",icon:"credit_card sm tertiary left"},{default:s(()=>[R("Contabilidade (apenas desenvolvedor)")]),_:1})]),_:1}),e(t,{col:"12"},{default:s(()=>[o.compraTitulos.length?(Q(),at(m,{key:0,text:"sub1 medium"},{default:s(()=>[R("Titulos")]),_:1})):lt("",!0),e(xt,{highlight:"",class:"q-pa-none"},{default:s(()=>[(Q(!0),wt(Pt,null,Rt(o.compraTitulos,r=>(Q(),at(w,{key:r.id,items:"center"},{default:s(()=>[e(t,{col:"sm2"},{default:s(()=>[e(v,{modelValue:r.dataVencimento,"somente-leitura":"",rotulo:"Data vencimento",tipo:"data",dense:""},null,8,["modelValue"])]),_:2},1024),e(t,{col:"sm2"},{default:s(()=>[e(v,{modelValue:r.dataPagamento||"A pagar","somente-leitura":"",rotulo:"Data pagamento",tipo:r.dataPagamento?"data":"texto",dense:""},null,8,["modelValue","tipo"])]),_:2},1024),e(t,{col:"sm2"},{default:s(()=>[e(v,{modelValue:r.valor,"somente-leitura":"",align:"left",rotulo:"Valor",decimals:"2",tipo:"decimal"},null,8,["modelValue"])]),_:2},1024),e(t,{col:"sm2"},{default:s(()=>[e(v,{modelValue:r.parcela,"somente-leitura":"",align:"left",rotulo:"Parcela"},null,8,["modelValue"])]),_:2},1024),e(t,{col:"sm2"},{default:s(()=>[e(v,{modelValue:r.formaDePagamento,"somente-leitura":"",rotulo:"Forma de pagamento"},null,8,["modelValue"])]),_:2},1024),e(t,{col:"sm2"},{default:s(()=>[e(v,{modelValue:r.observacao,"somente-leitura":"",rotulo:"Observa\xE7\xE3o"},null,8,["modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),e(t,{col:"12"},{default:s(()=>[o.compraMovimentacoes.length?(Q(),at(m,{key:0,text:"sub1 medium"},{default:s(()=>[R("Movimenta\xE7\xF4es")]),_:1})):lt("",!0),e(xt,{highlight:"",class:"q-pa-none"},{default:s(()=>[(Q(!0),wt(Pt,null,Rt(o.compraMovimentacoes,r=>(Q(),at(w,{key:r.id,gutter:"sm",mg:"sm-y",items:"center"},{default:s(()=>[e(t,{col:"xs-grow"},{default:s(()=>[e(v,{modelValue:r.descricao,"somente-leitura":"",rotulo:"Descri\xE7\xE3o"},null,8,["modelValue"])]),_:2},1024),r.valorCredito?(Q(),at(t,{key:0,col:"xs6 md2"},{default:s(()=>[e(v,{modelValue:r.valorCredito,"somente-leitura":"",align:"left",rotulo:"Valor Credito",decimals:"2",tipo:"decimal"},null,8,["modelValue"])]),_:2},1024)):lt("",!0),r.valorDebito?(Q(),at(t,{key:1,col:"xs6 md2"},{default:s(()=>[e(v,{modelValue:r.valorDebito,"somente-leitura":"",align:"left",rotulo:"Valor Debito",decimals:"2",tipo:"decimal"},null,8,["modelValue"])]),_:2},1024)):lt("",!0),e(t,{col:"xs6 md-shrink"},{default:s(()=>[e(v,{modelValue:r.dataCompetencia,"somente-leitura":"",rotulo:"Data competencia",tipo:"data",dense:""},null,8,["modelValue"])]),_:2},1024),e(t,{col:"xs-grow"},{default:s(()=>[e(v,{modelValue:r.observacao,"somente-leitura":"",rotulo:"Observa\xE7\xE3o"},null,8,["modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})):lt("",!0),o.$db.usuario.desenvolvedor()&&o.compraDocumentoXml.length?(Q(),at(w,{key:1,gutter:"md",mg:"md",bg:"bg-yellow"},{default:s(()=>[e(t,{col:"12"},{default:s(()=>[e(m,{text:"sub1 medium",icon:"credit_card sm tertiary left"},{default:s(()=>[R("XML importado (apenas desenvolvedor)")]),_:1})]),_:1}),e(t,{col:"12"},{default:s(()=>[e(xt,{highlight:"",class:"q-pa-none"},{default:s(()=>[(Q(!0),wt(Pt,null,Rt(o.compraDocumentoXml,r=>(Q(),at(w,{key:r.id},{default:s(()=>[ft("pre",null,J(n.formatXml(r.xmlData)),1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})):lt("",!0)]),_:1})]),_:1}),e(Yt,{class:"bg-light border-top"},{default:s(()=>[e(Tt,{class:"bg-light text-tertiary q-px-md u-container"},{default:s(()=>[e(Ut,{class:"text-subtitle2"},{default:s(()=>[R(" Valor Total: "+J(o.$filters.numero(o.compra.totalDocumento,2))+" ",1),He,R(" SKU: "+J(n.skus),1)]),_:1}),e(oe),bt(e(ct,{onClick:n.excluir_click,type:"submit",class:"q-ml-sm",color:"white","text-color":"negative",flat:"",label:"Excluir"},null,8,["onClick"]),[[Dt,o.compra.status==="Digita\xE7\xE3o"]]),bt(e(ct,{onClick:n.finalizar_click,type:"submit",class:"q-ml-sm",color:"primary",unelevated:"",label:"Finalizar"},null,8,["onClick"]),[[Dt,o.compra.status==="Digita\xE7\xE3o"]]),bt(e(ct,{onClick:n.reabrir_click,color:"tertiary",flat:"",label:"Reabrir",type:"submit",class:"q-ml-sm"},null,8,["onClick"]),[[Dt,o.compra.status==="Finalizado"]]),bt(e(ct,{unelevated:"",onClick:n.transformarEmNotaDeEntrada_click,class:"q-ml-sm",color:"primary",label:"Transformar em Nota de Entrada",type:"submit"},null,8,["onClick"]),[[Dt,o.compra.status==="Finalizado"&&o.compra.operacao==="Pedido de Compra"]])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onKeyup"]),e(i,{ref:"ModalEditarProdutoCompras",onSalvar:n.fecharEdicaoProduto},null,8,["onSalvar"]),e(I,{modelValue:o.adicionar.modal.value,"onUpdate:modelValue":l[34]||(l[34]=r=>o.adicionar.modal.value=r),filtro:{ativo:!0,idEmpresa:o.compra.idEmpresa},ref:"promptItem",habilitarQuantidade:!0,exibirValorVenda:!1,calculaItemCusto:!0,onSelecionarItens:n.selecionarItens},null,8,["modelValue","filtro","onSelecionarItens"])],64)}var Xe=re(Me,[["render",Ze]]);const We={components:{PromptItemV2:be},data(){return{mostrarItemModal:!1,idxItem:0,compra:{},compraItens:[],visivel:!1,edicaoGeral:{marca:"",grupo:"",subGrupo:"",percentualMarkup:0}}},emits:["atualizar","concluirImportacao"],computed:{produtosNaoVinculados(){return this.compraItens.reduce((o,l)=>o+(l.vinculado?0:1),0)},quantProdutos(){return this.compraItens.reduce((o,l)=>o+1,0)}},methods:{async mostrar(o){for(const l of o.documentosItem)this.recalcularItem_blur(l);this.compra=o,this.compraItens=o.documentosItem,this.visivel=!0},async fechar(){this.visivel=!1},async selecionarItens(o){await $tryLoading(async()=>{var m;const l=(m=Object.values(o)[0])==null?void 0:m.item;$utils.verificarErro(!(l!=null&&l.id),"Produto inv\xE1lido"),this.compraItens[this.idxItem].item=l;const{documentoItem:h,item:k,nfeProd:a}=this.compraItens[this.idxItem];h.idItem=k.id,h.descricaoItem=k.descricao;const n={id:$utils.uuid(),idItem:h.idItem,idContato:this.compra.documento.idContato,referencia:a.cProd,descricao:a.xProd};this.compra.itensFornecedor.push(n),this.compraItens[this.idxItem].vinculado=!0,$q.notifyPositive(`Produto vinculado com sucesso: ${k.descricao}`)},{mensagem:"Vinculando produto..."}),this.mostrarItemModal=!1},aplicar_click(){for(const o of this.compraItens)this.edicaoGeral.marca&&(o.item.marca=this.edicaoGeral.marca),this.edicaoGeral.grupo&&(o.item.grupo=this.edicaoGeral.grupo),this.edicaoGeral.subGrupo&&(o.item.subGrupo=this.edicaoGeral.subGrupo),this.edicaoGeral.percentualMarkup&&(o.item.percentualMarkup=this.edicaoGeral.percentualMarkup,this.recalcularItem_blur(o))},async recalcularItem_blur(o){const{item:l,documentoItem:h,itemAnterior:k=$utils.clonarV2(o.item)}=o,{valorFreteRateado:a=0,valorSeguroRateado:n=0,valorOutrasDespesasRateado:m=0}=h;o.valoresEdicao||(o.valoresEdicao={valorOutrasDespesas:a+n+m,percentualIpi:h.percentualIpi||0,percentualIcmsSt:h.percentualIcmsSt||0,percentualDifal:0});const{valorOutrasDespesas:t,percentualIpi:c,percentualIcmsSt:b,percentualDifal:w}=o.valoresEdicao,{valorCusto:g=0,percentualMarkup:v=0,valorVenda:i=0}=l,I=g+t,r=I*c/100,p=I*b/100,u=I*w/100;l.valorCustoReposicao=$utils.arredondar(I+r+p+u,2),i!==k.valorVenda?l.percentualMarkup=$utils.arredondar(100*(i-l.valorCustoReposicao)/i,2):l.valorVenda=$utils.arredondar(l.valorCustoReposicao/(1-v/100),2),o.itemAnterior=$utils.clonarV2(l)},async adicionarItem_click(o){o.buttonLoading=!0,await this.$nextTick(),await $tryLoading(async()=>{const l=await $db.hibrido.lista({table:"item",where:{referencia:o.item.referencia}});$utils.verificarErro(l.length,"Referencia j\xE1 utilizada por outro produto"),o.documentoItem.descricaoItem=o.item.descricao,o.item.descricaoConcatenada=o.item.descricao;const h=o.nfeProd,k={id:$utils.uuid(),idItem:o.item.id,idContato:this.compra.documento.idContato,referencia:h.cProd,descricao:h.xProd};this.compra.itens.push(o.item),this.compra.itensFornecedor.push(k),o.vinculado=!0,$q.notifyPositive(`Item criado com sucesso: ${o.item.descricao}`)},{mensagem:"Cadastrando produto..."}),o.buttonLoading=!1},async salvar_click(){this.compraItens.some(({vinculado:o})=>!o)?$q.notifyError("Verifique todos os itens n\xE3o vinculados!"):(this.mostrarItemModal=!1,this.visivel=!1,this.$emit("concluirImportacao",this.compra))},async incluirTodos_click(){for(const o of this.compraItens)o.vinculado||await this.adicionarItem_click(o)}}},Ge={class:"layout-padding q-pa-none q-pb-md"},Qe={class:"items-carrinho items-center row q-pa-none rounded-borders u-container",style:{"margin-top":"12px","margin-bottom":"12px"}},Ke=ft("div",{class:"col-8"},null,-1),Ye={class:"col-2"},Je=["id"],ta={class:"col-12"},ea={class:"col-4 col-md"},aa={class:"col-4 col-md"},oa={class:"col-4 col-md"},ra={class:"col-4 col-md"},ia={class:"col-6 col-md"},sa={class:"col-12 col-md"},na={class:"col-6 col-md"},la={class:"col-12 col-md"},da={key:0,class:"col-12"},ua={class:"col-12 col-md-4"},ca=ft("div",{class:"col-12 col-md-auto"},"ou",-1),ma={class:"col-12 col-md-auto q-pl-none"},fa={key:1,class:"col-12 q-pt-md text-right text-bold"},ha={class:"text-positive"};function pa(o,l,h,k,a,n){const m=mt("ajuda"),t=mt("campo"),c=mt("row"),b=mt("card"),w=mt("PromptItemV2");return Q(),wt(Pt,null,[e(Zt,{modelValue:a.visivel,"onUpdate:modelValue":l[4]||(l[4]=g=>a.visivel=g),persistent:"",maximized:"",onKeyup:ve(n.fechar,["esc"])},{default:s(()=>[e(Lt,{container:"",view:"hHh LpR fFf",class:"bg-light"},{default:s(()=>[e(jt,null,{default:s(()=>[e(Tt,null,{default:s(()=>[e(ct,{icon:"arrow_back",flat:"",round:"",dense:"",onClick:n.fechar},null,8,["onClick"]),e(Ut,null,{default:s(()=>[R("Importar XML x Cadastro")]),_:1}),e(m)]),_:1})]),_:1}),e($t,null,{default:s(()=>[e(Ht,null,{default:s(()=>[ft("div",Ge,[ft("div",Qe,[e(b,{icon:"mdi-set-none",label:"Propriedades para todos os produtos",class:"full-width"},{default:s(()=>[e(c,null,{default:s(()=>[e(t,{modelValue:a.edicaoGeral.marca,"onUpdate:modelValue":l[0]||(l[0]=g=>a.edicaoGeral.marca=g),rotulo:"Marca",dense:"",tipo:"texto",outlined:"",col:"4"},null,8,["modelValue"]),e(t,{modelValue:a.edicaoGeral.grupo,"onUpdate:modelValue":l[1]||(l[1]=g=>a.edicaoGeral.grupo=g),rotulo:"Grupo",dense:"",tipo:"texto",outlined:"",col:"4"},null,8,["modelValue"]),e(t,{modelValue:a.edicaoGeral.subGrupo,"onUpdate:modelValue":l[2]||(l[2]=g=>a.edicaoGeral.subGrupo=g),rotulo:"SubGrupo",dense:"",tipo:"texto",outlined:"",col:"4"},null,8,["modelValue"])]),_:1}),e(c,{class:"q-pt-sm"},{default:s(()=>[Ke,e(t,{modelValue:a.edicaoGeral.percentualMarkup,"onUpdate:modelValue":l[3]||(l[3]=g=>a.edicaoGeral.percentualMarkup=g),rotulo:"Margem de Lucro",suffix:"%",opcoes:{maximumValue:100},dense:"",tipo:"decimal",decimals:"2",outlined:"",col:"2"},null,8,["modelValue"]),ft("div",Ye,[e(ct,{class:"q-ml-sm no-shadow",color:"primary",icon:"play_arrow",unelevated:"",label:"Aplicar",onClick:n.aplicar_click},null,8,["onClick"])])]),_:1})]),_:1})]),e(De,{items:a.compraItens,separator:""},{default:s(({item:g,index:v})=>[ft("div",{class:"items-carrinho items-center row q-pa-md bg-white rounded-borders u-container",style:{"margin-top":"12px","margin-bottom":"12px"},id:v},[e(xt,{class:"full-width"},{default:s(()=>[e(_t,{class:"q-px-none"},{default:s(()=>[e(tt,{class:"q-px-none"},{default:s(()=>[e(pt,null,{default:s(()=>[e(t,{dense:"",align:"left",tipo:"texto",outlined:"",rotulo:"Descri\xE7\xE3o Item",modelValue:g.item.descricao,"onUpdate:modelValue":i=>g.item.descricao=i,"somente-leitura":!!g.vinculado},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024)]),_:2},1024),e(tt,null,{default:s(()=>[e(pt,null,{default:s(()=>[e(t,{dense:"",align:"left",tipo:"texto",outlined:"",rotulo:"Referencia",modelValue:g.item.referencia,"onUpdate:modelValue":i=>g.item.referencia=i,"somente-leitura":!!g.vinculado},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(xt,{class:"full-width"},{default:s(()=>[e(_t,{class:"q-px-none"},{default:s(()=>[e(tt,null,{default:s(()=>[e(pt,null,{default:s(()=>[e(t,{dense:"",tipo:"texto",outlined:"",rotulo:"Marca",modelValue:g.item.marca,"onUpdate:modelValue":i=>g.item.marca=i,"somente-leitura":!!g.vinculado},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024)]),_:2},1024),e(tt,null,{default:s(()=>[e(pt,null,{default:s(()=>[e(t,{dense:"",tipo:"texto",outlined:"",rotulo:"Grupo",modelValue:g.item.grupo,"onUpdate:modelValue":i=>g.item.grupo=i,"somente-leitura":!!g.vinculado},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024)]),_:2},1024),e(tt,null,{default:s(()=>[e(pt,null,{default:s(()=>[e(t,{dense:"",tipo:"texto",outlined:"",rotulo:"SubGrupo",modelValue:g.item.subGrupo,"onUpdate:modelValue":i=>g.item.subGrupo=i,"somente-leitura":!!g.vinculado},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),ft("div",ta,[e(c,{class:"q-col-gutter-sm"},{default:s(()=>[ft("div",ea,[e(t,{modelValue:g.item.valorCusto,"onUpdate:modelValue":i=>g.item.valorCusto=i,rotulo:"Valor pr\xE9 custo",dense:"",tipo:"decimal",decimals:"4",zerosDireita:"2",outlined:"","somente-leitura":""},null,8,["modelValue","onUpdate:modelValue"])]),ft("div",aa,[e(t,{modelValue:g.valoresEdicao.valorOutrasDespesas,"onUpdate:modelValue":i=>g.valoresEdicao.valorOutrasDespesas=i,rotulo:"Outras Despesas",dense:"",tipo:"decimal",decimals:"4","somente-leitura":!!g.vinculado,outlined:"",onBlur:i=>n.recalcularItem_blur(g)},null,8,["modelValue","onUpdate:modelValue","somente-leitura","onBlur"])]),ft("div",oa,[e(t,{modelValue:g.valoresEdicao.percentualIpi,"onUpdate:modelValue":i=>g.valoresEdicao.percentualIpi=i,rotulo:"IPI",suffix:"%",opcoes:{maximumValue:100},dense:"",tipo:"decimal",decimals:"2","somente-leitura":!!g.vinculado,outlined:"",onBlur:i=>n.recalcularItem_blur(g)},null,8,["modelValue","onUpdate:modelValue","somente-leitura","onBlur"])]),ft("div",ra,[e(t,{modelValue:g.valoresEdicao.percentualIcmsSt,"onUpdate:modelValue":i=>g.valoresEdicao.percentualIcmsSt=i,rotulo:"ST",suffix:"%",opcoes:{maximumValue:100},dense:"",tipo:"decimal",decimals:"2","somente-leitura":!!g.vinculado,outlined:"",onBlur:i=>n.recalcularItem_blur(g)},null,8,["modelValue","onUpdate:modelValue","somente-leitura","onBlur"])]),ft("div",ia,[e(t,{modelValue:g.valoresEdicao.percentualDifal,"onUpdate:modelValue":i=>g.valoresEdicao.percentualDifal=i,rotulo:"DIFAL",suffix:"%",opcoes:{maximumValue:100},dense:"",tipo:"decimal",decimals:"2","somente-leitura":!!g.vinculado,outlined:"",onBlur:i=>n.recalcularItem_blur(g)},null,8,["modelValue","onUpdate:modelValue","somente-leitura","onBlur"])]),ft("div",sa,[e(t,{modelValue:g.item.valorCustoReposicao,"onUpdate:modelValue":i=>g.item.valorCustoReposicao=i,rotulo:"Custo de reposi\xE7\xE3o",dense:"",tipo:"decimal",decimals:"4",zerosDireita:"2",outlined:"","somente-leitura":""},null,8,["modelValue","onUpdate:modelValue"])]),ft("div",na,[e(t,{modelValue:g.item.percentualMarkup,"onUpdate:modelValue":i=>g.item.percentualMarkup=i,rotulo:"Margem de Lucro",suffix:"%",opcoes:{maximumValue:100},dense:"",tipo:"decimal",decimals:"2","somente-leitura":!!g.vinculado,outlined:"",onBlur:i=>n.recalcularItem_blur(g)},null,8,["modelValue","onUpdate:modelValue","somente-leitura","onBlur"])]),ft("div",la,[e(t,{modelValue:g.item.valorVenda,"onUpdate:modelValue":i=>g.item.valorVenda=i,rotulo:"Valor de Venda",dense:"",tipo:"decimal",decimals:"4",zerosDireita:"2",outlined:"","somente-leitura":!!g.vinculado,onBlur:i=>n.recalcularItem_blur(g)},null,8,["modelValue","onUpdate:modelValue","somente-leitura","onBlur"])])]),_:2},1024)]),g.vinculado?(Q(),wt("div",fa," Produto vinculado ")):(Q(),wt("div",da,[e(c,{class:"q-mt-lg text-right full-width justify-end items-center"},{default:s(()=>[ft("div",ua,[e(ct,{class:"q-ml-sm no-shadow",color:"primary",icon:"search",unelevated:"",label:"Vincular",onClick:()=>{a.mostrarItemModal=!a.mostrarItemModal,a.idxItem=v}},null,8,["onClick"])]),ca,ft("div",ma,[e(ct,{loading:g.buttonLoading,class:"q-ml-sm no-shadow",color:"primary",icon:"add",unelevated:"",label:"Novo",onClick:i=>n.adicionarItem_click(g)},null,8,["loading","onClick"])])]),_:2},1024)]))],8,Je)]),_:1},8,["items"])])]),_:1})]),_:1}),e(Yt,{class:"bg-light"},{default:s(()=>[e(Tt,null,{default:s(()=>[e(Ut,null,{default:s(()=>[ft("span",ha,"Produtos: "+J(n.quantProdutos)+" - N\xE3o vinculados: "+J(n.produtosNaoVinculados),1)]),_:1}),n.produtosNaoVinculados?(Q(),at(ct,{key:0,class:"q-ml-sm no-shadow float-right",color:"primary",label:"Incluir Todos",onClick:n.incluirTodos_click,unelevated:""},null,8,["onClick"])):(Q(),at(ct,{key:1,class:"q-ml-sm no-shadow float-right",color:"primary",label:"Salvar",onClick:n.salvar_click,unelevated:""},null,8,["onClick"]))]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onKeyup"]),e(w,{modelValue:a.mostrarItemModal,"onUpdate:modelValue":l[5]||(l[5]=g=>a.mostrarItemModal=g),habilitarQuantidade:!1,filtro:{ativo:!0,idEmpresa:a.compra.idEmpresa},exibirValorVenda:!1,onSelecionarItens:n.selecionarItens,ref:"promptItem"},null,8,["modelValue","filtro","onSelecionarItens"])],64)}var ga=re(We,[["render",pa]]),_e={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(o,l){(function(h){o.exports=h()})(function(){return function h(k,a,n){function m(b,w){if(!a[b]){if(!k[b]){var g=typeof ae=="function"&&ae;if(!w&&g)return g(b,!0);if(t)return t(b,!0);var v=new Error("Cannot find module '"+b+"'");throw v.code="MODULE_NOT_FOUND",v}var i=a[b]={exports:{}};k[b][0].call(i.exports,function(I){var r=k[b][1][I];return m(r||I)},i,i.exports,h,k,a,n)}return a[b].exports}for(var t=typeof ae=="function"&&ae,c=0;c<n.length;c++)m(n[c]);return m}({1:[function(h,k,a){var n=h("./utils"),m=h("./support"),t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";a.encode=function(c){for(var b,w,g,v,i,I,r,p=[],u=0,_=c.length,E=_,D=n.getTypeOf(c)!=="string";u<c.length;)E=_-u,g=D?(b=c[u++],w=u<_?c[u++]:0,u<_?c[u++]:0):(b=c.charCodeAt(u++),w=u<_?c.charCodeAt(u++):0,u<_?c.charCodeAt(u++):0),v=b>>2,i=(3&b)<<4|w>>4,I=1<E?(15&w)<<2|g>>6:64,r=2<E?63&g:64,p.push(t.charAt(v)+t.charAt(i)+t.charAt(I)+t.charAt(r));return p.join("")},a.decode=function(c){var b,w,g,v,i,I,r=0,p=0,u="data:";if(c.substr(0,u.length)===u)throw new Error("Invalid base64 input, it looks like a data url.");var _,E=3*(c=c.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(c.charAt(c.length-1)===t.charAt(64)&&E--,c.charAt(c.length-2)===t.charAt(64)&&E--,E%1!=0)throw new Error("Invalid base64 input, bad content length.");for(_=m.uint8array?new Uint8Array(0|E):new Array(0|E);r<c.length;)b=t.indexOf(c.charAt(r++))<<2|(v=t.indexOf(c.charAt(r++)))>>4,w=(15&v)<<4|(i=t.indexOf(c.charAt(r++)))>>2,g=(3&i)<<6|(I=t.indexOf(c.charAt(r++))),_[p++]=b,i!==64&&(_[p++]=w),I!==64&&(_[p++]=g);return _}},{"./support":30,"./utils":32}],2:[function(h,k,a){var n=h("./external"),m=h("./stream/DataWorker"),t=h("./stream/Crc32Probe"),c=h("./stream/DataLengthProbe");function b(w,g,v,i,I){this.compressedSize=w,this.uncompressedSize=g,this.crc32=v,this.compression=i,this.compressedContent=I}b.prototype={getContentWorker:function(){var w=new m(n.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new c("data_length")),g=this;return w.on("end",function(){if(this.streamInfo.data_length!==g.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),w},getCompressedWorker:function(){return new m(n.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},b.createWorkerFrom=function(w,g,v){return w.pipe(new t).pipe(new c("uncompressedSize")).pipe(g.compressWorker(v)).pipe(new c("compressedSize")).withStreamInfo("compression",g)},k.exports=b},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(h,k,a){var n=h("./stream/GenericWorker");a.STORE={magic:"\0\0",compressWorker:function(){return new n("STORE compression")},uncompressWorker:function(){return new n("STORE decompression")}},a.DEFLATE=h("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(h,k,a){var n=h("./utils"),m=function(){for(var t,c=[],b=0;b<256;b++){t=b;for(var w=0;w<8;w++)t=1&t?3988292384^t>>>1:t>>>1;c[b]=t}return c}();k.exports=function(t,c){return t!==void 0&&t.length?n.getTypeOf(t)!=="string"?function(b,w,g,v){var i=m,I=v+g;b^=-1;for(var r=v;r<I;r++)b=b>>>8^i[255&(b^w[r])];return-1^b}(0|c,t,t.length,0):function(b,w,g,v){var i=m,I=v+g;b^=-1;for(var r=v;r<I;r++)b=b>>>8^i[255&(b^w.charCodeAt(r))];return-1^b}(0|c,t,t.length,0):0}},{"./utils":32}],5:[function(h,k,a){a.base64=!1,a.binary=!1,a.dir=!1,a.createFolders=!0,a.date=null,a.compression=null,a.compressionOptions=null,a.comment=null,a.unixPermissions=null,a.dosPermissions=null},{}],6:[function(h,k,a){var n=null;n=typeof Promise!="undefined"?Promise:h("lie"),k.exports={Promise:n}},{lie:37}],7:[function(h,k,a){var n=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Uint32Array!="undefined",m=h("pako"),t=h("./utils"),c=h("./stream/GenericWorker"),b=n?"uint8array":"array";function w(g,v){c.call(this,"FlateWorker/"+g),this._pako=null,this._pakoAction=g,this._pakoOptions=v,this.meta={}}a.magic="\b\0",t.inherits(w,c),w.prototype.processChunk=function(g){this.meta=g.meta,this._pako===null&&this._createPako(),this._pako.push(t.transformTo(b,g.data),!1)},w.prototype.flush=function(){c.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},w.prototype.cleanUp=function(){c.prototype.cleanUp.call(this),this._pako=null},w.prototype._createPako=function(){this._pako=new m[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var g=this;this._pako.onData=function(v){g.push({data:v,meta:g.meta})}},a.compressWorker=function(g){return new w("Deflate",g)},a.uncompressWorker=function(){return new w("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(h,k,a){function n(i,I){var r,p="";for(r=0;r<I;r++)p+=String.fromCharCode(255&i),i>>>=8;return p}function m(i,I,r,p,u,_){var E,D,x=i.file,B=i.compression,N=_!==b.utf8encode,j=t.transformTo("string",_(x.name)),A=t.transformTo("string",b.utf8encode(x.name)),H=x.comment,et=t.transformTo("string",_(H)),S=t.transformTo("string",b.utf8encode(H)),q=A.length!==x.name.length,f=S.length!==H.length,U="",st="",$="",nt=x.dir,Z=x.date,it={crc32:0,compressedSize:0,uncompressedSize:0};I&&!r||(it.crc32=i.crc32,it.compressedSize=i.compressedSize,it.uncompressedSize=i.uncompressedSize);var F=0;I&&(F|=8),N||!q&&!f||(F|=2048);var z=0,rt=0;nt&&(z|=16),u==="UNIX"?(rt=798,z|=function(G,yt){var Et=G;return G||(Et=yt?16893:33204),(65535&Et)<<16}(x.unixPermissions,nt)):(rt=20,z|=function(G){return 63&(G||0)}(x.dosPermissions)),E=Z.getUTCHours(),E<<=6,E|=Z.getUTCMinutes(),E<<=5,E|=Z.getUTCSeconds()/2,D=Z.getUTCFullYear()-1980,D<<=4,D|=Z.getUTCMonth()+1,D<<=5,D|=Z.getUTCDate(),q&&(st=n(1,1)+n(w(j),4)+A,U+="up"+n(st.length,2)+st),f&&($=n(1,1)+n(w(et),4)+S,U+="uc"+n($.length,2)+$);var K="";return K+=`
\0`,K+=n(F,2),K+=B.magic,K+=n(E,2),K+=n(D,2),K+=n(it.crc32,4),K+=n(it.compressedSize,4),K+=n(it.uncompressedSize,4),K+=n(j.length,2),K+=n(U.length,2),{fileRecord:g.LOCAL_FILE_HEADER+K+j+U,dirRecord:g.CENTRAL_FILE_HEADER+n(rt,2)+K+n(et.length,2)+"\0\0\0\0"+n(z,4)+n(p,4)+j+U+et}}var t=h("../utils"),c=h("../stream/GenericWorker"),b=h("../utf8"),w=h("../crc32"),g=h("../signature");function v(i,I,r,p){c.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=I,this.zipPlatform=r,this.encodeFileName=p,this.streamFiles=i,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}t.inherits(v,c),v.prototype.push=function(i){var I=i.meta.percent||0,r=this.entriesCount,p=this._sources.length;this.accumulate?this.contentBuffer.push(i):(this.bytesWritten+=i.data.length,c.prototype.push.call(this,{data:i.data,meta:{currentFile:this.currentFile,percent:r?(I+100*(r-p-1))/r:100}}))},v.prototype.openedSource=function(i){this.currentSourceOffset=this.bytesWritten,this.currentFile=i.file.name;var I=this.streamFiles&&!i.file.dir;if(I){var r=m(i,I,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:r.fileRecord,meta:{percent:0}})}else this.accumulate=!0},v.prototype.closedSource=function(i){this.accumulate=!1;var I=this.streamFiles&&!i.file.dir,r=m(i,I,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(r.dirRecord),I)this.push({data:function(p){return g.DATA_DESCRIPTOR+n(p.crc32,4)+n(p.compressedSize,4)+n(p.uncompressedSize,4)}(i),meta:{percent:100}});else for(this.push({data:r.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},v.prototype.flush=function(){for(var i=this.bytesWritten,I=0;I<this.dirRecords.length;I++)this.push({data:this.dirRecords[I],meta:{percent:100}});var r=this.bytesWritten-i,p=function(u,_,E,D,x){var B=t.transformTo("string",x(D));return g.CENTRAL_DIRECTORY_END+"\0\0\0\0"+n(u,2)+n(u,2)+n(_,4)+n(E,4)+n(B.length,2)+B}(this.dirRecords.length,r,i,this.zipComment,this.encodeFileName);this.push({data:p,meta:{percent:100}})},v.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},v.prototype.registerPrevious=function(i){this._sources.push(i);var I=this;return i.on("data",function(r){I.processChunk(r)}),i.on("end",function(){I.closedSource(I.previous.streamInfo),I._sources.length?I.prepareNextSource():I.end()}),i.on("error",function(r){I.error(r)}),this},v.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},v.prototype.error=function(i){var I=this._sources;if(!c.prototype.error.call(this,i))return!1;for(var r=0;r<I.length;r++)try{I[r].error(i)}catch{}return!0},v.prototype.lock=function(){c.prototype.lock.call(this);for(var i=this._sources,I=0;I<i.length;I++)i[I].lock()},k.exports=v},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(h,k,a){var n=h("../compressions"),m=h("./ZipFileWorker");a.generateWorker=function(t,c,b){var w=new m(c.streamFiles,b,c.platform,c.encodeFileName),g=0;try{t.forEach(function(v,i){g++;var I=function(_,E){var D=_||E,x=n[D];if(!x)throw new Error(D+" is not a valid compression method !");return x}(i.options.compression,c.compression),r=i.options.compressionOptions||c.compressionOptions||{},p=i.dir,u=i.date;i._compressWorker(I,r).withStreamInfo("file",{name:v,dir:p,date:u,comment:i.comment||"",unixPermissions:i.unixPermissions,dosPermissions:i.dosPermissions}).pipe(w)}),w.entriesCount=g}catch(v){w.error(v)}return w}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(h,k,a){function n(){if(!(this instanceof n))return new n;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var m=new n;for(var t in this)typeof this[t]!="function"&&(m[t]=this[t]);return m}}(n.prototype=h("./object")).loadAsync=h("./load"),n.support=h("./support"),n.defaults=h("./defaults"),n.version="3.10.1",n.loadAsync=function(m,t){return new n().loadAsync(m,t)},n.external=h("./external"),k.exports=n},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(h,k,a){var n=h("./utils"),m=h("./external"),t=h("./utf8"),c=h("./zipEntries"),b=h("./stream/Crc32Probe"),w=h("./nodejsUtils");function g(v){return new m.Promise(function(i,I){var r=v.decompressed.getContentWorker().pipe(new b);r.on("error",function(p){I(p)}).on("end",function(){r.streamInfo.crc32!==v.decompressed.crc32?I(new Error("Corrupted zip : CRC32 mismatch")):i()}).resume()})}k.exports=function(v,i){var I=this;return i=n.extend(i||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:t.utf8decode}),w.isNode&&w.isStream(v)?m.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):n.prepareContent("the loaded zip file",v,!0,i.optimizedBinaryString,i.base64).then(function(r){var p=new c(i);return p.load(r),p}).then(function(r){var p=[m.Promise.resolve(r)],u=r.files;if(i.checkCRC32)for(var _=0;_<u.length;_++)p.push(g(u[_]));return m.Promise.all(p)}).then(function(r){for(var p=r.shift(),u=p.files,_=0;_<u.length;_++){var E=u[_],D=E.fileNameStr,x=n.resolve(E.fileNameStr);I.file(x,E.decompressed,{binary:!0,optimizedBinaryString:!0,date:E.date,dir:E.dir,comment:E.fileCommentStr.length?E.fileCommentStr:null,unixPermissions:E.unixPermissions,dosPermissions:E.dosPermissions,createFolders:i.createFolders}),E.dir||(I.file(x).unsafeOriginalName=D)}return p.zipComment.length&&(I.comment=p.zipComment),I})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(h,k,a){var n=h("../utils"),m=h("../stream/GenericWorker");function t(c,b){m.call(this,"Nodejs stream input adapter for "+c),this._upstreamEnded=!1,this._bindStream(b)}n.inherits(t,m),t.prototype._bindStream=function(c){var b=this;(this._stream=c).pause(),c.on("data",function(w){b.push({data:w,meta:{percent:0}})}).on("error",function(w){b.isPaused?this.generatedError=w:b.error(w)}).on("end",function(){b.isPaused?b._upstreamEnded=!0:b.end()})},t.prototype.pause=function(){return!!m.prototype.pause.call(this)&&(this._stream.pause(),!0)},t.prototype.resume=function(){return!!m.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},k.exports=t},{"../stream/GenericWorker":28,"../utils":32}],13:[function(h,k,a){var n=h("readable-stream").Readable;function m(t,c,b){n.call(this,c),this._helper=t;var w=this;t.on("data",function(g,v){w.push(g)||w._helper.pause(),b&&b(v)}).on("error",function(g){w.emit("error",g)}).on("end",function(){w.push(null)})}h("../utils").inherits(m,n),m.prototype._read=function(){this._helper.resume()},k.exports=m},{"../utils":32,"readable-stream":16}],14:[function(h,k,a){k.exports={isNode:typeof Buffer!="undefined",newBufferFrom:function(n,m){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(n,m);if(typeof n=="number")throw new Error('The "data" argument must not be a number');return new Buffer(n,m)},allocBuffer:function(n){if(Buffer.alloc)return Buffer.alloc(n);var m=new Buffer(n);return m.fill(0),m},isBuffer:function(n){return Buffer.isBuffer(n)},isStream:function(n){return n&&typeof n.on=="function"&&typeof n.pause=="function"&&typeof n.resume=="function"}}},{}],15:[function(h,k,a){function n(x,B,N){var j,A=t.getTypeOf(B),H=t.extend(N||{},w);H.date=H.date||new Date,H.compression!==null&&(H.compression=H.compression.toUpperCase()),typeof H.unixPermissions=="string"&&(H.unixPermissions=parseInt(H.unixPermissions,8)),H.unixPermissions&&16384&H.unixPermissions&&(H.dir=!0),H.dosPermissions&&16&H.dosPermissions&&(H.dir=!0),H.dir&&(x=u(x)),H.createFolders&&(j=p(x))&&_.call(this,j,!0);var et=A==="string"&&H.binary===!1&&H.base64===!1;N&&N.binary!==void 0||(H.binary=!et),(B instanceof g&&B.uncompressedSize===0||H.dir||!B||B.length===0)&&(H.base64=!1,H.binary=!0,B="",H.compression="STORE",A="string");var S=null;S=B instanceof g||B instanceof c?B:I.isNode&&I.isStream(B)?new r(x,B):t.prepareContent(x,B,H.binary,H.optimizedBinaryString,H.base64);var q=new v(x,S,H);this.files[x]=q}var m=h("./utf8"),t=h("./utils"),c=h("./stream/GenericWorker"),b=h("./stream/StreamHelper"),w=h("./defaults"),g=h("./compressedObject"),v=h("./zipObject"),i=h("./generate"),I=h("./nodejsUtils"),r=h("./nodejs/NodejsStreamInputAdapter"),p=function(x){x.slice(-1)==="/"&&(x=x.substring(0,x.length-1));var B=x.lastIndexOf("/");return 0<B?x.substring(0,B):""},u=function(x){return x.slice(-1)!=="/"&&(x+="/"),x},_=function(x,B){return B=B!==void 0?B:w.createFolders,x=u(x),this.files[x]||n.call(this,x,null,{dir:!0,createFolders:B}),this.files[x]};function E(x){return Object.prototype.toString.call(x)==="[object RegExp]"}var D={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(x){var B,N,j;for(B in this.files)j=this.files[B],(N=B.slice(this.root.length,B.length))&&B.slice(0,this.root.length)===this.root&&x(N,j)},filter:function(x){var B=[];return this.forEach(function(N,j){x(N,j)&&B.push(j)}),B},file:function(x,B,N){if(arguments.length!==1)return x=this.root+x,n.call(this,x,B,N),this;if(E(x)){var j=x;return this.filter(function(H,et){return!et.dir&&j.test(H)})}var A=this.files[this.root+x];return A&&!A.dir?A:null},folder:function(x){if(!x)return this;if(E(x))return this.filter(function(A,H){return H.dir&&x.test(A)});var B=this.root+x,N=_.call(this,B),j=this.clone();return j.root=N.name,j},remove:function(x){x=this.root+x;var B=this.files[x];if(B||(x.slice(-1)!=="/"&&(x+="/"),B=this.files[x]),B&&!B.dir)delete this.files[x];else for(var N=this.filter(function(A,H){return H.name.slice(0,x.length)===x}),j=0;j<N.length;j++)delete this.files[N[j].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(x){var B,N={};try{if((N=t.extend(x||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:m.utf8encode})).type=N.type.toLowerCase(),N.compression=N.compression.toUpperCase(),N.type==="binarystring"&&(N.type="string"),!N.type)throw new Error("No output type specified.");t.checkSupport(N.type),N.platform!=="darwin"&&N.platform!=="freebsd"&&N.platform!=="linux"&&N.platform!=="sunos"||(N.platform="UNIX"),N.platform==="win32"&&(N.platform="DOS");var j=N.comment||this.comment||"";B=i.generateWorker(this,N,j)}catch(A){(B=new c("error")).error(A)}return new b(B,N.type||"string",N.mimeType)},generateAsync:function(x,B){return this.generateInternalStream(x).accumulate(B)},generateNodeStream:function(x,B){return(x=x||{}).type||(x.type="nodebuffer"),this.generateInternalStream(x).toNodejsStream(B)}};k.exports=D},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(h,k,a){k.exports=h("stream")},{stream:void 0}],17:[function(h,k,a){var n=h("./DataReader");function m(t){n.call(this,t);for(var c=0;c<this.data.length;c++)t[c]=255&t[c]}h("../utils").inherits(m,n),m.prototype.byteAt=function(t){return this.data[this.zero+t]},m.prototype.lastIndexOfSignature=function(t){for(var c=t.charCodeAt(0),b=t.charCodeAt(1),w=t.charCodeAt(2),g=t.charCodeAt(3),v=this.length-4;0<=v;--v)if(this.data[v]===c&&this.data[v+1]===b&&this.data[v+2]===w&&this.data[v+3]===g)return v-this.zero;return-1},m.prototype.readAndCheckSignature=function(t){var c=t.charCodeAt(0),b=t.charCodeAt(1),w=t.charCodeAt(2),g=t.charCodeAt(3),v=this.readData(4);return c===v[0]&&b===v[1]&&w===v[2]&&g===v[3]},m.prototype.readData=function(t){if(this.checkOffset(t),t===0)return[];var c=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,c},k.exports=m},{"../utils":32,"./DataReader":18}],18:[function(h,k,a){var n=h("../utils");function m(t){this.data=t,this.length=t.length,this.index=0,this.zero=0}m.prototype={checkOffset:function(t){this.checkIndex(this.index+t)},checkIndex:function(t){if(this.length<this.zero+t||t<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+t+"). Corrupted zip ?")},setIndex:function(t){this.checkIndex(t),this.index=t},skip:function(t){this.setIndex(this.index+t)},byteAt:function(){},readInt:function(t){var c,b=0;for(this.checkOffset(t),c=this.index+t-1;c>=this.index;c--)b=(b<<8)+this.byteAt(c);return this.index+=t,b},readString:function(t){return n.transformTo("string",this.readData(t))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var t=this.readInt(4);return new Date(Date.UTC(1980+(t>>25&127),(t>>21&15)-1,t>>16&31,t>>11&31,t>>5&63,(31&t)<<1))}},k.exports=m},{"../utils":32}],19:[function(h,k,a){var n=h("./Uint8ArrayReader");function m(t){n.call(this,t)}h("../utils").inherits(m,n),m.prototype.readData=function(t){this.checkOffset(t);var c=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,c},k.exports=m},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(h,k,a){var n=h("./DataReader");function m(t){n.call(this,t)}h("../utils").inherits(m,n),m.prototype.byteAt=function(t){return this.data.charCodeAt(this.zero+t)},m.prototype.lastIndexOfSignature=function(t){return this.data.lastIndexOf(t)-this.zero},m.prototype.readAndCheckSignature=function(t){return t===this.readData(4)},m.prototype.readData=function(t){this.checkOffset(t);var c=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,c},k.exports=m},{"../utils":32,"./DataReader":18}],21:[function(h,k,a){var n=h("./ArrayReader");function m(t){n.call(this,t)}h("../utils").inherits(m,n),m.prototype.readData=function(t){if(this.checkOffset(t),t===0)return new Uint8Array(0);var c=this.data.subarray(this.zero+this.index,this.zero+this.index+t);return this.index+=t,c},k.exports=m},{"../utils":32,"./ArrayReader":17}],22:[function(h,k,a){var n=h("../utils"),m=h("../support"),t=h("./ArrayReader"),c=h("./StringReader"),b=h("./NodeBufferReader"),w=h("./Uint8ArrayReader");k.exports=function(g){var v=n.getTypeOf(g);return n.checkSupport(v),v!=="string"||m.uint8array?v==="nodebuffer"?new b(g):m.uint8array?new w(n.transformTo("uint8array",g)):new t(n.transformTo("array",g)):new c(g)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(h,k,a){a.LOCAL_FILE_HEADER="PK",a.CENTRAL_FILE_HEADER="PK",a.CENTRAL_DIRECTORY_END="PK",a.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",a.ZIP64_CENTRAL_DIRECTORY_END="PK",a.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(h,k,a){var n=h("./GenericWorker"),m=h("../utils");function t(c){n.call(this,"ConvertWorker to "+c),this.destType=c}m.inherits(t,n),t.prototype.processChunk=function(c){this.push({data:m.transformTo(this.destType,c.data),meta:c.meta})},k.exports=t},{"../utils":32,"./GenericWorker":28}],25:[function(h,k,a){var n=h("./GenericWorker"),m=h("../crc32");function t(){n.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}h("../utils").inherits(t,n),t.prototype.processChunk=function(c){this.streamInfo.crc32=m(c.data,this.streamInfo.crc32||0),this.push(c)},k.exports=t},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(h,k,a){var n=h("../utils"),m=h("./GenericWorker");function t(c){m.call(this,"DataLengthProbe for "+c),this.propName=c,this.withStreamInfo(c,0)}n.inherits(t,m),t.prototype.processChunk=function(c){if(c){var b=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=b+c.data.length}m.prototype.processChunk.call(this,c)},k.exports=t},{"../utils":32,"./GenericWorker":28}],27:[function(h,k,a){var n=h("../utils"),m=h("./GenericWorker");function t(c){m.call(this,"DataWorker");var b=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,c.then(function(w){b.dataIsReady=!0,b.data=w,b.max=w&&w.length||0,b.type=n.getTypeOf(w),b.isPaused||b._tickAndRepeat()},function(w){b.error(w)})}n.inherits(t,m),t.prototype.cleanUp=function(){m.prototype.cleanUp.call(this),this.data=null},t.prototype.resume=function(){return!!m.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,n.delay(this._tickAndRepeat,[],this)),!0)},t.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(n.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},t.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var c=null,b=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":c=this.data.substring(this.index,b);break;case"uint8array":c=this.data.subarray(this.index,b);break;case"array":case"nodebuffer":c=this.data.slice(this.index,b)}return this.index=b,this.push({data:c,meta:{percent:this.max?this.index/this.max*100:0}})},k.exports=t},{"../utils":32,"./GenericWorker":28}],28:[function(h,k,a){function n(m){this.name=m||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}n.prototype={push:function(m){this.emit("data",m)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(m){this.emit("error",m)}return!0},error:function(m){return!this.isFinished&&(this.isPaused?this.generatedError=m:(this.isFinished=!0,this.emit("error",m),this.previous&&this.previous.error(m),this.cleanUp()),!0)},on:function(m,t){return this._listeners[m].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(m,t){if(this._listeners[m])for(var c=0;c<this._listeners[m].length;c++)this._listeners[m][c].call(this,t)},pipe:function(m){return m.registerPrevious(this)},registerPrevious:function(m){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=m.streamInfo,this.mergeStreamInfo(),this.previous=m;var t=this;return m.on("data",function(c){t.processChunk(c)}),m.on("end",function(){t.end()}),m.on("error",function(c){t.error(c)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var m=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),m=!0),this.previous&&this.previous.resume(),!m},flush:function(){},processChunk:function(m){this.push(m)},withStreamInfo:function(m,t){return this.extraStreamInfo[m]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var m in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,m)&&(this.streamInfo[m]=this.extraStreamInfo[m])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var m="Worker "+this.name;return this.previous?this.previous+" -> "+m:m}},k.exports=n},{}],29:[function(h,k,a){var n=h("../utils"),m=h("./ConvertWorker"),t=h("./GenericWorker"),c=h("../base64"),b=h("../support"),w=h("../external"),g=null;if(b.nodestream)try{g=h("../nodejs/NodejsStreamOutputAdapter")}catch{}function v(I,r){return new w.Promise(function(p,u){var _=[],E=I._internalType,D=I._outputType,x=I._mimeType;I.on("data",function(B,N){_.push(B),r&&r(N)}).on("error",function(B){_=[],u(B)}).on("end",function(){try{var B=function(N,j,A){switch(N){case"blob":return n.newBlob(n.transformTo("arraybuffer",j),A);case"base64":return c.encode(j);default:return n.transformTo(N,j)}}(D,function(N,j){var A,H=0,et=null,S=0;for(A=0;A<j.length;A++)S+=j[A].length;switch(N){case"string":return j.join("");case"array":return Array.prototype.concat.apply([],j);case"uint8array":for(et=new Uint8Array(S),A=0;A<j.length;A++)et.set(j[A],H),H+=j[A].length;return et;case"nodebuffer":return Buffer.concat(j);default:throw new Error("concat : unsupported type '"+N+"'")}}(E,_),x);p(B)}catch(N){u(N)}_=[]}).resume()})}function i(I,r,p){var u=r;switch(r){case"blob":case"arraybuffer":u="uint8array";break;case"base64":u="string"}try{this._internalType=u,this._outputType=r,this._mimeType=p,n.checkSupport(u),this._worker=I.pipe(new m(u)),I.lock()}catch(_){this._worker=new t("error"),this._worker.error(_)}}i.prototype={accumulate:function(I){return v(this,I)},on:function(I,r){var p=this;return I==="data"?this._worker.on(I,function(u){r.call(p,u.data,u.meta)}):this._worker.on(I,function(){n.delay(r,arguments,p)}),this},resume:function(){return n.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(I){if(n.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new g(this,{objectMode:this._outputType!=="nodebuffer"},I)}},k.exports=i},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(h,k,a){if(a.base64=!0,a.array=!0,a.string=!0,a.arraybuffer=typeof ArrayBuffer!="undefined"&&typeof Uint8Array!="undefined",a.nodebuffer=typeof Buffer!="undefined",a.uint8array=typeof Uint8Array!="undefined",typeof ArrayBuffer=="undefined")a.blob=!1;else{var n=new ArrayBuffer(0);try{a.blob=new Blob([n],{type:"application/zip"}).size===0}catch{try{var m=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);m.append(n),a.blob=m.getBlob("application/zip").size===0}catch{a.blob=!1}}}try{a.nodestream=!!h("readable-stream").Readable}catch{a.nodestream=!1}},{"readable-stream":16}],31:[function(h,k,a){for(var n=h("./utils"),m=h("./support"),t=h("./nodejsUtils"),c=h("./stream/GenericWorker"),b=new Array(256),w=0;w<256;w++)b[w]=252<=w?6:248<=w?5:240<=w?4:224<=w?3:192<=w?2:1;b[254]=b[254]=1;function g(){c.call(this,"utf-8 decode"),this.leftOver=null}function v(){c.call(this,"utf-8 encode")}a.utf8encode=function(i){return m.nodebuffer?t.newBufferFrom(i,"utf-8"):function(I){var r,p,u,_,E,D=I.length,x=0;for(_=0;_<D;_++)(64512&(p=I.charCodeAt(_)))==55296&&_+1<D&&(64512&(u=I.charCodeAt(_+1)))==56320&&(p=65536+(p-55296<<10)+(u-56320),_++),x+=p<128?1:p<2048?2:p<65536?3:4;for(r=m.uint8array?new Uint8Array(x):new Array(x),_=E=0;E<x;_++)(64512&(p=I.charCodeAt(_)))==55296&&_+1<D&&(64512&(u=I.charCodeAt(_+1)))==56320&&(p=65536+(p-55296<<10)+(u-56320),_++),p<128?r[E++]=p:(p<2048?r[E++]=192|p>>>6:(p<65536?r[E++]=224|p>>>12:(r[E++]=240|p>>>18,r[E++]=128|p>>>12&63),r[E++]=128|p>>>6&63),r[E++]=128|63&p);return r}(i)},a.utf8decode=function(i){return m.nodebuffer?n.transformTo("nodebuffer",i).toString("utf-8"):function(I){var r,p,u,_,E=I.length,D=new Array(2*E);for(r=p=0;r<E;)if((u=I[r++])<128)D[p++]=u;else if(4<(_=b[u]))D[p++]=65533,r+=_-1;else{for(u&=_===2?31:_===3?15:7;1<_&&r<E;)u=u<<6|63&I[r++],_--;1<_?D[p++]=65533:u<65536?D[p++]=u:(u-=65536,D[p++]=55296|u>>10&1023,D[p++]=56320|1023&u)}return D.length!==p&&(D.subarray?D=D.subarray(0,p):D.length=p),n.applyFromCharCode(D)}(i=n.transformTo(m.uint8array?"uint8array":"array",i))},n.inherits(g,c),g.prototype.processChunk=function(i){var I=n.transformTo(m.uint8array?"uint8array":"array",i.data);if(this.leftOver&&this.leftOver.length){if(m.uint8array){var r=I;(I=new Uint8Array(r.length+this.leftOver.length)).set(this.leftOver,0),I.set(r,this.leftOver.length)}else I=this.leftOver.concat(I);this.leftOver=null}var p=function(_,E){var D;for((E=E||_.length)>_.length&&(E=_.length),D=E-1;0<=D&&(192&_[D])==128;)D--;return D<0||D===0?E:D+b[_[D]]>E?D:E}(I),u=I;p!==I.length&&(m.uint8array?(u=I.subarray(0,p),this.leftOver=I.subarray(p,I.length)):(u=I.slice(0,p),this.leftOver=I.slice(p,I.length))),this.push({data:a.utf8decode(u),meta:i.meta})},g.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:a.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},a.Utf8DecodeWorker=g,n.inherits(v,c),v.prototype.processChunk=function(i){this.push({data:a.utf8encode(i.data),meta:i.meta})},a.Utf8EncodeWorker=v},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(h,k,a){var n=h("./support"),m=h("./base64"),t=h("./nodejsUtils"),c=h("./external");function b(r){return r}function w(r,p){for(var u=0;u<r.length;++u)p[u]=255&r.charCodeAt(u);return p}h("setimmediate"),a.newBlob=function(r,p){a.checkSupport("blob");try{return new Blob([r],{type:p})}catch{try{var u=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return u.append(r),u.getBlob(p)}catch{throw new Error("Bug : can't construct the Blob.")}}};var g={stringifyByChunk:function(r,p,u){var _=[],E=0,D=r.length;if(D<=u)return String.fromCharCode.apply(null,r);for(;E<D;)p==="array"||p==="nodebuffer"?_.push(String.fromCharCode.apply(null,r.slice(E,Math.min(E+u,D)))):_.push(String.fromCharCode.apply(null,r.subarray(E,Math.min(E+u,D)))),E+=u;return _.join("")},stringifyByChar:function(r){for(var p="",u=0;u<r.length;u++)p+=String.fromCharCode(r[u]);return p},applyCanBeUsed:{uint8array:function(){try{return n.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return n.nodebuffer&&String.fromCharCode.apply(null,t.allocBuffer(1)).length===1}catch{return!1}}()}};function v(r){var p=65536,u=a.getTypeOf(r),_=!0;if(u==="uint8array"?_=g.applyCanBeUsed.uint8array:u==="nodebuffer"&&(_=g.applyCanBeUsed.nodebuffer),_)for(;1<p;)try{return g.stringifyByChunk(r,u,p)}catch{p=Math.floor(p/2)}return g.stringifyByChar(r)}function i(r,p){for(var u=0;u<r.length;u++)p[u]=r[u];return p}a.applyFromCharCode=v;var I={};I.string={string:b,array:function(r){return w(r,new Array(r.length))},arraybuffer:function(r){return I.string.uint8array(r).buffer},uint8array:function(r){return w(r,new Uint8Array(r.length))},nodebuffer:function(r){return w(r,t.allocBuffer(r.length))}},I.array={string:v,array:b,arraybuffer:function(r){return new Uint8Array(r).buffer},uint8array:function(r){return new Uint8Array(r)},nodebuffer:function(r){return t.newBufferFrom(r)}},I.arraybuffer={string:function(r){return v(new Uint8Array(r))},array:function(r){return i(new Uint8Array(r),new Array(r.byteLength))},arraybuffer:b,uint8array:function(r){return new Uint8Array(r)},nodebuffer:function(r){return t.newBufferFrom(new Uint8Array(r))}},I.uint8array={string:v,array:function(r){return i(r,new Array(r.length))},arraybuffer:function(r){return r.buffer},uint8array:b,nodebuffer:function(r){return t.newBufferFrom(r)}},I.nodebuffer={string:v,array:function(r){return i(r,new Array(r.length))},arraybuffer:function(r){return I.nodebuffer.uint8array(r).buffer},uint8array:function(r){return i(r,new Uint8Array(r.length))},nodebuffer:b},a.transformTo=function(r,p){if(p=p||"",!r)return p;a.checkSupport(r);var u=a.getTypeOf(p);return I[u][r](p)},a.resolve=function(r){for(var p=r.split("/"),u=[],_=0;_<p.length;_++){var E=p[_];E==="."||E===""&&_!==0&&_!==p.length-1||(E===".."?u.pop():u.push(E))}return u.join("/")},a.getTypeOf=function(r){return typeof r=="string"?"string":Object.prototype.toString.call(r)==="[object Array]"?"array":n.nodebuffer&&t.isBuffer(r)?"nodebuffer":n.uint8array&&r instanceof Uint8Array?"uint8array":n.arraybuffer&&r instanceof ArrayBuffer?"arraybuffer":void 0},a.checkSupport=function(r){if(!n[r.toLowerCase()])throw new Error(r+" is not supported by this platform")},a.MAX_VALUE_16BITS=65535,a.MAX_VALUE_32BITS=-1,a.pretty=function(r){var p,u,_="";for(u=0;u<(r||"").length;u++)_+="\\x"+((p=r.charCodeAt(u))<16?"0":"")+p.toString(16).toUpperCase();return _},a.delay=function(r,p,u){setImmediate(function(){r.apply(u||null,p||[])})},a.inherits=function(r,p){function u(){}u.prototype=p.prototype,r.prototype=new u},a.extend=function(){var r,p,u={};for(r=0;r<arguments.length;r++)for(p in arguments[r])Object.prototype.hasOwnProperty.call(arguments[r],p)&&u[p]===void 0&&(u[p]=arguments[r][p]);return u},a.prepareContent=function(r,p,u,_,E){return c.Promise.resolve(p).then(function(D){return n.blob&&(D instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(D))!==-1)&&typeof FileReader!="undefined"?new c.Promise(function(x,B){var N=new FileReader;N.onload=function(j){x(j.target.result)},N.onerror=function(j){B(j.target.error)},N.readAsArrayBuffer(D)}):D}).then(function(D){var x=a.getTypeOf(D);return x?(x==="arraybuffer"?D=a.transformTo("uint8array",D):x==="string"&&(E?D=m.decode(D):u&&_!==!0&&(D=function(B){return w(B,n.uint8array?new Uint8Array(B.length):new Array(B.length))}(D))),D):c.Promise.reject(new Error("Can't read the data of '"+r+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(h,k,a){var n=h("./reader/readerFor"),m=h("./utils"),t=h("./signature"),c=h("./zipEntry"),b=h("./support");function w(g){this.files=[],this.loadOptions=g}w.prototype={checkSignature:function(g){if(!this.reader.readAndCheckSignature(g)){this.reader.index-=4;var v=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+m.pretty(v)+", expected "+m.pretty(g)+")")}},isSignature:function(g,v){var i=this.reader.index;this.reader.setIndex(g);var I=this.reader.readString(4)===v;return this.reader.setIndex(i),I},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var g=this.reader.readData(this.zipCommentLength),v=b.uint8array?"uint8array":"array",i=m.transformTo(v,g);this.zipComment=this.loadOptions.decodeFileName(i)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var g,v,i,I=this.zip64EndOfCentralSize-44;0<I;)g=this.reader.readInt(2),v=this.reader.readInt(4),i=this.reader.readData(v),this.zip64ExtensibleData[g]={id:g,length:v,value:i}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var g,v;for(g=0;g<this.files.length;g++)v=this.files[g],this.reader.setIndex(v.localHeaderOffset),this.checkSignature(t.LOCAL_FILE_HEADER),v.readLocalPart(this.reader),v.handleUTF8(),v.processAttributes()},readCentralDir:function(){var g;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(t.CENTRAL_FILE_HEADER);)(g=new c({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(g);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var g=this.reader.lastIndexOfSignature(t.CENTRAL_DIRECTORY_END);if(g<0)throw this.isSignature(0,t.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(g);var v=g;if(this.checkSignature(t.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===m.MAX_VALUE_16BITS||this.diskWithCentralDirStart===m.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===m.MAX_VALUE_16BITS||this.centralDirRecords===m.MAX_VALUE_16BITS||this.centralDirSize===m.MAX_VALUE_32BITS||this.centralDirOffset===m.MAX_VALUE_32BITS){if(this.zip64=!0,(g=this.reader.lastIndexOfSignature(t.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(g),this.checkSignature(t.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,t.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(t.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(t.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var i=this.centralDirOffset+this.centralDirSize;this.zip64&&(i+=20,i+=12+this.zip64EndOfCentralSize);var I=v-i;if(0<I)this.isSignature(v,t.CENTRAL_FILE_HEADER)||(this.reader.zero=I);else if(I<0)throw new Error("Corrupted zip: missing "+Math.abs(I)+" bytes.")},prepareReader:function(g){this.reader=n(g)},load:function(g){this.prepareReader(g),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},k.exports=w},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(h,k,a){var n=h("./reader/readerFor"),m=h("./utils"),t=h("./compressedObject"),c=h("./crc32"),b=h("./utf8"),w=h("./compressions"),g=h("./support");function v(i,I){this.options=i,this.loadOptions=I}v.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(i){var I,r;if(i.skip(22),this.fileNameLength=i.readInt(2),r=i.readInt(2),this.fileName=i.readData(this.fileNameLength),i.skip(r),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((I=function(p){for(var u in w)if(Object.prototype.hasOwnProperty.call(w,u)&&w[u].magic===p)return w[u];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+m.pretty(this.compressionMethod)+" unknown (inner file : "+m.transformTo("string",this.fileName)+")");this.decompressed=new t(this.compressedSize,this.uncompressedSize,this.crc32,I,i.readData(this.compressedSize))},readCentralPart:function(i){this.versionMadeBy=i.readInt(2),i.skip(2),this.bitFlag=i.readInt(2),this.compressionMethod=i.readString(2),this.date=i.readDate(),this.crc32=i.readInt(4),this.compressedSize=i.readInt(4),this.uncompressedSize=i.readInt(4);var I=i.readInt(2);if(this.extraFieldsLength=i.readInt(2),this.fileCommentLength=i.readInt(2),this.diskNumberStart=i.readInt(2),this.internalFileAttributes=i.readInt(2),this.externalFileAttributes=i.readInt(4),this.localHeaderOffset=i.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");i.skip(I),this.readExtraFields(i),this.parseZIP64ExtraField(i),this.fileComment=i.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var i=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),i==0&&(this.dosPermissions=63&this.externalFileAttributes),i==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var i=n(this.extraFields[1].value);this.uncompressedSize===m.MAX_VALUE_32BITS&&(this.uncompressedSize=i.readInt(8)),this.compressedSize===m.MAX_VALUE_32BITS&&(this.compressedSize=i.readInt(8)),this.localHeaderOffset===m.MAX_VALUE_32BITS&&(this.localHeaderOffset=i.readInt(8)),this.diskNumberStart===m.MAX_VALUE_32BITS&&(this.diskNumberStart=i.readInt(4))}},readExtraFields:function(i){var I,r,p,u=i.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});i.index+4<u;)I=i.readInt(2),r=i.readInt(2),p=i.readData(r),this.extraFields[I]={id:I,length:r,value:p};i.setIndex(u)},handleUTF8:function(){var i=g.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=b.utf8decode(this.fileName),this.fileCommentStr=b.utf8decode(this.fileComment);else{var I=this.findExtraFieldUnicodePath();if(I!==null)this.fileNameStr=I;else{var r=m.transformTo(i,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(r)}var p=this.findExtraFieldUnicodeComment();if(p!==null)this.fileCommentStr=p;else{var u=m.transformTo(i,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(u)}}},findExtraFieldUnicodePath:function(){var i=this.extraFields[28789];if(i){var I=n(i.value);return I.readInt(1)!==1||c(this.fileName)!==I.readInt(4)?null:b.utf8decode(I.readData(i.length-5))}return null},findExtraFieldUnicodeComment:function(){var i=this.extraFields[25461];if(i){var I=n(i.value);return I.readInt(1)!==1||c(this.fileComment)!==I.readInt(4)?null:b.utf8decode(I.readData(i.length-5))}return null}},k.exports=v},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(h,k,a){function n(I,r,p){this.name=I,this.dir=p.dir,this.date=p.date,this.comment=p.comment,this.unixPermissions=p.unixPermissions,this.dosPermissions=p.dosPermissions,this._data=r,this._dataBinary=p.binary,this.options={compression:p.compression,compressionOptions:p.compressionOptions}}var m=h("./stream/StreamHelper"),t=h("./stream/DataWorker"),c=h("./utf8"),b=h("./compressedObject"),w=h("./stream/GenericWorker");n.prototype={internalStream:function(I){var r=null,p="string";try{if(!I)throw new Error("No output type specified.");var u=(p=I.toLowerCase())==="string"||p==="text";p!=="binarystring"&&p!=="text"||(p="string"),r=this._decompressWorker();var _=!this._dataBinary;_&&!u&&(r=r.pipe(new c.Utf8EncodeWorker)),!_&&u&&(r=r.pipe(new c.Utf8DecodeWorker))}catch(E){(r=new w("error")).error(E)}return new m(r,p,"")},async:function(I,r){return this.internalStream(I).accumulate(r)},nodeStream:function(I,r){return this.internalStream(I||"nodebuffer").toNodejsStream(r)},_compressWorker:function(I,r){if(this._data instanceof b&&this._data.compression.magic===I.magic)return this._data.getCompressedWorker();var p=this._decompressWorker();return this._dataBinary||(p=p.pipe(new c.Utf8EncodeWorker)),b.createWorkerFrom(p,I,r)},_decompressWorker:function(){return this._data instanceof b?this._data.getContentWorker():this._data instanceof w?this._data:new t(this._data)}};for(var g=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],v=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},i=0;i<g.length;i++)n.prototype[g[i]]=v;k.exports=n},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(h,k,a){(function(n){var m,t,c=n.MutationObserver||n.WebKitMutationObserver;if(c){var b=0,w=new c(I),g=n.document.createTextNode("");w.observe(g,{characterData:!0}),m=function(){g.data=b=++b%2}}else if(n.setImmediate||n.MessageChannel===void 0)m="document"in n&&"onreadystatechange"in n.document.createElement("script")?function(){var r=n.document.createElement("script");r.onreadystatechange=function(){I(),r.onreadystatechange=null,r.parentNode.removeChild(r),r=null},n.document.documentElement.appendChild(r)}:function(){setTimeout(I,0)};else{var v=new n.MessageChannel;v.port1.onmessage=I,m=function(){v.port2.postMessage(0)}}var i=[];function I(){var r,p;t=!0;for(var u=i.length;u;){for(p=i,i=[],r=-1;++r<u;)p[r]();u=i.length}t=!1}k.exports=function(r){i.push(r)!==1||t||m()}}).call(this,typeof ee!="undefined"?ee:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],37:[function(h,k,a){var n=h("immediate");function m(){}var t={},c=["REJECTED"],b=["FULFILLED"],w=["PENDING"];function g(u){if(typeof u!="function")throw new TypeError("resolver must be a function");this.state=w,this.queue=[],this.outcome=void 0,u!==m&&r(this,u)}function v(u,_,E){this.promise=u,typeof _=="function"&&(this.onFulfilled=_,this.callFulfilled=this.otherCallFulfilled),typeof E=="function"&&(this.onRejected=E,this.callRejected=this.otherCallRejected)}function i(u,_,E){n(function(){var D;try{D=_(E)}catch(x){return t.reject(u,x)}D===u?t.reject(u,new TypeError("Cannot resolve promise with itself")):t.resolve(u,D)})}function I(u){var _=u&&u.then;if(u&&(typeof u=="object"||typeof u=="function")&&typeof _=="function")return function(){_.apply(u,arguments)}}function r(u,_){var E=!1;function D(N){E||(E=!0,t.reject(u,N))}function x(N){E||(E=!0,t.resolve(u,N))}var B=p(function(){_(x,D)});B.status==="error"&&D(B.value)}function p(u,_){var E={};try{E.value=u(_),E.status="success"}catch(D){E.status="error",E.value=D}return E}(k.exports=g).prototype.finally=function(u){if(typeof u!="function")return this;var _=this.constructor;return this.then(function(E){return _.resolve(u()).then(function(){return E})},function(E){return _.resolve(u()).then(function(){throw E})})},g.prototype.catch=function(u){return this.then(null,u)},g.prototype.then=function(u,_){if(typeof u!="function"&&this.state===b||typeof _!="function"&&this.state===c)return this;var E=new this.constructor(m);return this.state!==w?i(E,this.state===b?u:_,this.outcome):this.queue.push(new v(E,u,_)),E},v.prototype.callFulfilled=function(u){t.resolve(this.promise,u)},v.prototype.otherCallFulfilled=function(u){i(this.promise,this.onFulfilled,u)},v.prototype.callRejected=function(u){t.reject(this.promise,u)},v.prototype.otherCallRejected=function(u){i(this.promise,this.onRejected,u)},t.resolve=function(u,_){var E=p(I,_);if(E.status==="error")return t.reject(u,E.value);var D=E.value;if(D)r(u,D);else{u.state=b,u.outcome=_;for(var x=-1,B=u.queue.length;++x<B;)u.queue[x].callFulfilled(_)}return u},t.reject=function(u,_){u.state=c,u.outcome=_;for(var E=-1,D=u.queue.length;++E<D;)u.queue[E].callRejected(_);return u},g.resolve=function(u){return u instanceof this?u:t.resolve(new this(m),u)},g.reject=function(u){var _=new this(m);return t.reject(_,u)},g.all=function(u){var _=this;if(Object.prototype.toString.call(u)!=="[object Array]")return this.reject(new TypeError("must be an array"));var E=u.length,D=!1;if(!E)return this.resolve([]);for(var x=new Array(E),B=0,N=-1,j=new this(m);++N<E;)A(u[N],N);return j;function A(H,et){_.resolve(H).then(function(S){x[et]=S,++B!==E||D||(D=!0,t.resolve(j,x))},function(S){D||(D=!0,t.reject(j,S))})}},g.race=function(u){var _=this;if(Object.prototype.toString.call(u)!=="[object Array]")return this.reject(new TypeError("must be an array"));var E=u.length,D=!1;if(!E)return this.resolve([]);for(var x=-1,B=new this(m);++x<E;)N=u[x],_.resolve(N).then(function(j){D||(D=!0,t.resolve(B,j))},function(j){D||(D=!0,t.reject(B,j))});var N;return B}},{immediate:36}],38:[function(h,k,a){var n={};(0,h("./lib/utils/common").assign)(n,h("./lib/deflate"),h("./lib/inflate"),h("./lib/zlib/constants")),k.exports=n},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(h,k,a){var n=h("./zlib/deflate"),m=h("./utils/common"),t=h("./utils/strings"),c=h("./zlib/messages"),b=h("./zlib/zstream"),w=Object.prototype.toString,g=0,v=-1,i=0,I=8;function r(u){if(!(this instanceof r))return new r(u);this.options=m.assign({level:v,method:I,chunkSize:16384,windowBits:15,memLevel:8,strategy:i,to:""},u||{});var _=this.options;_.raw&&0<_.windowBits?_.windowBits=-_.windowBits:_.gzip&&0<_.windowBits&&_.windowBits<16&&(_.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new b,this.strm.avail_out=0;var E=n.deflateInit2(this.strm,_.level,_.method,_.windowBits,_.memLevel,_.strategy);if(E!==g)throw new Error(c[E]);if(_.header&&n.deflateSetHeader(this.strm,_.header),_.dictionary){var D;if(D=typeof _.dictionary=="string"?t.string2buf(_.dictionary):w.call(_.dictionary)==="[object ArrayBuffer]"?new Uint8Array(_.dictionary):_.dictionary,(E=n.deflateSetDictionary(this.strm,D))!==g)throw new Error(c[E]);this._dict_set=!0}}function p(u,_){var E=new r(_);if(E.push(u,!0),E.err)throw E.msg||c[E.err];return E.result}r.prototype.push=function(u,_){var E,D,x=this.strm,B=this.options.chunkSize;if(this.ended)return!1;D=_===~~_?_:_===!0?4:0,typeof u=="string"?x.input=t.string2buf(u):w.call(u)==="[object ArrayBuffer]"?x.input=new Uint8Array(u):x.input=u,x.next_in=0,x.avail_in=x.input.length;do{if(x.avail_out===0&&(x.output=new m.Buf8(B),x.next_out=0,x.avail_out=B),(E=n.deflate(x,D))!==1&&E!==g)return this.onEnd(E),!(this.ended=!0);x.avail_out!==0&&(x.avail_in!==0||D!==4&&D!==2)||(this.options.to==="string"?this.onData(t.buf2binstring(m.shrinkBuf(x.output,x.next_out))):this.onData(m.shrinkBuf(x.output,x.next_out)))}while((0<x.avail_in||x.avail_out===0)&&E!==1);return D===4?(E=n.deflateEnd(this.strm),this.onEnd(E),this.ended=!0,E===g):D!==2||(this.onEnd(g),!(x.avail_out=0))},r.prototype.onData=function(u){this.chunks.push(u)},r.prototype.onEnd=function(u){u===g&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=m.flattenChunks(this.chunks)),this.chunks=[],this.err=u,this.msg=this.strm.msg},a.Deflate=r,a.deflate=p,a.deflateRaw=function(u,_){return(_=_||{}).raw=!0,p(u,_)},a.gzip=function(u,_){return(_=_||{}).gzip=!0,p(u,_)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(h,k,a){var n=h("./zlib/inflate"),m=h("./utils/common"),t=h("./utils/strings"),c=h("./zlib/constants"),b=h("./zlib/messages"),w=h("./zlib/zstream"),g=h("./zlib/gzheader"),v=Object.prototype.toString;function i(r){if(!(this instanceof i))return new i(r);this.options=m.assign({chunkSize:16384,windowBits:0,to:""},r||{});var p=this.options;p.raw&&0<=p.windowBits&&p.windowBits<16&&(p.windowBits=-p.windowBits,p.windowBits===0&&(p.windowBits=-15)),!(0<=p.windowBits&&p.windowBits<16)||r&&r.windowBits||(p.windowBits+=32),15<p.windowBits&&p.windowBits<48&&(15&p.windowBits)==0&&(p.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new w,this.strm.avail_out=0;var u=n.inflateInit2(this.strm,p.windowBits);if(u!==c.Z_OK)throw new Error(b[u]);this.header=new g,n.inflateGetHeader(this.strm,this.header)}function I(r,p){var u=new i(p);if(u.push(r,!0),u.err)throw u.msg||b[u.err];return u.result}i.prototype.push=function(r,p){var u,_,E,D,x,B,N=this.strm,j=this.options.chunkSize,A=this.options.dictionary,H=!1;if(this.ended)return!1;_=p===~~p?p:p===!0?c.Z_FINISH:c.Z_NO_FLUSH,typeof r=="string"?N.input=t.binstring2buf(r):v.call(r)==="[object ArrayBuffer]"?N.input=new Uint8Array(r):N.input=r,N.next_in=0,N.avail_in=N.input.length;do{if(N.avail_out===0&&(N.output=new m.Buf8(j),N.next_out=0,N.avail_out=j),(u=n.inflate(N,c.Z_NO_FLUSH))===c.Z_NEED_DICT&&A&&(B=typeof A=="string"?t.string2buf(A):v.call(A)==="[object ArrayBuffer]"?new Uint8Array(A):A,u=n.inflateSetDictionary(this.strm,B)),u===c.Z_BUF_ERROR&&H===!0&&(u=c.Z_OK,H=!1),u!==c.Z_STREAM_END&&u!==c.Z_OK)return this.onEnd(u),!(this.ended=!0);N.next_out&&(N.avail_out!==0&&u!==c.Z_STREAM_END&&(N.avail_in!==0||_!==c.Z_FINISH&&_!==c.Z_SYNC_FLUSH)||(this.options.to==="string"?(E=t.utf8border(N.output,N.next_out),D=N.next_out-E,x=t.buf2string(N.output,E),N.next_out=D,N.avail_out=j-D,D&&m.arraySet(N.output,N.output,E,D,0),this.onData(x)):this.onData(m.shrinkBuf(N.output,N.next_out)))),N.avail_in===0&&N.avail_out===0&&(H=!0)}while((0<N.avail_in||N.avail_out===0)&&u!==c.Z_STREAM_END);return u===c.Z_STREAM_END&&(_=c.Z_FINISH),_===c.Z_FINISH?(u=n.inflateEnd(this.strm),this.onEnd(u),this.ended=!0,u===c.Z_OK):_!==c.Z_SYNC_FLUSH||(this.onEnd(c.Z_OK),!(N.avail_out=0))},i.prototype.onData=function(r){this.chunks.push(r)},i.prototype.onEnd=function(r){r===c.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=m.flattenChunks(this.chunks)),this.chunks=[],this.err=r,this.msg=this.strm.msg},a.Inflate=i,a.inflate=I,a.inflateRaw=function(r,p){return(p=p||{}).raw=!0,I(r,p)},a.ungzip=I},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(h,k,a){var n=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Int32Array!="undefined";a.assign=function(c){for(var b=Array.prototype.slice.call(arguments,1);b.length;){var w=b.shift();if(w){if(typeof w!="object")throw new TypeError(w+"must be non-object");for(var g in w)w.hasOwnProperty(g)&&(c[g]=w[g])}}return c},a.shrinkBuf=function(c,b){return c.length===b?c:c.subarray?c.subarray(0,b):(c.length=b,c)};var m={arraySet:function(c,b,w,g,v){if(b.subarray&&c.subarray)c.set(b.subarray(w,w+g),v);else for(var i=0;i<g;i++)c[v+i]=b[w+i]},flattenChunks:function(c){var b,w,g,v,i,I;for(b=g=0,w=c.length;b<w;b++)g+=c[b].length;for(I=new Uint8Array(g),b=v=0,w=c.length;b<w;b++)i=c[b],I.set(i,v),v+=i.length;return I}},t={arraySet:function(c,b,w,g,v){for(var i=0;i<g;i++)c[v+i]=b[w+i]},flattenChunks:function(c){return[].concat.apply([],c)}};a.setTyped=function(c){c?(a.Buf8=Uint8Array,a.Buf16=Uint16Array,a.Buf32=Int32Array,a.assign(a,m)):(a.Buf8=Array,a.Buf16=Array,a.Buf32=Array,a.assign(a,t))},a.setTyped(n)},{}],42:[function(h,k,a){var n=h("./common"),m=!0,t=!0;try{String.fromCharCode.apply(null,[0])}catch{m=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{t=!1}for(var c=new n.Buf8(256),b=0;b<256;b++)c[b]=252<=b?6:248<=b?5:240<=b?4:224<=b?3:192<=b?2:1;function w(g,v){if(v<65537&&(g.subarray&&t||!g.subarray&&m))return String.fromCharCode.apply(null,n.shrinkBuf(g,v));for(var i="",I=0;I<v;I++)i+=String.fromCharCode(g[I]);return i}c[254]=c[254]=1,a.string2buf=function(g){var v,i,I,r,p,u=g.length,_=0;for(r=0;r<u;r++)(64512&(i=g.charCodeAt(r)))==55296&&r+1<u&&(64512&(I=g.charCodeAt(r+1)))==56320&&(i=65536+(i-55296<<10)+(I-56320),r++),_+=i<128?1:i<2048?2:i<65536?3:4;for(v=new n.Buf8(_),r=p=0;p<_;r++)(64512&(i=g.charCodeAt(r)))==55296&&r+1<u&&(64512&(I=g.charCodeAt(r+1)))==56320&&(i=65536+(i-55296<<10)+(I-56320),r++),i<128?v[p++]=i:(i<2048?v[p++]=192|i>>>6:(i<65536?v[p++]=224|i>>>12:(v[p++]=240|i>>>18,v[p++]=128|i>>>12&63),v[p++]=128|i>>>6&63),v[p++]=128|63&i);return v},a.buf2binstring=function(g){return w(g,g.length)},a.binstring2buf=function(g){for(var v=new n.Buf8(g.length),i=0,I=v.length;i<I;i++)v[i]=g.charCodeAt(i);return v},a.buf2string=function(g,v){var i,I,r,p,u=v||g.length,_=new Array(2*u);for(i=I=0;i<u;)if((r=g[i++])<128)_[I++]=r;else if(4<(p=c[r]))_[I++]=65533,i+=p-1;else{for(r&=p===2?31:p===3?15:7;1<p&&i<u;)r=r<<6|63&g[i++],p--;1<p?_[I++]=65533:r<65536?_[I++]=r:(r-=65536,_[I++]=55296|r>>10&1023,_[I++]=56320|1023&r)}return w(_,I)},a.utf8border=function(g,v){var i;for((v=v||g.length)>g.length&&(v=g.length),i=v-1;0<=i&&(192&g[i])==128;)i--;return i<0||i===0?v:i+c[g[i]]>v?i:v}},{"./common":41}],43:[function(h,k,a){k.exports=function(n,m,t,c){for(var b=65535&n|0,w=n>>>16&65535|0,g=0;t!==0;){for(t-=g=2e3<t?2e3:t;w=w+(b=b+m[c++]|0)|0,--g;);b%=65521,w%=65521}return b|w<<16|0}},{}],44:[function(h,k,a){k.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(h,k,a){var n=function(){for(var m,t=[],c=0;c<256;c++){m=c;for(var b=0;b<8;b++)m=1&m?3988292384^m>>>1:m>>>1;t[c]=m}return t}();k.exports=function(m,t,c,b){var w=n,g=b+c;m^=-1;for(var v=b;v<g;v++)m=m>>>8^w[255&(m^t[v])];return-1^m}},{}],46:[function(h,k,a){var n,m=h("../utils/common"),t=h("./trees"),c=h("./adler32"),b=h("./crc32"),w=h("./messages"),g=0,v=4,i=0,I=-2,r=-1,p=4,u=2,_=8,E=9,D=286,x=30,B=19,N=2*D+1,j=15,A=3,H=258,et=H+A+1,S=42,q=113,f=1,U=2,st=3,$=4;function nt(d,O){return d.msg=w[O],O}function Z(d){return(d<<1)-(4<d?9:0)}function it(d){for(var O=d.length;0<=--O;)d[O]=0}function F(d){var O=d.state,T=O.pending;T>d.avail_out&&(T=d.avail_out),T!==0&&(m.arraySet(d.output,O.pending_buf,O.pending_out,T,d.next_out),d.next_out+=T,O.pending_out+=T,d.total_out+=T,d.avail_out-=T,O.pending-=T,O.pending===0&&(O.pending_out=0))}function z(d,O){t._tr_flush_block(d,0<=d.block_start?d.block_start:-1,d.strstart-d.block_start,O),d.block_start=d.strstart,F(d.strm)}function rt(d,O){d.pending_buf[d.pending++]=O}function K(d,O){d.pending_buf[d.pending++]=O>>>8&255,d.pending_buf[d.pending++]=255&O}function G(d,O){var T,C,y=d.max_chain_length,V=d.strstart,M=d.prev_length,L=d.nice_match,P=d.strstart>d.w_size-et?d.strstart-(d.w_size-et):0,X=d.window,Y=d.w_mask,W=d.prev,ot=d.strstart+H,gt=X[V+M-1],ut=X[V+M];d.prev_length>=d.good_match&&(y>>=2),L>d.lookahead&&(L=d.lookahead);do if(X[(T=O)+M]===ut&&X[T+M-1]===gt&&X[T]===X[V]&&X[++T]===X[V+1]){V+=2,T++;do;while(X[++V]===X[++T]&&X[++V]===X[++T]&&X[++V]===X[++T]&&X[++V]===X[++T]&&X[++V]===X[++T]&&X[++V]===X[++T]&&X[++V]===X[++T]&&X[++V]===X[++T]&&V<ot);if(C=H-(ot-V),V=ot-H,M<C){if(d.match_start=O,L<=(M=C))break;gt=X[V+M-1],ut=X[V+M]}}while((O=W[O&Y])>P&&--y!=0);return M<=d.lookahead?M:d.lookahead}function yt(d){var O,T,C,y,V,M,L,P,X,Y,W=d.w_size;do{if(y=d.window_size-d.lookahead-d.strstart,d.strstart>=W+(W-et)){for(m.arraySet(d.window,d.window,W,W,0),d.match_start-=W,d.strstart-=W,d.block_start-=W,O=T=d.hash_size;C=d.head[--O],d.head[O]=W<=C?C-W:0,--T;);for(O=T=W;C=d.prev[--O],d.prev[O]=W<=C?C-W:0,--T;);y+=W}if(d.strm.avail_in===0)break;if(M=d.strm,L=d.window,P=d.strstart+d.lookahead,X=y,Y=void 0,Y=M.avail_in,X<Y&&(Y=X),T=Y===0?0:(M.avail_in-=Y,m.arraySet(L,M.input,M.next_in,Y,P),M.state.wrap===1?M.adler=c(M.adler,L,Y,P):M.state.wrap===2&&(M.adler=b(M.adler,L,Y,P)),M.next_in+=Y,M.total_in+=Y,Y),d.lookahead+=T,d.lookahead+d.insert>=A)for(V=d.strstart-d.insert,d.ins_h=d.window[V],d.ins_h=(d.ins_h<<d.hash_shift^d.window[V+1])&d.hash_mask;d.insert&&(d.ins_h=(d.ins_h<<d.hash_shift^d.window[V+A-1])&d.hash_mask,d.prev[V&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=V,V++,d.insert--,!(d.lookahead+d.insert<A)););}while(d.lookahead<et&&d.strm.avail_in!==0)}function Et(d,O){for(var T,C;;){if(d.lookahead<et){if(yt(d),d.lookahead<et&&O===g)return f;if(d.lookahead===0)break}if(T=0,d.lookahead>=A&&(d.ins_h=(d.ins_h<<d.hash_shift^d.window[d.strstart+A-1])&d.hash_mask,T=d.prev[d.strstart&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=d.strstart),T!==0&&d.strstart-T<=d.w_size-et&&(d.match_length=G(d,T)),d.match_length>=A)if(C=t._tr_tally(d,d.strstart-d.match_start,d.match_length-A),d.lookahead-=d.match_length,d.match_length<=d.max_lazy_match&&d.lookahead>=A){for(d.match_length--;d.strstart++,d.ins_h=(d.ins_h<<d.hash_shift^d.window[d.strstart+A-1])&d.hash_mask,T=d.prev[d.strstart&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=d.strstart,--d.match_length!=0;);d.strstart++}else d.strstart+=d.match_length,d.match_length=0,d.ins_h=d.window[d.strstart],d.ins_h=(d.ins_h<<d.hash_shift^d.window[d.strstart+1])&d.hash_mask;else C=t._tr_tally(d,0,d.window[d.strstart]),d.lookahead--,d.strstart++;if(C&&(z(d,!1),d.strm.avail_out===0))return f}return d.insert=d.strstart<A-1?d.strstart:A-1,O===v?(z(d,!0),d.strm.avail_out===0?st:$):d.last_lit&&(z(d,!1),d.strm.avail_out===0)?f:U}function dt(d,O){for(var T,C,y;;){if(d.lookahead<et){if(yt(d),d.lookahead<et&&O===g)return f;if(d.lookahead===0)break}if(T=0,d.lookahead>=A&&(d.ins_h=(d.ins_h<<d.hash_shift^d.window[d.strstart+A-1])&d.hash_mask,T=d.prev[d.strstart&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=d.strstart),d.prev_length=d.match_length,d.prev_match=d.match_start,d.match_length=A-1,T!==0&&d.prev_length<d.max_lazy_match&&d.strstart-T<=d.w_size-et&&(d.match_length=G(d,T),d.match_length<=5&&(d.strategy===1||d.match_length===A&&4096<d.strstart-d.match_start)&&(d.match_length=A-1)),d.prev_length>=A&&d.match_length<=d.prev_length){for(y=d.strstart+d.lookahead-A,C=t._tr_tally(d,d.strstart-1-d.prev_match,d.prev_length-A),d.lookahead-=d.prev_length-1,d.prev_length-=2;++d.strstart<=y&&(d.ins_h=(d.ins_h<<d.hash_shift^d.window[d.strstart+A-1])&d.hash_mask,T=d.prev[d.strstart&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=d.strstart),--d.prev_length!=0;);if(d.match_available=0,d.match_length=A-1,d.strstart++,C&&(z(d,!1),d.strm.avail_out===0))return f}else if(d.match_available){if((C=t._tr_tally(d,0,d.window[d.strstart-1]))&&z(d,!1),d.strstart++,d.lookahead--,d.strm.avail_out===0)return f}else d.match_available=1,d.strstart++,d.lookahead--}return d.match_available&&(C=t._tr_tally(d,0,d.window[d.strstart-1]),d.match_available=0),d.insert=d.strstart<A-1?d.strstart:A-1,O===v?(z(d,!0),d.strm.avail_out===0?st:$):d.last_lit&&(z(d,!1),d.strm.avail_out===0)?f:U}function ht(d,O,T,C,y){this.good_length=d,this.max_lazy=O,this.nice_length=T,this.max_chain=C,this.func=y}function Ct(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=_,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new m.Buf16(2*N),this.dyn_dtree=new m.Buf16(2*(2*x+1)),this.bl_tree=new m.Buf16(2*(2*B+1)),it(this.dyn_ltree),it(this.dyn_dtree),it(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new m.Buf16(j+1),this.heap=new m.Buf16(2*D+1),it(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new m.Buf16(2*D+1),it(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function It(d){var O;return d&&d.state?(d.total_in=d.total_out=0,d.data_type=u,(O=d.state).pending=0,O.pending_out=0,O.wrap<0&&(O.wrap=-O.wrap),O.status=O.wrap?S:q,d.adler=O.wrap===2?0:1,O.last_flush=g,t._tr_init(O),i):nt(d,I)}function At(d){var O=It(d);return O===i&&function(T){T.window_size=2*T.w_size,it(T.head),T.max_lazy_match=n[T.level].max_lazy,T.good_match=n[T.level].good_length,T.nice_match=n[T.level].nice_length,T.max_chain_length=n[T.level].max_chain,T.strstart=0,T.block_start=0,T.lookahead=0,T.insert=0,T.match_length=T.prev_length=A-1,T.match_available=0,T.ins_h=0}(d.state),O}function Ft(d,O,T,C,y,V){if(!d)return I;var M=1;if(O===r&&(O=6),C<0?(M=0,C=-C):15<C&&(M=2,C-=16),y<1||E<y||T!==_||C<8||15<C||O<0||9<O||V<0||p<V)return nt(d,I);C===8&&(C=9);var L=new Ct;return(d.state=L).strm=d,L.wrap=M,L.gzhead=null,L.w_bits=C,L.w_size=1<<L.w_bits,L.w_mask=L.w_size-1,L.hash_bits=y+7,L.hash_size=1<<L.hash_bits,L.hash_mask=L.hash_size-1,L.hash_shift=~~((L.hash_bits+A-1)/A),L.window=new m.Buf8(2*L.w_size),L.head=new m.Buf16(L.hash_size),L.prev=new m.Buf16(L.w_size),L.lit_bufsize=1<<y+6,L.pending_buf_size=4*L.lit_bufsize,L.pending_buf=new m.Buf8(L.pending_buf_size),L.d_buf=1*L.lit_bufsize,L.l_buf=3*L.lit_bufsize,L.level=O,L.strategy=V,L.method=T,At(d)}n=[new ht(0,0,0,0,function(d,O){var T=65535;for(T>d.pending_buf_size-5&&(T=d.pending_buf_size-5);;){if(d.lookahead<=1){if(yt(d),d.lookahead===0&&O===g)return f;if(d.lookahead===0)break}d.strstart+=d.lookahead,d.lookahead=0;var C=d.block_start+T;if((d.strstart===0||d.strstart>=C)&&(d.lookahead=d.strstart-C,d.strstart=C,z(d,!1),d.strm.avail_out===0)||d.strstart-d.block_start>=d.w_size-et&&(z(d,!1),d.strm.avail_out===0))return f}return d.insert=0,O===v?(z(d,!0),d.strm.avail_out===0?st:$):(d.strstart>d.block_start&&(z(d,!1),d.strm.avail_out),f)}),new ht(4,4,8,4,Et),new ht(4,5,16,8,Et),new ht(4,6,32,32,Et),new ht(4,4,16,16,dt),new ht(8,16,32,32,dt),new ht(8,16,128,128,dt),new ht(8,32,128,256,dt),new ht(32,128,258,1024,dt),new ht(32,258,258,4096,dt)],a.deflateInit=function(d,O){return Ft(d,O,_,15,8,0)},a.deflateInit2=Ft,a.deflateReset=At,a.deflateResetKeep=It,a.deflateSetHeader=function(d,O){return d&&d.state?d.state.wrap!==2?I:(d.state.gzhead=O,i):I},a.deflate=function(d,O){var T,C,y,V;if(!d||!d.state||5<O||O<0)return d?nt(d,I):I;if(C=d.state,!d.output||!d.input&&d.avail_in!==0||C.status===666&&O!==v)return nt(d,d.avail_out===0?-5:I);if(C.strm=d,T=C.last_flush,C.last_flush=O,C.status===S)if(C.wrap===2)d.adler=0,rt(C,31),rt(C,139),rt(C,8),C.gzhead?(rt(C,(C.gzhead.text?1:0)+(C.gzhead.hcrc?2:0)+(C.gzhead.extra?4:0)+(C.gzhead.name?8:0)+(C.gzhead.comment?16:0)),rt(C,255&C.gzhead.time),rt(C,C.gzhead.time>>8&255),rt(C,C.gzhead.time>>16&255),rt(C,C.gzhead.time>>24&255),rt(C,C.level===9?2:2<=C.strategy||C.level<2?4:0),rt(C,255&C.gzhead.os),C.gzhead.extra&&C.gzhead.extra.length&&(rt(C,255&C.gzhead.extra.length),rt(C,C.gzhead.extra.length>>8&255)),C.gzhead.hcrc&&(d.adler=b(d.adler,C.pending_buf,C.pending,0)),C.gzindex=0,C.status=69):(rt(C,0),rt(C,0),rt(C,0),rt(C,0),rt(C,0),rt(C,C.level===9?2:2<=C.strategy||C.level<2?4:0),rt(C,3),C.status=q);else{var M=_+(C.w_bits-8<<4)<<8;M|=(2<=C.strategy||C.level<2?0:C.level<6?1:C.level===6?2:3)<<6,C.strstart!==0&&(M|=32),M+=31-M%31,C.status=q,K(C,M),C.strstart!==0&&(K(C,d.adler>>>16),K(C,65535&d.adler)),d.adler=1}if(C.status===69)if(C.gzhead.extra){for(y=C.pending;C.gzindex<(65535&C.gzhead.extra.length)&&(C.pending!==C.pending_buf_size||(C.gzhead.hcrc&&C.pending>y&&(d.adler=b(d.adler,C.pending_buf,C.pending-y,y)),F(d),y=C.pending,C.pending!==C.pending_buf_size));)rt(C,255&C.gzhead.extra[C.gzindex]),C.gzindex++;C.gzhead.hcrc&&C.pending>y&&(d.adler=b(d.adler,C.pending_buf,C.pending-y,y)),C.gzindex===C.gzhead.extra.length&&(C.gzindex=0,C.status=73)}else C.status=73;if(C.status===73)if(C.gzhead.name){y=C.pending;do{if(C.pending===C.pending_buf_size&&(C.gzhead.hcrc&&C.pending>y&&(d.adler=b(d.adler,C.pending_buf,C.pending-y,y)),F(d),y=C.pending,C.pending===C.pending_buf_size)){V=1;break}V=C.gzindex<C.gzhead.name.length?255&C.gzhead.name.charCodeAt(C.gzindex++):0,rt(C,V)}while(V!==0);C.gzhead.hcrc&&C.pending>y&&(d.adler=b(d.adler,C.pending_buf,C.pending-y,y)),V===0&&(C.gzindex=0,C.status=91)}else C.status=91;if(C.status===91)if(C.gzhead.comment){y=C.pending;do{if(C.pending===C.pending_buf_size&&(C.gzhead.hcrc&&C.pending>y&&(d.adler=b(d.adler,C.pending_buf,C.pending-y,y)),F(d),y=C.pending,C.pending===C.pending_buf_size)){V=1;break}V=C.gzindex<C.gzhead.comment.length?255&C.gzhead.comment.charCodeAt(C.gzindex++):0,rt(C,V)}while(V!==0);C.gzhead.hcrc&&C.pending>y&&(d.adler=b(d.adler,C.pending_buf,C.pending-y,y)),V===0&&(C.status=103)}else C.status=103;if(C.status===103&&(C.gzhead.hcrc?(C.pending+2>C.pending_buf_size&&F(d),C.pending+2<=C.pending_buf_size&&(rt(C,255&d.adler),rt(C,d.adler>>8&255),d.adler=0,C.status=q)):C.status=q),C.pending!==0){if(F(d),d.avail_out===0)return C.last_flush=-1,i}else if(d.avail_in===0&&Z(O)<=Z(T)&&O!==v)return nt(d,-5);if(C.status===666&&d.avail_in!==0)return nt(d,-5);if(d.avail_in!==0||C.lookahead!==0||O!==g&&C.status!==666){var L=C.strategy===2?function(P,X){for(var Y;;){if(P.lookahead===0&&(yt(P),P.lookahead===0)){if(X===g)return f;break}if(P.match_length=0,Y=t._tr_tally(P,0,P.window[P.strstart]),P.lookahead--,P.strstart++,Y&&(z(P,!1),P.strm.avail_out===0))return f}return P.insert=0,X===v?(z(P,!0),P.strm.avail_out===0?st:$):P.last_lit&&(z(P,!1),P.strm.avail_out===0)?f:U}(C,O):C.strategy===3?function(P,X){for(var Y,W,ot,gt,ut=P.window;;){if(P.lookahead<=H){if(yt(P),P.lookahead<=H&&X===g)return f;if(P.lookahead===0)break}if(P.match_length=0,P.lookahead>=A&&0<P.strstart&&(W=ut[ot=P.strstart-1])===ut[++ot]&&W===ut[++ot]&&W===ut[++ot]){gt=P.strstart+H;do;while(W===ut[++ot]&&W===ut[++ot]&&W===ut[++ot]&&W===ut[++ot]&&W===ut[++ot]&&W===ut[++ot]&&W===ut[++ot]&&W===ut[++ot]&&ot<gt);P.match_length=H-(gt-ot),P.match_length>P.lookahead&&(P.match_length=P.lookahead)}if(P.match_length>=A?(Y=t._tr_tally(P,1,P.match_length-A),P.lookahead-=P.match_length,P.strstart+=P.match_length,P.match_length=0):(Y=t._tr_tally(P,0,P.window[P.strstart]),P.lookahead--,P.strstart++),Y&&(z(P,!1),P.strm.avail_out===0))return f}return P.insert=0,X===v?(z(P,!0),P.strm.avail_out===0?st:$):P.last_lit&&(z(P,!1),P.strm.avail_out===0)?f:U}(C,O):n[C.level].func(C,O);if(L!==st&&L!==$||(C.status=666),L===f||L===st)return d.avail_out===0&&(C.last_flush=-1),i;if(L===U&&(O===1?t._tr_align(C):O!==5&&(t._tr_stored_block(C,0,0,!1),O===3&&(it(C.head),C.lookahead===0&&(C.strstart=0,C.block_start=0,C.insert=0))),F(d),d.avail_out===0))return C.last_flush=-1,i}return O!==v?i:C.wrap<=0?1:(C.wrap===2?(rt(C,255&d.adler),rt(C,d.adler>>8&255),rt(C,d.adler>>16&255),rt(C,d.adler>>24&255),rt(C,255&d.total_in),rt(C,d.total_in>>8&255),rt(C,d.total_in>>16&255),rt(C,d.total_in>>24&255)):(K(C,d.adler>>>16),K(C,65535&d.adler)),F(d),0<C.wrap&&(C.wrap=-C.wrap),C.pending!==0?i:1)},a.deflateEnd=function(d){var O;return d&&d.state?(O=d.state.status)!==S&&O!==69&&O!==73&&O!==91&&O!==103&&O!==q&&O!==666?nt(d,I):(d.state=null,O===q?nt(d,-3):i):I},a.deflateSetDictionary=function(d,O){var T,C,y,V,M,L,P,X,Y=O.length;if(!d||!d.state||(V=(T=d.state).wrap)===2||V===1&&T.status!==S||T.lookahead)return I;for(V===1&&(d.adler=c(d.adler,O,Y,0)),T.wrap=0,Y>=T.w_size&&(V===0&&(it(T.head),T.strstart=0,T.block_start=0,T.insert=0),X=new m.Buf8(T.w_size),m.arraySet(X,O,Y-T.w_size,T.w_size,0),O=X,Y=T.w_size),M=d.avail_in,L=d.next_in,P=d.input,d.avail_in=Y,d.next_in=0,d.input=O,yt(T);T.lookahead>=A;){for(C=T.strstart,y=T.lookahead-(A-1);T.ins_h=(T.ins_h<<T.hash_shift^T.window[C+A-1])&T.hash_mask,T.prev[C&T.w_mask]=T.head[T.ins_h],T.head[T.ins_h]=C,C++,--y;);T.strstart=C,T.lookahead=A-1,yt(T)}return T.strstart+=T.lookahead,T.block_start=T.strstart,T.insert=T.lookahead,T.lookahead=0,T.match_length=T.prev_length=A-1,T.match_available=0,d.next_in=L,d.input=P,d.avail_in=M,T.wrap=V,i},a.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(h,k,a){k.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(h,k,a){k.exports=function(n,m){var t,c,b,w,g,v,i,I,r,p,u,_,E,D,x,B,N,j,A,H,et,S,q,f,U;t=n.state,c=n.next_in,f=n.input,b=c+(n.avail_in-5),w=n.next_out,U=n.output,g=w-(m-n.avail_out),v=w+(n.avail_out-257),i=t.dmax,I=t.wsize,r=t.whave,p=t.wnext,u=t.window,_=t.hold,E=t.bits,D=t.lencode,x=t.distcode,B=(1<<t.lenbits)-1,N=(1<<t.distbits)-1;t:do{E<15&&(_+=f[c++]<<E,E+=8,_+=f[c++]<<E,E+=8),j=D[_&B];e:for(;;){if(_>>>=A=j>>>24,E-=A,(A=j>>>16&255)===0)U[w++]=65535&j;else{if(!(16&A)){if((64&A)==0){j=D[(65535&j)+(_&(1<<A)-1)];continue e}if(32&A){t.mode=12;break t}n.msg="invalid literal/length code",t.mode=30;break t}H=65535&j,(A&=15)&&(E<A&&(_+=f[c++]<<E,E+=8),H+=_&(1<<A)-1,_>>>=A,E-=A),E<15&&(_+=f[c++]<<E,E+=8,_+=f[c++]<<E,E+=8),j=x[_&N];a:for(;;){if(_>>>=A=j>>>24,E-=A,!(16&(A=j>>>16&255))){if((64&A)==0){j=x[(65535&j)+(_&(1<<A)-1)];continue a}n.msg="invalid distance code",t.mode=30;break t}if(et=65535&j,E<(A&=15)&&(_+=f[c++]<<E,(E+=8)<A&&(_+=f[c++]<<E,E+=8)),i<(et+=_&(1<<A)-1)){n.msg="invalid distance too far back",t.mode=30;break t}if(_>>>=A,E-=A,(A=w-g)<et){if(r<(A=et-A)&&t.sane){n.msg="invalid distance too far back",t.mode=30;break t}if(q=u,(S=0)===p){if(S+=I-A,A<H){for(H-=A;U[w++]=u[S++],--A;);S=w-et,q=U}}else if(p<A){if(S+=I+p-A,(A-=p)<H){for(H-=A;U[w++]=u[S++],--A;);if(S=0,p<H){for(H-=A=p;U[w++]=u[S++],--A;);S=w-et,q=U}}}else if(S+=p-A,A<H){for(H-=A;U[w++]=u[S++],--A;);S=w-et,q=U}for(;2<H;)U[w++]=q[S++],U[w++]=q[S++],U[w++]=q[S++],H-=3;H&&(U[w++]=q[S++],1<H&&(U[w++]=q[S++]))}else{for(S=w-et;U[w++]=U[S++],U[w++]=U[S++],U[w++]=U[S++],2<(H-=3););H&&(U[w++]=U[S++],1<H&&(U[w++]=U[S++]))}break}}break}}while(c<b&&w<v);c-=H=E>>3,_&=(1<<(E-=H<<3))-1,n.next_in=c,n.next_out=w,n.avail_in=c<b?b-c+5:5-(c-b),n.avail_out=w<v?v-w+257:257-(w-v),t.hold=_,t.bits=E}},{}],49:[function(h,k,a){var n=h("../utils/common"),m=h("./adler32"),t=h("./crc32"),c=h("./inffast"),b=h("./inftrees"),w=1,g=2,v=0,i=-2,I=1,r=852,p=592;function u(S){return(S>>>24&255)+(S>>>8&65280)+((65280&S)<<8)+((255&S)<<24)}function _(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function E(S){var q;return S&&S.state?(q=S.state,S.total_in=S.total_out=q.total=0,S.msg="",q.wrap&&(S.adler=1&q.wrap),q.mode=I,q.last=0,q.havedict=0,q.dmax=32768,q.head=null,q.hold=0,q.bits=0,q.lencode=q.lendyn=new n.Buf32(r),q.distcode=q.distdyn=new n.Buf32(p),q.sane=1,q.back=-1,v):i}function D(S){var q;return S&&S.state?((q=S.state).wsize=0,q.whave=0,q.wnext=0,E(S)):i}function x(S,q){var f,U;return S&&S.state?(U=S.state,q<0?(f=0,q=-q):(f=1+(q>>4),q<48&&(q&=15)),q&&(q<8||15<q)?i:(U.window!==null&&U.wbits!==q&&(U.window=null),U.wrap=f,U.wbits=q,D(S))):i}function B(S,q){var f,U;return S?(U=new _,(S.state=U).window=null,(f=x(S,q))!==v&&(S.state=null),f):i}var N,j,A=!0;function H(S){if(A){var q;for(N=new n.Buf32(512),j=new n.Buf32(32),q=0;q<144;)S.lens[q++]=8;for(;q<256;)S.lens[q++]=9;for(;q<280;)S.lens[q++]=7;for(;q<288;)S.lens[q++]=8;for(b(w,S.lens,0,288,N,0,S.work,{bits:9}),q=0;q<32;)S.lens[q++]=5;b(g,S.lens,0,32,j,0,S.work,{bits:5}),A=!1}S.lencode=N,S.lenbits=9,S.distcode=j,S.distbits=5}function et(S,q,f,U){var st,$=S.state;return $.window===null&&($.wsize=1<<$.wbits,$.wnext=0,$.whave=0,$.window=new n.Buf8($.wsize)),U>=$.wsize?(n.arraySet($.window,q,f-$.wsize,$.wsize,0),$.wnext=0,$.whave=$.wsize):(U<(st=$.wsize-$.wnext)&&(st=U),n.arraySet($.window,q,f-U,st,$.wnext),(U-=st)?(n.arraySet($.window,q,f-U,U,0),$.wnext=U,$.whave=$.wsize):($.wnext+=st,$.wnext===$.wsize&&($.wnext=0),$.whave<$.wsize&&($.whave+=st))),0}a.inflateReset=D,a.inflateReset2=x,a.inflateResetKeep=E,a.inflateInit=function(S){return B(S,15)},a.inflateInit2=B,a.inflate=function(S,q){var f,U,st,$,nt,Z,it,F,z,rt,K,G,yt,Et,dt,ht,Ct,It,At,Ft,d,O,T,C,y=0,V=new n.Buf8(4),M=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!S||!S.state||!S.output||!S.input&&S.avail_in!==0)return i;(f=S.state).mode===12&&(f.mode=13),nt=S.next_out,st=S.output,it=S.avail_out,$=S.next_in,U=S.input,Z=S.avail_in,F=f.hold,z=f.bits,rt=Z,K=it,O=v;t:for(;;)switch(f.mode){case I:if(f.wrap===0){f.mode=13;break}for(;z<16;){if(Z===0)break t;Z--,F+=U[$++]<<z,z+=8}if(2&f.wrap&&F===35615){V[f.check=0]=255&F,V[1]=F>>>8&255,f.check=t(f.check,V,2,0),z=F=0,f.mode=2;break}if(f.flags=0,f.head&&(f.head.done=!1),!(1&f.wrap)||(((255&F)<<8)+(F>>8))%31){S.msg="incorrect header check",f.mode=30;break}if((15&F)!=8){S.msg="unknown compression method",f.mode=30;break}if(z-=4,d=8+(15&(F>>>=4)),f.wbits===0)f.wbits=d;else if(d>f.wbits){S.msg="invalid window size",f.mode=30;break}f.dmax=1<<d,S.adler=f.check=1,f.mode=512&F?10:12,z=F=0;break;case 2:for(;z<16;){if(Z===0)break t;Z--,F+=U[$++]<<z,z+=8}if(f.flags=F,(255&f.flags)!=8){S.msg="unknown compression method",f.mode=30;break}if(57344&f.flags){S.msg="unknown header flags set",f.mode=30;break}f.head&&(f.head.text=F>>8&1),512&f.flags&&(V[0]=255&F,V[1]=F>>>8&255,f.check=t(f.check,V,2,0)),z=F=0,f.mode=3;case 3:for(;z<32;){if(Z===0)break t;Z--,F+=U[$++]<<z,z+=8}f.head&&(f.head.time=F),512&f.flags&&(V[0]=255&F,V[1]=F>>>8&255,V[2]=F>>>16&255,V[3]=F>>>24&255,f.check=t(f.check,V,4,0)),z=F=0,f.mode=4;case 4:for(;z<16;){if(Z===0)break t;Z--,F+=U[$++]<<z,z+=8}f.head&&(f.head.xflags=255&F,f.head.os=F>>8),512&f.flags&&(V[0]=255&F,V[1]=F>>>8&255,f.check=t(f.check,V,2,0)),z=F=0,f.mode=5;case 5:if(1024&f.flags){for(;z<16;){if(Z===0)break t;Z--,F+=U[$++]<<z,z+=8}f.length=F,f.head&&(f.head.extra_len=F),512&f.flags&&(V[0]=255&F,V[1]=F>>>8&255,f.check=t(f.check,V,2,0)),z=F=0}else f.head&&(f.head.extra=null);f.mode=6;case 6:if(1024&f.flags&&(Z<(G=f.length)&&(G=Z),G&&(f.head&&(d=f.head.extra_len-f.length,f.head.extra||(f.head.extra=new Array(f.head.extra_len)),n.arraySet(f.head.extra,U,$,G,d)),512&f.flags&&(f.check=t(f.check,U,G,$)),Z-=G,$+=G,f.length-=G),f.length))break t;f.length=0,f.mode=7;case 7:if(2048&f.flags){if(Z===0)break t;for(G=0;d=U[$+G++],f.head&&d&&f.length<65536&&(f.head.name+=String.fromCharCode(d)),d&&G<Z;);if(512&f.flags&&(f.check=t(f.check,U,G,$)),Z-=G,$+=G,d)break t}else f.head&&(f.head.name=null);f.length=0,f.mode=8;case 8:if(4096&f.flags){if(Z===0)break t;for(G=0;d=U[$+G++],f.head&&d&&f.length<65536&&(f.head.comment+=String.fromCharCode(d)),d&&G<Z;);if(512&f.flags&&(f.check=t(f.check,U,G,$)),Z-=G,$+=G,d)break t}else f.head&&(f.head.comment=null);f.mode=9;case 9:if(512&f.flags){for(;z<16;){if(Z===0)break t;Z--,F+=U[$++]<<z,z+=8}if(F!==(65535&f.check)){S.msg="header crc mismatch",f.mode=30;break}z=F=0}f.head&&(f.head.hcrc=f.flags>>9&1,f.head.done=!0),S.adler=f.check=0,f.mode=12;break;case 10:for(;z<32;){if(Z===0)break t;Z--,F+=U[$++]<<z,z+=8}S.adler=f.check=u(F),z=F=0,f.mode=11;case 11:if(f.havedict===0)return S.next_out=nt,S.avail_out=it,S.next_in=$,S.avail_in=Z,f.hold=F,f.bits=z,2;S.adler=f.check=1,f.mode=12;case 12:if(q===5||q===6)break t;case 13:if(f.last){F>>>=7&z,z-=7&z,f.mode=27;break}for(;z<3;){if(Z===0)break t;Z--,F+=U[$++]<<z,z+=8}switch(f.last=1&F,z-=1,3&(F>>>=1)){case 0:f.mode=14;break;case 1:if(H(f),f.mode=20,q!==6)break;F>>>=2,z-=2;break t;case 2:f.mode=17;break;case 3:S.msg="invalid block type",f.mode=30}F>>>=2,z-=2;break;case 14:for(F>>>=7&z,z-=7&z;z<32;){if(Z===0)break t;Z--,F+=U[$++]<<z,z+=8}if((65535&F)!=(F>>>16^65535)){S.msg="invalid stored block lengths",f.mode=30;break}if(f.length=65535&F,z=F=0,f.mode=15,q===6)break t;case 15:f.mode=16;case 16:if(G=f.length){if(Z<G&&(G=Z),it<G&&(G=it),G===0)break t;n.arraySet(st,U,$,G,nt),Z-=G,$+=G,it-=G,nt+=G,f.length-=G;break}f.mode=12;break;case 17:for(;z<14;){if(Z===0)break t;Z--,F+=U[$++]<<z,z+=8}if(f.nlen=257+(31&F),F>>>=5,z-=5,f.ndist=1+(31&F),F>>>=5,z-=5,f.ncode=4+(15&F),F>>>=4,z-=4,286<f.nlen||30<f.ndist){S.msg="too many length or distance symbols",f.mode=30;break}f.have=0,f.mode=18;case 18:for(;f.have<f.ncode;){for(;z<3;){if(Z===0)break t;Z--,F+=U[$++]<<z,z+=8}f.lens[M[f.have++]]=7&F,F>>>=3,z-=3}for(;f.have<19;)f.lens[M[f.have++]]=0;if(f.lencode=f.lendyn,f.lenbits=7,T={bits:f.lenbits},O=b(0,f.lens,0,19,f.lencode,0,f.work,T),f.lenbits=T.bits,O){S.msg="invalid code lengths set",f.mode=30;break}f.have=0,f.mode=19;case 19:for(;f.have<f.nlen+f.ndist;){for(;ht=(y=f.lencode[F&(1<<f.lenbits)-1])>>>16&255,Ct=65535&y,!((dt=y>>>24)<=z);){if(Z===0)break t;Z--,F+=U[$++]<<z,z+=8}if(Ct<16)F>>>=dt,z-=dt,f.lens[f.have++]=Ct;else{if(Ct===16){for(C=dt+2;z<C;){if(Z===0)break t;Z--,F+=U[$++]<<z,z+=8}if(F>>>=dt,z-=dt,f.have===0){S.msg="invalid bit length repeat",f.mode=30;break}d=f.lens[f.have-1],G=3+(3&F),F>>>=2,z-=2}else if(Ct===17){for(C=dt+3;z<C;){if(Z===0)break t;Z--,F+=U[$++]<<z,z+=8}z-=dt,d=0,G=3+(7&(F>>>=dt)),F>>>=3,z-=3}else{for(C=dt+7;z<C;){if(Z===0)break t;Z--,F+=U[$++]<<z,z+=8}z-=dt,d=0,G=11+(127&(F>>>=dt)),F>>>=7,z-=7}if(f.have+G>f.nlen+f.ndist){S.msg="invalid bit length repeat",f.mode=30;break}for(;G--;)f.lens[f.have++]=d}}if(f.mode===30)break;if(f.lens[256]===0){S.msg="invalid code -- missing end-of-block",f.mode=30;break}if(f.lenbits=9,T={bits:f.lenbits},O=b(w,f.lens,0,f.nlen,f.lencode,0,f.work,T),f.lenbits=T.bits,O){S.msg="invalid literal/lengths set",f.mode=30;break}if(f.distbits=6,f.distcode=f.distdyn,T={bits:f.distbits},O=b(g,f.lens,f.nlen,f.ndist,f.distcode,0,f.work,T),f.distbits=T.bits,O){S.msg="invalid distances set",f.mode=30;break}if(f.mode=20,q===6)break t;case 20:f.mode=21;case 21:if(6<=Z&&258<=it){S.next_out=nt,S.avail_out=it,S.next_in=$,S.avail_in=Z,f.hold=F,f.bits=z,c(S,K),nt=S.next_out,st=S.output,it=S.avail_out,$=S.next_in,U=S.input,Z=S.avail_in,F=f.hold,z=f.bits,f.mode===12&&(f.back=-1);break}for(f.back=0;ht=(y=f.lencode[F&(1<<f.lenbits)-1])>>>16&255,Ct=65535&y,!((dt=y>>>24)<=z);){if(Z===0)break t;Z--,F+=U[$++]<<z,z+=8}if(ht&&(240&ht)==0){for(It=dt,At=ht,Ft=Ct;ht=(y=f.lencode[Ft+((F&(1<<It+At)-1)>>It)])>>>16&255,Ct=65535&y,!(It+(dt=y>>>24)<=z);){if(Z===0)break t;Z--,F+=U[$++]<<z,z+=8}F>>>=It,z-=It,f.back+=It}if(F>>>=dt,z-=dt,f.back+=dt,f.length=Ct,ht===0){f.mode=26;break}if(32&ht){f.back=-1,f.mode=12;break}if(64&ht){S.msg="invalid literal/length code",f.mode=30;break}f.extra=15&ht,f.mode=22;case 22:if(f.extra){for(C=f.extra;z<C;){if(Z===0)break t;Z--,F+=U[$++]<<z,z+=8}f.length+=F&(1<<f.extra)-1,F>>>=f.extra,z-=f.extra,f.back+=f.extra}f.was=f.length,f.mode=23;case 23:for(;ht=(y=f.distcode[F&(1<<f.distbits)-1])>>>16&255,Ct=65535&y,!((dt=y>>>24)<=z);){if(Z===0)break t;Z--,F+=U[$++]<<z,z+=8}if((240&ht)==0){for(It=dt,At=ht,Ft=Ct;ht=(y=f.distcode[Ft+((F&(1<<It+At)-1)>>It)])>>>16&255,Ct=65535&y,!(It+(dt=y>>>24)<=z);){if(Z===0)break t;Z--,F+=U[$++]<<z,z+=8}F>>>=It,z-=It,f.back+=It}if(F>>>=dt,z-=dt,f.back+=dt,64&ht){S.msg="invalid distance code",f.mode=30;break}f.offset=Ct,f.extra=15&ht,f.mode=24;case 24:if(f.extra){for(C=f.extra;z<C;){if(Z===0)break t;Z--,F+=U[$++]<<z,z+=8}f.offset+=F&(1<<f.extra)-1,F>>>=f.extra,z-=f.extra,f.back+=f.extra}if(f.offset>f.dmax){S.msg="invalid distance too far back",f.mode=30;break}f.mode=25;case 25:if(it===0)break t;if(G=K-it,f.offset>G){if((G=f.offset-G)>f.whave&&f.sane){S.msg="invalid distance too far back",f.mode=30;break}yt=G>f.wnext?(G-=f.wnext,f.wsize-G):f.wnext-G,G>f.length&&(G=f.length),Et=f.window}else Et=st,yt=nt-f.offset,G=f.length;for(it<G&&(G=it),it-=G,f.length-=G;st[nt++]=Et[yt++],--G;);f.length===0&&(f.mode=21);break;case 26:if(it===0)break t;st[nt++]=f.length,it--,f.mode=21;break;case 27:if(f.wrap){for(;z<32;){if(Z===0)break t;Z--,F|=U[$++]<<z,z+=8}if(K-=it,S.total_out+=K,f.total+=K,K&&(S.adler=f.check=f.flags?t(f.check,st,K,nt-K):m(f.check,st,K,nt-K)),K=it,(f.flags?F:u(F))!==f.check){S.msg="incorrect data check",f.mode=30;break}z=F=0}f.mode=28;case 28:if(f.wrap&&f.flags){for(;z<32;){if(Z===0)break t;Z--,F+=U[$++]<<z,z+=8}if(F!==(4294967295&f.total)){S.msg="incorrect length check",f.mode=30;break}z=F=0}f.mode=29;case 29:O=1;break t;case 30:O=-3;break t;case 31:return-4;case 32:default:return i}return S.next_out=nt,S.avail_out=it,S.next_in=$,S.avail_in=Z,f.hold=F,f.bits=z,(f.wsize||K!==S.avail_out&&f.mode<30&&(f.mode<27||q!==4))&&et(S,S.output,S.next_out,K-S.avail_out)?(f.mode=31,-4):(rt-=S.avail_in,K-=S.avail_out,S.total_in+=rt,S.total_out+=K,f.total+=K,f.wrap&&K&&(S.adler=f.check=f.flags?t(f.check,st,K,S.next_out-K):m(f.check,st,K,S.next_out-K)),S.data_type=f.bits+(f.last?64:0)+(f.mode===12?128:0)+(f.mode===20||f.mode===15?256:0),(rt==0&&K===0||q===4)&&O===v&&(O=-5),O)},a.inflateEnd=function(S){if(!S||!S.state)return i;var q=S.state;return q.window&&(q.window=null),S.state=null,v},a.inflateGetHeader=function(S,q){var f;return S&&S.state?(2&(f=S.state).wrap)==0?i:((f.head=q).done=!1,v):i},a.inflateSetDictionary=function(S,q){var f,U=q.length;return S&&S.state?(f=S.state).wrap!==0&&f.mode!==11?i:f.mode===11&&m(1,q,U,0)!==f.check?-3:et(S,q,U,U)?(f.mode=31,-4):(f.havedict=1,v):i},a.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(h,k,a){var n=h("../utils/common"),m=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],t=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],b=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];k.exports=function(w,g,v,i,I,r,p,u){var _,E,D,x,B,N,j,A,H,et=u.bits,S=0,q=0,f=0,U=0,st=0,$=0,nt=0,Z=0,it=0,F=0,z=null,rt=0,K=new n.Buf16(16),G=new n.Buf16(16),yt=null,Et=0;for(S=0;S<=15;S++)K[S]=0;for(q=0;q<i;q++)K[g[v+q]]++;for(st=et,U=15;1<=U&&K[U]===0;U--);if(U<st&&(st=U),U===0)return I[r++]=20971520,I[r++]=20971520,u.bits=1,0;for(f=1;f<U&&K[f]===0;f++);for(st<f&&(st=f),S=Z=1;S<=15;S++)if(Z<<=1,(Z-=K[S])<0)return-1;if(0<Z&&(w===0||U!==1))return-1;for(G[1]=0,S=1;S<15;S++)G[S+1]=G[S]+K[S];for(q=0;q<i;q++)g[v+q]!==0&&(p[G[g[v+q]]++]=q);if(N=w===0?(z=yt=p,19):w===1?(z=m,rt-=257,yt=t,Et-=257,256):(z=c,yt=b,-1),S=f,B=r,nt=q=F=0,D=-1,x=(it=1<<($=st))-1,w===1&&852<it||w===2&&592<it)return 1;for(;;){for(j=S-nt,H=p[q]<N?(A=0,p[q]):p[q]>N?(A=yt[Et+p[q]],z[rt+p[q]]):(A=96,0),_=1<<S-nt,f=E=1<<$;I[B+(F>>nt)+(E-=_)]=j<<24|A<<16|H|0,E!==0;);for(_=1<<S-1;F&_;)_>>=1;if(_!==0?(F&=_-1,F+=_):F=0,q++,--K[S]==0){if(S===U)break;S=g[v+p[q]]}if(st<S&&(F&x)!==D){for(nt===0&&(nt=st),B+=f,Z=1<<($=S-nt);$+nt<U&&!((Z-=K[$+nt])<=0);)$++,Z<<=1;if(it+=1<<$,w===1&&852<it||w===2&&592<it)return 1;I[D=F&x]=st<<24|$<<16|B-r|0}}return F!==0&&(I[B+F]=S-nt<<24|64<<16|0),u.bits=st,0}},{"../utils/common":41}],51:[function(h,k,a){k.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(h,k,a){var n=h("../utils/common"),m=0,t=1;function c(y){for(var V=y.length;0<=--V;)y[V]=0}var b=0,w=29,g=256,v=g+1+w,i=30,I=19,r=2*v+1,p=15,u=16,_=7,E=256,D=16,x=17,B=18,N=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],j=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],A=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],et=new Array(2*(v+2));c(et);var S=new Array(2*i);c(S);var q=new Array(512);c(q);var f=new Array(256);c(f);var U=new Array(w);c(U);var st,$,nt,Z=new Array(i);function it(y,V,M,L,P){this.static_tree=y,this.extra_bits=V,this.extra_base=M,this.elems=L,this.max_length=P,this.has_stree=y&&y.length}function F(y,V){this.dyn_tree=y,this.max_code=0,this.stat_desc=V}function z(y){return y<256?q[y]:q[256+(y>>>7)]}function rt(y,V){y.pending_buf[y.pending++]=255&V,y.pending_buf[y.pending++]=V>>>8&255}function K(y,V,M){y.bi_valid>u-M?(y.bi_buf|=V<<y.bi_valid&65535,rt(y,y.bi_buf),y.bi_buf=V>>u-y.bi_valid,y.bi_valid+=M-u):(y.bi_buf|=V<<y.bi_valid&65535,y.bi_valid+=M)}function G(y,V,M){K(y,M[2*V],M[2*V+1])}function yt(y,V){for(var M=0;M|=1&y,y>>>=1,M<<=1,0<--V;);return M>>>1}function Et(y,V,M){var L,P,X=new Array(p+1),Y=0;for(L=1;L<=p;L++)X[L]=Y=Y+M[L-1]<<1;for(P=0;P<=V;P++){var W=y[2*P+1];W!==0&&(y[2*P]=yt(X[W]++,W))}}function dt(y){var V;for(V=0;V<v;V++)y.dyn_ltree[2*V]=0;for(V=0;V<i;V++)y.dyn_dtree[2*V]=0;for(V=0;V<I;V++)y.bl_tree[2*V]=0;y.dyn_ltree[2*E]=1,y.opt_len=y.static_len=0,y.last_lit=y.matches=0}function ht(y){8<y.bi_valid?rt(y,y.bi_buf):0<y.bi_valid&&(y.pending_buf[y.pending++]=y.bi_buf),y.bi_buf=0,y.bi_valid=0}function Ct(y,V,M,L){var P=2*V,X=2*M;return y[P]<y[X]||y[P]===y[X]&&L[V]<=L[M]}function It(y,V,M){for(var L=y.heap[M],P=M<<1;P<=y.heap_len&&(P<y.heap_len&&Ct(V,y.heap[P+1],y.heap[P],y.depth)&&P++,!Ct(V,L,y.heap[P],y.depth));)y.heap[M]=y.heap[P],M=P,P<<=1;y.heap[M]=L}function At(y,V,M){var L,P,X,Y,W=0;if(y.last_lit!==0)for(;L=y.pending_buf[y.d_buf+2*W]<<8|y.pending_buf[y.d_buf+2*W+1],P=y.pending_buf[y.l_buf+W],W++,L===0?G(y,P,V):(G(y,(X=f[P])+g+1,V),(Y=N[X])!==0&&K(y,P-=U[X],Y),G(y,X=z(--L),M),(Y=j[X])!==0&&K(y,L-=Z[X],Y)),W<y.last_lit;);G(y,E,V)}function Ft(y,V){var M,L,P,X=V.dyn_tree,Y=V.stat_desc.static_tree,W=V.stat_desc.has_stree,ot=V.stat_desc.elems,gt=-1;for(y.heap_len=0,y.heap_max=r,M=0;M<ot;M++)X[2*M]!==0?(y.heap[++y.heap_len]=gt=M,y.depth[M]=0):X[2*M+1]=0;for(;y.heap_len<2;)X[2*(P=y.heap[++y.heap_len]=gt<2?++gt:0)]=1,y.depth[P]=0,y.opt_len--,W&&(y.static_len-=Y[2*P+1]);for(V.max_code=gt,M=y.heap_len>>1;1<=M;M--)It(y,X,M);for(P=ot;M=y.heap[1],y.heap[1]=y.heap[y.heap_len--],It(y,X,1),L=y.heap[1],y.heap[--y.heap_max]=M,y.heap[--y.heap_max]=L,X[2*P]=X[2*M]+X[2*L],y.depth[P]=(y.depth[M]>=y.depth[L]?y.depth[M]:y.depth[L])+1,X[2*M+1]=X[2*L+1]=P,y.heap[1]=P++,It(y,X,1),2<=y.heap_len;);y.heap[--y.heap_max]=y.heap[1],function(ut,zt){var Xt,Nt,Wt,kt,Jt,ie,qt=zt.dyn_tree,ue=zt.max_code,we=zt.stat_desc.static_tree,ye=zt.stat_desc.has_stree,Ie=zt.stat_desc.extra_bits,ce=zt.stat_desc.extra_base,Gt=zt.stat_desc.max_length,te=0;for(kt=0;kt<=p;kt++)ut.bl_count[kt]=0;for(qt[2*ut.heap[ut.heap_max]+1]=0,Xt=ut.heap_max+1;Xt<r;Xt++)Gt<(kt=qt[2*qt[2*(Nt=ut.heap[Xt])+1]+1]+1)&&(kt=Gt,te++),qt[2*Nt+1]=kt,ue<Nt||(ut.bl_count[kt]++,Jt=0,ce<=Nt&&(Jt=Ie[Nt-ce]),ie=qt[2*Nt],ut.opt_len+=ie*(kt+Jt),ye&&(ut.static_len+=ie*(we[2*Nt+1]+Jt)));if(te!==0){do{for(kt=Gt-1;ut.bl_count[kt]===0;)kt--;ut.bl_count[kt]--,ut.bl_count[kt+1]+=2,ut.bl_count[Gt]--,te-=2}while(0<te);for(kt=Gt;kt!==0;kt--)for(Nt=ut.bl_count[kt];Nt!==0;)ue<(Wt=ut.heap[--Xt])||(qt[2*Wt+1]!==kt&&(ut.opt_len+=(kt-qt[2*Wt+1])*qt[2*Wt],qt[2*Wt+1]=kt),Nt--)}}(y,V),Et(X,gt,y.bl_count)}function d(y,V,M){var L,P,X=-1,Y=V[1],W=0,ot=7,gt=4;for(Y===0&&(ot=138,gt=3),V[2*(M+1)+1]=65535,L=0;L<=M;L++)P=Y,Y=V[2*(L+1)+1],++W<ot&&P===Y||(W<gt?y.bl_tree[2*P]+=W:P!==0?(P!==X&&y.bl_tree[2*P]++,y.bl_tree[2*D]++):W<=10?y.bl_tree[2*x]++:y.bl_tree[2*B]++,X=P,gt=(W=0)===Y?(ot=138,3):P===Y?(ot=6,3):(ot=7,4))}function O(y,V,M){var L,P,X=-1,Y=V[1],W=0,ot=7,gt=4;for(Y===0&&(ot=138,gt=3),L=0;L<=M;L++)if(P=Y,Y=V[2*(L+1)+1],!(++W<ot&&P===Y)){if(W<gt)for(;G(y,P,y.bl_tree),--W!=0;);else P!==0?(P!==X&&(G(y,P,y.bl_tree),W--),G(y,D,y.bl_tree),K(y,W-3,2)):W<=10?(G(y,x,y.bl_tree),K(y,W-3,3)):(G(y,B,y.bl_tree),K(y,W-11,7));X=P,gt=(W=0)===Y?(ot=138,3):P===Y?(ot=6,3):(ot=7,4)}}c(Z);var T=!1;function C(y,V,M,L){K(y,(b<<1)+(L?1:0),3),function(P,X,Y,W){ht(P),W&&(rt(P,Y),rt(P,~Y)),n.arraySet(P.pending_buf,P.window,X,Y,P.pending),P.pending+=Y}(y,V,M,!0)}a._tr_init=function(y){T||(function(){var V,M,L,P,X,Y=new Array(p+1);for(P=L=0;P<w-1;P++)for(U[P]=L,V=0;V<1<<N[P];V++)f[L++]=P;for(f[L-1]=P,P=X=0;P<16;P++)for(Z[P]=X,V=0;V<1<<j[P];V++)q[X++]=P;for(X>>=7;P<i;P++)for(Z[P]=X<<7,V=0;V<1<<j[P]-7;V++)q[256+X++]=P;for(M=0;M<=p;M++)Y[M]=0;for(V=0;V<=143;)et[2*V+1]=8,V++,Y[8]++;for(;V<=255;)et[2*V+1]=9,V++,Y[9]++;for(;V<=279;)et[2*V+1]=7,V++,Y[7]++;for(;V<=287;)et[2*V+1]=8,V++,Y[8]++;for(Et(et,v+1,Y),V=0;V<i;V++)S[2*V+1]=5,S[2*V]=yt(V,5);st=new it(et,N,g+1,v,p),$=new it(S,j,0,i,p),nt=new it(new Array(0),A,0,I,_)}(),T=!0),y.l_desc=new F(y.dyn_ltree,st),y.d_desc=new F(y.dyn_dtree,$),y.bl_desc=new F(y.bl_tree,nt),y.bi_buf=0,y.bi_valid=0,dt(y)},a._tr_stored_block=C,a._tr_flush_block=function(y,V,M,L){var P,X,Y=0;0<y.level?(y.strm.data_type===2&&(y.strm.data_type=function(W){var ot,gt=4093624447;for(ot=0;ot<=31;ot++,gt>>>=1)if(1&gt&&W.dyn_ltree[2*ot]!==0)return m;if(W.dyn_ltree[18]!==0||W.dyn_ltree[20]!==0||W.dyn_ltree[26]!==0)return t;for(ot=32;ot<g;ot++)if(W.dyn_ltree[2*ot]!==0)return t;return m}(y)),Ft(y,y.l_desc),Ft(y,y.d_desc),Y=function(W){var ot;for(d(W,W.dyn_ltree,W.l_desc.max_code),d(W,W.dyn_dtree,W.d_desc.max_code),Ft(W,W.bl_desc),ot=I-1;3<=ot&&W.bl_tree[2*H[ot]+1]===0;ot--);return W.opt_len+=3*(ot+1)+5+5+4,ot}(y),P=y.opt_len+3+7>>>3,(X=y.static_len+3+7>>>3)<=P&&(P=X)):P=X=M+5,M+4<=P&&V!==-1?C(y,V,M,L):y.strategy===4||X===P?(K(y,2+(L?1:0),3),At(y,et,S)):(K(y,4+(L?1:0),3),function(W,ot,gt,ut){var zt;for(K(W,ot-257,5),K(W,gt-1,5),K(W,ut-4,4),zt=0;zt<ut;zt++)K(W,W.bl_tree[2*H[zt]+1],3);O(W,W.dyn_ltree,ot-1),O(W,W.dyn_dtree,gt-1)}(y,y.l_desc.max_code+1,y.d_desc.max_code+1,Y+1),At(y,y.dyn_ltree,y.dyn_dtree)),dt(y),L&&ht(y)},a._tr_tally=function(y,V,M){return y.pending_buf[y.d_buf+2*y.last_lit]=V>>>8&255,y.pending_buf[y.d_buf+2*y.last_lit+1]=255&V,y.pending_buf[y.l_buf+y.last_lit]=255&M,y.last_lit++,V===0?y.dyn_ltree[2*M]++:(y.matches++,V--,y.dyn_ltree[2*(f[M]+g+1)]++,y.dyn_dtree[2*z(V)]++),y.last_lit===y.lit_bufsize-1},a._tr_align=function(y){K(y,2,3),G(y,E,et),function(V){V.bi_valid===16?(rt(V,V.bi_buf),V.bi_buf=0,V.bi_valid=0):8<=V.bi_valid&&(V.pending_buf[V.pending++]=255&V.bi_buf,V.bi_buf>>=8,V.bi_valid-=8)}(y)}},{"../utils/common":41}],53:[function(h,k,a){k.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(h,k,a){(function(n){(function(m,t){if(!m.setImmediate){var c,b,w,g,v=1,i={},I=!1,r=m.document,p=Object.getPrototypeOf&&Object.getPrototypeOf(m);p=p&&p.setTimeout?p:m,c={}.toString.call(m.process)==="[object process]"?function(D){process.nextTick(function(){_(D)})}:function(){if(m.postMessage&&!m.importScripts){var D=!0,x=m.onmessage;return m.onmessage=function(){D=!1},m.postMessage("","*"),m.onmessage=x,D}}()?(g="setImmediate$"+Math.random()+"$",m.addEventListener?m.addEventListener("message",E,!1):m.attachEvent("onmessage",E),function(D){m.postMessage(g+D,"*")}):m.MessageChannel?((w=new MessageChannel).port1.onmessage=function(D){_(D.data)},function(D){w.port2.postMessage(D)}):r&&"onreadystatechange"in r.createElement("script")?(b=r.documentElement,function(D){var x=r.createElement("script");x.onreadystatechange=function(){_(D),x.onreadystatechange=null,b.removeChild(x),x=null},b.appendChild(x)}):function(D){setTimeout(_,0,D)},p.setImmediate=function(D){typeof D!="function"&&(D=new Function(""+D));for(var x=new Array(arguments.length-1),B=0;B<x.length;B++)x[B]=arguments[B+1];var N={callback:D,args:x};return i[v]=N,c(v),v++},p.clearImmediate=u}function u(D){delete i[D]}function _(D){if(I)setTimeout(_,0,D);else{var x=i[D];if(x){I=!0;try{(function(B){var N=B.callback,j=B.args;switch(j.length){case 0:N();break;case 1:N(j[0]);break;case 2:N(j[0],j[1]);break;case 3:N(j[0],j[1],j[2]);break;default:N.apply(t,j)}})(x)}finally{u(D),I=!1}}}}function E(D){D.source===m&&typeof D.data=="string"&&D.data.indexOf(g)===0&&_(+D.data.slice(g.length))}})(typeof self=="undefined"?n===void 0?this:n:self)}).call(this,typeof ee!="undefined"?ee:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}]},{},[10])(10)})})(_e);var ba=_e.exports;const Qt={paginacao:{atual:1,maximo:1,total:1,limite:25},filtros:{numero:"",numeroCompra:null,termoBusca:"",periodoEmissao:{ini:"",fim:""},periodoFinalizado:{ini:"",fim:""},fornecedor:{nome:""},destinatario:null}},va={components:{Lista:Fe,ComprasFicha:Xe,ComprasImportacaoXML:ga},data(){return{usuario:"",clienteSistema:"",lista:[],contatos:{},destinatarioOpcoes:[],destinatarioSelecionado:null,mostrar:{barraTopo:!0,toolbarTitulo:!0,icone:"factory",titulo:"Compras",filtroAvancado:!0,buscar:!0,btnAjuda:!0,btnAtualizar:!0,btnNovo:!0,toolbarAcoes:!0,checkBox:!1,btnRemover:!1,btnRestaurar:!1,centralizaTabs:!1,btnDetalhes:!1,btnExportaXLS:!1,btnMenuMais:!1,toolbarAdicao:!1,bannerMsg:""},resultado:{},busca:"",filtros:$utils.clonarV2(Qt.filtros),tabSelecionada:{valor:"Digita\xE7\xE3o"},tabs:[{valor:"Digita\xE7\xE3o",rotulo:"Digita\xE7\xE3o"},{valor:"Finalizado",rotulo:"Finalizado"},{valor:"Todos",rotulo:"Todos"}],tabSelecionada2:{valor:"Pedido de Compra"},tabs2:[{valor:"Pedido de Compra",rotulo:"Pedido de Compra"},{valor:"Nota de Entrada",rotulo:"Nota de Entrada"},{valor:"Nota no SEFAZ",rotulo:"Nota no SEFAZ"}],paginacao:$utils.clonarV2(Qt.paginacao),xmlDevolucao:!1,xmlEstrangeiro:!1,modalXMLNotaEntrada:!1,xmlNotaEntrada:{},configImpressao:[],abrirNotadeEntrada:null,dialogEtiquetas:{impressao:!1,adicionar:!1,limpar:!1,item:{}},opcoesModelo:[],modeloSelecionado:"",emBranco:0,opcoesEmpresas:[],empresaSelecionada:"",tabelasPreco:[],opcoesTabelasPreco:[],tabelaPrecoSelecionada:""}},methods:{aoSelecionarDestinatario(){this.filtros.destinatario=$utils.clonar(this.destinatarioSelecionado)},async atualizar(o){var h;const l=$utils.logarIni("ComprasLista");await $tryLoading(async()=>{var w;let{buscarDadosRecentes:k}=o!=null?o:{},a,n,m,t,c=["dataHoraFinalizado","dataHoraEmissao"],b=["desc","desc"];if(o!=null&&o.aba2&&(this.tabSelecionada2.valor=o.aba2),this.tabSelecionada2Anterior&&this.tabSelecionada2Anterior!==this.tabSelecionada2.valor&&(this.setOpcoesTabs(this.tabSelecionada2.valor),this.filtros=$utils.clonarV2(Qt.filtros),this.paginacao=$utils.clonarV2(Qt.paginacao),this.busca="",k=!0),this.tabSelecionada2Anterior=this.tabSelecionada2.valor,k&&(a=await $utils.localIDB.getItem({objectStore:"dadosRecentes",id:this.tabSelecionada2.valor}),a!=null&&a._id&&(this.destinatarioSelecionado=a.filtros.destinatario,this.filtros=a.filtros,this.busca=a.termoBusca,c=a.sort,b=a.dir)),o!=null&&o.aba&&(this.tabSelecionada.valor=o.aba),n=$utils.eliminarVazios(this.filtros),m=this.paginacao.limite,t=this.paginacao.atual,n.status=this.tabSelecionada.valor,n.operacao=this.tabSelecionada2.valor,n.termoBusca=this.busca,this.tabSelecionada.valor==="Todos"&&delete n.status,n.operacao==="Nota no SEFAZ"){let g=await $db.hibrido.lista({table:"documentoFiscalEletronico",columns:["id","xNomeEmitente","xNomeDestinatario","cpfCnpjDestinatario","vNF","situacao","nNF"],where:{tipo:"DFe",...this.tabSelecionada.valor!=="Todos"?{situacao:this.tabSelecionada.valor}:{}}});g=g.filter(r=>{var p,u,_;return!(((p=this.filtros.fornecedor)==null?void 0:p.nome)&&!r.xNomeEmitente.toLowerCase().includes(this.filtros.fornecedor.nome.toLowerCase())||((u=this.filtros.destinatario)==null?void 0:u.numeroDocumentoNacional)&&((_=r.cpfCnpjDestinatario)==null?void 0:_.replace(/\D/g,""))!==this.filtros.destinatario.numeroDocumentoNacional.replace(/\D/g,""))});const v=await $db.hibrido.lista({table:"documentoFiscalEletronicoXml",columns:["idDocumentoFiscalEletronico","dhRecbto"],whereIn:{idDocumentoFiscalEletronico:g.map(r=>r.id)}}),i=[];v.forEach(r=>{var D,x;const p=g.find(B=>B.id===r.idDocumentoFiscalEletronico),u=new Date(r.dhRecbto).setHours(0,0,0,0),_=new Date((D=this.filtros.periodoEmissao)==null?void 0:D.ini).setHours(0,0,0,0),E=new Date((x=this.filtros.periodoEmissao)==null?void 0:x.fim).setHours(0,0,0,0);(_||E)&&u&&(_&&u<_||E&&u>E)||p&&i.push({id:p.id,descricaoContato:p.xNomeEmitente,descricaoDestinatario:p.xNomeDestinatario,dhRecbto:r.dhRecbto,totalDocumento:p.vNF,status:p.situacao,notaNumero:p.nNF})});const I=(t-1)*m;this.paginacao.total=i.length,this.paginacao.maximo=Math.ceil(this.paginacao.total/m)||1,i.sort((r,p)=>r.dhRecbto<p.dhRecbto?1:-1),this.lista=i.splice(I,m)}else{(w=this.filtros.destinatario)!=null&&w.value&&(n.idContatoEmpresa=this.filtros.destinatario.value);const g=await $db.compra.leListaCompleta({filtros:n,limit:m,page:t,sort:c,dir:b});this.paginacao.total=g.total,this.paginacao.maximo=g.totalPages,this.lista=g.data.compras}for(const{idContato:g}of this.lista)g&&!this.contatos[g]&&(this.contatos[g]={});this.carregarImagensContatos(this.contatos),a={_id:this.tabSelecionada2.valor,tabSelecionada:this.tabSelecionada.valor,filtros:$utils.clonarV2(n),termoBusca:this.busca,sort:c,dir:b},await $utils.localIDB.setItem({objectStore:"dadosRecentes",data:a}),this.configuraImpressao(this.filtros.idEmpresa)}),$utils.logarFim(l,((h=this.paginacao)==null?void 0:h.total)||1)},async carregarImagensContatos(o){const l=Object.keys(o);if(!!l.length){await $utils.dormir(200);try{const h=await $db.hibrido.lista({table:"contato",columns:["id","apelido","imagem"],whereIn:{id:l}});for(const k of h)o[k.id].imagem=k.imagem||""}catch(h){console.error("Erro ao carregar imagens de contatos - ",h)}}},adicionarXml(o){this.xmlNotaEntrada.arquivo=o[0]},async concluirImportacao(o){await $tryLoading(async()=>{await $db.compra.grava({atual:o}),$q.notifyPositive("Importa\xE7\xE3o realizada com sucesso!"),this.tabSelecionada.valor="Digita\xE7\xE3o",this.tabSelecionada2.valor="Nota de Entrada",await this.$refs.comprasFicha.mostrar({id:o.documento.id})},{mensagem:"Gravando importa\xE7\xE3o..."})},async importarXmlNotaDeEntrada(){var h,k,a,n,m,t;let o,l;try{$utils.verificarErro(!this.xmlNotaEntrada.arquivo,"Adicione um arquivo XML antes de enviar!");const b=await(r=>new Promise((p,u)=>{const _=new FileReader;_.readAsBinaryString(r),_.onload=()=>p(_.result),_.onerror=E=>u(E)}))(this.xmlNotaEntrada.arquivo),w=new DOMParser,g=new XMLSerializer,v=w.parseFromString(b,"text/xml");l=g.serializeToString(v),$utils.verificarErro(v.documentElement.nodeName==="html","Arquivo inv\xE1lido ou corrompido");const i=new Ve.Parser;let I;i.parseString(l,(r,p)=>{r&&console.log(r),I=p}),o=(t=(m=(n=(a=(k=(h=I==null?void 0:I.nfeProc)==null?void 0:h.protNFe)==null?void 0:k[0])==null?void 0:a.infProt)==null?void 0:n[0])==null?void 0:m.nProt)==null?void 0:t[0]}catch(c){return $q.notifyError("Ocorreu um erro na importa\xE7\xE3o",c),!1}if(!o&&!await $q.dialogSimNao({title:"Aviso importante",message:"O XML que est\xE1 sendo importado n\xE3o foi protocolado pela Sefaz, gostaria de importar o XML sem o protocolo?",html:!0})){$q.notifyError("Opera\xE7\xE3o para importa\xE7\xE3o de XML n\xE3o realizada!",erro);return}await $tryLoading(async()=>{const c=(await $db.hibrido.lista({table:"documentoXML",whereFilter:{xmlAux:l}}))[0];$utils.verificarErro(c==null?void 0:c.id,"Esse xml j\xE1 foi importado!");const b=await $db.compra.importaXml({xmlString:l,xmlEstrangeiro:Boolean(this.xmlEstrangeiro)});b.documentosItem.find(({vinculado:w})=>!w)?this.$refs.comprasImportacaoXML.mostrar(b):await this.concluirImportacao(b)},{mensagem:"Importando..."}),delete this.xmlNotaEntrada.arquivo,this.modalXMLNotaEntrada=!1,this.xmlEstrangeiro=!1},async fecharXmlNotaDeEntrada(){delete this.xmlNotaEntrada.arquivo},async abrir(o){this.tabSelecionada2.valor!=="Nota no SEFAZ"&&this.$refs.comprasFicha.mostrar({id:o})},criarClick(){this.$refs.comprasFicha.criar()},importarXmlClick(){this.modalXMLNotaEntrada=!0},limparFiltrosClick(){this.filtros=$utils.clonarV2(Qt.filtros),this.destinatarioSelecionado=null,this.atualizar()},async configuraImpressao(o){const l=await $db.configuracoes.porNome("impressao.compra",o);this.configImpressao=[...l.length?l.map(h=>({texto:"Imprimir Compra",...h})):[{valor:"invoice",texto:"Compras e Estoque"}]]},setOpcoesTabs(o){o!=="Nota no SEFAZ"&&(this.tabSelecionada.valor="Digita\xE7\xE3o",this.tabs=[{valor:"Digita\xE7\xE3o",rotulo:"Digita\xE7\xE3o"},{valor:"Finalizado",rotulo:"Finalizado"},{valor:"Todos",rotulo:"Todos"}]),o==="Nota no SEFAZ"&&(this.tabSelecionada.valor="N\xE3o Importada",this.tabs=[{valor:"N\xE3o Importada",rotulo:"N\xE3o Importada"},{valor:"Importada",rotulo:"Importada"},{valor:"Todos",rotulo:"Todos"}])},async downloadXmlDFeFiltrados(){var l,h,k,a,n;if(!await $q.dialogSimNao({title:"Download XML's filtrados",message:"Deseja prosseguir com a opera\xE7\xE3o?"}))return;let o=[];if($db.hibrido.isOnline())o=(n=(a=(k=await $utils.geeksApi({downloadDFe:{funcao:"2D9F9B43-47D3-491E-AD49-528EC9547BDC",...this.tabSelecionada.valor!=="Todos"?{situacao:this.tabSelecionada.valor}:{},fornecedor:(l=this.filtros.fornecedor)==null?void 0:l.nome,numeroDocumentoNacionalDestinatario:(h=this.filtros.destinatario)==null?void 0:h.numeroDocumentoNacional,periodoRecbto:this.filtros.periodoEmissao}}))==null?void 0:k.data)==null?void 0:a.downloadDFe)!=null?n:[];else{let m=await $db.hibrido.lista({table:"documentoFiscalEletronico",columns:["id","dhEmi","cpfCnpjDestinatario","xNomeEmitente","xNomeDestinatario"],where:{tipo:"DFe",...this.tabSelecionada.valor!=="Todos"?{situacao:this.tabSelecionada.valor}:{}}});m=m.filter(c=>{var b,w,g;return!(((b=this.filtros.fornecedor)==null?void 0:b.nome)&&!c.xNomeEmitente.toLowerCase().includes(this.filtros.fornecedor.nome.toLowerCase())||((w=this.filtros.destinatario)==null?void 0:w.numeroDocumentoNacional)&&((g=c.cpfCnpjDestinatario)==null?void 0:g.replace(/\D/g,""))!==this.filtros.destinatario.numeroDocumentoNacional.replace(/\D/g,""))}),(await $db.hibrido.lista({table:"documentoFiscalEletronicoXml",columns:["idDocumentoFiscalEletronico","chNFe","dhRecbto","xmlProt"],whereIn:{idDocumentoFiscalEletronico:m.map(c=>c.id)}})).forEach(c=>{var i,I;const b=m.find(r=>r.id===c.idDocumentoFiscalEletronico),w=new Date(c.dhRecbto).setHours(0,0,0,0),g=new Date((i=this.filtros.periodoEmissao)==null?void 0:i.ini).setHours(0,0,0,0),v=new Date((I=this.filtros.periodoEmissao)==null?void 0:I.fim).setHours(0,0,0,0);(g||v)&&w&&(g&&w<g||v&&w>v)||b&&o.push({chNFe:c.chNFe,xml:c.xmlProt,cnpj:b.cpfCnpjDestinatario})})}if((o==null?void 0:o.length)>0){const m=Array.from(new Set(o.filter(c=>c.cnpj).map(c=>c.cnpj))),t=new ba;for(const c of m)for(const b of o.filter(w=>w.cnpj===c))t.file(`${c}/${b.chNFe}.procNFe.xml`,b.xml);t.generateAsync({type:"blob"}).then(function(c){const b=new Date,w=document.createElement("a");w.href=window.URL.createObjectURL(c),w.download=`${b.getFullYear()}-${String(b.getMonth()+1).padStart(2,"0")}-${String(b.getDate()).padStart(2,"0")}_NotasEntradaSEFAZ.zip`,w.click()})}},async downloadXmlDFe(o){if(!await $q.dialogSimNao({title:"Download XML",message:"Deseja prosseguir com a opera\xE7\xE3o?"}))return;const h=(await $db.hibrido.lista({table:"documentoFiscalEletronicoXml",where:{idDocumentoFiscalEletronico:o}}))[0],k=h==null?void 0:h.xmlProt,a=h==null?void 0:h.chNFe;if(!k){this.$q.notify({message:"N\xE3o foi poss\xEDvel recuperar o XML",type:"negative"});return}const n=document.createElement("a"),m=new Blob([k],{type:"text/plain"});n.setAttribute("href",window.URL.createObjectURL(m)),n.setAttribute("download",`${a}-procNFe.xml`),n.dataset.downloadurl=["text/plain",n.download,n.href].join(":"),n.click()},async importarXmlDFe(o){!await $q.dialogSimNao({title:"Importar XML",message:"Deseja prosseguir com a opera\xE7\xE3o?"})||await $tryLoading(async()=>{try{const l=await $db.hibrido.le({table:"documentoFiscalEletronico",id:o}),h=(await $db.hibrido.lista({table:"documentoFiscalEletronicoXml",where:{idDocumentoFiscalEletronico:o}}))[0];if((l==null?void 0:l.id)&&(h==null?void 0:h.xmlProt)){const k=await $db.compra.importaXml({xmlString:h.xmlProt}),a={original:$utils.clonar(l),atual:$utils.clonar(l)};a.atual.situacao="Importada",await $db.documentoFiscalEletronico.grava(a),await this.concluirImportacao(k),$q.notify({message:"XML Importado para Compras",type:"positive"})}}catch(l){$q.notifyError("Erro ao importar XML",l)}},{mensagem:"Importando..."})},async destinatarioOpcoesCarregar(){const o=(await $db.contato.ler({filtros:{ativo:!0,empresas:!0}})).data;this.destinatarioOpcoes=o.map(l=>({label:l.nome,value:l.id,numeroDocumentoNacional:l.numeroDocumentoNacional}))},async configuraEtiqueta(){const o=await $db.configuracoes.le({nome:"impressao.etiqueta"});this.opcoesModelo=[],o.some(l=>l.valor==="etiquetaFila")?this.opcoesModelo.push({rotulo:"Etiqueta Fila",valor:"etiquetaFila",modelo:"etiquetaFila"}):o.forEach(l=>{this.opcoesModelo.push({rotulo:l.texto,valor:l.observacao&&l.observacao.trim()!==""?l.observacao:l.valor,modelo:l.valor})}),this.opcoesModelo=[...this.opcoesModelo,{rotulo:"Modelos antigos:",value:"modelos-antigos",disable:!0},{rotulo:"Folha Argox",valor:"etiqueta-fila"},{rotulo:"Folha Carta",valor:"etiqueta-carta"},{rotulo:"Folha Pimaco",valor:"EtiquetaPimaco6Col"},{rotulo:"Personaliz\xE1vel",valor:"etiqueta_generica_ajustavel"}],this.modeloSelecionado=this.opcoesModelo[0].valor},async configuraEmpresas(){const o=(await $db.contato.ler({filtros:{ativo:!0,empresas:!0}})).data;this.opcoesEmpresas=o.map(l=>({rotulo:l.apelido||l.nome,valor:l.id,codigoEmpresa:l.codigoContato})),this.empresaSelecionada=""},async configuraTabelasPreco(){this.tabelasPreco=await $db.itemTabelaPreco.le({ativo:!0,tabelaMaster:!0})||[],this.opcoesTabelasPreco=this.tabelasPreco.map(o=>({rotulo:o.descricao,valor:o.id,codigoItemTabelaPreco:o.codigoItemTabelaPreco})),this.tabelaPrecoSelecionada=""},async dialogImprimirEtiquetas({acao:o,item:l}){try{await this.configuraEtiqueta(),await this.configuraEmpresas(),await this.configuraTabelasPreco(),this.dialogEtiquetas={[o]:!0,item:l||{},limpar:!1}}catch(h){console.error("Erro ao configurar impress\xE3o de etiquetas",h)}},imprimirEtiquetas(o){var l,h,k,a,n;if(o==="etiqueta_generica_ajustavel"||o==="etiqueta-fila"||o==="etiqueta-carta"||o==="EtiquetaPimaco6Col"){const m=o==="etiqueta_generica_ajustavel"?"":"OptiSoul/";this.abrirImpressao(`
            https://rel.storage.b15.com.br/Relatorios/${m}${o}.html
            ?Banco=${this.clienteSistema.bancoDeDados}
            &URLServidor=${this.clienteSistema.urlServidor}
            &CodigoUsuario=${this.usuario.codigoUsuario}
            &EmBranco=${this.emBranco}
            &CodigoPedido=${(h=(l=this.dialogEtiquetas)==null?void 0:l.item)==null?void 0:h.codigoDocumento}
            &TabelaPreco=${this.tabelaPrecoSelecionada?this.opcoesTabelasPreco.find(t=>t.valor===this.tabelaPrecoSelecionada).codigoItemTabelaPreco:""}
            &CodigoContatoEmpresa=${this.empresaSelecionada?this.opcoesEmpresas.find(t=>t.valor===this.empresaSelecionada).codigoEmpresa:""}
            &cpfUsuarioLogado=${this.usuario.cpf}
            &hfCodigoSistema={
              data:{
                CodigoUsuario:${this.usuario.codigoUsuario},
                CodigoSistema:${this.clienteSistema.codigoSistema},
                CodigoClienteSistema:${this.clienteSistema.codigoClienteSistema},
                Sistema:${this.clienteSistema.sistema},
                URLServidor:${this.clienteSistema.urlServidor},
                BancoDeDados:${this.clienteSistema.bancoDeDados},
                CodigoCliente:${this.clienteSistema.codigoCliente},
                Cliente:${this.clienteSistema.cliente},
                Administrador:${this.clienteSistema.administrador},
                GrupoInterno:${this.clienteSistema.grupoInterno}
              }
            }
          `)}else{const m=(k=this.opcoesModelo)==null?void 0:k.find(b=>b.valor===o),t=(m==null?void 0:m.modelo)||"",c=(m==null?void 0:m.valor)||"";$imprimir(t,{id:(n=(a=this.dialogEtiquetas)==null?void 0:a.item)==null?void 0:n.id,impressao:"etiquetas"},{modelo:c,idEmpresa:this.empresaSelecionada,idTabelaPreco:this.tabelaPrecoSelecionada,emBranco:this.emBranco})}},abrirImpressao(o){window.open(o.replace(/[\s\n]/g,""),"_blank").focus()},async adicionarEtiquetas(){var o;try{$q.loading.show();const l=this.dialogEtiquetas;let h=await $db.etiqueta.ler({cpfUsuarioLogado:this.usuario.numeroDocumentoNacional})||[];if(l!=null&&l.limpar){for(const m of h)await $db.etiqueta.remover(m.id);h=[]}const k=await $db.hibrido.lista({table:"documentoItem",where:{idDocumento:(o=l==null?void 0:l.item)==null?void 0:o.id}});if(!k.length){$q.notifyError("N\xE3o foi poss\xEDvel encontrar itens para carregar a impress\xE3o etiquetas");return}const a=k.map(m=>m.idItem),n=await $db.hibrido.lista({table:"item",columns:["id","codigoItem","descricaoConcatenada","valorVenda"],whereIn:{id:a}});if(!n.length){$q.notifyError("N\xE3o foi poss\xEDvel encontrar itens para carregar a impress\xE3o etiquetas");return}for(const m of n){if(h.length){const c=h.find(b=>b.idItem===m.id)||null;c&&await $db.etiqueta.remover(c==null?void 0:c.id)}const t={id:$utils.uuid(),idItem:m.id,nomeProduto:m.descricaoConcatenada,valor:m.valorVenda||0,quantidadeEtiquetas:k.find(c=>c.idItem===m.id).quantidade||0,cpfUsuarioLogado:this.usuario.numeroDocumentoNacional,dataHoraEmissao:$utils.dataAtual()};await $db.etiqueta.gravar({atual:t})}$q.loading.hide(),this.$q.dialog({title:"",message:"Ir para tela de impress\xE3o de etiquetas?",noRefocus:!0,preventClose:!0,ok:{label:"SIM",push:!0,class:"bg-primary",textColor:"white",flat:!0},cancel:{label:"N\xC3O",push:!0,color:"tertiary",flat:!0}}).onOk(()=>{this.$router.push({name:"EtiquetasLista"})}).onCancel(()=>{this.dialogEtiquetas.adicionar=!1})}catch(l){$q.loading.hide(),$q.notifyError("Erro ao adicionar etiquetas",l)}}},watch:{"tabSelecionada2.valor"(){this.tabSelecionada2.valor==="Nota no SEFAZ"&&(this.mostrar.btnMenuMais=!0)}},async created(){await this.destinatarioOpcoesCarregar()},async mounted(){this.usuario=JSON.parse(localStorage.getItem("usuario")),this.clienteSistema=JSON.parse(localStorage.getItem("clienteSistema")),this.tabSelecionada2.valor=this.$route.name,this.atualizar({buscarDadosRecentes:!0})}},_a={id:"Compras"},wa={class:"mw80 text-center"},ya={class:"row q-ma-md"},Ia={key:0,class:"row q-ma-md"},ka={class:"certificado-error-messages"};function Ca(o,l,h,k,a,n){const m=mt("campo"),t=mt("row"),c=mt("BadgeCopiarUid"),b=mt("avatar"),w=mt("g-label"),g=mt("badge"),v=mt("g-col"),i=mt("g-row"),I=mt("Lista"),r=mt("ComprasFicha"),p=mt("ComprasImportacaoXML");return Q(),wt("div",_a,[e(I,{busca:a.busca,"onUpdate:busca":l[11]||(l[11]=u=>a.busca=u),onAtualizar:n.atualizar,onLimparFiltrosClick:n.limparFiltrosClick,onCriarClick:n.criarClick,lista:a.lista,tabSelecionada:a.tabSelecionada,tabs:a.tabs,tabSelecionada2:a.tabSelecionada2,tabs2:a.tabs2,paginacao:a.paginacao,mostrar:a.mostrar},{botaoNovo:s(()=>[e(ct,{label:"Novo",icon:"add",unelevated:"",color:"primary","text-color":"white",class:"hideonmobile"},{default:s(()=>[e(Kt,null,{default:s(()=>[e(xt,{link:"","no-border":"",separator:""},{default:s(()=>[bt((Q(),at(_t,{onClick:n.criarClick,clickable:""},{default:s(()=>[e(tt,{avatar:""},{default:s(()=>[e(vt,{name:"add"})]),_:1}),e(tt,null,{default:s(()=>[e(pt,null,{default:s(()=>[R("Incluir Manual")]),_:1})]),_:1})]),_:1},8,["onClick"])),[[Vt]]),bt((Q(),at(_t,{onClick:n.importarXmlClick,clickable:""},{default:s(()=>[e(tt,{avatar:""},{default:s(()=>[e(vt,{name:"add"})]),_:1}),e(tt,null,{default:s(()=>[e(pt,null,{default:s(()=>[R("Importar XML")]),_:1})]),_:1})]),_:1},8,["onClick"])),[[Vt]])]),_:1})]),_:1})]),_:1}),e(ct,{icon:"add",flat:"",round:"",color:"primary","text-color":"white",class:"hideondesktop"},{default:s(()=>[e(Kt,null,{default:s(()=>[e(xt,{link:"","no-border":"",separator:""},{default:s(()=>[bt((Q(),at(_t,{onClick:n.criarClick,clickable:""},{default:s(()=>[e(tt,{avatar:""},{default:s(()=>[e(vt,{name:"add"})]),_:1}),e(tt,null,{default:s(()=>[e(pt,null,{default:s(()=>[R("Incluir Manual")]),_:1})]),_:1})]),_:1},8,["onClick"])),[[Vt]]),bt((Q(),at(_t,{onClick:n.importarXmlClick,clickable:""},{default:s(()=>[e(tt,{avatar:""},{default:s(()=>[e(vt,{name:"add"})]),_:1}),e(tt,null,{default:s(()=>[e(pt,null,{default:s(()=>[R("Importar XML")]),_:1})]),_:1})]),_:1},8,["onClick"])),[[Vt]])]),_:1})]),_:1})]),_:1})]),filtroCampos:s(()=>[e(t,{class:"q-col-gutter-md q-mt-md"},{default:s(()=>[e(m,{modelValue:a.filtros.numero,"onUpdate:modelValue":l[0]||(l[0]=u=>a.filtros.numero=u),rotulo:"N\xBA Nota",dense:"",class:"col-md-12",style:{"padding-top":"0px"}},null,8,["modelValue"]),e(m,{modelValue:a.filtros.numeroCompra,"onUpdate:modelValue":l[1]||(l[1]=u=>a.filtros.numeroCompra=u),rotulo:"Ordem de compra",dense:"",class:"q-field--with-bottom"},null,8,["modelValue"])]),_:1}),e(xe,{modelValue:a.destinatarioSelecionado,"onUpdate:modelValue":[l[2]||(l[2]=u=>a.destinatarioSelecionado=u),n.aoSelecionarDestinatario],options:a.destinatarioOpcoes,clearable:"",dense:"",label:"Destinat\xE1rio",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue","options"]),e(t,{class:"q-col-gutter-md q-mt-md",style:{"margin-top":"-10px"}},{default:s(()=>[e(m,{modelValue:a.filtros.fornecedor.nome,"onUpdate:modelValue":l[3]||(l[3]=u=>a.filtros.fornecedor.nome=u),rotulo:"Fornecedor",dense:"",class:"col-md-12 q-mb-lg"},null,8,["modelValue"]),this.tabSelecionada2.valor==="Nota no SEFAZ"?(Q(),wt(Pt,{key:0},[e(m,{modelValue:a.filtros.periodoEmissao.ini,"onUpdate:modelValue":l[4]||(l[4]=u=>a.filtros.periodoEmissao.ini=u),rotulo:"Data Emiss\xE3o",dense:"",tipo:"data",class:"col-md-12"},null,8,["modelValue"]),e(m,{modelValue:a.filtros.periodoEmissao.fim,"onUpdate:modelValue":l[5]||(l[5]=u=>a.filtros.periodoEmissao.fim=u),rotulo:"at\xE9",dense:"",tipo:"data",class:"col-md-12"},null,8,["modelValue"])],64)):(Q(),wt(Pt,{key:1},[e(m,{modelValue:a.filtros.periodoEmissao.ini,"onUpdate:modelValue":l[6]||(l[6]=u=>a.filtros.periodoEmissao.ini=u),rotulo:"Data Emiss\xE3o",dense:"",tipo:"data",class:"col-md-12"},null,8,["modelValue"]),e(m,{modelValue:a.filtros.periodoEmissao.fim,"onUpdate:modelValue":l[7]||(l[7]=u=>a.filtros.periodoEmissao.fim=u),rotulo:"at\xE9",dense:"",tipo:"data",class:"col-md-12 q-mb-lg"},null,8,["modelValue"]),e(m,{modelValue:a.filtros.periodoFinalizado.ini,"onUpdate:modelValue":l[8]||(l[8]=u=>a.filtros.periodoFinalizado.ini=u),rotulo:"Data Finalizado",dense:"",tipo:"data",class:"col-md-12"},null,8,["modelValue"]),e(m,{modelValue:a.filtros.periodoFinalizado.fim,"onUpdate:modelValue":l[9]||(l[9]=u=>a.filtros.periodoFinalizado.fim=u),rotulo:"at\xE9",dense:"",tipo:"data",class:"col-md-12 q-mb-lg"},null,8,["modelValue"])],64)),e(m,{modelValue:a.paginacao.limite,"onUpdate:modelValue":l[10]||(l[10]=u=>a.paginacao.limite=u),rotulo:"Quantidade por p\xE1gina",dense:"",tipo:"quantidade",min:"1"},null,8,["modelValue"])]),_:1})]),menuExtras:s(()=>[bt((Q(),at(_t,{onClick:n.downloadXmlDFeFiltrados,clickable:""},{default:s(()=>[e(tt,{avatar:""},{default:s(()=>[e(vt,{name:"download"})]),_:1}),e(tt,null,{default:s(()=>[e(pt,null,{default:s(()=>[R("Download")]),_:1})]),_:1}),e(St,null,{default:s(()=>[R("Download dos XML's filtrados")]),_:1})]),_:1},8,["onClick"])),[[Vt]])]),itemLista:s(()=>[e(xt,{bordered:"",class:"bg-white q-mb-xs rounded-borders",style:{"min-height":"calc(100vh - 200px)"}},{default:s(()=>[(Q(!0),wt(Pt,null,Rt(a.lista,u=>(Q(),wt("div",{key:u.id,class:"itemHover"},[e(_t,{"manual-focus":"",class:"q-py-sm q-px-xs items-center"},{default:s(()=>[e(tt,{class:"hideonmobile col-auto q-px-sm no-margin"},{default:s(()=>[ft("div",wa,[e(c,{id:u.id,numero:u.numero,cor:"positive",escuro:""},null,8,["id","numero"])])]),_:2},1024),e(tt,{class:"col-md col-lg col-xl no-margin"},{default:s(()=>[e(_t,{class:"q-pa-none"},{default:s(()=>[e(tt,{onClick:_=>n.abrir(u.id),class:"col-auto items-center"},{default:s(()=>[e(b,{imagem:(a.contatos[u.idContato]||{}).imagem,rotulo:u.descricaoContato,tamanho:"40"},null,8,["imagem","rotulo"])]),_:2},1032,["onClick"]),e(tt,{class:"col"},{default:s(()=>[e(pt,{onClick:_=>n.abrir(u.id),lines:"2",class:"text-tertiary text-weight-bold ellipsis-2-lines"},{default:s(()=>[R(J(u.descricaoContato)+" ",1),e(St,{anchor:"bottom middle",self:"center middle"},{default:s(()=>[R("Fornecedor")]),_:1})]),_:2},1032,["onClick"]),u.descricaoDestinatario?(Q(),at(pt,{key:0,onClick:_=>n.abrir(u.id),lines:"2",class:"ellipsis-2-lines"},{default:s(()=>[e(w,{icon:"business xs tertiary left"},{default:s(()=>[R(J(u.descricaoDestinatario),1)]),_:2},1024)]),_:2},1032,["onClick"])):lt("",!0),e(_t,{class:"q-pa-none hideonmobile q-mt-xs",style:{"min-height":"unset"}},{default:s(()=>[u.notaNumero?(Q(),at(g,{key:0,cor:"tertiary",class:"mw50 text-center",escuro:""},{default:s(()=>[R(J(u.notaNumero)+" ",1),e(St,{anchor:"bottom middle",self:"center middle"},{default:s(()=>[R("N\xFAmero da Nota")]),_:1})]),_:2},1024)):(Q(),at(g,{key:1,cor:"warning",class:"mw50 text-center",escuro:""},{default:s(()=>[R(" S/N "),e(St,{anchor:"bottom middle",self:"center middle"},{default:s(()=>[R("N\xFAmero da Nota")]),_:1})]),_:1}))]),_:2},1024),e(tt,{class:"hideondesktop q-mt-sm"},{default:s(()=>[e(i,{mg:"xs-b"},{default:s(()=>[u.dataHoraEmissao?(Q(),at(v,{key:0,col:"shrink"},{default:s(()=>[e(w,{icon:"mdi-calendar-today xs tertiary left",tip:`Emitido \xE0s ${o.$filters.hora(u.dataHoraEmissao)}`},{default:s(()=>[R(J(o.$filters.data(u.dataHoraEmissao)),1)]),_:2},1032,["tip"])]),_:2},1024)):lt("",!0),u.dataHoraFinalizado?(Q(),at(v,{key:1,col:"shrink",class:"q-ml-sm"},{default:s(()=>[e(w,{icon:"mdi-calendar xs tertiary left",tip:`Finalizado \xE1s ${o.$filters.hora(u.dataHoraFinalizado)}`},{default:s(()=>[R(J(o.$filters.data(u.dataHoraFinalizado)),1)]),_:2},1032,["tip"])]),_:2},1024)):lt("",!0)]),_:2},1024),e(i,{mg:"xs-b"},{default:s(()=>[e(v,{col:"shrink"},{default:s(()=>[e(c,{id:u.id,numero:u.numero,cor:"positive",escuro:""},null,8,["id","numero"])]),_:2},1024),e(v,{col:"shrink",class:"q-ml-sm"},{default:s(()=>[u.notaNumero?(Q(),at(g,{key:0,cor:"tertiary",class:"mw50",escuro:""},{default:s(()=>[R(J(u.notaNumero)+" ",1),e(St,{anchor:"bottom middle",self:"center middle"},{default:s(()=>[R("N\xFAmero da Nota")]),_:1})]),_:2},1024)):(Q(),at(g,{key:1,cor:"warning",class:"mw50",escuro:""},{default:s(()=>[R(" S/N "),e(St,{anchor:"bottom middle",self:"center middle"},{default:s(()=>[R("N\xFAmero da Nota")]),_:1})]),_:1}))]),_:2},1024),e(v,{col:"shrink",class:"q-ml-sm"},{default:s(()=>[e(g,{rotulo:u.status,cor:u.status!=="Digita\xE7\xE3o"?"tertiary":"light",escuro:u.status!=="Digita\xE7\xE3o"},null,8,["rotulo","cor","escuro"])]),_:2},1024)]),_:2},1024),e(i,null,{default:s(()=>[e(v,{col:"shrink",text:"bold"},{default:s(()=>[R(J(o.$filters.numero(u.totalDocumento,2)),1)]),_:2},1024),bt(e(v,{col:"grow",text:"center",class:"q-ml-sm"},{default:s(()=>[R(J(u.qtdeContatos)+" Itens ",1)]),_:2},1536),[[Dt,u.qtdeContatos>0]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(tt,{onClick:_=>n.abrir(u.id),class:"hideonmobile maxw110 q-pl-sm no-margin"},{default:s(()=>[this.tabSelecionada2.valor==="Nota no SEFAZ"?(Q(),wt(Pt,{key:0},[u.dhRecbto?(Q(),at(pt,{key:0,lines:"1",color:"tertiary",class:"ellipsis"},{default:s(()=>[e(vt,{name:"mdi-calendar-today"}),R(" "+J(o.$filters.data(u.dhRecbto))+" ",1),e(St,{anchor:"bottom middle",self:"center middle"},{default:s(()=>[R(" Autorizado \xE0s "+J(o.$filters.hora(u.dhRecbto)),1)]),_:2},1024)]),_:2},1024)):lt("",!0)],64)):(Q(),wt(Pt,{key:1},[u.dataHoraEmissao?(Q(),at(pt,{key:0,lines:"1",color:"tertiary",class:"ellipsis"},{default:s(()=>[e(vt,{name:"mdi-calendar-today"}),R(" "+J(o.$filters.data(u.dataHoraEmissao))+" ",1),e(St,{anchor:"bottom middle",self:"center middle"},{default:s(()=>[R(" Emitido \xE0s "+J(o.$filters.hora(u.dataHoraEmissao)),1)]),_:2},1024)]),_:2},1024)):lt("",!0),u.dataHoraFinalizado?(Q(),at(pt,{key:1,lines:"1",color:"tertiary",class:"ellipsis"},{default:s(()=>[e(vt,{name:"mdi-calendar"}),R(" "+J(o.$filters.data(u.dataHoraFinalizado))+" ",1),e(St,{anchor:"bottom middle",self:"center middle"},{default:s(()=>[R(" Finalizado \xE1s "+J(o.$filters.hora(u.dataHoraFinalizado)),1)]),_:2},1024)]),_:2},1024)):lt("",!0)],64))]),_:2},1032,["onClick"]),e(tt,{onClick:_=>n.abrir(u.id),class:"hideonmobile maxw100 q-pl-sm no-margin"},{default:s(()=>[e(g,{cor:u.status!=="Digita\xE7\xE3o"?"tertiary":"light",escuro:u.status!=="Digita\xE7\xE3o",class:"col-auto q-mx-auto"},{default:s(()=>[R(J(u.status)+" ",1),e(St,{anchor:"bottom middle",self:"center middle"},{default:s(()=>[R(" Status ")]),_:1})]),_:2},1032,["cor","escuro"])]),_:2},1032,["onClick"]),e(tt,{onClick:_=>n.abrir(u.id),class:"hideonmobile maxw120 q-pl-sm no-margin"},{default:s(()=>[e(pt,{class:"text-tertiary text-weight-bold text-right"},{default:s(()=>[R(J(o.$filters.numero(u.totalDocumento,2)),1)]),_:2},1024),bt(e(pt,{class:"text-tertiary text-right"},{default:s(()=>[R(J(u.qtdeContatos)+" Itens ",1)]),_:2},1536),[[Dt,u.qtdeContatos>0]])]),_:2},1032,["onClick"]),e(tt,{class:"hideonmobile col-auto q-pl-sm no-margin"},{default:s(()=>[e(_t,{class:"q-pa-none"},{default:s(()=>[a.tabSelecionada2.valor!=="Nota no SEFAZ"?(Q(),at(tt,{key:0,class:"no-margin"},{default:s(()=>[e(ct,{onClick:_=>n.abrir(u.id),icon:"edit",size:"md",color:"primary",round:"",flat:"",dense:""},null,8,["onClick"])]),_:2},1024)):lt("",!0),a.tabSelecionada2.valor==="Nota no SEFAZ"?(Q(),at(tt,{key:1,class:"no-margin",style:{width:"33.6px"}},{default:s(()=>[u.status==="N\xE3o Importada"?(Q(),at(ct,{key:0,onClick:_=>n.importarXmlDFe(u.id),flat:"",round:"",dense:"",icon:"mdi-upload",size:"md",color:"tertiary",class:"buttons"},{default:s(()=>[e(St,{anchor:"bottom middle",self:"center middle"},{default:s(()=>[R("Importar XML")]),_:1})]),_:2},1032,["onClick"])):lt("",!0)]),_:2},1024)):lt("",!0),a.tabSelecionada2.valor==="Nota no SEFAZ"?(Q(),at(tt,{key:2,class:"no-margin",style:{width:"33.6px"}},{default:s(()=>[e(ct,{onClick:_=>n.downloadXmlDFe(u.id),flat:"",round:"",dense:"",icon:"mdi-download",color:"tertiary",size:"md",class:"buttons"},{default:s(()=>[e(St,{anchor:"bottom middle",self:"center middle"},{default:s(()=>[R("Download XML")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)):lt("",!0),a.tabSelecionada2.valor!=="Nota no SEFAZ"?(Q(),at(tt,{key:3,class:"no-margin"},{default:s(()=>[e(ct,{icon:"more_vert",size:"md",color:"tertiary",round:"",flat:"",dense:""},{default:s(()=>[e(Kt,null,{default:s(()=>[bt((Q(),at(xt,{link:"","no-border":"",separator:""},{default:s(()=>[e(_t,{onClick:_=>n.dialogImprimirEtiquetas({acao:"adicionar",item:u}),clickable:""},{default:s(()=>[e(tt,{avatar:""},{default:s(()=>[e(vt,{name:"print"})]),_:1}),e(tt,null,{default:s(()=>[e(pt,null,{default:s(()=>[R(" Adicionar Etiquetas ")]),_:1})]),_:1})]),_:2},1032,["onClick"]),e(_t,{onClick:_=>n.dialogImprimirEtiquetas({acao:"impressao",item:u}),clickable:""},{default:s(()=>[e(tt,{avatar:""},{default:s(()=>[e(vt,{name:"print"})]),_:1}),e(tt,null,{default:s(()=>[e(pt,null,{default:s(()=>[R(" Imprimir Etiquetas ")]),_:1})]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)),[[Vt]])]),_:2},1024)]),_:2},1024)]),_:2},1024)):lt("",!0)]),_:2},1024)]),_:2},1024),e(tt,{class:"hideondesktop col-auto q-pl-sm no-margin"},{default:s(()=>[e(ct,{icon:"more_vert",size:"md",color:"tertiary",round:"",flat:"",dense:""},{default:s(()=>[e(Kt,null,{default:s(()=>[bt((Q(),at(xt,{link:"","no-border":"",separator:""},{default:s(()=>[a.tabSelecionada2.valor!=="Nota no SEFAZ"?(Q(),at(_t,{key:0,onClick:_=>n.abrir(u.id),clickable:"",class:"itemHover"},{default:s(()=>[e(tt,{avatar:""},{default:s(()=>[e(vt,{name:"edit"})]),_:1}),e(tt,null,{default:s(()=>[e(pt,null,{default:s(()=>[R(" Editar ")]),_:1})]),_:1})]),_:2},1032,["onClick"])):lt("",!0),a.tabSelecionada2.valor==="Nota no SEFAZ"&&u.status==="N\xE3o Importada"?(Q(),at(_t,{key:1,onClick:_=>n.importarXmlDFe(u.id),clickable:"",class:"itemHover"},{default:s(()=>[e(tt,{avatar:""},{default:s(()=>[e(vt,{name:"mdi-upload"})]),_:1}),e(tt,null,{default:s(()=>[e(pt,null,{default:s(()=>[R(" Importar XML ")]),_:1})]),_:1})]),_:2},1032,["onClick"])):lt("",!0),a.tabSelecionada2.valor==="Nota no SEFAZ"?(Q(),at(_t,{key:2,onClick:_=>n.downloadXmlDFe(u.id),clickable:"",class:"itemHover"},{default:s(()=>[e(tt,{avatar:""},{default:s(()=>[e(vt,{name:"mdi-download"})]),_:1}),e(tt,null,{default:s(()=>[e(pt,null,{default:s(()=>[R(" Download XML ")]),_:1})]),_:1})]),_:2},1032,["onClick"])):lt("",!0),a.tabSelecionada2.valor!=="Nota no SEFAZ"?(Q(),at(_t,{key:3,clickable:"",onClick:_=>n.dialogImprimirEtiquetas({acao:"adicionar",item:u})},{default:s(()=>[e(tt,{avatar:""},{default:s(()=>[e(vt,{name:"print"})]),_:1}),e(tt,null,{default:s(()=>[e(pt,null,{default:s(()=>[R(" Adicionar Etiquetas ")]),_:1})]),_:1})]),_:2},1032,["onClick"])):lt("",!0),a.tabSelecionada2.valor!=="Nota no SEFAZ"?(Q(),at(_t,{key:4,clickable:"",onClick:_=>n.dialogImprimirEtiquetas({acao:"impressao",item:u})},{default:s(()=>[e(tt,{avatar:""},{default:s(()=>[e(vt,{name:"print"})]),_:1}),e(tt,null,{default:s(()=>[e(pt,null,{default:s(()=>[R(" Imprimir Etiquetas ")]),_:1})]),_:1})]),_:2},1032,["onClick"])):lt("",!0)]),_:2},1024)),[[Vt]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(le)]))),128))]),_:1})]),_:1},8,["busca","onAtualizar","onLimparFiltrosClick","onCriarClick","lista","tabSelecionada","tabs","tabSelecionada2","tabs2","paginacao","mostrar"]),e(r,{ref:"comprasFicha",onAtualizar:n.atualizar,onDialogImprimirEtiquetas:n.dialogImprimirEtiquetas},null,8,["onAtualizar","onDialogImprimirEtiquetas"]),e(p,{ref:"comprasImportacaoXML",onAtualizar:n.atualizar,onConcluirImportacao:n.concluirImportacao},null,8,["onAtualizar","onConcluirImportacao"]),e(Zt,{modelValue:a.modalXMLNotaEntrada,"onUpdate:modelValue":l[15]||(l[15]=u=>a.modalXMLNotaEntrada=u),persistent:""},{default:s(()=>[e(Lt,{container:"",class:"bg-light",style:{height:"40vh",width:"50vw","max-width":"100vw"}},{default:s(()=>[ft("form",{onSubmit:l[14]||(l[14]=Pe((...u)=>n.importarXmlNotaDeEntrada&&n.importarXmlNotaDeEntrada(...u),["prevent"]))},[e(jt,null,{default:s(()=>[e(Tt,null,{default:s(()=>[bt(e(ct,{onClick:n.fecharXmlNotaDeEntrada,flat:"",round:"",dense:"",icon:"close"},null,8,["onClick"]),[[Vt]]),e(Ut,null,{default:s(()=>[R("Importar XML Nota de Entrada")]),_:1}),e(ct,{color:"white","text-color":"primary",label:"Enviar",type:"submit",unelevated:""})]),_:1})]),_:1}),e($t,{class:"u-container"},{default:s(()=>[e(Ht,{style:{"min-height":"300px"}},{default:s(()=>{var u,_,E;return[ft("div",ya,[e(ze,{class:"col-12","hide-upload-btn":"","auto-upload":"",factory:n.adicionarXml,filter:D=>D.filter(x=>x.type==="text/xml")},null,8,["factory","filter"]),e(ge,{modelValue:a.xmlDevolucao,"onUpdate:modelValue":l[12]||(l[12]=D=>a.xmlDevolucao=D),label:"Devolu\xE7\xE3o"},null,8,["modelValue"]),e(ge,{modelValue:a.xmlEstrangeiro,"onUpdate:modelValue":l[13]||(l[13]=D=>a.xmlEstrangeiro=D),label:"Importa\xE7\xE3o do exterior"},null,8,["modelValue"])]),Object.keys((E=(_=(u=a.xmlNotaEntrada.error)==null?void 0:u.data)==null?void 0:_.fields)!=null?E:{}).length?(Q(),wt("div",Ia,[ft("ul",ka,[(Q(!0),wt(Pt,null,Rt(Object.keys(a.xmlNotaEntrada.error.data.fields),D=>(Q(),wt("li",{key:D},[ft("span",null,J(D),1),ft("span",null,J(a.xmlNotaEntrada.error.data.fields[D]),1)]))),128))])])):lt("",!0)]}),_:1})]),_:1})],32)]),_:1})]),_:1},8,["modelValue"]),e(Zt,{modelValue:a.dialogEtiquetas.impressao,"onUpdate:modelValue":l[21]||(l[21]=u=>a.dialogEtiquetas.impressao=u)},{default:s(()=>[e(Lt,{container:"",view:"hHh LpR fFf",class:"bg-white rounded-borders",style:{height:"100%","max-height":"425px"}},{default:s(()=>[e(de,{onSubmit:l[20]||(l[20]=u=>n.imprimirEtiquetas(a.modeloSelecionado)),autocorrect:"off",autocapitalize:"off",autocomplete:"off",spellcheck:"false",novalidate:""},{default:s(()=>[e(jt,null,{default:s(()=>[e(Tt,{class:"bg-primary text-white"},{default:s(()=>[e(Ut,null,{default:s(()=>[e(vt,{name:"mdi-tag-plus",size:"sm",class:"q-mr-sm"}),R(" Imprimir Etiquetas ")]),_:1})]),_:1})]),_:1}),e($t,null,{default:s(()=>[e(Ht,{class:"q-pa-md"},{default:s(()=>[e(w,{class:"q-pb-lg"},{default:s(()=>{var u,_,E,D,x,B,N,j,A,H,et,S,q;return[R(" Imprimir os itens: "),ft("strong",null,J((u=a.tabSelecionada2)==null?void 0:u.valor)+" "+J((E=(_=a.dialogEtiquetas)==null?void 0:_.item)!=null&&E.numero?", #"+((x=(D=a.dialogEtiquetas)==null?void 0:D.item)==null?void 0:x.numero):"")+" "+J((N=(B=a.dialogEtiquetas)==null?void 0:B.item)!=null&&N.descricaoContato?" - "+((A=(j=a.dialogEtiquetas)==null?void 0:j.item)==null?void 0:A.descricaoContato):"")+" "+J((et=(H=a.dialogEtiquetas)==null?void 0:H.item)!=null&&et.notaNumero?", Nota #"+((q=(S=a.dialogEtiquetas)==null?void 0:S.item)==null?void 0:q.notaNumero):""),1),R(". ")]}),_:1}),e(m,{modelValue:a.modeloSelecionado,"onUpdate:modelValue":l[16]||(l[16]=u=>a.modeloSelecionado=u),opcoes:a.opcoesModelo,dense:"",filled:"",tipo:"seletor",rotulo:"Modelo",cor:"white","popup-content-class":"etiquetas-modelo-selecionado",class:"q-field--with-bottom"},null,8,["modelValue","opcoes"]),e(m,{modelValue:a.empresaSelecionada,"onUpdate:modelValue":l[17]||(l[17]=u=>a.empresaSelecionada=u),opcoes:a.opcoesEmpresas,dense:"",filled:"",clearable:"",tipo:"seletor",rotulo:"Empresa",color:"tertiary",class:"q-field--with-bottom"},null,8,["modelValue","opcoes"]),e(m,{modelValue:a.tabelaPrecoSelecionada,"onUpdate:modelValue":l[18]||(l[18]=u=>a.tabelaPrecoSelecionada=u),opcoes:a.opcoesTabelasPreco,dense:"",filled:"",clearable:"",tipo:"seletor",rotulo:"Tabela de Pre\xE7o",color:"tertiary",class:"q-field--with-bottom"},null,8,["modelValue","opcoes"]),e(m,{modelValue:a.emBranco,"onUpdate:modelValue":l[19]||(l[19]=u=>a.emBranco=u),min:0,tipo:"quantidade",dense:"",filled:"",rotulo:"Etiquetas em branco",color:"tertiary","text-color":"red"},null,8,["modelValue"])]),_:1})]),_:1}),e(Yt,{class:"bg-light"},{default:s(()=>[e(Tt,null,{default:s(()=>[e(oe),bt(e(ct,{label:"Cancelar",color:"tertiary",flat:"",class:"q-mr-sm"},null,512),[[Vt]]),e(ct,{label:"Confirmar",color:"primary",type:"submit",unelevated:""})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Zt,{modelValue:a.dialogEtiquetas.adicionar,"onUpdate:modelValue":l[23]||(l[23]=u=>a.dialogEtiquetas.adicionar=u)},{default:s(()=>[e(Lt,{container:"",view:"hHh LpR fFf",class:"bg-white rounded-borders",style:{height:"100%","max-height":"250px"}},{default:s(()=>[e(de,{onSubmit:n.adicionarEtiquetas,autocorrect:"off",autocapitalize:"off",autocomplete:"off",spellcheck:"false",novalidate:""},{default:s(()=>[e(jt,null,{default:s(()=>[e(Tt,{class:"bg-primary text-white"},{default:s(()=>[e(Ut,null,{default:s(()=>[e(vt,{name:"mdi-tag-plus",size:"sm",class:"q-mr-sm"}),R(" Adicionar os itens a lista de etiquetas ")]),_:1})]),_:1})]),_:1}),e($t,null,{default:s(()=>[e(Ht,{class:"q-pa-md"},{default:s(()=>[e(w,{class:"q-pb-lg"},{default:s(()=>{var u,_,E,D,x,B,N,j,A,H,et,S,q;return[R(" Adicionar os itens: "),ft("strong",null,J((u=a.tabSelecionada2)==null?void 0:u.valor)+" "+J((E=(_=a.dialogEtiquetas)==null?void 0:_.item)!=null&&E.numero?", #"+((x=(D=a.dialogEtiquetas)==null?void 0:D.item)==null?void 0:x.numero):"")+" "+J((N=(B=a.dialogEtiquetas)==null?void 0:B.item)!=null&&N.descricaoContato?" - "+((A=(j=a.dialogEtiquetas)==null?void 0:j.item)==null?void 0:A.descricaoContato):"")+" "+J((et=(H=a.dialogEtiquetas)==null?void 0:H.item)!=null&&et.notaNumero?", Nota #"+((q=(S=a.dialogEtiquetas)==null?void 0:S.item)==null?void 0:q.notaNumero):""),1),R(" \xE0 lista de etiquetas para impress\xE3o. ")]}),_:1}),e(m,{modelValue:a.dialogEtiquetas.limpar,"onUpdate:modelValue":l[22]||(l[22]=u=>a.dialogEtiquetas.limpar=u),tipo:"logico",rotulo:"Limpar lista de etiquetas anterior."},null,8,["modelValue"])]),_:1})]),_:1}),e(Yt,{class:"bg-light"},{default:s(()=>[e(Tt,null,{default:s(()=>[e(oe),bt(e(ct,{label:"Cancelar",color:"tertiary",flat:"",class:"q-mr-sm"},null,512),[[Vt]]),e(ct,{label:"Confirmar",color:"primary",type:"submit",unelevated:""})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])])}var Pa=re(va,[["render",Ca]]);export{Pa as default};
