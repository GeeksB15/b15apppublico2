import{_ as _e,ax as ae,aX as we,bQ as he,bm as ve,o as d,d as f,w as t,f as e,M as Be,C as A,at as Ce,G as Fe,h as ke,i as xe,j as x,k as n,H as Y,Q as Z,N as ie,J as Ee,I as qe,S as F,T as u,U as _,t as m,e as p,P as te,cK as Pe,p as N,F as S,x as H,aZ as Ve,m as W,X as de,aN as se,l as oe,as as De,cL as Ie,aP as ze,K as Ne,aU as Te,D as Se,aw as O,cM as Re,b3 as Ae,r as X,bJ as He,bf as re,q as ne,b4 as ye,A as Qe}from"./index.a47eb334.js";import{e as Le}from"./emitirNFe.35117289.js";import{n as je}from"./nfePrincipal.f40418d2.js";import{F as Me}from"./FaturaModal.7cdbcd24.js";import{D as Ue}from"./DocumentosFiscais.cf5eef66.js";import{M as Oe}from"./ModalHistoricoStatus.d4b9a8b6.js";const We={computed:{visivel:{get(){return this.modelValue},async set(l){this.$emit("update:modelValue",l)}},ativarBotaoEmissaoBoleto(){var o,v,g,a;const l=Number((v=(o=this.boletos)==null?void 0:o.financeiroBanco)==null?void 0:v.value);return Number.isInteger(l)&&l&&((a=(g=this.boletos)==null?void 0:g.condicoesPagamento)==null?void 0:a.find(c=>c.checked))}},data(){return{boletos:{codigoFinanceiroBanco:"",condicoesPagamento:[],bancos:[],emitidos:!1,emitir:!1,loading:!1,cancelarAtualizarBoletos:!1}}},emits:["update:modelValue"],methods:{async atualizar(){var l,o,v,g,a;try{if((l=this.fatura)!=null&&l.id){this.boletos={codigoFinanceiroBanco:"",condicoesPagamento:[],bancos:[],emitidos:!1,emitir:!1,loading:!1,cancelarAtualizarBoletos:!1};const c=[],C=await ae().formaPagamento.toArray(),V=await ae().empresa.where({idContato:(o=this.fatura)==null?void 0:o.idEmpresa}).toArray();if(await(await $db.hibrido.lista({table:"documentoCondicaoPagamento",where:{idDocumento:(v=this.fatura)==null?void 0:v.id}})).forEach(y=>{const I=C.find(B=>B.id===y.idFormaPagamento&&B.tipo===99&&B.tipoFinanceiro==="T\xEDtulo em aberto");I&&c.push({dataVencimento:y.dataVencimento,descricao:I.descricao,idFinanceiroTitulo:y.idFinanceiroTitulo,codigoFinanceiroBoleto:"",checked:!1,disable:!0,valor:y.valor})}),!c.length)return;const Q=[];await ae().financeiroBanco.each(y=>{if(!!y.ativo){if(y.id==="7D07229E-B35E-42AA-A312-78313BE61B2F"){Q.push(y);return}y.idEmpresa&&V.find(I=>I.id===y.idEmpresa)&&Q.push(y)}});const P=[...new Set(Q.map(y=>y.codigoBanco))],T=[];await ae()._banco.each(y=>{P.find(I=>I===y.codigoBanco)&&T.push(y)}),this.boletos.condicoesPagamento=we.exports.orderBy(c,"dataVencimento","asc");const R=[];for(const y of Q){const I=T.find(E=>E.codigoBanco===y.codigoBanco)||{};if(!I)continue;const B=(I.descricao||"").trim(),i=(y.agencia||"").trim(),r=(y.conta||"").trim();if(!I.arquivoBoleto||!B||!i||!r)continue;let s=B+" - Ag. "+i+" C/C "+r;R.push({arquivoBoleto:I.arquivoBoleto,label:s,value:y.codigoFinanceiroBanco})}R.length&&(this.boletos.financeiroBanco=R[0],this.boletos.bancos=R);const w=(await $db.hibrido.lista({table:"documentoFiscalEletronico",where:{idDocumento:(g=this.fatura)==null?void 0:g.id}})).find(y=>y.situacao==="Emitido")||null;for(const y of(a=this.boletos)==null?void 0:a.condicoesPagamento)y.checked=!1,y.disable=!0,y.codigoFinanceiroBoleto="",y.codigoFinanceiroTitulo="",y.banco={};this.boletos.docFiscal=w,this.boletos.financeiroBanco=this.boletos.bancos[0],this.$nextTick().then(async()=>{await this.atualizarBoletos()})}}catch(c){console.error("ERRO: ",c)}},async atualizarBoletos(){var l;try{let o,v,g,a;a=(l=this.boletos)==null?void 0:l.condicoesPagamento,g=a.reduce((C,V)=>C+"'"+V.idFinanceiroTitulo+"',",""),g=g.slice(0,g.length-1),o=`
            select
              fTitulo.id,
              fTitulo.codigoFinanceiroTitulo,
              fBoleto.codigoFinanceiroBoleto,
              fBoleto.dataEmissao,
              b.descricao,
              fBanco.agencia,
              fBanco.conta,
              b.arquivoBoleto
            from financeiroTitulo fTitulo
              left join financeiroBoleto fBoleto on(fBoleto.codigoFinanceiroBoleto = fTitulo.codigoFinanceiroBoleto)
              left join financeiroBanco fBanco on(fBanco.CodigoFinanceiroBanco = fBoleto.codigoFinanceiroBanco)
              left join _banco b on(b.codigoBanco = fBanco.codigoBanco)
            where fTitulo.id in (${g})
          `,this.boletos.cancelarAtualizarBoletos=!1;let c=0;do{try{v=await he(o),c=0}catch(C){v=[],++c%3===0&&this.$q.notifyError(C.message)}for(const C of v){const V=a.find(k=>k.idFinanceiroTitulo===C.id);V&&(C.codigoFinanceiroBoleto&&(V.codigoFinanceiroBoleto=C.codigoFinanceiroBoleto,V.banco={descricao:C.descricao,dataEmissao:C.dataEmissao,agencia:C.agencia,conta:C.conta,arquivoBoleto:C.arquivoBoleto}),C.codigoFinanceiroTitulo&&(V.codigoFinanceiroTitulo=C.codigoFinanceiroTitulo,V.disable=!1))}if(v.length===a.length||this.boletos.cancelarAtualizarBoletos)break;await ve(5e3)}while(1)}catch{$q.notify({message:"N\xE3o foi poss\xEDvel atualizar os boletos.",type:"tertiary"})}},async emitirImprimirBoleto(){var C,V,k,Q,P,T,R,w,y,I;this.boletos.loading=!0;let l,o,v,g={},a=[];v=(V=(C=this.boletos)==null?void 0:C.condicoesPagamento)==null?void 0:V.filter(B=>B.checked);for(const B of v){if(B.codigoFinanceiroBoleto&&(B.banco||{}).arquivoBoleto){if(!g[B.banco.arquivoBoleto]){g[B.banco.arquivoBoleto]=[B.codigoFinanceiroBoleto];continue}g[B.banco.arquivoBoleto].push(B.codigoFinanceiroBoleto);continue}a.push(B.codigoFinanceiroTitulo)}if((a==null?void 0:a.length)&&((Q=(k=this.boletos)==null?void 0:k.financeiroBanco)==null?void 0:Q.value)){let B,i,r,s=0,E=0,h,q="";if(this.cancelarEmitirBoletos=!1,(P=this.boletos)!=null&&P.docFiscal&&(q=`${this.boletos.docFiscal.nNF} / S\xE9rie ${this.boletos.docFiscal.serie} | `),h=(w=((R=(T=this.boletos)==null?void 0:T.bancos)==null?void 0:R.find(D=>{var z,L;return D.value===((L=(z=this.boletos)==null?void 0:z.financeiroBanco)==null?void 0:L.value)}))||{})==null?void 0:w.arquivoBoleto,!h){this.$q.notifyError("Arquivo boleto n\xE3o encontrado");return}l=`sp_financeiro_boletoEmitir ${(I=(y=this.boletos)==null?void 0:y.financeiroBanco)==null?void 0:I.value}, '${a==null?void 0:a.join(",")}', '${q}'`;do{if(this.cancelarEmitirBoletos)break;try{o=await he(l),s=0}catch(D){o=[],++s%3===0&&this.$q.notifyError(D.message)}if(B=(o||[])[0],i=((B||{}).Msg||"").trim(),r=((B||{}).Retorno||"").trim(),i==="Boleto Gerado com sucesso!"&&r){const D=r.substring(0,r.length-1).split(",");if(!g[h]){g[h]=D;break}for(const z of D)g[h].push(z);break}else++E%3===0&&this.$q.notifyError(i);await ve(5e3)}while(1)}let c=JSON.parse(localStorage.getItem("clienteSistema"))||{};for(const B in g){let i;i="https://rel.storage.b15.com.br/Relatorios/"+B+".html?",i+="CodigoFinanceiroBoleto="+g[B].join(","),i+="&Banco="+c.bancoDeDados,i+="&URLServidor="+c.urlServidor,this.$imprimir("tela-de-boleto-automatico",btoa(i))}await this.atualizarBoletos(),this.boletos.loading=!1},checkboxTodos(l){var o,v,g,a,c,C,V,k,Q,P,T,R,w,y,I,B,i,r,s,E;if(l==="emitidos"&&((g=(v=(o=this.boletos)==null?void 0:o.condicoesPagamento)==null?void 0:v.filter(h=>!h.disable&&h.codigoFinanceiroBoleto))==null?void 0:g.length))for(const h of(c=(a=this.boletos)==null?void 0:a.condicoesPagamento)==null?void 0:c.filter(q=>!q.disable&&q.codigoFinanceiroBoleto))h.checked=!!this.boletos.emitidos;if(l==="emitir"&&((k=(V=(C=this.boletos)==null?void 0:C.condicoesPagamento)==null?void 0:V.filter(h=>!h.disable&&!h.codigoFinanceiroBoleto))==null?void 0:k.length))for(const h of(P=(Q=this.boletos)==null?void 0:Q.condicoesPagamento)==null?void 0:P.filter(q=>!q.disable&&!q.codigoFinanceiroBoleto))h.checked=!!this.boletos.emitir;if(!l){if((w=(R=(T=this.boletos)==null?void 0:T.condicoesPagamento)==null?void 0:R.filter(h=>!h.disable&&h.codigoFinanceiroBoleto))!=null&&w.length){const h=(I=(y=this.boletos)==null?void 0:y.condicoesPagamento)==null?void 0:I.filter(q=>!q.disable&&q.codigoFinanceiroBoleto);this.boletos.emitidos=h.reduce((q,D)=>q&&D.checked,!0)}if((r=(i=(B=this.boletos)==null?void 0:B.condicoesPagamento)==null?void 0:i.filter(h=>!h.disable&&!h.codigoFinanceiroBoleto))!=null&&r.length){const h=(E=(s=this.boletos)==null?void 0:s.condicoesPagamento)==null?void 0:E.filter(q=>!q.disable&&!q.codigoFinanceiroBoleto);this.boletos.emitir=h.reduce((q,D)=>q&&D.checked,!0)}}},async fetchAndRenderHTMLInIframe(l){return new Promise((o,v)=>{const g=document.createElement("iframe");g.style.display="none",document.body.appendChild(g),g.onload=async()=>{try{const a=g.contentWindow.document.body.innerHTML;document.body.removeChild(g),o(a)}catch(a){v(a)}},g.onerror=()=>{v(new Error("Erro ao carregar o iframe"))},g.src=l})},async enviarBoletoEmailAutomatico(l,o,v){try{const{showLoading:g,successMsg:a,errorMsg:c}={},V={host:"smtp.gmail.com",port:587,ssl:!0,auth:{user:"auto@geekssolucoes.com.br",pass:"drab azmd uvtf izhd"},from:o,to:v,subject:"Boleto Automatico",text:"Boleto envio automatico",attachments:[{name:"boleto.pdf",content:l,method:"url2pdf"}]},k=await axios({baseURL:"https://api.b15.com.br",method:"post",url:"/email/v2",data:V});this.$q.notifyPositive((k==null?void 0:k.status)===200&&a?a:k.data.message)}catch(g){this.$q.notifyError("Erro ao enviar o boleto",g)}}},props:{modelValue:{type:Boolean,required:!0},fatura:{type:Object,required:!0,default:()=>({})}},watch:{async visivel(l){l&&await this.atualizar()}}},Ge={class:"text-weight-medium q-px-xs"},Je={class:"text-weight-medium q-px-xs"},Ke={class:"text-weight-bold q-pr-xs"},Xe={class:"text-weight-bold q-pr-xs"},Ze={class:"text-weight-bold q-pr-xs"},Ye={class:"text-weight-medium float-right"};function $e(l,o,v,g,a,c){return d(),f(Se,{modelValue:c.visivel,"onUpdate:modelValue":o[8]||(o[8]=C=>c.visivel=C)},{default:t(()=>[e(Be,{container:"",view:"hHh LpR fFf",class:"bg-white rounded-borders",style:{height:"100%","max-height":"500px"}},{default:t(()=>[A("form",{onSubmit:o[7]||(o[7]=Ce(C=>c.emitirImprimirBoleto(),["prevent"])),class:"q-pa-sm"},[e(Fe,null,{default:t(()=>[e(ke,null,{default:t(()=>[e(xe,null,{default:t(()=>[e(x,{name:"receipt_long",size:"sm",class:"q-mr-sm"}),o[9]||(o[9]=n(" Emiss\xE3o de Boleto "))]),_:1}),Y(e(Z,{icon:"close",flat:"",round:"",dense:""},null,512),[[ie]])]),_:1})]),_:1}),e(Ee,null,{default:t(()=>[e(qe,null,{default:t(()=>{var C,V,k,Q,P,T,R,w,y,I,B;return[(C=a.boletos)!=null&&C.docFiscal?(d(),f(F,{key:0,class:"q-py-none q-px-sm"},{default:t(()=>[e(u,{class:"no-margin"},{default:t(()=>[e(_,{header:""},{default:t(()=>{var i,r,s,E;return[e(x,{name:"insert_drive_file",size:"xs",class:"q-mr-xs"}),o[10]||(o[10]=n(" Nota fiscal: ")),A("span",Ge,m((r=(i=a.boletos)==null?void 0:i.docFiscal)==null?void 0:r.nNF),1),o[11]||(o[11]=n(" | S\xE9rie: ")),A("span",Je,m((E=(s=a.boletos)==null?void 0:s.docFiscal)==null?void 0:E.serie),1)]}),_:1})]),_:1})]),_:1})):p("",!0),(Q=(k=(V=a.boletos)==null?void 0:V.condicoesPagamento)==null?void 0:k.filter(i=>i.disable))!=null&&Q.length?(d(),f(te,{key:1,dense:"",highlight:"",bordered:"","rounded-borders":"",class:"q-pa-none q-mx-sm q-my-lg"},{default:t(()=>{var i,r;return[e(_,{header:"",class:"text-weight-medium text-center"},{default:t(()=>[e(Pe,{size:"xs",class:"q-mr-sm"}),o[12]||(o[12]=n(" Recuperando informa\xE7\xF5es do servidor... "))]),_:1}),(d(!0),N(S,null,H((r=(i=a.boletos)==null?void 0:i.condicoesPagamento)==null?void 0:r.filter(s=>s.disable),(s,E)=>Y((d(),f(F,{key:E,tag:"label"},{default:t(()=>[e(u,{side:""},{default:t(()=>[s!=null&&s.disable?(d(),f(Ve,{key:0})):p("",!0)]),_:2},1024),e(u,null,{default:t(()=>[e(_,null,{default:t(()=>[n(m(s==null?void 0:s.descricao),1)]),_:2},1024)]),_:2},1024),e(u,null,{default:t(()=>[e(_,{class:"text-weight-medium text-center"},{default:t(()=>[A("span",null,[n(m(l.$filters.data(s==null?void 0:s.dataVencimento))+" ",1),e(W,{anchor:"bottom middle",self:"center middle"},{default:t(()=>o[13]||(o[13]=[n(" Data de Vencimento ")])),_:1})])]),_:2},1024)]),_:2},1024),e(u,null,{default:t(()=>[e(_,{class:"text-weight-medium text-right"},{default:t(()=>[n(m(l.$filters.numero(s==null?void 0:s.valor,2)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)),[[de]])),128))]}),_:1})):p("",!0),(R=(T=(P=a.boletos)==null?void 0:P.condicoesPagamento)==null?void 0:T.filter(i=>!i.disable&&i.codigoFinanceiroBoleto))!=null&&R.length?(d(),f(te,{key:2,dense:"",highlight:"",bordered:"","rounded-borders":"",class:"q-pa-none q-mx-sm q-my-lg"},{default:t(()=>{var i,r;return[e(_,{header:"",class:"text-weight-medium"},{default:t(()=>[A("span",null,[e(se,{modelValue:a.boletos.emitidos,"onUpdate:modelValue":[o[0]||(o[0]=s=>a.boletos.emitidos=s),o[1]||(o[1]=s=>c.checkboxTodos("emitidos"))]},null,8,["modelValue"]),e(W,{anchor:"bottom middle",self:"center middle"},{default:t(()=>[n(m(a.boletos.emitidos?"Desmarcar Todos":"Marcar Todos"),1)]),_:1})]),o[14]||(o[14]=n(" Boletos Emitidos "))]),_:1}),(d(!0),N(S,null,H((r=(i=a.boletos)==null?void 0:i.condicoesPagamento)==null?void 0:r.filter(s=>!s.disable&&s.codigoFinanceiroBoleto),(s,E)=>Y((d(),f(F,{key:E,tag:"label"},{default:t(()=>[e(u,{side:""},{default:t(()=>[e(se,{modelValue:s.checked,"onUpdate:modelValue":[h=>s.checked=h,o[2]||(o[2]=h=>c.checkboxTodos())]},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(u,null,{default:t(()=>[e(_,null,{default:t(()=>[e(F,{class:"q-pa-none",style:{"min-height":"22px"}},{default:t(()=>[e(u,null,{default:t(()=>[e(_,null,{default:t(()=>[n(m(s==null?void 0:s.descricao),1)]),_:2},1024)]),_:2},1024),e(u,null,{default:t(()=>[e(_,{class:"text-weight-medium text-center"},{default:t(()=>[A("span",null,[n(m(l.$filters.data(s==null?void 0:s.dataVencimento))+" ",1),e(W,{anchor:"bottom middle",self:"center middle"},{default:t(()=>o[15]||(o[15]=[n(" Data de Vencimento ")])),_:1})])]),_:2},1024)]),_:2},1024),e(u,null,{default:t(()=>[e(_,{class:"text-weight-medium text-right"},{default:t(()=>[n(m(l.$filters.numero(s==null?void 0:s.valor,2)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(oe,{class:"q-mx-sm"}),e(_,{caption:""},{default:t(()=>{var h,q,D,z;return[A("span",Ke,m((h=s==null?void 0:s.banco)==null?void 0:h.descricao)+",",1),o[16]||(o[16]=n(" Ag.: ")),A("span",Xe,m((q=s==null?void 0:s.banco)==null?void 0:q.agencia)+",",1),o[17]||(o[17]=n(" C/C: ")),A("span",Ze,m((D=s==null?void 0:s.banco)==null?void 0:D.conta),1),A("span",Ye,[n(m(l.$filters.data((z=s==null?void 0:s.banco)==null?void 0:z.dataEmissao))+" ",1),e(W,{anchor:"bottom middle",self:"center middle"},{default:t(()=>{var L;return[n(" Emitido \xE1s "+m(l.$filters.hora((L=s==null?void 0:s.banco)==null?void 0:L.dataEmissao)),1)]}),_:2},1024)])]}),_:2},1024)]),_:2},1024)]),_:2},1024)),[[de]])),128))]}),_:1})):p("",!0),(I=(y=(w=a.boletos)==null?void 0:w.condicoesPagamento)==null?void 0:y.filter(i=>!i.disable&&!i.codigoFinanceiroBoleto))!=null&&I.length?(d(),f(te,{key:3,dense:"",highlight:"",bordered:"","rounded-borders":"",class:"q-pa-none q-mx-sm q-my-lg"},{default:t(()=>{var i,r;return[e(_,{header:"",class:"text-weight-medium"},{default:t(()=>[A("span",null,[e(se,{modelValue:a.boletos.emitir,"onUpdate:modelValue":[o[3]||(o[3]=s=>a.boletos.emitir=s),o[4]||(o[4]=s=>c.checkboxTodos("emitir"))]},null,8,["modelValue"]),e(W,{anchor:"bottom middle",self:"center middle"},{default:t(()=>[n(m(a.boletos.emitir?"Desmarcar Todos":"Marcar Todos"),1)]),_:1})]),o[18]||(o[18]=n(" Boletos a Emitir "))]),_:1}),e(F,{class:"q-pa-none"},{default:t(()=>[e(u,null,{default:t(()=>[e(De,{modelValue:a.boletos.financeiroBanco,"onUpdate:modelValue":o[5]||(o[5]=s=>a.boletos.financeiroBanco=s),options:a.boletos.bancos,dense:"",filled:"",label:"Op\xE7\xF5es de Bancos",class:"q-field--with-bottom"},null,8,["modelValue","options"])]),_:1})]),_:1}),(d(!0),N(S,null,H((r=(i=a.boletos)==null?void 0:i.condicoesPagamento)==null?void 0:r.filter(s=>!s.disable&&!s.codigoFinanceiroBoleto),(s,E)=>Y((d(),f(F,{key:E,tag:"label"},{default:t(()=>[e(u,{side:""},{default:t(()=>[e(se,{modelValue:s.checked,"onUpdate:modelValue":[h=>s.checked=h,o[6]||(o[6]=h=>c.checkboxTodos())]},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(u,null,{default:t(()=>[e(_,null,{default:t(()=>[n(m(s==null?void 0:s.descricao),1)]),_:2},1024)]),_:2},1024),e(u,null,{default:t(()=>[e(_,{class:"text-weight-medium text-center"},{default:t(()=>[A("span",null,[n(m(l.$filters.data(s==null?void 0:s.dataVencimento))+" ",1),e(W,{anchor:"bottom middle",self:"center middle"},{default:t(()=>o[19]||(o[19]=[n(" Data de Vencimento ")])),_:1})])]),_:2},1024)]),_:2},1024),e(u,null,{default:t(()=>[e(_,{class:"text-weight-medium text-right"},{default:t(()=>[n(m(l.$filters.numero(s==null?void 0:s.valor,2)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)),[[de]])),128))]}),_:1})):p("",!0),e(Ie,{showing:(B=a.boletos)==null?void 0:B.loading},{default:t(()=>[e(ze,{size:"50px",color:"primary"})]),_:1},8,["showing"])]}),_:1})]),_:1}),e(Ne,{class:"bg-light"},{default:t(()=>[e(ke,null,{default:t(()=>[e(Te),Y(e(Z,{label:"Cancelar",color:"tertiary",flat:"",class:"q-mr-sm"},null,512),[[ie]]),e(Z,{disable:!c.ativarBotaoEmissaoBoleto,type:"submit",label:"Imprimir",color:"primary",unelevated:""},null,8,["disable"])]),_:1})]),_:1})],32)]),_:1})]),_:1},8,["modelValue"])}var et=_e(We,[["render",$e]]);const tt={components:{FaturaModal:Me,nfePrincipal:je,DocumentosFiscais:Ue,ModalHistoricoStatus:Oe,EmitirBoletos:et},computed:{config(){return O.configuracoes.valores},mostrarOpcaoRemoverFatura(){return this.dados.fatura.status==="Aberta"&&!this.dados.vendas.length&&!this.dados.documentosEnvelope.length&&!this.dados.carnes.length&&!this.dados.condicaoPagamento.length}},data(){return{dbUsuario:O.usuario,width:0,dados:{fatura:{}},contatos:{},detalhesVisivel:!1,sistemaPai:"",configImpressaoCarne:[],configImpressaoConvenio:[],configImpressaoFatura:[],configImpressaoEnvelope:[],configImpressosWhatsapp:[],configImpressosEmail:[],boletos:{visivel:!1,fatura:{},btnEmitirBoleto:!1},podeEditar:!1,mostrarBotaoEnviarAvaliacao:!1,mostrarBotaoEnviarPedidosProtheus:!1,mostrarBotaoEmitirCupom:!1}},emits:["executar","carregou","verificarListaLayout"],mixins:[Re,Le],props:{id:{required:!0,type:String},layout:{type:String,default:"card"}},methods:{async enviarPedidosProtheus(l){await $db.fatura.enviarPedidosProtheus(l)},async removerFatura(){try{await new Promise((l,o)=>{this.$q.dialog({message:"Esta a\xE7\xE3o ir\xE1 remover esta fatura.",noRefocus:!0,preventClose:!0,title:"Tem certeza?",cancel:{label:"CANCELAR",push:!0,color:"tertiary",flat:!0},ok:{label:"CONTINUAR",push:!0,class:"bg-negative",textColor:"white",flat:!0}}).onOk(()=>{l()}).onCancel(()=>{o()})})}catch{return}this.dados.fatura.id?(await O.fatura.remover(this.dados.fatura.id),this.$emit("executar","atualizar")):this.$q.notify("N\xE3o foi poss\xEDvel realizar a opera\xE7\xE3o")},abrirEmitirBoletos(l){this.boletos.visivel=!0,this.boletos.fatura=l},alternarDetalhes(l){this.detalhesVisivel=!this.detalhesVisivel,this.layout==="lista"&&this.$emit("verificarListaLayout",{id:l,acao:"detalhes",estado:this.detalhesVisivel})},async atualizar(){var g,a,c,C,V,k,Q,P,T,R;const l={},o=await O.fatura.leCompleto(this.id);if(o.vendas.sort((w,y)=>new Date(w.dataHoraFinalizado)<new Date(y.dataHoraFinalizado)?-1:1),o.documentosEnvelope.sort((w,y)=>new Date(w.dataHoraFinalizado)<new Date(y.dataHoraFinalizado)?-1:1),o.carnes.sort((w,y)=>new Date(w.dataVencimento)<new Date(y.dataVencimento)?-1:1),o.vendas)for(const w of o.vendas)l[w.idContatoVendedor]||(l[w.idContatoVendedor]=await O.contato.le({id:w.idContatoVendedor})),l[w.idContatoDigitador]||(l[w.idContatoDigitador]=await O.contato.le({id:w.idContatoDigitador}));if(o.documentosEnvelope)for(const w of o.documentosEnvelope)l[w.idContatoVendedor]||(l[w.idContatoVendedor]=await O.contato.le({id:w.idContatoVendedor})),l[w.idContatoDigitador]||(l[w.idContatoDigitador]=await O.contato.le({id:w.idContatoDigitador}));if(o.fatura.idContato){const w=o.fatura.idContato;l[w]||(l[w]=await O.contato.le({id:w}))}if(o.fatura.idEmpresa){const w=o.fatura.idEmpresa;l[w]||(l[w]=await O.contato.le({id:w}))}if(o.fatura){let w=[],y=[];for(const I of o.vendas)w.push(I.idContatoVendedor),y.push(I.idContatoDigitador);for(const I of o.documentosEnvelope)w.push(I.idContatoVendedor),y.push(I.idContatoDigitador);o.fatura.vendedores=[...new Set(w)],o.fatura.digitadores=[...new Set(y)]}this.contatos=l,this.dados=o,this.condicaoPagamento=o.condicaoPagamento,await this.resumeCondicaoPagamento();const v=(await O.contato.ler({filtros:{ativo:!0,empresas:!0}})).data;this.podeEditar=!1,v.find(w=>w.id===o.fatura.idEmpresa)&&(this.podeEditar=!0),await this.configuraVisibilidadeBotoes(),await this.configuraVisibilidadeBtnBoletos(),await this.configuraImpressaoCarne((a=(g=this.dados)==null?void 0:g.fatura)==null?void 0:a.idEmpresa),await this.configuraImpressaoConvenio((C=(c=this.dados)==null?void 0:c.fatura)==null?void 0:C.idEmpresa),this.configImpressaoEnvelope=await $utils.envelope.listaOpcoesImpressao(this.dados.fatura.idEmpresa),await this.configuraImpressaoFatura((k=(V=this.dados)==null?void 0:V.fatura)==null?void 0:k.idEmpresa),await this.configuraImpressosWhatsapp((P=(Q=this.dados)==null?void 0:Q.fatura)==null?void 0:P.idEmpresa),await this.configuraImpressosEmail((R=(T=this.dados)==null?void 0:T.fatura)==null?void 0:R.idEmpresa),this.$nextTick(()=>{o.fatura.id===localStorage.getItem("idFatura")&&(this.podeEditar&&this.$refs.faturaModal.mostrar({id:this.dados.fatura.id}),localStorage.removeItem("idFatura"))})},editar(){this.$refs.faturaModal.mostrar({id:this.dados.fatura.id})},async executar(l){switch(l){case"atualizar":case"finalizar":case"retornarOrcamento":case"remover":this.$emit("executar","atualizar");return}await this.atualizar()},async sendReview(l){try{this.$q.loading.show();const o=[],v=this.contatos[l.idContato],g=await $api.bten.send(v,l);for(let a=0;a<g.length;a++){const c=g[a];c.status?o.push(c.telefone):this.$q.notifyError(`Falha ao enviar NPS para ${c.telefone}!`)}this.$q.loading.hide(),o.length&&this.$q.notifyPositive(`NPS enviado para ${o.join(",")}!`)}catch(o){if(o.name==="GeeksException"){this.$q.notifyAlert(o.message);return}this.$q.notifyError("N\xE3o foi possivel enviar NPS para o contato.",o)}finally{this.$q.loading.hide()}},fechouNFe(l){l&&$utils.emitter.emit("atualizarDocumentosFiscais")},async configuraImpressaoConvenio(l){const o=await O.configuracoes.porNome("impressao.convenio",l);this.configImpressaoConvenio=[...o.length?o.map(v=>({texto:"Imprimir Conv\xEAnio",...v})):[{valor:"convenio",texto:"Imprimir Conv\xEAnio"}]]},async configuraImpressaoCarne(l){const o=await O.configuracoes.porNome("impressao.carne",l);this.configImpressaoCarne=[...o.length?o.map(v=>({texto:"Imprimir Carn\xEA",...v})):[{valor:"carne-crediario",texto:"Reimprimir carn\xEA e notas promiss\xF3rias da fatura"}]]},async configuraImpressaoFatura(l){const o=await O.configuracoes.porNome("impressao.fatura",l),v=[{valor:"invoice",texto:"Fatura (Invoice)"},{valor:"fatura-recibo",texto:"Recibo"}];this.sistemaPai==="optisoul"&&v.push({valor:"termoGarantia",texto:"Termo de Garantia"}),this.configImpressaoFatura=[...o.length?o.map(g=>({texto:"Imprimir Fatura",...g})):v]},async configuraImpressosWhatsapp(l){let o=await $db.configuracoes.le({prefixoNome:"fatura.whatsapp.enviar."});o=o.filter(v=>v.idEmpresa===l||!v.idEmpresa),this.configImpressosWhatsapp=o.map(v=>{var g,a;return{...v,idFatura:(a=(g=this.dados)==null?void 0:g.fatura)==null?void 0:a.id}})},async configuraImpressosEmail(l){let o=await $db.configuracoes.le({prefixoNome:"fatura.email.enviar."});o=o.filter(v=>v.idEmpresa===l||!v.idEmpresa),this.configImpressosEmail=o.map(v=>{var g,a;return{...v,idFatura:(a=(g=this.dados)==null?void 0:g.fatura)==null?void 0:a.id}})},async enviarImpresso(l,o){var v,g;l==="whatsapp"&&await $utils.enviarWhatsapp({configuracao:$utils.clonar(o),documento:$utils.clonar((v=this.dados)==null?void 0:v.fatura),loading:!0,dialog:!0}),l==="email"&&await $utils.enviarEmail({configuracao:$utils.clonar(o),documento:$utils.clonar((g=this.dados)==null?void 0:g.fatura),loading:!0,dialog:!0})},async configuraVisibilidadeBotoes(){var g,a,c,C,V;let l,o,v;l=await $db.configuracoes.leValorComFiltroEmpresa("integrador.idDispositivo",this.dados.fatura.idEmpresa),this.mostrarBotaoEmitirCupom=!!l,l=await $db.configuracoes.porNome("integracao.bten.business"),o=(a=(g=l[0])==null?void 0:g.valor)!=null?a:!1,l=await $db.configuracoes.porNome("integracao.bten.authorization"),v=(C=(c=l[0])==null?void 0:c.valor)!=null?C:!1,this.mostrarBotaoEnviarAvaliacao=o&&v,l=await $db.configuracoes.porNome("protheus.credentials"),this.mostrarBotaoEnviarPedidosProtheus=!!((V=l[0])!=null&&V.valor)&&!!this.dados.fatura.dataHoraFinalizado},async configuraVisibilidadeBtnBoletos(){var l,o,v,g,a,c,C,V;try{if((o=(l=this.dados)==null?void 0:l.fatura)!=null&&o.id){const k=[],Q=await ae().formaPagamento.toArray(),P=await ae().empresa.where({idContato:(g=(v=this.dados)==null?void 0:v.fatura)==null?void 0:g.idEmpresa}).toArray();if(await(await $db.hibrido.lista({table:"documentoCondicaoPagamento",where:{idDocumento:(c=(a=this.dados)==null?void 0:a.fatura)==null?void 0:c.id}})).forEach(B=>{const i=Q.find(r=>r.id===B.idFormaPagamento&&r.tipo===99&&r.tipoFinanceiro==="T\xEDtulo em aberto");i&&k.push({descricao:i.descricao})}),!k.length)return;const R=[];await ae().financeiroBanco.each(B=>{if(!!B.ativo){if(B.id==="7D07229E-B35E-42AA-A312-78313BE61B2F"){R.push(B);return}B.idEmpresa&&P.find(i=>i.id===B.idEmpresa)&&R.push(B)}});const w=[...new Set(R.map(B=>B.codigoBanco))],y=[];await ae()._banco.each(B=>{w.find(i=>i===b.codigoBanco)&&y.push(B)});const I=[];for(const B of R){y.find(r=>r.codigoBanco===B.codigoBanco);I.push({codigoBanco:B.codigoBanco})}this.boletos.btnEmitirBoleto=!!((C=k||[])!=null&&C.length)&&!!((V=I||[])!=null&&V.length)}}catch(k){console.error("ERRO: ",k)}},onResize(){this.width=window.innerWidth}},async mounted(){this.sistemaPai=Ae(),await this.atualizar(),this.$emit("carregou")}},at={id:"FaturaCard"},ot={class:"mw80 text-center"},it={key:0},lt={key:1},st={style:{"margin-left":"14px"}},rt={style:{"margin-left":"14px"}},nt={class:"float-right text-weight-medium text-right q-ml-sm",style:{"min-width":"70px"}};function dt(l,o,v,g,a,c){const C=X("badge"),V=X("BadgeCopiarUid"),k=X("g-col"),Q=X("avatar"),P=X("g-label"),T=X("g-row"),R=X("DocumentosFiscais"),w=X("fatura-modal"),y=X("modal-historico-status"),I=X("nfePrincipal"),B=X("EmitirBoletos");return d(),N("div",at,[e(He,{onResize:c.onResize},null,8,["onResize"]),v.layout==="card"?(d(),N(S,{key:0},[a.dados.fatura.id?(d(),f(Qe,{key:0,class:"extratoItem bg-white no-shadow"},{default:t(()=>[e(T,{gutter:"sm",items:"center",justify:"between"},{default:t(()=>[e(k,{col:"12",text:"right",class:"hideondesktop"},{default:t(()=>{var i,r,s,E,h,q;return[e(C,{rotulo:a.dados.fatura.status,escuro:"",cor:"tertiary",class:"q-mr-xs"},null,8,["rotulo"]),e(V,{cor:((r=(i=a.dados)==null?void 0:i.fatura)==null?void 0:r.status)==="Finalizada"?"positive":"tertiary",numero:(E=(s=a.dados)==null?void 0:s.fatura)==null?void 0:E.numero,id:(q=(h=a.dados)==null?void 0:h.fatura)==null?void 0:q.id,icone:"shopping_cart",escuro:""},null,8,["cor","numero","id"])]}),_:1}),e(k,{col:"12 sm5"},{default:t(()=>[e(T,{items:"center"},{default:t(()=>[e(k,{col:"shrink",self:a.width<=992?"top":"center"},{default:t(()=>{var i;return[e(Q,{imagem:(i=a.contatos[a.dados.fatura.idContato])==null?void 0:i.imagem,rotulo:a.dados.fatura.descricaoContato,tamanho:"40"},null,8,["imagem","rotulo"])]}),_:1},8,["self"]),e(k,null,{default:t(()=>[e(P,{text:"body1 medium"},{default:t(()=>{var i,r,s;return[n(m((i=a.contatos[a.dados.fatura.idContato])==null?void 0:i.apelido)+" ",1),((r=a.contatos[a.dados.fatura.idContato])==null?void 0:r.nome)!==((s=a.contatos[a.dados.fatura.idContato])==null?void 0:s.apelido)?(d(),f(P,{key:0,caption:""},{default:t(()=>{var E;return[n(m((E=a.contatos[a.dados.fatura.idContato])==null?void 0:E.nome),1)]}),_:1})):p("",!0)]}),_:1})]),_:1})]),_:1})]),_:1}),e(k,{col:"sm3",class:"hideonmobile"},{default:t(()=>{var i,r,s,E;return[e(V,{numero:(r=(i=a.dados)==null?void 0:i.fatura)==null?void 0:r.numero,id:(E=(s=a.dados)==null?void 0:s.fatura)==null?void 0:E.id,icone:"request_quote",cor:"positive",escuro:"",class:"q-mr-xs"},null,8,["numero","id"]),e(C,{rotulo:a.dados.fatura.status,escuro:"",cor:"tertiary"},null,8,["rotulo"])]}),_:1}),e(k,{col:"5 sm-shrink md2"},{default:t(()=>[a.dados.fatura.dataHoraEmissao?(d(),f(P,{key:0,icon:"mdi-calendar-today",tip:"Emiss\xE3o"},{default:t(()=>[n(m(l.$filters.data(a.dados.fatura.dataHoraEmissao)),1)]),_:1})):p("",!0),a.dados.fatura.dataHoraFinalizado?(d(),f(P,{key:1,icon:"mdi-calendar-check",tip:"Finalizado"},{default:t(()=>[n(m(l.$filters.data(a.dados.fatura.dataHoraFinalizado)),1)]),_:1})):p("",!0)]),_:1}),e(k,{col:"7 sm md2"},{default:t(()=>[e(P,{text:"h5 right bold",color:"text-positive"},{default:t(()=>[n(m(l.$filters.numero(a.dados.fatura.totalDocumento,2)),1)]),_:1}),e(P,{text:"body right medium"},{default:t(()=>[n(m(l.$filters.numero(a.dados.fatura.subTotal,2)),1)]),_:1})]),_:1})]),_:1}),e(oe,{class:"q-mx-sm q-mb-xs"}),e(T,{gutter:"sm",items:"center"},{default:t(()=>[e(k,{col:"12 md"},{default:t(()=>[a.dados.vendas.length?(d(!0),N(S,{key:0},H(a.dados.vendas,i=>(d(),f(T,{key:i.id,gutter:"none",items:"center",justify:"end"},{default:t(()=>[e(k,{col:"12 sm"},{default:t(()=>[e(P,null,{default:t(()=>{var r;return[e(x,{name:"shopping_cart"}),n(" "+m(i.tipo)+" ",1),e(V,{numero:i.numero,id:i.id,cor:"positive",escuro:"",class:"q-mr-xs"},null,8,["numero","id"]),e(C,{rotulo:i.status,escuro:"",cor:"tertiary",class:"q-mr-xs"},null,8,["rotulo"]),a.contatos[i.idContatoVendedor]?(d(),f(C,{key:0,icone:"mdi-account-tie",cor:"light",rotulo:(r=a.contatos[i.idContatoVendedor])==null?void 0:r.apelido,dica:"Vendedor(a)",class:"q-mr-xs"},null,8,["rotulo"])):p("",!0)]}),_:2},1024)]),_:2},1024),e(k,{col:"shrink"},{default:t(()=>[e(P,{inline:"",class:"float-right",text:"medium"},{default:t(()=>[e(P,{caption:"",inline:"",class:"q-mx-xs"},{default:t(()=>[n(m(l.$filters.data(i.dataHoraFinalizado)),1)]),_:2},1024),n(" "+m(l.$filters.numero(i.totalDocumento,2)),1)]),_:2},1024)]),_:2},1024),e(k,{col:"12",class:"hideondesktop"},{default:t(()=>[e(oe,{class:"q-my-xs"})]),_:1})]),_:2},1024))),128)):p("",!0),a.dados.documentosEnvelope.length?(d(!0),N(S,{key:1},H(a.dados.documentosEnvelope,i=>(d(),f(T,{key:i.id,gutter:"none",items:"center",justify:"end"},{default:t(()=>[e(k,{col:"12 sm"},{default:t(()=>[e(P,null,{default:t(()=>{var r;return[e(x,{name:"mdi-sunglasses"}),n(" "+m(i.tipo)+" ",1),e(V,{numero:i.numero,id:i.id,cor:"positive",escuro:"",class:"q-mr-xs"},null,8,["numero","id"]),e(C,{rotulo:i.status,escuro:"",cor:"tertiary",class:"q-mr-xs"},null,8,["rotulo"]),a.contatos[i.idContatoVendedor]?(d(),f(C,{key:0,rotulo:(r=a.contatos[i.idContatoVendedor])==null?void 0:r.apelido,dica:"Vendedor(a)",icone:"mdi-account-tie",cor:"light",class:"q-mr-xs"},null,8,["rotulo"])):p("",!0),i.descricaoContato&&a.dados.fatura.idContato!==i.idContato?(d(),f(C,{key:1,rotulo:i.descricaoContato,dica:"Paciente",icone:"assignment_ind",cor:"light"},null,8,["rotulo"])):p("",!0)]}),_:2},1024)]),_:2},1024),e(k,{col:"shrink"},{default:t(()=>[e(P,{inline:"",class:"float-right",text:"medium"},{default:t(()=>[e(P,{caption:"",inline:"",class:"q-mx-xs"},{default:t(()=>[n(m(l.$filters.data(i.dataHoraFinalizado)),1)]),_:2},1024),n(" "+m(l.$filters.numero(i.totalDocumento,2)),1)]),_:2},1024)]),_:2},1024),e(k,{col:"12",class:"hideondesktop"},{default:t(()=>[e(oe,{class:"q-my-xs"})]),_:1})]),_:2},1024))),128)):p("",!0),a.dados.carnes.length?(d(!0),N(S,{key:2},H(a.dados.carnes,i=>(d(),f(T,{key:i.id,gutter:"none",items:"center",justify:"end"},{default:t(()=>[e(k,{col:"12 sm"},{default:t(()=>[e(P,null,{default:t(()=>[e(x,{name:"mdi-file-document"}),o[27]||(o[27]=n(" Carn\xEA ")),e(V,{numero:i.numero,id:i.id,cor:"positive",escuro:"",class:"q-mr-xs"},null,8,["numero","id"]),e(C,{rotulo:i.formaDePagamento,escuro:"",cor:"tertiary"},null,8,["rotulo"])]),_:2},1024)]),_:2},1024),e(k,{col:"shrink"},{default:t(()=>[e(P,{inline:"",class:"float-right",text:"medium"},{default:t(()=>[e(P,{caption:"",inline:"",class:"q-mx-xs"},{default:t(()=>[n(m(l.$filters.data(i.dataVencimento)),1)]),_:2},1024),n(" "+m(l.$filters.numero(i.valorTotal,2)),1)]),_:2},1024)]),_:2},1024),e(k,{col:"12",class:"hideondesktop"},{default:t(()=>[e(oe,{class:"q-my-xs"})]),_:1})]),_:2},1024))),128)):p("",!0)]),_:1}),e(k,{col:"12 md3",text:"right",self:"end"},{default:t(()=>[e(Z,{onClick:c.alternarDetalhes,size:"md",color:"tertiary",class:"q-mr-sm",dense:"",round:"",flat:"",icon:a.detalhesVisivel?"keyboard_arrow_up":"keyboard_arrow_down"},null,8,["onClick","icon"]),a.podeEditar?(d(),f(Z,{key:0,onClick:c.editar,round:"",flat:"",dense:"",icon:"edit",size:"md",color:"primary",class:"q-mr-sm"},null,8,["onClick"])):p("",!0),e(Z,{icon:"print",size:"md",color:"primary",round:"",dense:"",flat:"",class:"q-mr-sm"},{default:t(()=>[e(re,null,{default:t(()=>[Y((d(),f(te,{link:"",separator:""},{default:t(()=>{var i;return[(i=a.boletos)!=null&&i.btnEmitirBoleto?(d(),f(F,{key:0,onClick:o[0]||(o[0]=r=>{var s;return c.abrirEmitirBoletos((s=a.dados)==null?void 0:s.fatura)}),clickable:""},{default:t(()=>[e(u,{avatar:""},{default:t(()=>[e(x,{name:"mdi-printer"})]),_:1}),e(u,null,{default:t(()=>o[28]||(o[28]=[n("Emitir Boleto")])),_:1})]),_:1})):p("",!0),(d(!0),N(S,null,H(a.configImpressaoFatura,r=>(d(),f(F,{key:r.valor,clickable:"",onClick:s=>l.$imprimir(r.valor,(a.dados.fatura||{}).id||"0")},{default:t(()=>[e(u,{avatar:""},{default:t(()=>[e(x,{name:"print"})]),_:1}),e(u,null,{default:t(()=>[n(m(r.texto),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),a.sistemaPai==="optisoul"?(d(!0),N(S,{key:1},H(a.configImpressaoEnvelope,r=>(d(),f(F,{key:r.valor,onClick:s=>l.$utils.envelope.imprime({nomeImpresso:r.valor,idDocumento:a.dados.fatura.id}),clickable:""},{default:t(()=>[e(u,{avatar:""},{default:t(()=>[e(x,{name:"print"})]),_:1}),e(u,null,{default:t(()=>[n(m(r.texto),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):p("",!0),(d(!0),N(S,null,H(a.configImpressaoCarne,r=>(d(),f(F,{key:r.valor,onClick:s=>l.$imprimir(r.valor,(a.dados.fatura||{}).id||"0"),clickable:""},{default:t(()=>[e(u,{avatar:""},{default:t(()=>[e(x,{name:"print"})]),_:1}),e(u,null,{default:t(()=>[n(m(r.texto),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),(d(!0),N(S,null,H(a.configImpressaoConvenio,r=>(d(),f(F,{key:r.valor,onClick:s=>l.$imprimir(r.valor,(a.dados.fatura||{}).id||"0"),clickable:""},{default:t(()=>[e(u,{avatar:""},{default:t(()=>[e(x,{name:"print"})]),_:1}),e(u,null,{default:t(()=>[n(m(r.texto),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]}),_:1})),[[ie]])]),_:1})]),_:1}),e(Z,{icon:"more_vert",size:"md",color:"tertiary",rounded:"",dense:"",flat:""},{default:t(()=>[e(re,null,{default:t(()=>[Y((d(),f(te,{link:"",separator:""},{default:t(()=>[a.dados.fatura.id?(d(),f(F,{key:0,clickable:"",onClick:o[1]||(o[1]=i=>l.$refs.documentosFiscais.emitirCupom(a.dados.fatura.id))},{default:t(()=>[e(u,{avatar:""},{default:t(()=>[e(x,{name:"account_balance"})]),_:1}),e(u,null,{default:t(()=>o[29]||(o[29]=[n("Emitir cupom")])),_:1})]),_:1})):p("",!0),l.$utils.mapearStatus(a.dados.fatura).permiteNota?(d(),N(S,{key:1},[e(F,{onClick:o[2]||(o[2]=i=>l.emitirNFeV2({idFatura:a.dados.fatura.id},1,"Venda")),clickable:""},{default:t(()=>[e(u,{avatar:""},{default:t(()=>[e(x,{name:"account_balance"})]),_:1}),e(u,null,{default:t(()=>o[30]||(o[30]=[n("NFe de Sa\xEDda/Venda")])),_:1})]),_:1}),e(F,{onClick:o[3]||(o[3]=i=>l.emitirNFeV2({idFatura:a.dados.fatura.id},0,"Devolu\xE7\xE3o")),clickable:""},{default:t(()=>[e(u,{avatar:""},{default:t(()=>[e(x,{name:"account_balance"})]),_:1}),e(u,null,{default:t(()=>o[31]||(o[31]=[n("NFe de Entrada/Devolu\xE7\xE3o")])),_:1})]),_:1}),e(F,{onClick:o[4]||(o[4]=i=>l.emitirNFeV2({idFatura:a.dados.fatura.id},1,"Remessa")),clickable:""},{default:t(()=>[e(u,{avatar:""},{default:t(()=>[e(x,{name:"account_balance"})]),_:1}),e(u,null,{default:t(()=>o[32]||(o[32]=[n("NFe de Remessa")])),_:1})]),_:1})],64)):p("",!0),c.mostrarOpcaoRemoverFatura?(d(),f(F,{key:2,onClick:o[5]||(o[5]=i=>c.removerFatura()),clickable:""},{default:t(()=>[e(u,{avatar:""},{default:t(()=>[e(x,{name:"mdi-trash-can"})]),_:1}),e(u,null,{default:t(()=>o[33]||(o[33]=[n("Remover Fatura")])),_:1})]),_:1})):p("",!0),e(F,{onClick:o[6]||(o[6]=i=>l.$refs.modalHistoricoStatus.mostrar({idDocumento:a.dados.fatura.id})),clickable:""},{default:t(()=>[e(u,{avatar:""},{default:t(()=>[e(x,{name:"history"})]),_:1}),e(u,null,{default:t(()=>o[34]||(o[34]=[n("Hist\xF3rico do Status")])),_:1})]),_:1}),a.mostrarBotaoEnviarAvaliacao&&a.dados.fatura.status==="Finalizada"?(d(),f(F,{key:3,onClick:o[7]||(o[7]=i=>c.sendReview(a.dados.fatura)),clickable:""},{default:t(()=>[e(u,{avatar:""},{default:t(()=>[e(x,{name:"mdi-file-replace-outline"})]),_:1}),e(u,null,{default:t(()=>o[35]||(o[35]=[n("Enviar Avalia\xE7\xE3o")])),_:1})]),_:1})):p("",!0),a.mostrarBotaoEnviarPedidosProtheus?(d(),f(F,{key:4,onClick:o[8]||(o[8]=i=>c.enviarPedidosProtheus(a.dados.fatura.id)),clickable:""},{default:t(()=>[e(u,{avatar:""},{default:t(()=>[e(x,{name:"send"})]),_:1}),e(u,null,{default:t(()=>o[36]||(o[36]=[n("Enviar Pedidos - Protheus")])),_:1})]),_:1})):p("",!0),(d(!0),N(S,null,H(a.configImpressosWhatsapp.filter(i=>i.valor),i=>(d(),f(F,{key:i.valor,onClick:r=>c.enviarImpresso("whatsapp",i),clickable:""},{default:t(()=>[e(u,{avatar:""},{default:t(()=>[e(x,{name:"mdi-whatsapp"})]),_:1}),e(u,null,{default:t(()=>[n(m(i.valor),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),(d(!0),N(S,null,H(a.configImpressosEmail.filter(i=>i.valor),i=>(d(),f(F,{key:i.valor,onClick:r=>c.enviarImpresso("email",i),clickable:""},{default:t(()=>[e(u,{avatar:""},{default:t(()=>[e(x,{name:"mail"})]),_:1}),e(u,null,{default:t(()=>[n(m(i.valor),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})),[[ie]])]),_:1})]),_:1})]),_:1})]),_:1}),a.detalhesVisivel?(d(),f(oe,{key:0,class:"q-mx-sm q-mb-xs"})):p("",!0),Y(e(T,{gutter:"sm"},{default:t(()=>[e(k,{col:"12"},{default:t(()=>[e(T,null,{default:t(()=>[e(k,{col:"xs12 sm"},{default:t(()=>[a.dados.fatura.descricaoEmpresa?(d(),f(P,{key:0,text:"sub2 medium",inline:"",icon:`business ${a.width<=992?"15px":"xs"} tertiary left`},{default:t(()=>[n(m(a.dados.fatura.descricaoEmpresa),1)]),_:1},8,["icon"])):p("",!0)]),_:1}),e(k,{col:"xs12 sm-shrink"},{default:t(()=>[e(P,{text:"sub2 medium",class:ne(`${a.width<=992?"text-left":"text-right"}`)},{default:t(()=>[o[37]||(o[37]=n(" Desconto: ")),e(P,{text:"right bold",class:"q-ml-sm float-right",style:{"min-width":"70px"}},{default:t(()=>[n(m(l.$filters.numero(a.dados.fatura.totalDesconto,2)),1)]),_:1})]),_:1},8,["class"])]),_:1})]),_:1})]),_:1}),e(k,{col:"12 md6",bordered:""},{default:t(()=>[e(R,{idFatura:a.dados.fatura.id,ref:"documentosFiscais"},null,8,["idFatura"])]),_:1}),e(k,{col:"12 md6",bordered:""},{default:t(()=>[a.dados.fatura.observacaoFaturamento||l.condicaoPagamentoResumo.length||a.dados.fatura.totalDesconto?(d(),f(P,{key:0,icon:`attach_money ${a.width<=992?"15px":"xs"} tertiary left`,text:"sub2 medium",class:"q-mb-md"},{default:t(()=>o[38]||(o[38]=[n(" Faturamento ")])),_:1},8,["icon"])):p("",!0),a.dados.fatura.observacaoFaturamento?(d(),f(P,{key:1,text:"sub2 regular",class:"q-mb-md q-mx-xs"},{default:t(()=>[o[39]||(o[39]=A("span",{class:"text-weight-medium q-pr-sm"},"Obs.:",-1)),n(" "+m(a.dados.fatura.observacaoFaturamento),1)]),_:1})):p("",!0),l.condicaoPagamentoResumo.length?(d(!0),N(S,{key:2},H(l.condicaoPagamentoResumo,i=>(d(),f(T,{key:i.id,class:ne(`${l.condicaoPagamentoResumo.length>1?"border-bottom":""}`),gutter:"none",items:"center",justify:"end"},{default:t(()=>[e(k,{col:"12 sm",text:"medium"},{default:t(()=>[n(m(i.formaPagamento),1)]),_:2},1024),e(k,{col:"shrink"},{default:t(()=>[e(P,{inline:"",class:"float-right",text:"medium"},{default:t(()=>[e(P,{caption:"",inline:"",class:"q-mx-xs"},{default:t(()=>[n(m(l.$filters.data(i.dataVencimento)),1)]),_:2},1024),n(" "+m(l.$filters.numero(i.valor,2))+" "+m(i.parcelas>1?`(${i.parcelas}x)`:""),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["class"]))),128)):p("",!0)]),_:1})]),_:1},512),[[ye,a.detalhesVisivel]])]),_:1})):p("",!0)],64)):p("",!0),v.layout==="lista"?(d(),N(S,{key:1},[a.dados.fatura.id?(d(),f(F,{key:0,clickable:"","manual-focus":"",class:"q-py-sm q-px-xs items-center"},{default:t(()=>[e(u,{class:"hideonmobile col-auto no-margin"},{default:t(()=>{var i,r,s,E,h,q;return[A("div",ot,[e(V,{id:(r=(i=a.dados)==null?void 0:i.fatura)==null?void 0:r.id,numero:(E=(s=a.dados)==null?void 0:s.fatura)==null?void 0:E.numero,cor:((q=(h=a.dados)==null?void 0:h.fatura)==null?void 0:q.status)==="Finalizada"?"positive":"tertiary"},null,8,["id","numero","cor"])])]}),_:1}),e(u,{class:"col-md col-lg col-xl no-margin"},{default:t(()=>[e(F,{class:"q-pa-none"},{default:t(()=>[e(u,{onClick:o[9]||(o[9]=i=>c.editar()),class:"col-auto items-center"},{default:t(()=>{var i,r,s,E,h;return[e(Q,{imagem:(s=a.contatos[(r=(i=a.dados)==null?void 0:i.fatura)==null?void 0:r.idContato]||{})==null?void 0:s.imagem,tamanho:"40",rotulo:(h=(E=a.dados)==null?void 0:E.fatura)==null?void 0:h.descricaoContato,style:{display:"flex","align-self":"center"}},null,8,["imagem","rotulo"])]}),_:1}),e(u,{onClick:o[10]||(o[10]=i=>c.editar()),class:"col"},{default:t(()=>{var i,r,s,E,h,q;return[e(_,{lines:"2",class:"text-weight-bold"},{default:t(()=>{var D,z,L;return[A("span",null,[n(m((L=a.contatos[(z=(D=a.dados)==null?void 0:D.fatura)==null?void 0:z.idContato]||{})==null?void 0:L.apelido)+" ",1),e(W,{anchor:"bottom middle",self:"center middle"},{default:t(()=>o[40]||(o[40]=[n("Cliente")])),_:1})])]}),_:1}),e(_,{caption:"",class:"hideondesktop"},{default:t(()=>{var D,z,L,J,M,U;return[e(V,{id:(z=(D=a.dados)==null?void 0:D.fatura)==null?void 0:z.id,numero:(J=(L=a.dados)==null?void 0:L.fatura)==null?void 0:J.numero,cor:((U=(M=a.dados)==null?void 0:M.fatura)==null?void 0:U.status)==="Finalizada"?"positive":"tertiary",class:"q-mr-sm"},null,8,["id","numero","cor"])]}),_:1}),a.contatos[a.dados.fatura.idEmpresa]?(d(),f(_,{key:0,caption:"",lines:"2"},{default:t(()=>{var D,z;return[A("span",null,[e(x,{name:"business"}),n(" "+m(((D=a.contatos[a.dados.fatura.idEmpresa])==null?void 0:D.apelido)||((z=a.contatos[a.dados.fatura.idEmpresa])==null?void 0:z.nome))+" ",1),e(W,{anchor:"bottom middle",self:"center middle"},{default:t(()=>o[41]||(o[41]=[n(" Empresa ")])),_:1})])]}),_:1})):p("",!0),((s=(r=(i=a.dados)==null?void 0:i.fatura)==null?void 0:r.vendedores)==null?void 0:s.filter(Boolean).length)||((q=(h=(E=a.dados)==null?void 0:E.fatura)==null?void 0:h.digitadores)==null?void 0:q.filter(Boolean).length)?(d(),f(_,{key:1,caption:"",lines:"2"},{default:t(()=>{var D,z,L,J,M,U,$,ee,ue,me,fe,ce,pe,ge,be;return[e(x,{name:"mdi-account-tie",style:{"margin-right":"2px"}}),(L=(z=(D=a.dados)==null?void 0:D.fatura)==null?void 0:z.vendedores)!=null&&L.filter(Boolean).length?(d(),N("span",it,[n(m((U=(M=(J=a.dados)==null?void 0:J.fatura)==null?void 0:M.vendedores)==null?void 0:U.map(G=>{var j;return(j=a.contatos[G])==null?void 0:j.apelido}).filter(Boolean).join(", "))+" ",1),e(W,{anchor:"bottom middle",self:"center middle"},{default:t(()=>{var G,j,K;return[n(m(((K=(j=(G=a.dados)==null?void 0:G.fatura)==null?void 0:j.vendedores)==null?void 0:K.length)>1?"Vendedores":"Vendedor"),1)]}),_:1})])):p("",!0),((ue=(ee=($=a.dados)==null?void 0:$.fatura)==null?void 0:ee.digitadores)==null?void 0:ue.filter(Boolean).length)&&((ce=(fe=(me=a.dados)==null?void 0:me.fatura)==null?void 0:fe.digitadores)==null?void 0:ce.some(G=>{var j,K,le;return!((le=(K=(j=a.dados)==null?void 0:j.fatura)==null?void 0:K.vendedores)!=null&&le.includes(G))}))?(d(),N("span",lt,[n(" | "+m((be=(ge=(pe=a.dados)==null?void 0:pe.fatura)==null?void 0:ge.digitadores)==null?void 0:be.filter(G=>{var j,K,le;return!((le=(K=(j=a.dados)==null?void 0:j.fatura)==null?void 0:K.vendedores)!=null&&le.includes(G))}).map(G=>{var j;return(j=a.contatos[G])==null?void 0:j.apelido}).filter(Boolean).join(", "))+" ",1),e(W,{anchor:"bottom middle",self:"center middle"},{default:t(()=>{var G,j,K;return[n(m(((K=(j=(G=a.dados)==null?void 0:G.fatura)==null?void 0:j.digitadores)==null?void 0:K.length)>1?"Digitadores":"Digitador"),1)]}),_:1})])):p("",!0)]}),_:1})):p("",!0),e(u,{class:"hideondesktop q-mt-sm"},{default:t(()=>[e(F,{class:"q-pa-none",style:{"min-height":"36px!important"}},{default:t(()=>[e(u,{top:"",class:"col-5 no-margin"},{default:t(()=>{var D,z,L,J;return[(z=(D=a.dados)==null?void 0:D.fatura)!=null&&z.dataHoraEmissao?(d(),f(_,{key:0,caption:""},{default:t(()=>{var M,U;return[e(x,{name:"mdi-calendar-today",style:{position:"absolute","margin-top":"2px"}}),A("span",st,m(l.$filters.data((U=(M=a.dados)==null?void 0:M.fatura)==null?void 0:U.dataHoraEmissao)),1)]}),_:1})):p("",!0),(J=(L=a.dados)==null?void 0:L.fatura)!=null&&J.dataHoraFinalizado?(d(),f(_,{key:1,caption:""},{default:t(()=>{var M,U;return[e(x,{name:"mdi-calendar",style:{position:"absolute","margin-top":"2px"}}),A("span",rt,m(l.$filters.data((U=(M=a.dados)==null?void 0:M.fatura)==null?void 0:U.dataHoraFinalizado)),1)]}),_:1})):p("",!0)]}),_:1}),e(u,{top:"",class:"col-7 no-margin text-right"},{default:t(()=>{var D,z,L,J,M,U;return[(z=(D=a.dados)==null?void 0:D.fatura)!=null&&z.totalDocumento?(d(),f(_,{key:0,caption:"",class:"text-weight-bold"},{default:t(()=>{var $,ee;return[n(m(l.$filters.numero((ee=($=a.dados)==null?void 0:$.fatura)==null?void 0:ee.totalDocumento,2)),1)]}),_:1})):p("",!0),((J=(L=a.dados)==null?void 0:L.fatura)==null?void 0:J.subTotal)!==((U=(M=a.dados)==null?void 0:M.fatura)==null?void 0:U.totalDocumento)?(d(),f(_,{key:1,caption:""},{default:t(()=>{var $,ee;return[n(m(l.$filters.numero((ee=($=a.dados)==null?void 0:$.fatura)==null?void 0:ee.subTotal,2)),1)]}),_:1})):p("",!0)]}),_:1})]),_:1})]),_:1})]}),_:1})]),_:1})]),_:1}),e(u,{onClick:o[11]||(o[11]=i=>c.editar()),class:"hideonmobile maxw100 q-pl-sm no-margin"},{default:t(()=>{var i,r,s,E;return[(r=(i=a.dados)==null?void 0:i.fatura)!=null&&r.dataHoraEmissao?(d(),f(_,{key:0,caption:"",class:"text-weight-medium"},{default:t(()=>{var h,q;return[A("span",null,[e(x,{name:"mdi-calendar-today"}),n(" "+m(l.$filters.data((q=(h=a.dados)==null?void 0:h.fatura)==null?void 0:q.dataHoraEmissao))+" ",1),e(W,{anchor:"bottom middle",self:"center middle"},{default:t(()=>{var D,z;return[n(" Emitido \xE0s "+m(l.$filters.hora((z=(D=a.dados)==null?void 0:D.fatura)==null?void 0:z.dataHoraEmissao)),1)]}),_:1})])]}),_:1})):p("",!0),(E=(s=a.dados)==null?void 0:s.fatura)!=null&&E.dataHoraFinalizado?(d(),f(_,{key:1,caption:"",class:"text-weight-medium"},{default:t(()=>{var h,q;return[A("span",null,[e(x,{name:"mdi-calendar"}),n(" "+m(l.$filters.data((q=(h=a.dados)==null?void 0:h.fatura)==null?void 0:q.dataHoraFinalizado))+" ",1),e(W,{anchor:"bottom middle",self:"center middle"},{default:t(()=>{var D,z;return[n(" Finalizado \xE1s "+m(l.$filters.hora((z=(D=a.dados)==null?void 0:D.fatura)==null?void 0:z.dataHoraFinalizado)),1)]}),_:1})])]}),_:1})):p("",!0)]}),_:1}),e(u,{onClick:o[12]||(o[12]=i=>c.editar()),class:"hideonmobile maxw120 q-pl-sm no-margin"},{default:t(()=>{var i,r,s,E;return[(r=(i=a.dados)==null?void 0:i.fatura)!=null&&r.totalDocumento?(d(),f(_,{key:0,class:"text-weight-bold text-right"},{default:t(()=>{var h,q;return[A("span",null,[n(m(l.$filters.numero((q=(h=a.dados)==null?void 0:h.fatura)==null?void 0:q.totalDocumento,2))+" ",1),e(W,{anchor:"bottom middle",self:"center middle"},{default:t(()=>o[42]||(o[42]=[n(" Total ")])),_:1})])]}),_:1})):p("",!0),(E=(s=a.dados)==null?void 0:s.fatura)!=null&&E.subTotal?(d(),f(_,{key:1,class:"text-caption text-right"},{default:t(()=>{var h,q;return[A("span",null,[n(m(l.$filters.numero((q=(h=a.dados)==null?void 0:h.fatura)==null?void 0:q.subTotal,2))+" ",1),e(W,{anchor:"bottom middle",self:"center middle"},{default:t(()=>o[43]||(o[43]=[n(" Subtotal ")])),_:1})])]}),_:1})):p("",!0)]}),_:1}),e(u,{class:"col-auto q-pl-sm no-margin"},{default:t(()=>[e(F,{class:"q-pa-none"},{default:t(()=>[e(u,{class:"hideonmobile no-margin"},{default:t(()=>[e(Z,{onClick:o[13]||(o[13]=i=>{var r,s;return c.alternarDetalhes((s=(r=a.dados)==null?void 0:r.fatura)==null?void 0:s.id)}),round:"",flat:"",dense:"",size:"md",color:"tertiary",icon:a.detalhesVisivel?"keyboard_arrow_up":"keyboard_arrow_down"},null,8,["icon"])]),_:1}),e(u,{class:"hideonmobile no-margin"},{default:t(()=>[a.podeEditar?(d(),f(Z,{key:0,onClick:o[14]||(o[14]=i=>c.editar()),icon:"edit",size:"md",color:"primary",round:"",flat:"",dense:""})):p("",!0)]),_:1}),e(u,{class:"hideonmobile no-margin"},{default:t(()=>[e(Z,{icon:"print",size:"md",round:"",flat:"",dense:"",class:"hideonmobile"},{default:t(()=>[e(re,null,{default:t(()=>[Y((d(),f(te,{link:"","no-border":"",separator:""},{default:t(()=>{var i;return[(i=a.boletos)!=null&&i.btnEmitirBoleto?(d(),f(F,{key:0,onClick:o[15]||(o[15]=r=>{var s;return c.abrirEmitirBoletos((s=a.dados)==null?void 0:s.fatura)}),clickable:""},{default:t(()=>[e(u,{avatar:""},{default:t(()=>[e(x,{name:"mdi-printer"})]),_:1}),e(u,null,{default:t(()=>[e(_,null,{default:t(()=>o[44]||(o[44]=[n("Emitir Boleto")])),_:1})]),_:1})]),_:1})):p("",!0),(d(!0),N(S,null,H(a.configImpressaoFatura,r=>(d(),f(F,{key:r.valor,onClick:s=>l.$imprimir(r.valor,(a.dados.fatura||{}).id||"0"),clickable:""},{default:t(()=>[e(u,{avatar:""},{default:t(()=>[e(x,{name:"print"})]),_:1}),e(u,null,{default:t(()=>[e(_,null,{default:t(()=>[n(m(r.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),a.sistemaPai==="optisoul"?(d(!0),N(S,{key:1},H(a.configImpressaoEnvelope,r=>(d(),f(F,{clickable:"",key:r.valor,onClick:s=>l.$utils.envelope.imprime({nomeImpresso:r.valor,idDocumento:a.dados.fatura.id})},{default:t(()=>[e(u,{avatar:""},{default:t(()=>[e(x,{name:"print"})]),_:1}),e(u,null,{default:t(()=>[e(_,null,{default:t(()=>[n(m(r.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):p("",!0),(d(!0),N(S,null,H(a.configImpressaoCarne,r=>(d(),f(F,{key:r.valor,onClick:s=>l.$imprimir(r.valor,(a.dados.fatura||{}).id||"0"),clickable:""},{default:t(()=>[e(u,{avatar:""},{default:t(()=>[e(x,{name:"print"})]),_:1}),e(u,null,{default:t(()=>[e(_,null,{default:t(()=>[n(m(r.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),(d(!0),N(S,null,H(a.configImpressaoConvenio,r=>(d(),f(F,{key:r.valor,onClick:s=>l.$imprimir(r.valor,(a.dados.fatura||{}).id||"0"),clickable:""},{default:t(()=>[e(u,{avatar:""},{default:t(()=>[e(x,{name:"print"})]),_:1}),e(u,null,{default:t(()=>[e(_,null,{default:t(()=>[n(m(r.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]}),_:1})),[[ie]])]),_:1})]),_:1})]),_:1}),e(u,{class:"no-margin"},{default:t(()=>[e(Z,{icon:"more_vert",size:"md",round:"",flat:"",dense:""},{default:t(()=>[e(re,null,{default:t(()=>[Y((d(),f(te,{link:"","no-border":"",separator:""},{default:t(()=>{var i;return[a.podeEditar?(d(),f(F,{key:0,onClick:o[16]||(o[16]=r=>c.editar()),clickable:"",class:"hideondesktop"},{default:t(()=>[e(u,{avatar:""},{default:t(()=>[e(x,{name:"edit"})]),_:1}),e(u,null,{default:t(()=>o[45]||(o[45]=[n(" Editar ")])),_:1})]),_:1})):p("",!0),e(F,{onClick:o[17]||(o[17]=r=>{var s,E;return c.alternarDetalhes((E=(s=a.dados)==null?void 0:s.fatura)==null?void 0:E.id)}),clickable:"",class:"hideondesktop"},{default:t(()=>[e(u,{avatar:""},{default:t(()=>[e(x,{name:a.detalhesVisivel?"keyboard_arrow_up":"keyboard_arrow_down"},null,8,["name"])]),_:1}),e(u,null,{default:t(()=>o[46]||(o[46]=[n(" Detalhes ")])),_:1})]),_:1}),a.dados.fatura.id?(d(),f(F,{key:1,clickable:"",onClick:o[18]||(o[18]=r=>l.$refs.documentosFiscais.emitirCupom(a.dados.fatura.id))},{default:t(()=>[e(u,{avatar:""},{default:t(()=>[e(x,{name:"account_balance"})]),_:1}),e(u,null,{default:t(()=>[e(_,null,{default:t(()=>o[47]||(o[47]=[n("Emitir cupom")])),_:1})]),_:1})]),_:1})):p("",!0),l.$utils.mapearStatus(a.dados.fatura).permiteNota?(d(),f(F,{key:2,clickable:"",onClick:o[19]||(o[19]=r=>l.emitirNFeV2({idFatura:a.dados.fatura.id},1,"Venda"))},{default:t(()=>[e(u,{avatar:""},{default:t(()=>[e(x,{name:"account_balance"})]),_:1}),e(u,null,{default:t(()=>[e(_,null,{default:t(()=>o[48]||(o[48]=[n("NFe de Sa\xEDda/Venda")])),_:1})]),_:1})]),_:1})):p("",!0),l.$utils.mapearStatus(a.dados.fatura).permiteNota?(d(),f(F,{key:3,clickable:"",onClick:o[20]||(o[20]=r=>l.emitirNFeV2({idFatura:a.dados.fatura.id},0,"Devolu\xE7\xE3o"))},{default:t(()=>[e(u,{avatar:""},{default:t(()=>[e(x,{name:"account_balance"})]),_:1}),e(u,null,{default:t(()=>[e(_,null,{default:t(()=>o[49]||(o[49]=[n("NFe de Entrada/Devolu\xE7\xE3o")])),_:1})]),_:1})]),_:1})):p("",!0),l.$utils.mapearStatus(a.dados.fatura).permiteNota?(d(),f(F,{key:4,clickable:"",onClick:o[21]||(o[21]=r=>l.emitirNFeV2({idFatura:a.dados.fatura.id},1,"Remessa"))},{default:t(()=>[e(u,{avatar:""},{default:t(()=>[e(x,{name:"account_balance"})]),_:1}),e(u,null,{default:t(()=>[e(_,null,{default:t(()=>o[50]||(o[50]=[n("NFe de Remessa")])),_:1})]),_:1})]),_:1})):p("",!0),c.mostrarOpcaoRemoverFatura?(d(),f(F,{key:5,clickable:"",onClick:o[22]||(o[22]=r=>c.removerFatura())},{default:t(()=>[e(u,{avatar:""},{default:t(()=>[e(x,{name:"mdi-trash-can"})]),_:1}),e(u,null,{default:t(()=>[e(_,null,{default:t(()=>o[51]||(o[51]=[n("Remover Fatura")])),_:1})]),_:1})]),_:1})):p("",!0),e(F,{clickable:"",onClick:o[23]||(o[23]=r=>l.$refs.modalHistoricoStatus.mostrar({idDocumento:a.dados.fatura.id}))},{default:t(()=>[e(u,{avatar:""},{default:t(()=>[e(x,{name:"history"})]),_:1}),e(u,null,{default:t(()=>[e(_,null,{default:t(()=>o[52]||(o[52]=[n("Hist\xF3rico do Status")])),_:1})]),_:1})]),_:1}),a.mostrarBotaoEnviarAvaliacao&&a.dados.fatura.status==="Finalizada"?(d(),f(F,{key:6,onClick:o[24]||(o[24]=r=>c.sendReview(a.dados.fatura)),clickable:""},{default:t(()=>[e(u,{avatar:""},{default:t(()=>[e(x,{name:"mdi-file-replace-outline"})]),_:1}),e(u,null,{default:t(()=>[e(_,null,{default:t(()=>o[53]||(o[53]=[n("Enviar Avalia\xE7\xE3o")])),_:1})]),_:1})]),_:1})):p("",!0),(i=a.boletos)!=null&&i.btnEmitirBoleto?(d(),f(F,{key:7,clickable:"",onClick:o[25]||(o[25]=r=>{var s;return c.abrirEmitirBoletos((s=a.dados)==null?void 0:s.fatura)}),class:"hideondesktop"},{default:t(()=>[e(u,{avatar:""},{default:t(()=>[e(x,{name:"mdi-printer"})]),_:1}),e(u,null,{default:t(()=>[e(_,null,{default:t(()=>o[54]||(o[54]=[n("Emitir Boleto")])),_:1})]),_:1})]),_:1})):p("",!0),(d(!0),N(S,null,H(a.configImpressaoFatura,r=>(d(),f(F,{key:r.valor,onClick:s=>l.$imprimir(r.valor,(a.dados.fatura||{}).id||"0"),clickable:"",class:"hideondesktop"},{default:t(()=>[e(u,{avatar:""},{default:t(()=>[e(x,{name:"print"})]),_:1}),e(u,null,{default:t(()=>[e(_,null,{default:t(()=>[n(m(r.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),a.sistemaPai==="optisoul"?(d(!0),N(S,{key:8},H(a.configImpressaoEnvelope,r=>(d(),f(F,{clickable:"",class:"hideondesktop",key:r.valor,onClick:s=>l.$utils.envelope.imprime({nomeImpresso:r.valor,idDocumento:a.dados.fatura.id})},{default:t(()=>[e(u,{avatar:""},{default:t(()=>[e(x,{name:"print"})]),_:1}),e(u,null,{default:t(()=>[e(_,null,{default:t(()=>[n(m(r.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):p("",!0),(d(!0),N(S,null,H(a.configImpressaoCarne,r=>(d(),f(F,{key:r.valor,onClick:s=>l.$imprimir(r.valor,(a.dados.fatura||{}).id||"0"),clickable:"",class:"hideondesktop"},{default:t(()=>[e(u,{avatar:""},{default:t(()=>[e(x,{name:"print"})]),_:1}),e(u,null,{default:t(()=>[e(_,null,{default:t(()=>[n(m(r.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),(d(!0),N(S,null,H(a.configImpressaoConvenio,r=>(d(),f(F,{key:r.valor,onClick:s=>l.$imprimir(r.valor,(a.dados.fatura||{}).id||"0"),clickable:"",class:"hideondesktop"},{default:t(()=>[e(u,{avatar:""},{default:t(()=>[e(x,{name:"print"})]),_:1}),e(u,null,{default:t(()=>[e(_,null,{default:t(()=>[n(m(r.texto),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]}),_:1})),[[ie]])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):p("",!0),Y(e(T,{gutter:"md-x lg-y"},{default:t(()=>[a.dados.fatura.totalDesconto?(d(),f(k,{key:0,col:"xs12"},{default:t(()=>[e(P,{class:ne([`${a.width<=992?"text-left":"text-right"}`,"q-pr-sm"]),text:"sub2 regular"},{default:t(()=>[o[55]||(o[55]=n(" Desconto: ")),A("span",nt,m(l.$filters.numero(a.dados.fatura.totalDesconto,2)),1)]),_:1},8,["class"])]),_:1})):p("",!0),e(k,{col:"xs12 md6",bordered:""},{default:t(()=>[a.dados.fatura.observacaoFaturamento||l.condicaoPagamentoResumo.length||a.dados.fatura.totalDesconto?(d(),f(P,{key:0,icon:`attach_money ${a.width<=992?"15px":"xs"} tertiary left`,text:"sub2 medium",class:"q-mb-md"},{default:t(()=>o[56]||(o[56]=[n(" Faturamento ")])),_:1},8,["icon"])):p("",!0),a.dados.fatura.observacaoFaturamento?(d(),f(P,{key:1,text:"sub2 regular",class:"q-mb-md q-mx-xs"},{default:t(()=>[o[57]||(o[57]=A("span",{class:"text-weight-medium q-pr-sm"},"Obs.:",-1)),n(" "+m(a.dados.fatura.observacaoFaturamento),1)]),_:1})):p("",!0),l.condicaoPagamentoResumo.length?(d(),f(te,{key:2},{default:t(()=>[(d(!0),N(S,null,H(l.condicaoPagamentoResumo,i=>(d(),f(F,{key:i.id,class:ne([`${l.condicaoPagamentoResumo.length>1?"border-bottom":""}`,"q-px-sm q-py-none q-mb-md"])},{default:t(()=>[e(u,null,{default:t(()=>[e(_,{class:"text-weight-medium"},{default:t(()=>[n(m(i.formaPagamento),1)]),_:2},1024),e(u,{class:"hideondesktop"},{default:t(()=>[e(F,{class:"q-pa-none"},{default:t(()=>[e(u,{class:"maxw80 no-margin"},{default:t(()=>[e(_,{caption:"",class:"text-weight-medium"},{default:t(()=>[n(m(l.$filters.data(i.dataVencimento)),1)]),_:2},1024),e(_,{caption:""},{default:t(()=>[n(m(l.$filters.hora(i.dataVencimento)),1)]),_:2},1024)]),_:2},1024),e(u,{class:"no-margin"},{default:t(()=>[e(_,{class:"text-right text-weight-medium"},{default:t(()=>[n(m(l.$filters.numero(i.valor,2)),1)]),_:2},1024),i.parcelas?(d(),f(_,{key:0,caption:"",class:"text-right"},{default:t(()=>[n(m(i.parcelas>1?`(${i.parcelas}x)`:""),1)]),_:2},1024)):p("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(u,{class:"maxw80 no-margin hideonmobile"},{default:t(()=>[e(_,{class:"text-weight-medium"},{default:t(()=>[n(m(l.$filters.data(i.dataVencimento)),1)]),_:2},1024),e(_,{caption:""},{default:t(()=>[n(m(l.$filters.hora(i.dataVencimento)),1)]),_:2},1024)]),_:2},1024),e(u,{class:"maxw100 no-margin hideonmobile"},{default:t(()=>[e(_,{class:"text-right text-weight-medium"},{default:t(()=>[n(m(l.$filters.numero(i.valor,2)),1)]),_:2},1024),i.parcelas?(d(),f(_,{key:0,caption:"",class:"text-right"},{default:t(()=>[n(m(i.parcelas>1?`(${i.parcelas}x)`:""),1)]),_:2},1024)):p("",!0)]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1})):p("",!0)]),_:1}),e(k,{col:"xs12 md6",bordered:""},{default:t(()=>[e(R,{idFatura:a.dados.fatura.id,ref:"documentosFiscais"},null,8,["idFatura"])]),_:1})]),_:1},512),[[ye,a.dados.fatura.id&&a.detalhesVisivel]]),a.dados.fatura.id?(d(),f(oe,{key:1})):p("",!0)],64)):p("",!0),e(w,{onExecutar:c.executar,ref:"faturaModal"},null,8,["onExecutar"]),e(y,{ref:"modalHistoricoStatus"},null,512),e(I,{onFechar:c.fechouNFe},null,8,["onFechar"]),e(B,{modelValue:a.boletos.visivel,"onUpdate:modelValue":o[26]||(o[26]=i=>a.boletos.visivel=i),fatura:a.boletos.fatura},null,8,["modelValue","fatura"])])}var bt=_e(tt,[["render",dt]]);export{bt as F};
